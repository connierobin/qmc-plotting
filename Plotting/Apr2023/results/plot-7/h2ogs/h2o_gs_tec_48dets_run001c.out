Rank =    0  Free Memory = 58292 MB
Rank =    1  Free Memory = 58284 MB
Rank =    2  Free Memory = 58284 MB
Rank =    3  Free Memory = 58284 MB
Rank =    4  Free Memory = 58284 MB
Rank =    5  Free Memory = 58283 MB
Rank =    6  Free Memory = 58283 MB
Rank =    7  Free Memory = 58283 MB
Rank =    8  Free Memory = 58283 MB
Rank =    9  Free Memory = 58282 MB
Rank =   10  Free Memory = 58282 MB
Rank =   11  Free Memory = 58282 MB
Rank =   12  Free Memory = 58282 MB
Rank =   13  Free Memory = 58282 MB
Rank =   14  Free Memory = 58282 MB
Rank =   15  Free Memory = 58269 MB
Rank =   16  Free Memory = 58266 MB
Rank =   17  Free Memory = 58266 MB
Rank =   18  Free Memory = 58266 MB
Rank =   19  Free Memory = 58266 MB
Rank =   20  Free Memory = 58266 MB
Rank =   21  Free Memory = 58266 MB
Rank =   22  Free Memory = 58266 MB
Rank =   23  Free Memory = 58266 MB
Rank =   24  Free Memory = 56259 MB
Rank =   25  Free Memory = 56259 MB
Rank =   26  Free Memory = 56259 MB
Rank =   27  Free Memory = 56259 MB
Rank =   28  Free Memory = 56259 MB
Rank =   29  Free Memory = 56259 MB
Rank =   30  Free Memory = 56259 MB
Rank =   31  Free Memory = 56259 MB
Rank =   32  Free Memory = 56259 MB
Rank =   33  Free Memory = 56259 MB
Rank =   34  Free Memory = 56259 MB
Rank =   35  Free Memory = 56259 MB
Rank =   36  Free Memory = 56259 MB
Rank =   37  Free Memory = 56259 MB
Rank =   38  Free Memory = 56259 MB
Rank =   39  Free Memory = 56259 MB
Rank =   40  Free Memory = 56259 MB
Rank =   41  Free Memory = 56259 MB
Rank =   42  Free Memory = 56259 MB
Rank =   43  Free Memory = 56259 MB
Rank =   44  Free Memory = 56259 MB
Rank =   45  Free Memory = 56259 MB
Rank =   46  Free Memory = 56259 MB
Rank =   47  Free Memory = 56259 MB
Rank =   48  Free Memory = 56344 MB
Rank =   49  Free Memory = 56344 MB
Rank =   50  Free Memory = 56344 MB
Rank =   51  Free Memory = 56344 MB
Rank =   52  Free Memory = 56344 MB
Rank =   53  Free Memory = 56344 MB
Rank =   54  Free Memory = 56344 MB
Rank =   55  Free Memory = 56344 MB
Rank =   56  Free Memory = 56344 MB
Rank =   57  Free Memory = 56344 MB
Rank =   58  Free Memory = 56344 MB
Rank =   59  Free Memory = 56344 MB
Rank =   60  Free Memory = 56344 MB
Rank =   61  Free Memory = 56344 MB
Rank =   62  Free Memory = 56344 MB
Rank =   63  Free Memory = 56344 MB
Rank =   64  Free Memory = 56343 MB
Rank =   65  Free Memory = 56343 MB
Rank =   66  Free Memory = 56343 MB
Rank =   67  Free Memory = 56343 MB
Rank =   68  Free Memory = 56343 MB
Rank =   69  Free Memory = 56343 MB
Rank =   70  Free Memory = 56343 MB
Rank =   71  Free Memory = 56343 MB
Rank =   72  Free Memory = 54511 MB
Rank =   73  Free Memory = 54511 MB
Rank =   74  Free Memory = 54511 MB
Rank =   75  Free Memory = 54511 MB
Rank =   76  Free Memory = 54511 MB
Rank =   77  Free Memory = 54511 MB
Rank =   78  Free Memory = 54511 MB
Rank =   79  Free Memory = 54511 MB
Rank =   80  Free Memory = 54511 MB
Rank =   81  Free Memory = 54511 MB
Rank =   82  Free Memory = 54511 MB
Rank =   83  Free Memory = 54511 MB
Rank =   84  Free Memory = 54511 MB
Rank =   85  Free Memory = 54511 MB
Rank =   86  Free Memory = 54511 MB
Rank =   87  Free Memory = 54511 MB
Rank =   88  Free Memory = 54511 MB
Rank =   89  Free Memory = 54511 MB
Rank =   90  Free Memory = 54511 MB
Rank =   91  Free Memory = 54506 MB
Rank =   92  Free Memory = 54504 MB
Rank =   93  Free Memory = 54504 MB
Rank =   94  Free Memory = 54504 MB
Rank =   95  Free Memory = 54504 MB
  Input file(s): opt_h2o_gs_tec_48dets_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_48dets_run001c.xml

  Project = H2O
  date    = 2023-05-04 11:51:18 PDT
  host    = n0131.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 678

  Range of prime numbers to use as seeds over processors and threads = 5087-5897


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.084906e-01    1         1  ON     0
     uu_1                 5.267492e-02    1         1  ON     1
     uu_2                -3.672328e-02    1         1  ON     2
     uu_3                -8.984987e-02    1         1  ON     3
     uu_4                -1.217617e-01    1         1  ON     4
     uu_5                -1.312712e-01    1         1  ON     5
     uu_6                -1.137552e-01    1         1  ON     6
     uu_7                -5.646654e-02    1         1  ON     7
     uu_8                 5.948112e-02    1         1  ON     8
     uu_9                 1.220871e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.006703e-01    1         1  ON     0
     ud_1                 7.340215e-02    1         1  ON     1
     ud_2                -2.594437e-02    1         1  ON     2
     ud_3                -7.709097e-02    1         1  ON     3
     ud_4                -1.122879e-01    1         1  ON     4
     ud_5                -1.317609e-01    1         1  ON     5
     ud_6                -1.269123e-01    1         1  ON     6
     ud_7                -8.779749e-02    1         1  ON     7
     ud_8                -4.235440e-03    1         1  ON     8
     ud_9                 8.491370e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.932043e-01    1         1  ON     0
     eO_1                -4.132229e-01    1         1  ON     1
     eO_2                -4.142654e-02    1         1  ON     2
     eO_3                 1.783598e-01    1         1  ON     3
     eO_4                 2.499460e-01    1         1  ON     4
     eO_5                 2.747759e-01    1         1  ON     5
     eO_6                 2.477584e-01    1         1  ON     6
     eO_7                 1.370902e-01    1         1  ON     7
     eO_8                 2.907815e-02    1         1  ON     8
     eO_9                 1.941143e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.054429e-01    1         1  ON     0
     eH1_1                -1.005068e-01    1         1  ON     1
     eH1_2                -4.948312e-02    1         1  ON     2
     eH1_3                -1.791148e-02    1         1  ON     3
     eH1_4                 1.722512e-02    1         1  ON     4
     eH1_5                 2.532599e-02    1         1  ON     5
     eH1_6                 7.901743e-02    1         1  ON     6
     eH1_7                 1.070401e-01    1         1  ON     7
     eH1_8                 1.027396e-01    1         1  ON     8
     eH1_9                 2.587884e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.016950e-01    1         1  ON     0
     eH2_1                -9.694478e-02    1         1  ON     1
     eH2_2                -4.657011e-02    1         1  ON     2
     eH2_3                -1.598591e-02    1         1  ON     3
     eH2_4                 1.733486e-02    1         1  ON     4
     eH2_5                 2.121233e-02    1         1  ON     5
     eH2_6                 7.058523e-02    1         1  ON     6
     eH2_7                 1.059928e-01    1         1  ON     7
     eH2_8                 1.046974e-01    1         1  ON     8
     eH2_9                 2.830401e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.690905e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8704e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 97
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1718
    reference variance = 0.216881
====================================================
  Execution time = 2.7938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8374e-01
  Total weights = 1.966721690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3761e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275175830998
                                         uncertainty =       0.001772755529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275175830998
                                         uncertainty =       0.001772755529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370914802
  error estimate for blocks of size 2^( 2) =       0.000385045736
  error estimate for blocks of size 2^( 3) =       0.000398036863
  error estimate for blocks of size 2^( 4) =       0.000407657500
  error estimate for blocks of size 2^( 5) =       0.000414110554
  error estimate for blocks of size 2^( 6) =       0.000418006161
  error estimate for blocks of size 2^( 7) =       0.000417097539

      target function =      -0.938614225649
              le_mean =     -17.209324339836
             les_mean =     296.444579878351
             stat err =       0.000414217939
             autocorr =       1.247123540975
   target nu stat err =       0.000414217939
   target dn stat err =       0.002340798608
      target stat err =       0.003976485173
              std dev =       0.524561135676
             le_variance =       0.275164385061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720932433984e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938629893900       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938687471722       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938703328987       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938708232168       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938710221130       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938710379042       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938710280289       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938710572510       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938711483221       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938712316641       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938712982625       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938713551750       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938713664239       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938714423862       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938714809734       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938715232491       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938715224524       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938715380767       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938715680501       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938715983822       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938716034196       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938716162987       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938715818563       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938715844236       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938715843975       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938715841951       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938715783264       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938715904781       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938715907292       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938715917140       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938715938654       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938715897991       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938715872889       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938715983762       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938716083325       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938716080630       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938716029134       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938715973366       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938715934390       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938716009924       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938716015927       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938716025110       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938716045517       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.938716052914       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938716048674       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.068581e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938629893900       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938647442672       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938652082612       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938653431097       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938654035408       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938654074664       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938654039253       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938654100857       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938654375069       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938654612329       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938654816228       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938654974417       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938654999636       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938655212768       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938655295694       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938655414103       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938655412145       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938655455580       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938655532224       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938655591383       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938655592790       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938655633882       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938655555307       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938655559439       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938655549307       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938655533410       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938655524126       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938655561785       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938655562668       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938655562018       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938655557385       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938655552769       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938655552992       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938655585872       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938655592266       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938655589416       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938655580113       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938655571112       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938655568400       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938655577748       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938655579175       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 2.889782e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938629893900       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938634535353       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938635746150       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938636091510       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938636251412       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938636260896       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938636251093       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938636265532       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938636337623       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938636399384       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938636453291       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938636493629       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938636499586       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938636554373       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938636573802       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938636604461       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938636604075       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938636615270       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938636634302       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938636647489       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938636647117       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938636658124       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938636639395       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938636640007       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938636636448       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938636631559       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938636630023       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938636639691       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938636639853       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938636639072       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938636637732       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938636637247       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938636637486       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938636645561       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938636646115       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938636645481       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938636643437       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938636641645       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938636641233       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938636642899       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 7.383756e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6455e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.085434e-01                 1 1 ON  0
uu_1   5.274597e-02                 1 1 ON  1
uu_2   -3.664373e-02                1 1 ON  2
uu_3   -8.973114e-02                1 1 ON  3
uu_4   -1.216399e-01                1 1 ON  4
uu_5   -1.312505e-01                1 1 ON  5
uu_6   -1.138530e-01                1 1 ON  6
uu_7   -5.665242e-02                1 1 ON  7
uu_8   5.925124e-02                 1 1 ON  8
uu_9   1.220500e-01                 1 1 ON  9
ud_0   3.005827e-01                 1 1 ON  10
ud_1   7.328806e-02                 1 1 ON  11
ud_2   -2.605269e-02                1 1 ON  12
ud_3   -7.717640e-02                1 1 ON  13
ud_4   -1.123544e-01                1 1 ON  14
ud_5   -1.317322e-01                1 1 ON  15
ud_6   -1.267417e-01                1 1 ON  16
ud_7   -8.750851e-02                1 1 ON  17
ud_8   -4.234702e-03                1 1 ON  18
ud_9   8.479818e-02                 1 1 ON  19
eO_0   -6.931575e-01                1 1 ON  20
eO_1   -4.131512e-01                1 1 ON  21
eO_2   -4.142872e-02                1 1 ON  22
eO_3   1.783651e-01                 1 1 ON  23
eO_4   2.499184e-01                 1 1 ON  24
eO_5   2.745525e-01                 1 1 ON  25
eO_6   2.476672e-01                 1 1 ON  26
eO_7   1.373025e-01                 1 1 ON  27
eO_8   2.907848e-02                 1 1 ON  28
eO_9   1.941339e-02                 1 1 ON  29
eH1_0  -2.054655e-01                1 1 ON  30
eH1_1  -1.004941e-01                1 1 ON  31
eH1_2  -4.938634e-02                1 1 ON  32
eH1_3  -1.793570e-02                1 1 ON  33
eH1_4  1.710977e-02                 1 1 ON  34
eH1_5  2.521712e-02                 1 1 ON  35
eH1_6  7.910338e-02                 1 1 ON  36
eH1_7  1.069980e-01                 1 1 ON  37
eH1_8  1.028511e-01                 1 1 ON  38
eH1_9  2.587517e-02                 1 1 ON  39
eH2_0  -2.018545e-01                1 1 ON  40
eH2_1  -9.701443e-02                1 1 ON  41
eH2_2  -4.653143e-02                1 1 ON  42
eH2_3  -1.584245e-02                1 1 ON  43
eH2_4  1.739505e-02                 1 1 ON  44
eH2_5  2.128349e-02                 1 1 ON  45
eH2_6  7.054798e-02                 1 1 ON  46
eH2_7  1.058740e-01                 1 1 ON  47
eH2_8  1.047621e-01                 1 1 ON  48
eH2_9  2.831854e-02                 1 1 ON  49
ci_001 -4.227299e-02                3 1 ON  50
ci_002 -3.108047e-02                3 1 ON  51
ci_003 -2.573741e-02                3 1 ON  52
ci_004 2.450976e-02                 3 1 ON  53
ci_005 2.461922e-02                 3 1 ON  54
ci_006 -2.032863e-02                3 1 ON  55
ci_007 -2.042385e-02                3 1 ON  56
ci_008 -8.955638e-03                3 1 ON  57
ci_009 -1.495099e-02                3 1 ON  58
ci_010 -9.459744e-03                3 1 ON  59
ci_011 -1.025334e-02                3 1 ON  60
ci_012 -1.006950e-02                3 1 ON  61
ci_013 -1.948502e-02                3 1 ON  62
ci_014 1.305646e-02                 3 1 ON  63
ci_015 1.316158e-02                 3 1 ON  64
ci_016 1.640963e-02                 3 1 ON  65
ci_017 1.618479e-02                 3 1 ON  66
ci_018 1.024667e-02                 3 1 ON  67
ci_019 1.037805e-02                 3 1 ON  68
ci_020 1.647122e-02                 3 1 ON  69
ci_021 1.638103e-02                 3 1 ON  70
ci_022 1.059132e-02                 3 1 ON  71
ci_023 9.376610e-03                 3 1 ON  72
ci_024 7.516249e-03                 3 1 ON  73
ci_025 6.208806e-03                 3 1 ON  74
ci_026 1.168484e-02                 3 1 ON  75
ci_027 1.161055e-02                 3 1 ON  76
ci_028 -1.521296e-02                3 1 ON  77
ci_029 -1.536128e-02                3 1 ON  78
ci_030 -4.436560e-03                3 1 ON  79
ci_031 -4.879433e-03                3 1 ON  80
ci_032 -1.535313e-02                3 1 ON  81
ci_033 6.955132e-03                 3 1 ON  82
ci_034 7.302843e-03                 3 1 ON  83
ci_035 -4.604766e-03                3 1 ON  84
ci_036 -1.276840e-02                3 1 ON  85
ci_037 -1.281505e-02                3 1 ON  86
ci_038 1.148275e-03                 3 1 ON  87
ci_039 1.371617e-03                 3 1 ON  88
ci_040 -2.663067e-03                3 1 ON  89
ci_041 8.462341e-03                 3 1 ON  90
ci_042 8.395933e-03                 3 1 ON  91
ci_043 -3.626760e-03                3 1 ON  92
ci_044 -4.638180e-03                3 1 ON  93
ci_045 -2.798936e-03                3 1 ON  94
ci_046 5.810994e-03                 3 1 ON  95
ci_047 5.597739e-03                 3 1 ON  96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2719
    reference variance = 0.194422
====================================================
  Execution time = 2.7412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9263e-01
  Total weights = 1.9663e+06
  Execution time = 2.3381e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282902290826
                                         uncertainty =       0.005134159080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282902290826
                                         uncertainty =       0.005134159080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376053029
  error estimate for blocks of size 2^( 2) =       0.000390381410
  error estimate for blocks of size 2^( 3) =       0.000403142033
  error estimate for blocks of size 2^( 4) =       0.000412792738
  error estimate for blocks of size 2^( 5) =       0.000418284877
  error estimate for blocks of size 2^( 6) =       0.000421649851
  error estimate for blocks of size 2^( 7) =       0.000422281701

      target function =      -0.923261315981
              le_mean =     -17.210496874671
             les_mean =     296.494216393826
             stat err =       0.000418752292
             autocorr =       1.239984371799
   target nu stat err =       0.000418752292
   target dn stat err =       0.005248385683
      target stat err =       0.008528300952
              std dev =       0.531827802567
             le_variance =       0.282840811583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282846279262
                                         uncertainty =       0.005118201066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282846279262
                                         uncertainty =       0.005118201066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376015286
  error estimate for blocks of size 2^( 2) =       0.000390368747
  error estimate for blocks of size 2^( 3) =       0.000403153162
  error estimate for blocks of size 2^( 4) =       0.000412832429
  error estimate for blocks of size 2^( 5) =       0.000418336610
  error estimate for blocks of size 2^( 6) =       0.000421710136
  error estimate for blocks of size 2^( 7) =       0.000422356597

      target function =      -0.900050770781
              le_mean =     -17.210503061286
             les_mean =     296.508769377237
             stat err =       0.000418808943
             autocorr =       1.240568910405
   target nu stat err =       0.000418808943
   target dn stat err =       0.015604032593
      target stat err =       0.024033277059
              std dev =       0.531774425137
             le_variance =       0.282784039230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282864079249
                                         uncertainty =       0.005124437575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282864079249
                                         uncertainty =       0.005124437575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376027318
  error estimate for blocks of size 2^( 2) =       0.000390370217
  error estimate for blocks of size 2^( 3) =       0.000403144911
  error estimate for blocks of size 2^( 4) =       0.000412812252
  error estimate for blocks of size 2^( 5) =       0.000418310658
  error estimate for blocks of size 2^( 6) =       0.000421681173
  error estimate for blocks of size 2^( 7) =       0.000422322546

      target function =      -0.923734570520
              le_mean =     -17.210500122625
             les_mean =     296.494036260529
             stat err =       0.000418781657
             autocorr =       1.240327883210
   target nu stat err =       0.000418781657
   target dn stat err =       0.005227212639
      target stat err =       0.008502881103
              std dev =       0.531791441769
             le_variance =       0.282802137539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282896642548
                                         uncertainty =       0.005132867254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282896642548
                                         uncertainty =       0.005132867254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376049233
  error estimate for blocks of size 2^( 2) =       0.000390379520
  error estimate for blocks of size 2^( 3) =       0.000403141864
  error estimate for blocks of size 2^( 4) =       0.000412794473
  error estimate for blocks of size 2^( 5) =       0.000418286979
  error estimate for blocks of size 2^( 6) =       0.000421651902
  error estimate for blocks of size 2^( 7) =       0.000422284357

      target function =      -0.847221739201
              le_mean =     -17.210496905801
             les_mean =     296.541717353690
             stat err =       0.000418754428
             autocorr =       1.240022052882
   target nu stat err =       0.000418754428
   target dn stat err =       0.048074567103
      target stat err =       0.065930664113
              std dev =       0.531822434895
             le_variance =       0.282835102258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923261315981        initial
     2.5000e-01     2.5000e+00             1.0686e-03        -0.900050770781
     1.0000e+00     1.0000e+01             2.8898e-04        -0.923734570520  <--
     4.0000e+00     4.0000e+01             7.3838e-05        -0.847221739201

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 3.9224e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.085434e-01 1 1  ON 0
  uu_1                 5.274597e-02 1 1  ON 1
  uu_2                -3.664373e-02 1 1  ON 2
  uu_3                -8.973114e-02 1 1  ON 3
  uu_4                -1.216399e-01 1 1  ON 4
  uu_5                -1.312505e-01 1 1  ON 5
  uu_6                -1.138530e-01 1 1  ON 6
  uu_7                -5.665242e-02 1 1  ON 7
  uu_8                 5.925124e-02 1 1  ON 8
  uu_9                 1.220500e-01 1 1  ON 9
  ud_0                 3.005827e-01 1 1  ON 10
  ud_1                 7.328806e-02 1 1  ON 11
  ud_2                -2.605269e-02 1 1  ON 12
  ud_3                -7.717640e-02 1 1  ON 13
  ud_4                -1.123544e-01 1 1  ON 14
  ud_5                -1.317322e-01 1 1  ON 15
  ud_6                -1.267417e-01 1 1  ON 16
  ud_7                -8.750851e-02 1 1  ON 17
  ud_8                -4.234702e-03 1 1  ON 18
  ud_9                 8.479818e-02 1 1  ON 19
  eO_0                -6.931575e-01 1 1  ON 20
  eO_1                -4.131512e-01 1 1  ON 21
  eO_2                -4.142872e-02 1 1  ON 22
  eO_3                 1.783651e-01 1 1  ON 23
  eO_4                 2.499184e-01 1 1  ON 24
  eO_5                 2.745525e-01 1 1  ON 25
  eO_6                 2.476672e-01 1 1  ON 26
  eO_7                 1.373025e-01 1 1  ON 27
  eO_8                 2.907848e-02 1 1  ON 28
  eO_9                 1.941339e-02 1 1  ON 29
 eH1_0                -2.054655e-01 1 1  ON 30
 eH1_1                -1.004941e-01 1 1  ON 31
 eH1_2                -4.938634e-02 1 1  ON 32
 eH1_3                -1.793570e-02 1 1  ON 33
 eH1_4                 1.710977e-02 1 1  ON 34
 eH1_5                 2.521712e-02 1 1  ON 35
 eH1_6                 7.910338e-02 1 1  ON 36
 eH1_7                 1.069980e-01 1 1  ON 37
 eH1_8                 1.028511e-01 1 1  ON 38
 eH1_9                 2.587517e-02 1 1  ON 39
 eH2_0                -2.018545e-01 1 1  ON 40
 eH2_1                -9.701443e-02 1 1  ON 41
 eH2_2                -4.653143e-02 1 1  ON 42
 eH2_3                -1.584245e-02 1 1  ON 43
 eH2_4                 1.739505e-02 1 1  ON 44
 eH2_5                 2.128349e-02 1 1  ON 45
 eH2_6                 7.054798e-02 1 1  ON 46
 eH2_7                 1.058740e-01 1 1  ON 47
 eH2_8                 1.047621e-01 1 1  ON 48
 eH2_9                 2.831854e-02 1 1  ON 49
ci_001                -4.227299e-02 3 1  ON 50
ci_002                -3.108047e-02 3 1  ON 51
ci_003                -2.573741e-02 3 1  ON 52
ci_004                 2.450976e-02 3 1  ON 53
ci_005                 2.461922e-02 3 1  ON 54
ci_006                -2.032863e-02 3 1  ON 55
ci_007                -2.042385e-02 3 1  ON 56
ci_008                -8.955638e-03 3 1  ON 57
ci_009                -1.495099e-02 3 1  ON 58
ci_010                -9.459744e-03 3 1  ON 59
ci_011                -1.025334e-02 3 1  ON 60
ci_012                -1.006950e-02 3 1  ON 61
ci_013                -1.948502e-02 3 1  ON 62
ci_014                 1.305646e-02 3 1  ON 63
ci_015                 1.316158e-02 3 1  ON 64
ci_016                 1.640963e-02 3 1  ON 65
ci_017                 1.618479e-02 3 1  ON 66
ci_018                 1.024667e-02 3 1  ON 67
ci_019                 1.037805e-02 3 1  ON 68
ci_020                 1.647122e-02 3 1  ON 69
ci_021                 1.638103e-02 3 1  ON 70
ci_022                 1.059132e-02 3 1  ON 71
ci_023                 9.376610e-03 3 1  ON 72
ci_024                 7.516249e-03 3 1  ON 73
ci_025                 6.208806e-03 3 1  ON 74
ci_026                 1.168484e-02 3 1  ON 75
ci_027                 1.161055e-02 3 1  ON 76
ci_028                -1.521296e-02 3 1  ON 77
ci_029                -1.536128e-02 3 1  ON 78
ci_030                -4.436560e-03 3 1  ON 79
ci_031                -4.879433e-03 3 1  ON 80
ci_032                -1.535313e-02 3 1  ON 81
ci_033                 6.955132e-03 3 1  ON 82
ci_034                 7.302843e-03 3 1  ON 83
ci_035                -4.604766e-03 3 1  ON 84
ci_036                -1.276840e-02 3 1  ON 85
ci_037                -1.281505e-02 3 1  ON 86
ci_038                 1.148275e-03 3 1  ON 87
ci_039                 1.371617e-03 3 1  ON 88
ci_040                -2.663067e-03 3 1  ON 89
ci_041                 8.462341e-03 3 1  ON 90
ci_042                 8.395933e-03 3 1  ON 91
ci_043                -3.626760e-03 3 1  ON 92
ci_044                -4.638180e-03 3 1  ON 93
ci_045                -2.798936e-03 3 1  ON 94
ci_046                 5.810994e-03 3 1  ON 95
ci_047                 5.597739e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2978
    reference variance = 0.187768
====================================================
  Execution time = 2.7733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0488e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8469e-01
  Total weights = 1.966176405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4913e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275478532370
                                         uncertainty =       0.002412613963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275478532370
                                         uncertainty =       0.002412613963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371200514
  error estimate for blocks of size 2^( 2) =       0.000385103500
  error estimate for blocks of size 2^( 3) =       0.000398341006
  error estimate for blocks of size 2^( 4) =       0.000408083514
  error estimate for blocks of size 2^( 5) =       0.000413967996
  error estimate for blocks of size 2^( 6) =       0.000416325721
  error estimate for blocks of size 2^( 7) =       0.000418937022

      target function =      -0.937016111912
              le_mean =     -17.209374372337
             les_mean =     296.447257210720
             stat err =       0.000414328563
             autocorr =       1.245869659880
   target nu stat err =       0.000414328563
   target dn stat err =       0.002665698739
      target stat err =       0.004495932965
              std dev =       0.524965200949
             le_variance =       0.275588462208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720937437234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937036884833       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937126155366       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937146519354       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937149686642       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937152583680       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937153329592       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937153951417       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937154417791       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937154838692       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937155626089       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937156640730       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937156371390       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937156054604       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937156393255       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937156183109       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937156500121       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937157149684       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937157405104       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937157531267       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937157660018       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937157897539       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937158000251       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937158490892       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937158253995       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937158616155       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937158412248       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937158603399       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937158779473       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937158750305       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937158934651       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937158821802       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937158784755       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937158810271       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937158811773       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937158832311       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937158847218       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937158859311       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937158861021       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937158828738       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937158854369       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937158827052       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937158816174       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937158810528       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937158852720       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937158872011       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937158863215       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.169795e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937036884833       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937064101615       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937070046317       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937070955217       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937071787872       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937071982564       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937072167139       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937072291116       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937072416872       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937072645133       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937072937141       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937072829175       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937072718278       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937072810788       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937072763796       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937072846801       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937073024981       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937073083797       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937073115581       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937073150448       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937073212248       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937073245335       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937073366849       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937073287685       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937073377632       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937073332218       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937073383814       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937073412714       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937073403809       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937073434226       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937073407509       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937073401545       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937073414831       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937073414066       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937073415502       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937073417525       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937073420441       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937073419680       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937073419819       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937073419044       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937073414013       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937073409137       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937073411672       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937073419702       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 3.029139e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937036884833       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937044084084       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937045634693       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937045870613       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937046086759       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937046135826       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937046184342       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937046215528       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937046248673       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937046308490       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937046383818       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937046353246       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937046323038       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937046346903       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937046335800       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937046357063       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937046402509       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937046416617       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937046424599       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937046433408       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937046449149       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937046458013       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937046487424       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937046466480       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937046489187       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937046478419       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937046491304       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937046497362       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937046494969       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937046501439       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937046495147       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937046493991       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937046497665       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937046497393       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937046497390       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937046497825       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937046498619       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937046498402       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937046498690       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937046498207       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937046496974       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 7.603344e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6330e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.084951e-01 1 1  ON 0
  uu_1                 5.271496e-02 1 1  ON 1
  uu_2                -3.661476e-02 1 1  ON 2
  uu_3                -8.969284e-02 1 1  ON 3
  uu_4                -1.216210e-01 1 1  ON 4
  uu_5                -1.312001e-01 1 1  ON 5
  uu_6                -1.138963e-01 1 1  ON 6
  uu_7                -5.652647e-02 1 1  ON 7
  uu_8                 5.894833e-02 1 1  ON 8
  uu_9                 1.220919e-01 1 1  ON 9
  ud_0                 3.004695e-01 1 1  ON 10
  ud_1                 7.319240e-02 1 1  ON 11
  ud_2                -2.610221e-02 1 1  ON 12
  ud_3                -7.719060e-02 1 1  ON 13
  ud_4                -1.123209e-01 1 1  ON 14
  ud_5                -1.316608e-01 1 1  ON 15
  ud_6                -1.266812e-01 1 1  ON 16
  ud_7                -8.741172e-02 1 1  ON 17
  ud_8                -4.267127e-03 1 1  ON 18
  ud_9                 8.473757e-02 1 1  ON 19
  eO_0                -6.930594e-01 1 1  ON 20
  eO_1                -4.131642e-01 1 1  ON 21
  eO_2                -4.159959e-02 1 1  ON 22
  eO_3                 1.783152e-01 1 1  ON 23
  eO_4                 2.498564e-01 1 1  ON 24
  eO_5                 2.745196e-01 1 1  ON 25
  eO_6                 2.476242e-01 1 1  ON 26
  eO_7                 1.375427e-01 1 1  ON 27
  eO_8                 2.911924e-02 1 1  ON 28
  eO_9                 1.940511e-02 1 1  ON 29
 eH1_0                -2.052872e-01 1 1  ON 30
 eH1_1                -1.003043e-01 1 1  ON 31
 eH1_2                -4.923120e-02 1 1  ON 32
 eH1_3                -1.783841e-02 1 1  ON 33
 eH1_4                 1.695446e-02 1 1  ON 34
 eH1_5                 2.493047e-02 1 1  ON 35
 eH1_6                 7.888207e-02 1 1  ON 36
 eH1_7                 1.068911e-01 1 1  ON 37
 eH1_8                 1.029453e-01 1 1  ON 38
 eH1_9                 2.593340e-02 1 1  ON 39
 eH2_0                -2.019023e-01 1 1  ON 40
 eH2_1                -9.705114e-02 1 1  ON 41
 eH2_2                -4.658607e-02 1 1  ON 42
 eH2_3                -1.588136e-02 1 1  ON 43
 eH2_4                 1.732912e-02 1 1  ON 44
 eH2_5                 2.128750e-02 1 1  ON 45
 eH2_6                 7.072607e-02 1 1  ON 46
 eH2_7                 1.058406e-01 1 1  ON 47
 eH2_8                 1.048344e-01 1 1  ON 48
 eH2_9                 2.834450e-02 1 1  ON 49
ci_001                -4.224213e-02 3 1  ON 50
ci_002                -3.109964e-02 3 1  ON 51
ci_003                -2.578330e-02 3 1  ON 52
ci_004                 2.446711e-02 3 1  ON 53
ci_005                 2.458353e-02 3 1  ON 54
ci_006                -2.036841e-02 3 1  ON 55
ci_007                -2.041417e-02 3 1  ON 56
ci_008                -8.945959e-03 3 1  ON 57
ci_009                -1.494295e-02 3 1  ON 58
ci_010                -9.337477e-03 3 1  ON 59
ci_011                -1.026676e-02 3 1  ON 60
ci_012                -1.010244e-02 3 1  ON 61
ci_013                -1.952529e-02 3 1  ON 62
ci_014                 1.313074e-02 3 1  ON 63
ci_015                 1.318522e-02 3 1  ON 64
ci_016                 1.639465e-02 3 1  ON 65
ci_017                 1.624595e-02 3 1  ON 66
ci_018                 1.023989e-02 3 1  ON 67
ci_019                 1.034780e-02 3 1  ON 68
ci_020                 1.647598e-02 3 1  ON 69
ci_021                 1.636880e-02 3 1  ON 70
ci_022                 1.059768e-02 3 1  ON 71
ci_023                 9.459751e-03 3 1  ON 72
ci_024                 7.519445e-03 3 1  ON 73
ci_025                 6.318424e-03 3 1  ON 74
ci_026                 1.171773e-02 3 1  ON 75
ci_027                 1.156856e-02 3 1  ON 76
ci_028                -1.530919e-02 3 1  ON 77
ci_029                -1.534233e-02 3 1  ON 78
ci_030                -4.474722e-03 3 1  ON 79
ci_031                -4.886652e-03 3 1  ON 80
ci_032                -1.531132e-02 3 1  ON 81
ci_033                 6.984675e-03 3 1  ON 82
ci_034                 7.232145e-03 3 1  ON 83
ci_035                -4.598916e-03 3 1  ON 84
ci_036                -1.270887e-02 3 1  ON 85
ci_037                -1.284958e-02 3 1  ON 86
ci_038                 1.177458e-03 3 1  ON 87
ci_039                 1.407466e-03 3 1  ON 88
ci_040                -2.672411e-03 3 1  ON 89
ci_041                 8.369783e-03 3 1  ON 90
ci_042                 8.406106e-03 3 1  ON 91
ci_043                -3.615005e-03 3 1  ON 92
ci_044                -4.542314e-03 3 1  ON 93
ci_045                -2.780212e-03 3 1  ON 94
ci_046                 5.763793e-03 3 1  ON 95
ci_047                 5.620128e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.308226
====================================================
  Execution time = 2.7684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8745e-01
  Total weights = 1.9663e+06
  Execution time = 2.3488e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278733393338
                                         uncertainty =       0.003009950941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278733393338
                                         uncertainty =       0.003009950941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373321706
  error estimate for blocks of size 2^( 2) =       0.000387751106
  error estimate for blocks of size 2^( 3) =       0.000400782454
  error estimate for blocks of size 2^( 4) =       0.000410026980
  error estimate for blocks of size 2^( 5) =       0.000415785685
  error estimate for blocks of size 2^( 6) =       0.000418801918
  error estimate for blocks of size 2^( 7) =       0.000418366543

      target function =      -0.932254883981
              le_mean =     -17.209636678254
             les_mean =     296.459143485874
             stat err =       0.000415745281
             autocorr =       1.240189850942
   target nu stat err =       0.000415745281
   target dn stat err =       0.003884659254
      target stat err =       0.006443357475
              std dev =       0.527965067637
             le_variance =       0.278747112645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278617238354
                                         uncertainty =       0.002984444819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278617238354
                                         uncertainty =       0.002984444819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373244176
  error estimate for blocks of size 2^( 2) =       0.000387709725
  error estimate for blocks of size 2^( 3) =       0.000400776600
  error estimate for blocks of size 2^( 4) =       0.000410041838
  error estimate for blocks of size 2^( 5) =       0.000415814901
  error estimate for blocks of size 2^( 6) =       0.000418839032
  error estimate for blocks of size 2^( 7) =       0.000418393806

      target function =      -0.931840554514
              le_mean =     -17.209644447983
             les_mean =     296.459662825716
             stat err =       0.000415772394
             autocorr =       1.240866962200
   target nu stat err =       0.000415772394
   target dn stat err =       0.003849615040
      target stat err =       0.006380446569
              std dev =       0.527855420878
             le_variance =       0.278631345350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278658962604
                                         uncertainty =       0.002994448765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278658962604
                                         uncertainty =       0.002994448765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373272018
  error estimate for blocks of size 2^( 2) =       0.000387722920
  error estimate for blocks of size 2^( 3) =       0.000400775212
  error estimate for blocks of size 2^( 4) =       0.000410031724
  error estimate for blocks of size 2^( 5) =       0.000415799158
  error estimate for blocks of size 2^( 6) =       0.000418819976
  error estimate for blocks of size 2^( 7) =       0.000418378019

      target function =      -0.932265259682
              le_mean =     -17.209640586852
             les_mean =     296.459272069656
             stat err =       0.000415757219
             autocorr =       1.240591293358
   target nu stat err =       0.000415757219
   target dn stat err =       0.003853949428
      target stat err =       0.006393271704
              std dev =       0.527894796260
             le_variance =       0.278672915918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278722707660
                                         uncertainty =       0.003007891102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278722707660
                                         uncertainty =       0.003007891102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373314572
  error estimate for blocks of size 2^( 2) =       0.000387746779
  error estimate for blocks of size 2^( 3) =       0.000400780831
  error estimate for blocks of size 2^( 4) =       0.000410026871
  error estimate for blocks of size 2^( 5) =       0.000415786776
  error estimate for blocks of size 2^( 6) =       0.000418803553
  error estimate for blocks of size 2^( 7) =       0.000418367216

      target function =      -0.932183286968
              le_mean =     -17.209637063571
             les_mean =     296.459200272259
             stat err =       0.000415746104
             autocorr =       1.240242164557
   target nu stat err =       0.000415746104
   target dn stat err =       0.003879248118
      target stat err =       0.006433521144
              std dev =       0.527954977253
             le_variance =       0.278736458006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932254883981        initial
     2.5000e-01     2.5000e+00             1.1698e-03        -0.931840554514
     1.0000e+00     1.0000e+01             3.0291e-04        -0.932265259682  <--
     4.0000e+00     4.0000e+01             7.6033e-05        -0.932183286968

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 3.9542e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.084951e-01 1 1  ON 0
  uu_1                 5.271496e-02 1 1  ON 1
  uu_2                -3.661476e-02 1 1  ON 2
  uu_3                -8.969284e-02 1 1  ON 3
  uu_4                -1.216210e-01 1 1  ON 4
  uu_5                -1.312001e-01 1 1  ON 5
  uu_6                -1.138963e-01 1 1  ON 6
  uu_7                -5.652647e-02 1 1  ON 7
  uu_8                 5.894833e-02 1 1  ON 8
  uu_9                 1.220919e-01 1 1  ON 9
  ud_0                 3.004695e-01 1 1  ON 10
  ud_1                 7.319240e-02 1 1  ON 11
  ud_2                -2.610221e-02 1 1  ON 12
  ud_3                -7.719060e-02 1 1  ON 13
  ud_4                -1.123209e-01 1 1  ON 14
  ud_5                -1.316608e-01 1 1  ON 15
  ud_6                -1.266812e-01 1 1  ON 16
  ud_7                -8.741172e-02 1 1  ON 17
  ud_8                -4.267127e-03 1 1  ON 18
  ud_9                 8.473757e-02 1 1  ON 19
  eO_0                -6.930594e-01 1 1  ON 20
  eO_1                -4.131642e-01 1 1  ON 21
  eO_2                -4.159959e-02 1 1  ON 22
  eO_3                 1.783152e-01 1 1  ON 23
  eO_4                 2.498564e-01 1 1  ON 24
  eO_5                 2.745196e-01 1 1  ON 25
  eO_6                 2.476242e-01 1 1  ON 26
  eO_7                 1.375427e-01 1 1  ON 27
  eO_8                 2.911924e-02 1 1  ON 28
  eO_9                 1.940511e-02 1 1  ON 29
 eH1_0                -2.052872e-01 1 1  ON 30
 eH1_1                -1.003043e-01 1 1  ON 31
 eH1_2                -4.923120e-02 1 1  ON 32
 eH1_3                -1.783841e-02 1 1  ON 33
 eH1_4                 1.695446e-02 1 1  ON 34
 eH1_5                 2.493047e-02 1 1  ON 35
 eH1_6                 7.888207e-02 1 1  ON 36
 eH1_7                 1.068911e-01 1 1  ON 37
 eH1_8                 1.029453e-01 1 1  ON 38
 eH1_9                 2.593340e-02 1 1  ON 39
 eH2_0                -2.019023e-01 1 1  ON 40
 eH2_1                -9.705114e-02 1 1  ON 41
 eH2_2                -4.658607e-02 1 1  ON 42
 eH2_3                -1.588136e-02 1 1  ON 43
 eH2_4                 1.732912e-02 1 1  ON 44
 eH2_5                 2.128750e-02 1 1  ON 45
 eH2_6                 7.072607e-02 1 1  ON 46
 eH2_7                 1.058406e-01 1 1  ON 47
 eH2_8                 1.048344e-01 1 1  ON 48
 eH2_9                 2.834450e-02 1 1  ON 49
ci_001                -4.224213e-02 3 1  ON 50
ci_002                -3.109964e-02 3 1  ON 51
ci_003                -2.578330e-02 3 1  ON 52
ci_004                 2.446711e-02 3 1  ON 53
ci_005                 2.458353e-02 3 1  ON 54
ci_006                -2.036841e-02 3 1  ON 55
ci_007                -2.041417e-02 3 1  ON 56
ci_008                -8.945959e-03 3 1  ON 57
ci_009                -1.494295e-02 3 1  ON 58
ci_010                -9.337477e-03 3 1  ON 59
ci_011                -1.026676e-02 3 1  ON 60
ci_012                -1.010244e-02 3 1  ON 61
ci_013                -1.952529e-02 3 1  ON 62
ci_014                 1.313074e-02 3 1  ON 63
ci_015                 1.318522e-02 3 1  ON 64
ci_016                 1.639465e-02 3 1  ON 65
ci_017                 1.624595e-02 3 1  ON 66
ci_018                 1.023989e-02 3 1  ON 67
ci_019                 1.034780e-02 3 1  ON 68
ci_020                 1.647598e-02 3 1  ON 69
ci_021                 1.636880e-02 3 1  ON 70
ci_022                 1.059768e-02 3 1  ON 71
ci_023                 9.459751e-03 3 1  ON 72
ci_024                 7.519445e-03 3 1  ON 73
ci_025                 6.318424e-03 3 1  ON 74
ci_026                 1.171773e-02 3 1  ON 75
ci_027                 1.156856e-02 3 1  ON 76
ci_028                -1.530919e-02 3 1  ON 77
ci_029                -1.534233e-02 3 1  ON 78
ci_030                -4.474722e-03 3 1  ON 79
ci_031                -4.886652e-03 3 1  ON 80
ci_032                -1.531132e-02 3 1  ON 81
ci_033                 6.984675e-03 3 1  ON 82
ci_034                 7.232145e-03 3 1  ON 83
ci_035                -4.598916e-03 3 1  ON 84
ci_036                -1.270887e-02 3 1  ON 85
ci_037                -1.284958e-02 3 1  ON 86
ci_038                 1.177458e-03 3 1  ON 87
ci_039                 1.407466e-03 3 1  ON 88
ci_040                -2.672411e-03 3 1  ON 89
ci_041                 8.369783e-03 3 1  ON 90
ci_042                 8.406106e-03 3 1  ON 91
ci_043                -3.615005e-03 3 1  ON 92
ci_044                -4.542314e-03 3 1  ON 93
ci_045                -2.780212e-03 3 1  ON 94
ci_046                 5.763793e-03 3 1  ON 95
ci_047                 5.620128e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1917
    reference variance = 0.19552
====================================================
  Execution time = 2.7480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8488e-01
  Total weights = 1.966682604e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4083e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277607977617
                                         uncertainty =       0.001498529543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277607977617
                                         uncertainty =       0.001498529543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372557959
  error estimate for blocks of size 2^( 2) =       0.000386793104
  error estimate for blocks of size 2^( 3) =       0.000399716752
  error estimate for blocks of size 2^( 4) =       0.000409890288
  error estimate for blocks of size 2^( 5) =       0.000415537607
  error estimate for blocks of size 2^( 6) =       0.000418497212
  error estimate for blocks of size 2^( 7) =       0.000421095498

      target function =      -0.936709632612
              le_mean =     -17.209356108627
             les_mean =     296.446819642544
             stat err =       0.000416255151
             autocorr =       1.248336160306
   target nu stat err =       0.000416255151
   target dn stat err =       0.001867736194
      target stat err =       0.003192147063
              std dev =       0.526884948157
             le_variance =       0.277607748595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720935610863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936719484023       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936798014296       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936814949796       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936821588633       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936823295492       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936823987843       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936824688995       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936824492445       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936825791865       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936826724851       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936826302854       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936826849846       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936827379587       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936827824579       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936828543552       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936828431098       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936828834513       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936828877585       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936829068811       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936829108542       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936828944955       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936829247574       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936829479518       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936829895699       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936830033972       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936830321909       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936830296794       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936830270886       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936830248568       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936830204785       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936830215937       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936830293503       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936830343458       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936830372314       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936830355542       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936830378285       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936830406806       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936830424561       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936830409876       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936830467752       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936830449731       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936830434526       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936830438959       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936830430508       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936830420819       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.936830397659       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.701265e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936719484023       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936743446697       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936748409177       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936750317814       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936750785923       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936750967250       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936751176468       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936751099967       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936751441451       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936751745272       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936751617943       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936751753910       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936751939099       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936752049872       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936752237651       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936752190592       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936752294270       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936752302954       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936752357272       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936752357601       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936752311422       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936752392018       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936752461939       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936752576132       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936752596993       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936752658275       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936752644720       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936752635147       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936752624192       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936752615942       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936752621084       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936752638088       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936752647573       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936752648362       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936752649332       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936752657277       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936752660016       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936752661566       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936752660797       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936752673037       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936752667338       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936752663792       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 4.318783e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936719484023       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936725824258       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936727119985       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936727615949       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936727735517       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936727781562       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936727836385       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936727814967       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936727902033       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936727982727       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936727949760       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936727983340       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936728033916       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936728061195       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936728108235       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936728095088       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936728121315       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936728123358       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936728137379       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936728136535       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936728124719       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936728145234       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936728163695       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936728192693       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936728196675       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936728211031       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936728207298       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936728204687       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936728201823       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936728199871       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936728201575       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936728205493       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936728207472       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936728207434       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936728208123       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936728210107       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936728210478       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936728210722       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936728210795       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936728213504       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936728212065       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 1.084652e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5989e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.086313e-01 1 1  ON 0
  uu_1                 5.279939e-02 1 1  ON 1
  uu_2                -3.650999e-02 1 1  ON 2
  uu_3                -8.957327e-02 1 1  ON 3
  uu_4                -1.215342e-01 1 1  ON 4
  uu_5                -1.311383e-01 1 1  ON 5
  uu_6                -1.139959e-01 1 1  ON 6
  uu_7                -5.669501e-02 1 1  ON 7
  uu_8                 5.851645e-02 1 1  ON 8
  uu_9                 1.221374e-01 1 1  ON 9
  ud_0                 3.003001e-01 1 1  ON 10
  ud_1                 7.302986e-02 1 1  ON 11
  ud_2                -2.618831e-02 1 1  ON 12
  ud_3                -7.723801e-02 1 1  ON 13
  ud_4                -1.122987e-01 1 1  ON 14
  ud_5                -1.315748e-01 1 1  ON 15
  ud_6                -1.265733e-01 1 1  ON 16
  ud_7                -8.716132e-02 1 1  ON 17
  ud_8                -4.321018e-03 1 1  ON 18
  ud_9                 8.471870e-02 1 1  ON 19
  eO_0                -6.929959e-01 1 1  ON 20
  eO_1                -4.131479e-01 1 1  ON 21
  eO_2                -4.176916e-02 1 1  ON 22
  eO_3                 1.782126e-01 1 1  ON 23
  eO_4                 2.498318e-01 1 1  ON 24
  eO_5                 2.744486e-01 1 1  ON 25
  eO_6                 2.476838e-01 1 1  ON 26
  eO_7                 1.377801e-01 1 1  ON 27
  eO_8                 2.910249e-02 1 1  ON 28
  eO_9                 1.940628e-02 1 1  ON 29
 eH1_0                -2.052430e-01 1 1  ON 30
 eH1_1                -1.002299e-01 1 1  ON 31
 eH1_2                -4.920515e-02 1 1  ON 32
 eH1_3                -1.785773e-02 1 1  ON 33
 eH1_4                 1.697384e-02 1 1  ON 34
 eH1_5                 2.475193e-02 1 1  ON 35
 eH1_6                 7.880851e-02 1 1  ON 36
 eH1_7                 1.068341e-01 1 1  ON 37
 eH1_8                 1.030695e-01 1 1  ON 38
 eH1_9                 2.597020e-02 1 1  ON 39
 eH2_0                -2.018721e-01 1 1  ON 40
 eH2_1                -9.699646e-02 1 1  ON 41
 eH2_2                -4.654189e-02 1 1  ON 42
 eH2_3                -1.588831e-02 1 1  ON 43
 eH2_4                 1.723999e-02 1 1  ON 44
 eH2_5                 2.123610e-02 1 1  ON 45
 eH2_6                 7.065798e-02 1 1  ON 46
 eH2_7                 1.058526e-01 1 1  ON 47
 eH2_8                 1.049163e-01 1 1  ON 48
 eH2_9                 2.833752e-02 1 1  ON 49
ci_001                -4.223357e-02 3 1  ON 50
ci_002                -3.103697e-02 3 1  ON 51
ci_003                -2.576176e-02 3 1  ON 52
ci_004                 2.446672e-02 3 1  ON 53
ci_005                 2.460253e-02 3 1  ON 54
ci_006                -2.039744e-02 3 1  ON 55
ci_007                -2.041442e-02 3 1  ON 56
ci_008                -8.919899e-03 3 1  ON 57
ci_009                -1.497407e-02 3 1  ON 58
ci_010                -9.433121e-03 3 1  ON 59
ci_011                -1.019852e-02 3 1  ON 60
ci_012                -1.011103e-02 3 1  ON 61
ci_013                -1.949604e-02 3 1  ON 62
ci_014                 1.312035e-02 3 1  ON 63
ci_015                 1.321831e-02 3 1  ON 64
ci_016                 1.635036e-02 3 1  ON 65
ci_017                 1.619783e-02 3 1  ON 66
ci_018                 1.019727e-02 3 1  ON 67
ci_019                 1.029045e-02 3 1  ON 68
ci_020                 1.653275e-02 3 1  ON 69
ci_021                 1.649031e-02 3 1  ON 70
ci_022                 1.053710e-02 3 1  ON 71
ci_023                 9.489597e-03 3 1  ON 72
ci_024                 7.508494e-03 3 1  ON 73
ci_025                 6.347924e-03 3 1  ON 74
ci_026                 1.168613e-02 3 1  ON 75
ci_027                 1.164220e-02 3 1  ON 76
ci_028                -1.524536e-02 3 1  ON 77
ci_029                -1.535498e-02 3 1  ON 78
ci_030                -4.450382e-03 3 1  ON 79
ci_031                -4.919931e-03 3 1  ON 80
ci_032                -1.526657e-02 3 1  ON 81
ci_033                 7.031415e-03 3 1  ON 82
ci_034                 7.265367e-03 3 1  ON 83
ci_035                -4.570179e-03 3 1  ON 84
ci_036                -1.272749e-02 3 1  ON 85
ci_037                -1.281789e-02 3 1  ON 86
ci_038                 1.197637e-03 3 1  ON 87
ci_039                 1.393165e-03 3 1  ON 88
ci_040                -2.706494e-03 3 1  ON 89
ci_041                 8.373068e-03 3 1  ON 90
ci_042                 8.404620e-03 3 1  ON 91
ci_043                -3.597340e-03 3 1  ON 92
ci_044                -4.419894e-03 3 1  ON 93
ci_045                -2.801837e-03 3 1  ON 94
ci_046                 5.783107e-03 3 1  ON 95
ci_047                 5.581551e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2774
    reference variance = 0.252784
====================================================
  Execution time = 2.9705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8670e-01
  Total weights = 1.9662e+06
  Execution time = 2.3354e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277311490356
                                         uncertainty =       0.002244105614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277311490356
                                         uncertainty =       0.002244105614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372347137
  error estimate for blocks of size 2^( 2) =       0.000386474843
  error estimate for blocks of size 2^( 3) =       0.000399410205
  error estimate for blocks of size 2^( 4) =       0.000408022580
  error estimate for blocks of size 2^( 5) =       0.000412632082
  error estimate for blocks of size 2^( 6) =       0.000415240983
  error estimate for blocks of size 2^( 7) =       0.000417892504

      target function =      -0.929456700568
              le_mean =     -17.210445999955
             les_mean =     296.488684810028
             stat err =       0.000413447037
             autocorr =       1.232945075804
   target nu stat err =       0.000413447037
   target dn stat err =       0.003973995063
      target stat err =       0.006560004622
              std dev =       0.526586796270
             le_variance =       0.277293654005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277311594796
                                         uncertainty =       0.002257765758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277311594796
                                         uncertainty =       0.002257765758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372346918
  error estimate for blocks of size 2^( 2) =       0.000386511951
  error estimate for blocks of size 2^( 3) =       0.000399482707
  error estimate for blocks of size 2^( 4) =       0.000408114956
  error estimate for blocks of size 2^( 5) =       0.000412731365
  error estimate for blocks of size 2^( 6) =       0.000415341371
  error estimate for blocks of size 2^( 7) =       0.000418009825

      target function =      -0.930662973343
              le_mean =     -17.210442349984
             les_mean =     296.487834140631
             stat err =       0.000413549379
             autocorr =       1.233556995788
   target nu stat err =       0.000413549379
   target dn stat err =       0.003243737492
      target stat err =       0.005384835594
              std dev =       0.526586485928
             le_variance =       0.277293327162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277307019344
                                         uncertainty =       0.002252252304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277307019344
                                         uncertainty =       0.002252252304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372343958
  error estimate for blocks of size 2^( 2) =       0.000386493896
  error estimate for blocks of size 2^( 3) =       0.000399450228
  error estimate for blocks of size 2^( 4) =       0.000408074388
  error estimate for blocks of size 2^( 5) =       0.000412688229
  error estimate for blocks of size 2^( 6) =       0.000415297683
  error estimate for blocks of size 2^( 7) =       0.000417959047

      target function =      -0.933595519783
              le_mean =     -17.210443233922
             les_mean =     296.486090920960
             stat err =       0.000413504837
             autocorr =       1.233310891753
   target nu stat err =       0.000413504837
   target dn stat err =       0.002884823162
      target stat err =       0.004830570503
              std dev =       0.526582299901
             le_variance =       0.277288918569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277309925228
                                         uncertainty =       0.002245144617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277309925228
                                         uncertainty =       0.002245144617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372346063
  error estimate for blocks of size 2^( 2) =       0.000386476670
  error estimate for blocks of size 2^( 3) =       0.000399414741
  error estimate for blocks of size 2^( 4) =       0.000408028662
  error estimate for blocks of size 2^( 5) =       0.000412638682
  error estimate for blocks of size 2^( 6) =       0.000415247617
  error estimate for blocks of size 2^( 7) =       0.000417900283

      target function =      -0.932266022573
              le_mean =     -17.210445627978
             les_mean =     296.486975848158
             stat err =       0.000413453811
             autocorr =       1.232992589585
   target nu stat err =       0.000413453811
   target dn stat err =       0.003064541604
      target stat err =       0.005110364037
              std dev =       0.526585277047
             le_variance =       0.277292054003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929456700568        initial
     2.5000e-01     2.5000e+00             1.7013e-03        -0.930662973343
     1.0000e+00     1.0000e+01             4.3188e-04        -0.933595519783  <--
     4.0000e+00     4.0000e+01             1.0847e-04        -0.932266022573

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.1509e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.086313e-01 1 1  ON 0
  uu_1                 5.279939e-02 1 1  ON 1
  uu_2                -3.650999e-02 1 1  ON 2
  uu_3                -8.957327e-02 1 1  ON 3
  uu_4                -1.215342e-01 1 1  ON 4
  uu_5                -1.311383e-01 1 1  ON 5
  uu_6                -1.139959e-01 1 1  ON 6
  uu_7                -5.669501e-02 1 1  ON 7
  uu_8                 5.851645e-02 1 1  ON 8
  uu_9                 1.221374e-01 1 1  ON 9
  ud_0                 3.003001e-01 1 1  ON 10
  ud_1                 7.302986e-02 1 1  ON 11
  ud_2                -2.618831e-02 1 1  ON 12
  ud_3                -7.723801e-02 1 1  ON 13
  ud_4                -1.122987e-01 1 1  ON 14
  ud_5                -1.315748e-01 1 1  ON 15
  ud_6                -1.265733e-01 1 1  ON 16
  ud_7                -8.716132e-02 1 1  ON 17
  ud_8                -4.321018e-03 1 1  ON 18
  ud_9                 8.471870e-02 1 1  ON 19
  eO_0                -6.929959e-01 1 1  ON 20
  eO_1                -4.131479e-01 1 1  ON 21
  eO_2                -4.176916e-02 1 1  ON 22
  eO_3                 1.782126e-01 1 1  ON 23
  eO_4                 2.498318e-01 1 1  ON 24
  eO_5                 2.744486e-01 1 1  ON 25
  eO_6                 2.476838e-01 1 1  ON 26
  eO_7                 1.377801e-01 1 1  ON 27
  eO_8                 2.910249e-02 1 1  ON 28
  eO_9                 1.940628e-02 1 1  ON 29
 eH1_0                -2.052430e-01 1 1  ON 30
 eH1_1                -1.002299e-01 1 1  ON 31
 eH1_2                -4.920515e-02 1 1  ON 32
 eH1_3                -1.785773e-02 1 1  ON 33
 eH1_4                 1.697384e-02 1 1  ON 34
 eH1_5                 2.475193e-02 1 1  ON 35
 eH1_6                 7.880851e-02 1 1  ON 36
 eH1_7                 1.068341e-01 1 1  ON 37
 eH1_8                 1.030695e-01 1 1  ON 38
 eH1_9                 2.597020e-02 1 1  ON 39
 eH2_0                -2.018721e-01 1 1  ON 40
 eH2_1                -9.699646e-02 1 1  ON 41
 eH2_2                -4.654189e-02 1 1  ON 42
 eH2_3                -1.588831e-02 1 1  ON 43
 eH2_4                 1.723999e-02 1 1  ON 44
 eH2_5                 2.123610e-02 1 1  ON 45
 eH2_6                 7.065798e-02 1 1  ON 46
 eH2_7                 1.058526e-01 1 1  ON 47
 eH2_8                 1.049163e-01 1 1  ON 48
 eH2_9                 2.833752e-02 1 1  ON 49
ci_001                -4.223357e-02 3 1  ON 50
ci_002                -3.103697e-02 3 1  ON 51
ci_003                -2.576176e-02 3 1  ON 52
ci_004                 2.446672e-02 3 1  ON 53
ci_005                 2.460253e-02 3 1  ON 54
ci_006                -2.039744e-02 3 1  ON 55
ci_007                -2.041442e-02 3 1  ON 56
ci_008                -8.919899e-03 3 1  ON 57
ci_009                -1.497407e-02 3 1  ON 58
ci_010                -9.433121e-03 3 1  ON 59
ci_011                -1.019852e-02 3 1  ON 60
ci_012                -1.011103e-02 3 1  ON 61
ci_013                -1.949604e-02 3 1  ON 62
ci_014                 1.312035e-02 3 1  ON 63
ci_015                 1.321831e-02 3 1  ON 64
ci_016                 1.635036e-02 3 1  ON 65
ci_017                 1.619783e-02 3 1  ON 66
ci_018                 1.019727e-02 3 1  ON 67
ci_019                 1.029045e-02 3 1  ON 68
ci_020                 1.653275e-02 3 1  ON 69
ci_021                 1.649031e-02 3 1  ON 70
ci_022                 1.053710e-02 3 1  ON 71
ci_023                 9.489597e-03 3 1  ON 72
ci_024                 7.508494e-03 3 1  ON 73
ci_025                 6.347924e-03 3 1  ON 74
ci_026                 1.168613e-02 3 1  ON 75
ci_027                 1.164220e-02 3 1  ON 76
ci_028                -1.524536e-02 3 1  ON 77
ci_029                -1.535498e-02 3 1  ON 78
ci_030                -4.450382e-03 3 1  ON 79
ci_031                -4.919931e-03 3 1  ON 80
ci_032                -1.526657e-02 3 1  ON 81
ci_033                 7.031415e-03 3 1  ON 82
ci_034                 7.265367e-03 3 1  ON 83
ci_035                -4.570179e-03 3 1  ON 84
ci_036                -1.272749e-02 3 1  ON 85
ci_037                -1.281789e-02 3 1  ON 86
ci_038                 1.197637e-03 3 1  ON 87
ci_039                 1.393165e-03 3 1  ON 88
ci_040                -2.706494e-03 3 1  ON 89
ci_041                 8.373068e-03 3 1  ON 90
ci_042                 8.404620e-03 3 1  ON 91
ci_043                -3.597340e-03 3 1  ON 92
ci_044                -4.419894e-03 3 1  ON 93
ci_045                -2.801837e-03 3 1  ON 94
ci_046                 5.783107e-03 3 1  ON 95
ci_047                 5.581551e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.163817
====================================================
  Execution time = 2.7490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0522e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9057e-01
  Total weights = 1.966518249e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5011e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276805025116
                                         uncertainty =       0.002103794876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276805025116
                                         uncertainty =       0.002103794876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372052317
  error estimate for blocks of size 2^( 2) =       0.000386207610
  error estimate for blocks of size 2^( 3) =       0.000398681837
  error estimate for blocks of size 2^( 4) =       0.000408383838
  error estimate for blocks of size 2^( 5) =       0.000414834040
  error estimate for blocks of size 2^( 6) =       0.000418349043
  error estimate for blocks of size 2^( 7) =       0.000420982193

      target function =      -0.927317282496
              le_mean =     -17.208943212266
             les_mean =     296.438298851468
             stat err =       0.000415637278
             autocorr =       1.248018312211
   target nu stat err =       0.000415637278
   target dn stat err =       0.004242121719
      target stat err =       0.006945929512
              std dev =       0.526169851068
             le_variance =       0.276854712173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720894321227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927367751526       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927547266426       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927566006542       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927577206580       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927577670245       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927578367681       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927579583999       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927579922831       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927580479926       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927580862026       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927581459269       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927581585481       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927581831211       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927582367299       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927583259843       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927583099143       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927583276641       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927583848722       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927583827170       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927583567757       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927583782216       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927584143241       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927584305395       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927584351170       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927584272708       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927584371322       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927584381972       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927584334125       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927584337865       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927584494378       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927584621345       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927584747430       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927584682781       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927584640960       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927584658622       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927584598853       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927584620008       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927584586220       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927584689106       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927584661156       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.927584672577       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.927584703722       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.927584698422       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.927584663515       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.927584665671       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.927584673090       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         45 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.230049e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927367751526       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927422424277       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927427798481       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927431097438       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927431197913       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927431401023       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927431750222       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927431879159       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927432033197       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927432139079       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927432296788       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927432339795       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927432417666       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927432580051       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927432823528       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927432767824       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927432792237       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927432929707       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927432922465       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927432861002       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927432922463       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927433010796       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927433039795       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927433045895       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927433024575       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927433048115       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927433047024       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927433037790       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927433043629       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927433084574       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927433113744       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927433131311       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927433106085       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927433102142       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927433107143       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927433094497       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927433097225       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927433091581       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927433111651       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927433108148       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.927433110259       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 3.060125e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927367751526       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927382208298       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927383602324       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927384465685       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927384489374       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927384542756       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927384633147       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927384669416       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927384708793       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927384735919       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927384775868       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927384787398       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927384808390       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927384851052       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927384913329       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927384897983       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927384902226       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927384936026       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927384934168       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927384919255       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927384935169       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927384956892       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927384963127       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927384964343       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927384958995       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927384964731       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927384964163       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927384962371       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927384964176       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927384974324       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927384980960       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927384984601       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927384978123       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927384977525       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927384978570       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927384975643       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927384976254       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927384974859       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927384979860       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927384978805       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.927384979684       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 7.672254e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6089e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.087732e-01 1 1  ON 0
  uu_1                 5.283033e-02 1 1  ON 1
  uu_2                -3.647365e-02 1 1  ON 2
  uu_3                -8.955467e-02 1 1  ON 3
  uu_4                -1.215117e-01 1 1  ON 4
  uu_5                -1.311181e-01 1 1  ON 5
  uu_6                -1.140342e-01 1 1  ON 6
  uu_7                -5.682246e-02 1 1  ON 7
  uu_8                 5.821417e-02 1 1  ON 8
  uu_9                 1.221600e-01 1 1  ON 9
  ud_0                 3.001762e-01 1 1  ON 10
  ud_1                 7.291336e-02 1 1  ON 11
  ud_2                -2.631297e-02 1 1  ON 12
  ud_3                -7.737888e-02 1 1  ON 13
  ud_4                -1.124505e-01 1 1  ON 14
  ud_5                -1.316481e-01 1 1  ON 15
  ud_6                -1.263583e-01 1 1  ON 16
  ud_7                -8.687539e-02 1 1  ON 17
  ud_8                -4.204054e-03 1 1  ON 18
  ud_9                 8.468766e-02 1 1  ON 19
  eO_0                -6.930302e-01 1 1  ON 20
  eO_1                -4.132573e-01 1 1  ON 21
  eO_2                -4.177427e-02 1 1  ON 22
  eO_3                 1.783032e-01 1 1  ON 23
  eO_4                 2.497087e-01 1 1  ON 24
  eO_5                 2.742361e-01 1 1  ON 25
  eO_6                 2.476942e-01 1 1  ON 26
  eO_7                 1.380861e-01 1 1  ON 27
  eO_8                 2.916508e-02 1 1  ON 28
  eO_9                 1.941997e-02 1 1  ON 29
 eH1_0                -2.053268e-01 1 1  ON 30
 eH1_1                -1.001212e-01 1 1  ON 31
 eH1_2                -4.905231e-02 1 1  ON 32
 eH1_3                -1.787561e-02 1 1  ON 33
 eH1_4                 1.695455e-02 1 1  ON 34
 eH1_5                 2.464895e-02 1 1  ON 35
 eH1_6                 7.869747e-02 1 1  ON 36
 eH1_7                 1.067879e-01 1 1  ON 37
 eH1_8                 1.031662e-01 1 1  ON 38
 eH1_9                 2.598652e-02 1 1  ON 39
 eH2_0                -2.018797e-01 1 1  ON 40
 eH2_1                -9.702394e-02 1 1  ON 41
 eH2_2                -4.649344e-02 1 1  ON 42
 eH2_3                -1.577749e-02 1 1  ON 43
 eH2_4                 1.716440e-02 1 1  ON 44
 eH2_5                 2.111450e-02 1 1  ON 45
 eH2_6                 7.058442e-02 1 1  ON 46
 eH2_7                 1.057850e-01 1 1  ON 47
 eH2_8                 1.050629e-01 1 1  ON 48
 eH2_9                 2.839011e-02 1 1  ON 49
ci_001                -4.213025e-02 3 1  ON 50
ci_002                -3.089915e-02 3 1  ON 51
ci_003                -2.582004e-02 3 1  ON 52
ci_004                 2.454844e-02 3 1  ON 53
ci_005                 2.461133e-02 3 1  ON 54
ci_006                -2.036837e-02 3 1  ON 55
ci_007                -2.036272e-02 3 1  ON 56
ci_008                -8.911690e-03 3 1  ON 57
ci_009                -1.493863e-02 3 1  ON 58
ci_010                -9.502503e-03 3 1  ON 59
ci_011                -1.028166e-02 3 1  ON 60
ci_012                -1.014057e-02 3 1  ON 61
ci_013                -1.944921e-02 3 1  ON 62
ci_014                 1.309775e-02 3 1  ON 63
ci_015                 1.317803e-02 3 1  ON 64
ci_016                 1.637603e-02 3 1  ON 65
ci_017                 1.633488e-02 3 1  ON 66
ci_018                 1.013898e-02 3 1  ON 67
ci_019                 1.027733e-02 3 1  ON 68
ci_020                 1.653256e-02 3 1  ON 69
ci_021                 1.654192e-02 3 1  ON 70
ci_022                 1.048349e-02 3 1  ON 71
ci_023                 9.600798e-03 3 1  ON 72
ci_024                 7.569637e-03 3 1  ON 73
ci_025                 6.387691e-03 3 1  ON 74
ci_026                 1.149308e-02 3 1  ON 75
ci_027                 1.170509e-02 3 1  ON 76
ci_028                -1.524172e-02 3 1  ON 77
ci_029                -1.528747e-02 3 1  ON 78
ci_030                -4.468697e-03 3 1  ON 79
ci_031                -4.866916e-03 3 1  ON 80
ci_032                -1.527493e-02 3 1  ON 81
ci_033                 7.043545e-03 3 1  ON 82
ci_034                 7.254470e-03 3 1  ON 83
ci_035                -4.565210e-03 3 1  ON 84
ci_036                -1.277092e-02 3 1  ON 85
ci_037                -1.271744e-02 3 1  ON 86
ci_038                 1.199941e-03 3 1  ON 87
ci_039                 1.424618e-03 3 1  ON 88
ci_040                -2.720623e-03 3 1  ON 89
ci_041                 8.381955e-03 3 1  ON 90
ci_042                 8.391636e-03 3 1  ON 91
ci_043                -3.568704e-03 3 1  ON 92
ci_044                -4.369839e-03 3 1  ON 93
ci_045                -2.754081e-03 3 1  ON 94
ci_046                 5.782936e-03 3 1  ON 95
ci_047                 5.601668e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1378
    reference variance = 0.137345
====================================================
  Execution time = 2.7583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8713e-01
  Total weights = 1.9667e+06
  Execution time = 2.3230e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277527071161
                                         uncertainty =       0.001615684337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277527071161
                                         uncertainty =       0.001615684337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372494824
  error estimate for blocks of size 2^( 2) =       0.000386614760
  error estimate for blocks of size 2^( 3) =       0.000399384002
  error estimate for blocks of size 2^( 4) =       0.000409199549
  error estimate for blocks of size 2^( 5) =       0.000415142923
  error estimate for blocks of size 2^( 6) =       0.000418519768
  error estimate for blocks of size 2^( 7) =       0.000420874662

      target function =      -0.932887787061
              le_mean =     -17.209831961104
             les_mean =     296.465494325560
             stat err =       0.000415934225
             autocorr =       1.246834558506
   target nu stat err =       0.000415934225
   target dn stat err =       0.002371683015
      target stat err =       0.003983384171
              std dev =       0.526795660750
             le_variance =       0.277513668185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277692696854
                                         uncertainty =       0.001636025739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277692696854
                                         uncertainty =       0.001636025739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372605714
  error estimate for blocks of size 2^( 2) =       0.000386759174
  error estimate for blocks of size 2^( 3) =       0.000399545593
  error estimate for blocks of size 2^( 4) =       0.000409375998
  error estimate for blocks of size 2^( 5) =       0.000415309625
  error estimate for blocks of size 2^( 6) =       0.000418698731
  error estimate for blocks of size 2^( 7) =       0.000421064170

      target function =      -0.930111370111
              le_mean =     -17.209830826030
             les_mean =     296.467138820746
             stat err =       0.000416112131
             autocorr =       1.247158736098
   target nu stat err =       0.000416112131
   target dn stat err =       0.002765179871
      target stat err =       0.004596222318
              std dev =       0.526952485023
             le_variance =       0.277678921472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277617395205
                                         uncertainty =       0.001627509603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277617395205
                                         uncertainty =       0.001627509603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372555295
  error estimate for blocks of size 2^( 2) =       0.000386695343
  error estimate for blocks of size 2^( 3) =       0.000399475938
  error estimate for blocks of size 2^( 4) =       0.000409299684
  error estimate for blocks of size 2^( 5) =       0.000415237462
  error estimate for blocks of size 2^( 6) =       0.000418621761
  error estimate for blocks of size 2^( 7) =       0.000420982957

      target function =      -0.932854184185
              le_mean =     -17.209830322642
             les_mean =     296.465458303055
             stat err =       0.000416035466
             autocorr =       1.247036680932
   target nu stat err =       0.000416035466
   target dn stat err =       0.002372957953
      target stat err =       0.003985191011
              std dev =       0.526881181177
             le_variance =       0.277603779078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277537124564
                                         uncertainty =       0.001617141419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277537124564
                                         uncertainty =       0.001617141419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372501553
  error estimate for blocks of size 2^( 2) =       0.000386624119
  error estimate for blocks of size 2^( 3) =       0.000399394857
  error estimate for blocks of size 2^( 4) =       0.000409211464
  error estimate for blocks of size 2^( 5) =       0.000415154107
  error estimate for blocks of size 2^( 6) =       0.000418531954
  error estimate for blocks of size 2^( 7) =       0.000420887715

      target function =      -0.932936138568
              le_mean =     -17.209831520788
             les_mean =     296.465449900759
             stat err =       0.000415946310
             autocorr =       1.246861960065
   target nu stat err =       0.000415946310
   target dn stat err =       0.002369825940
      target stat err =       0.003980777703
              std dev =       0.526805177466
             le_variance =       0.277523695005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932887787061        initial
     2.5000e-01     2.5000e+00             1.2300e-03        -0.930111370111
     1.0000e+00     1.0000e+01             3.0601e-04        -0.932854184185
     4.0000e+00     4.0000e+01             7.6723e-05        -0.932936138568  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.9371e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.086683e-01 1 1  ON 0
  uu_1                 5.280697e-02 1 1  ON 1
  uu_2                -3.650090e-02 1 1  ON 2
  uu_3                -8.956883e-02 1 1  ON 3
  uu_4                -1.215287e-01 1 1  ON 4
  uu_5                -1.311333e-01 1 1  ON 5
  uu_6                -1.140060e-01 1 1  ON 6
  uu_7                -5.672715e-02 1 1  ON 7
  uu_8                 5.844045e-02 1 1  ON 8
  uu_9                 1.221431e-01 1 1  ON 9
  ud_0                 3.002686e-01 1 1  ON 10
  ud_1                 7.300034e-02 1 1  ON 11
  ud_2                -2.621999e-02 1 1  ON 12
  ud_3                -7.727400e-02 1 1  ON 13
  ud_4                -1.123377e-01 1 1  ON 14
  ud_5                -1.315935e-01 1 1  ON 15
  ud_6                -1.265171e-01 1 1  ON 16
  ud_7                -8.708839e-02 1 1  ON 17
  ud_8                -4.292051e-03 1 1  ON 18
  ud_9                 8.471085e-02 1 1  ON 19
  eO_0                -6.930043e-01 1 1  ON 20
  eO_1                -4.131763e-01 1 1  ON 21
  eO_2                -4.177011e-02 1 1  ON 22
  eO_3                 1.782367e-01 1 1  ON 23
  eO_4                 2.498003e-01 1 1  ON 24
  eO_5                 2.743950e-01 1 1  ON 25
  eO_6                 2.476864e-01 1 1  ON 26
  eO_7                 1.378568e-01 1 1  ON 27
  eO_8                 2.911817e-02 1 1  ON 28
  eO_9                 1.940971e-02 1 1  ON 29
 eH1_0                -2.052654e-01 1 1  ON 30
 eH1_1                -1.002017e-01 1 1  ON 31
 eH1_2                -4.916533e-02 1 1  ON 32
 eH1_3                -1.786277e-02 1 1  ON 33
 eH1_4                 1.696915e-02 1 1  ON 34
 eH1_5                 2.472561e-02 1 1  ON 35
 eH1_6                 7.878065e-02 1 1  ON 36
 eH1_7                 1.068225e-01 1 1  ON 37
 eH1_8                 1.030937e-01 1 1  ON 38
 eH1_9                 2.597428e-02 1 1  ON 39
 eH2_0                -2.018741e-01 1 1  ON 40
 eH2_1                -9.700391e-02 1 1  ON 41
 eH2_2                -4.652940e-02 1 1  ON 42
 eH2_3                -1.585931e-02 1 1  ON 43
 eH2_4                 1.722031e-02 1 1  ON 44
 eH2_5                 2.120520e-02 1 1  ON 45
 eH2_6                 7.063978e-02 1 1  ON 46
 eH2_7                 1.058356e-01 1 1  ON 47
 eH2_8                 1.049530e-01 1 1  ON 48
 eH2_9                 2.835070e-02 1 1  ON 49
ci_001                -4.220668e-02 3 1  ON 50
ci_002                -3.100095e-02 3 1  ON 51
ci_003                -2.577711e-02 3 1  ON 52
ci_004                 2.448841e-02 3 1  ON 53
ci_005                 2.460471e-02 3 1  ON 54
ci_006                -2.038988e-02 3 1  ON 55
ci_007                -2.040093e-02 3 1  ON 56
ci_008                -8.917707e-03 3 1  ON 57
ci_009                -1.496471e-02 3 1  ON 58
ci_010                -9.451373e-03 3 1  ON 59
ci_011                -1.022038e-02 3 1  ON 60
ci_012                -1.011878e-02 3 1  ON 61
ci_013                -1.948384e-02 3 1  ON 62
ci_014                 1.311442e-02 3 1  ON 63
ci_015                 1.320775e-02 3 1  ON 64
ci_016                 1.635701e-02 3 1  ON 65
ci_017                 1.623353e-02 3 1  ON 66
ci_018                 1.018182e-02 3 1  ON 67
ci_019                 1.028698e-02 3 1  ON 68
ci_020                 1.653270e-02 3 1  ON 69
ci_021                 1.650389e-02 3 1  ON 70
ci_022                 1.052300e-02 3 1  ON 71
ci_023                 9.518784e-03 3 1  ON 72
ci_024                 7.524506e-03 3 1  ON 73
ci_025                 6.358344e-03 3 1  ON 74
ci_026                 1.163507e-02 3 1  ON 75
ci_027                 1.165876e-02 3 1  ON 76
ci_028                -1.524440e-02 3 1  ON 77
ci_029                -1.533732e-02 3 1  ON 78
ci_030                -4.455212e-03 3 1  ON 79
ci_031                -4.905894e-03 3 1  ON 80
ci_032                -1.526875e-02 3 1  ON 81
ci_033                 7.034589e-03 3 1  ON 82
ci_034                 7.262512e-03 3 1  ON 83
ci_035                -4.568873e-03 3 1  ON 84
ci_036                -1.273893e-02 3 1  ON 85
ci_037                -1.279126e-02 3 1  ON 86
ci_038                 1.198243e-03 3 1  ON 87
ci_039                 1.401470e-03 3 1  ON 88
ci_040                -2.710222e-03 3 1  ON 89
ci_041                 8.375415e-03 3 1  ON 90
ci_042                 8.401267e-03 3 1  ON 91
ci_043                -3.589786e-03 3 1  ON 92
ci_044                -4.406717e-03 3 1  ON 93
ci_045                -2.789219e-03 3 1  ON 94
ci_046                 5.783052e-03 3 1  ON 95
ci_047                 5.586833e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.306172
====================================================
  Execution time = 2.7644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0458e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8915e-01
  Total weights = 1.966293305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4798e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276779171205
                                         uncertainty =       0.002067773956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276779171205
                                         uncertainty =       0.002067773956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371980553
  error estimate for blocks of size 2^( 2) =       0.000386295330
  error estimate for blocks of size 2^( 3) =       0.000398719377
  error estimate for blocks of size 2^( 4) =       0.000408315170
  error estimate for blocks of size 2^( 5) =       0.000414632521
  error estimate for blocks of size 2^( 6) =       0.000418590096
  error estimate for blocks of size 2^( 7) =       0.000420800611

      target function =      -0.929624710408
              le_mean =     -17.210113627245
             les_mean =     296.477161494050
             stat err =       0.000415584599
             autocorr =       1.248183446570
   target nu stat err =       0.000415584599
   target dn stat err =       0.002963263387
      target stat err =       0.004914775406
              std dev =       0.526068360160
             le_variance =       0.276747919562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721011362725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929649612897       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929720061697       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929734615008       residual = 8.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929736866111       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929737871928       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929738366913       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929739218284       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929739140134       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929739580217       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929740066661       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929739907104       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929740249919       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929740218546       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929740276182       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929740408532       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929740446537       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929740383439       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929740392441       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929740375748       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929740360922       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929740456664       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929740551277       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929740591194       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929740721792       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929740763079       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929740764525       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929740783568       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929740763421       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929740689542       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929740697220       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929740729390       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929740759343       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929740784978       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929740791290       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929740770807       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929740771265       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929740769886       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929740766105       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929740772263       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929740773683       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929740769273       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929740769533       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 2.847109e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929649612897       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929668275030       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929672089699       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929672671644       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929672933996       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929673062509       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929673284717       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929673265895       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929673375605       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929673504730       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929673462002       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929673550012       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929673545440       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929673557458       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929673590604       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929673598800       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929673581459       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929673583846       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929673579960       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929673577444       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929673602032       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929673625802       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929673635070       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929673666208       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929673677062       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929673677897       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929673682522       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929673676673       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929673658681       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929673660750       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929673668191       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929673675920       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929673682265       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929673683525       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929673678408       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929673677649       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929673678262       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929673676984       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929673678502       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929673678714       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929673677732       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929673677947       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 7.402300e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929649612897       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929654349009       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929655314353       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929655461075       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929655527382       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929655559826       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929655615994       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929655611343       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929655638732       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929655671514       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929655660651       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929655682789       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929655681875       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929655684716       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929655692998       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929655694958       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929655690522       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929655691134       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929655690182       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929655689633       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929655695817       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929655701764       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929655704032       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929655711721       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929655714469       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929655714706       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929655715849       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929655714336       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929655709875       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929655710401       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929655712222       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929655714169       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929655715749       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929655716045       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929655714768       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929655714526       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929655714721       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929655714402       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929655714777       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929655714814       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929655714579       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929655714643       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 1.869520e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.497001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6216e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086729e-01 1 1  ON 0
  uu_1                 5.283014e-02 1 1  ON 1
  uu_2                -3.646941e-02 1 1  ON 2
  uu_3                -8.954095e-02 1 1  ON 3
  uu_4                -1.215072e-01 1 1  ON 4
  uu_5                -1.311259e-01 1 1  ON 5
  uu_6                -1.140564e-01 1 1  ON 6
  uu_7                -5.678365e-02 1 1  ON 7
  uu_8                 5.837170e-02 1 1  ON 8
  uu_9                 1.221645e-01 1 1  ON 9
  ud_0                 3.001946e-01 1 1  ON 10
  ud_1                 7.295730e-02 1 1  ON 11
  ud_2                -2.624081e-02 1 1  ON 12
  ud_3                -7.727960e-02 1 1  ON 13
  ud_4                -1.123410e-01 1 1  ON 14
  ud_5                -1.315767e-01 1 1  ON 15
  ud_6                -1.264755e-01 1 1  ON 16
  ud_7                -8.703262e-02 1 1  ON 17
  ud_8                -4.294982e-03 1 1  ON 18
  ud_9                 8.470544e-02 1 1  ON 19
  eO_0                -6.929551e-01 1 1  ON 20
  eO_1                -4.131604e-01 1 1  ON 21
  eO_2                -4.179851e-02 1 1  ON 22
  eO_3                 1.782160e-01 1 1  ON 23
  eO_4                 2.497635e-01 1 1  ON 24
  eO_5                 2.743389e-01 1 1  ON 25
  eO_6                 2.476784e-01 1 1  ON 26
  eO_7                 1.379246e-01 1 1  ON 27
  eO_8                 2.913383e-02 1 1  ON 28
  eO_9                 1.940965e-02 1 1  ON 29
 eH1_0                -2.052630e-01 1 1  ON 30
 eH1_1                -1.001950e-01 1 1  ON 31
 eH1_2                -4.913929e-02 1 1  ON 32
 eH1_3                -1.784753e-02 1 1  ON 33
 eH1_4                 1.696049e-02 1 1  ON 34
 eH1_5                 2.465891e-02 1 1  ON 35
 eH1_6                 7.877168e-02 1 1  ON 36
 eH1_7                 1.068130e-01 1 1  ON 37
 eH1_8                 1.031223e-01 1 1  ON 38
 eH1_9                 2.598336e-02 1 1  ON 39
 eH2_0                -2.018974e-01 1 1  ON 40
 eH2_1                -9.699583e-02 1 1  ON 41
 eH2_2                -4.654795e-02 1 1  ON 42
 eH2_3                -1.589091e-02 1 1  ON 43
 eH2_4                 1.720536e-02 1 1  ON 44
 eH2_5                 2.123634e-02 1 1  ON 45
 eH2_6                 7.066617e-02 1 1  ON 46
 eH2_7                 1.058199e-01 1 1  ON 47
 eH2_8                 1.049866e-01 1 1  ON 48
 eH2_9                 2.835510e-02 1 1  ON 49
ci_001                -4.219851e-02 3 1  ON 50
ci_002                -3.102223e-02 3 1  ON 51
ci_003                -2.579675e-02 3 1  ON 52
ci_004                 2.450389e-02 3 1  ON 53
ci_005                 2.461505e-02 3 1  ON 54
ci_006                -2.040016e-02 3 1  ON 55
ci_007                -2.040416e-02 3 1  ON 56
ci_008                -8.901682e-03 3 1  ON 57
ci_009                -1.497686e-02 3 1  ON 58
ci_010                -9.441712e-03 3 1  ON 59
ci_011                -1.020297e-02 3 1  ON 60
ci_012                -1.012985e-02 3 1  ON 61
ci_013                -1.947951e-02 3 1  ON 62
ci_014                 1.315081e-02 3 1  ON 63
ci_015                 1.320562e-02 3 1  ON 64
ci_016                 1.636063e-02 3 1  ON 65
ci_017                 1.623394e-02 3 1  ON 66
ci_018                 1.018245e-02 3 1  ON 67
ci_019                 1.027341e-02 3 1  ON 68
ci_020                 1.654480e-02 3 1  ON 69
ci_021                 1.650049e-02 3 1  ON 70
ci_022                 1.054023e-02 3 1  ON 71
ci_023                 9.524662e-03 3 1  ON 72
ci_024                 7.541359e-03 3 1  ON 73
ci_025                 6.348991e-03 3 1  ON 74
ci_026                 1.163423e-02 3 1  ON 75
ci_027                 1.168288e-02 3 1  ON 76
ci_028                -1.524583e-02 3 1  ON 77
ci_029                -1.531516e-02 3 1  ON 78
ci_030                -4.440571e-03 3 1  ON 79
ci_031                -4.879125e-03 3 1  ON 80
ci_032                -1.527505e-02 3 1  ON 81
ci_033                 6.979762e-03 3 1  ON 82
ci_034                 7.267591e-03 3 1  ON 83
ci_035                -4.569255e-03 3 1  ON 84
ci_036                -1.276263e-02 3 1  ON 85
ci_037                -1.278109e-02 3 1  ON 86
ci_038                 1.204174e-03 3 1  ON 87
ci_039                 1.403257e-03 3 1  ON 88
ci_040                -2.697301e-03 3 1  ON 89
ci_041                 8.385987e-03 3 1  ON 90
ci_042                 8.428667e-03 3 1  ON 91
ci_043                -3.597422e-03 3 1  ON 92
ci_044                -4.336782e-03 3 1  ON 93
ci_045                -2.792823e-03 3 1  ON 94
ci_046                 5.786137e-03 3 1  ON 95
ci_047                 5.597523e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.13
    reference variance = 0.284837
====================================================
  Execution time = 2.8037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8431e-01
  Total weights = 1.9660e+06
  Execution time = 2.3254e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273932759920
                                         uncertainty =       0.001766276385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273932759920
                                         uncertainty =       0.001766276385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370212331
  error estimate for blocks of size 2^( 2) =       0.000384717885
  error estimate for blocks of size 2^( 3) =       0.000398300295
  error estimate for blocks of size 2^( 4) =       0.000407787835
  error estimate for blocks of size 2^( 5) =       0.000413339621
  error estimate for blocks of size 2^( 6) =       0.000416170817
  error estimate for blocks of size 2^( 7) =       0.000415303935

      target function =      -0.937448201253
              le_mean =     -17.209168033523
             les_mean =     296.439899209122
             stat err =       0.000413150552
             autocorr =       1.245417355171
   target nu stat err =       0.000413150552
   target dn stat err =       0.002562248947
      target stat err =       0.004328096474
              std dev =       0.523567676934
             le_variance =       0.274123112330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273887405576
                                         uncertainty =       0.001763165140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273887405576
                                         uncertainty =       0.001763165140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370182443
  error estimate for blocks of size 2^( 2) =       0.000384705299
  error estimate for blocks of size 2^( 3) =       0.000398300271
  error estimate for blocks of size 2^( 4) =       0.000407793468
  error estimate for blocks of size 2^( 5) =       0.000413351998
  error estimate for blocks of size 2^( 6) =       0.000416190392
  error estimate for blocks of size 2^( 7) =       0.000415338108

      target function =      -0.937964011285
              le_mean =     -17.209169993286
             les_mean =     296.439657151804
             stat err =       0.000413168492
             autocorr =       1.245726646475
   target nu stat err =       0.000413168492
   target dn stat err =       0.002540118460
      target stat err =       0.004296468040
              std dev =       0.523525408196
             le_variance =       0.274078853026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273907577878
                                         uncertainty =       0.001764602460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273907577878
                                         uncertainty =       0.001764602460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370195717
  error estimate for blocks of size 2^( 2) =       0.000384710404
  error estimate for blocks of size 2^( 3) =       0.000398299425
  error estimate for blocks of size 2^( 4) =       0.000407789961
  error estimate for blocks of size 2^( 5) =       0.000413345312
  error estimate for blocks of size 2^( 6) =       0.000416180273
  error estimate for blocks of size 2^( 7) =       0.000415321141

      target function =      -0.937797064786
              le_mean =     -17.209168939077
             les_mean =     296.439721006160
             stat err =       0.000413159172
             autocorr =       1.245581117394
   target nu stat err =       0.000413159172
   target dn stat err =       0.002547728413
      target stat err =       0.004307442177
              std dev =       0.523544180762
             le_variance =       0.274098509209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273929434398
                                         uncertainty =       0.001766061960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273929434398
                                         uncertainty =       0.001766061960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370210135
  error estimate for blocks of size 2^( 2) =       0.000384716901
  error estimate for blocks of size 2^( 3) =       0.000398300034
  error estimate for blocks of size 2^( 4) =       0.000407788106
  error estimate for blocks of size 2^( 5) =       0.000413340480
  error estimate for blocks of size 2^( 6) =       0.000416172558
  error estimate for blocks of size 2^( 7) =       0.000415306876

      target function =      -0.934334854666
              le_mean =     -17.209168239051
             les_mean =     296.441776352751
             stat err =       0.000413152005
             autocorr =       1.245440890525
   target nu stat err =       0.000413152005
   target dn stat err =       0.003191104484
      target stat err =       0.005327592446
              std dev =       0.523564571175
             le_variance =       0.274119860190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937448201253        initial
     1.0000e+00     1.0000e+01             2.8471e-04        -0.937964011285  <--
     4.0000e+00     4.0000e+01             7.4023e-05        -0.937797064786
     1.6000e+01     1.6000e+02             1.8695e-05        -0.934334854666

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 3.9850e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086891e-01 1 1  ON 0
  uu_1                 5.289759e-02 1 1  ON 1
  uu_2                -3.637866e-02 1 1  ON 2
  uu_3                -8.946018e-02 1 1  ON 3
  uu_4                -1.214444e-01 1 1  ON 4
  uu_5                -1.311040e-01 1 1  ON 5
  uu_6                -1.142004e-01 1 1  ON 6
  uu_7                -5.695156e-02 1 1  ON 7
  uu_8                 5.816631e-02 1 1  ON 8
  uu_9                 1.222280e-01 1 1  ON 9
  ud_0                 2.999839e-01 1 1  ON 10
  ud_1                 7.283243e-02 1 1  ON 11
  ud_2                -2.630334e-02 1 1  ON 12
  ud_3                -7.729899e-02 1 1  ON 13
  ud_4                -1.123526e-01 1 1  ON 14
  ud_5                -1.315300e-01 1 1  ON 15
  ud_6                -1.263552e-01 1 1  ON 16
  ud_7                -8.686942e-02 1 1  ON 17
  ud_8                -4.301998e-03 1 1  ON 18
  ud_9                 8.468927e-02 1 1  ON 19
  eO_0                -6.928171e-01 1 1  ON 20
  eO_1                -4.131156e-01 1 1  ON 21
  eO_2                -4.187773e-02 1 1  ON 22
  eO_3                 1.781570e-01 1 1  ON 23
  eO_4                 2.496569e-01 1 1  ON 24
  eO_5                 2.741721e-01 1 1  ON 25
  eO_6                 2.476538e-01 1 1  ON 26
  eO_7                 1.381266e-01 1 1  ON 27
  eO_8                 2.918057e-02 1 1  ON 28
  eO_9                 1.940946e-02 1 1  ON 29
 eH1_0                -2.052549e-01 1 1  ON 30
 eH1_1                -1.001744e-01 1 1  ON 31
 eH1_2                -4.906498e-02 1 1  ON 32
 eH1_3                -1.780377e-02 1 1  ON 33
 eH1_4                 1.693512e-02 1 1  ON 34
 eH1_5                 2.446639e-02 1 1  ON 35
 eH1_6                 7.874167e-02 1 1  ON 36
 eH1_7                 1.067845e-01 1 1  ON 37
 eH1_8                 1.032074e-01 1 1  ON 38
 eH1_9                 2.601045e-02 1 1  ON 39
 eH2_0                -2.019648e-01 1 1  ON 40
 eH2_1                -9.697635e-02 1 1  ON 41
 eH2_2                -4.660263e-02 1 1  ON 42
 eH2_3                -1.598230e-02 1 1  ON 43
 eH2_4                 1.716127e-02 1 1  ON 44
 eH2_5                 2.132612e-02 1 1  ON 45
 eH2_6                 7.074621e-02 1 1  ON 46
 eH2_7                 1.057734e-01 1 1  ON 47
 eH2_8                 1.050866e-01 1 1  ON 48
 eH2_9                 2.836823e-02 1 1  ON 49
ci_001                -4.217503e-02 3 1  ON 50
ci_002                -3.108213e-02 3 1  ON 51
ci_003                -2.585194e-02 3 1  ON 52
ci_004                 2.454751e-02 3 1  ON 53
ci_005                 2.464467e-02 3 1  ON 54
ci_006                -2.042905e-02 3 1  ON 55
ci_007                -2.041312e-02 3 1  ON 56
ci_008                -8.857566e-03 3 1  ON 57
ci_009                -1.501054e-02 3 1  ON 58
ci_010                -9.414578e-03 3 1  ON 59
ci_011                -1.015444e-02 3 1  ON 60
ci_012                -1.016082e-02 3 1  ON 61
ci_013                -1.946714e-02 3 1  ON 62
ci_014                 1.325284e-02 3 1  ON 63
ci_015                 1.319959e-02 3 1  ON 64
ci_016                 1.637071e-02 3 1  ON 65
ci_017                 1.623494e-02 3 1  ON 66
ci_018                 1.018388e-02 3 1  ON 67
ci_019                 1.023577e-02 3 1  ON 68
ci_020                 1.657851e-02 3 1  ON 69
ci_021                 1.649073e-02 3 1  ON 70
ci_022                 1.058830e-02 3 1  ON 71
ci_023                 9.541089e-03 3 1  ON 72
ci_024                 7.588616e-03 3 1  ON 73
ci_025                 6.322974e-03 3 1  ON 74
ci_026                 1.163216e-02 3 1  ON 75
ci_027                 1.175027e-02 3 1  ON 76
ci_028                -1.524994e-02 3 1  ON 77
ci_029                -1.525318e-02 3 1  ON 78
ci_030                -4.399835e-03 3 1  ON 79
ci_031                -4.804679e-03 3 1  ON 80
ci_032                -1.529272e-02 3 1  ON 81
ci_033                 6.826247e-03 3 1  ON 82
ci_034                 7.281871e-03 3 1  ON 83
ci_035                -4.570294e-03 3 1  ON 84
ci_036                -1.282860e-02 3 1  ON 85
ci_037                -1.275323e-02 3 1  ON 86
ci_038                 1.220686e-03 3 1  ON 87
ci_039                 1.408243e-03 3 1  ON 88
ci_040                -2.661409e-03 3 1  ON 89
ci_041                 8.415432e-03 3 1  ON 90
ci_042                 8.504192e-03 3 1  ON 91
ci_043                -3.618729e-03 3 1  ON 92
ci_044                -4.141533e-03 3 1  ON 93
ci_045                -2.802904e-03 3 1  ON 94
ci_046                 5.794801e-03 3 1  ON 95
ci_047                 5.627526e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1402
    reference variance = 0.195573
====================================================
  Execution time = 2.7961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0465e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8690e-01
  Total weights = 1.966332538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4717e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277634604905
                                         uncertainty =       0.003210611984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277634604905
                                         uncertainty =       0.003210611984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372551875
  error estimate for blocks of size 2^( 2) =       0.000386421595
  error estimate for blocks of size 2^( 3) =       0.000399701017
  error estimate for blocks of size 2^( 4) =       0.000408814628
  error estimate for blocks of size 2^( 5) =       0.000413367326
  error estimate for blocks of size 2^( 6) =       0.000416155125
  error estimate for blocks of size 2^( 7) =       0.000418587757

      target function =      -0.933313841932
              le_mean =     -17.210119892561
             les_mean =     296.475127290027
             stat err =       0.000414231209
             autocorr =       1.236266568991
   target nu stat err =       0.000414231209
   target dn stat err =       0.003716197294
      target stat err =       0.006186901246
              std dev =       0.526876344675
             le_variance =       0.277598682578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721011989256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933354029784       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933501171332       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933529516208       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933538175780       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933539855857       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933540784795       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933542365212       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933543493791       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933543790398       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933544954874       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933545548556       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933545797843       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933546154502       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933546888916       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933546807685       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933547594051       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933547778579       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933548113520       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933548363667       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933548617385       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933549334661       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933549562318       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933549849068       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933549632619       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933549646030       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933549770801       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933550140436       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933550126181       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933550199662       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933550089506       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933550163997       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933550239309       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933550381556       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933550383781       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933550449467       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933550482134       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933550431944       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933550450584       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933550453005       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933550425469       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933550473972       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933550477392       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933550493783       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933550489974       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933550495553       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.933550479410       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933550502260       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.933550511182       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933550523123       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.950000e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933354029784       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933398883214       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933407325973       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933409787460       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933410263359       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933410510511       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933410936098       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933411304257       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933411383050       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933411721986       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933411924929       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933412003775       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933412105270       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933412286441       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933412249506       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933412441554       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933412490221       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933412595930       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933412658365       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933412719480       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933412922675       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933412944850       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933413023105       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933412955241       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933412956167       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933412988192       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933413067212       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933413070465       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933413068721       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933413063823       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933413072981       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933413097112       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933413122902       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933413124048       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933413137222       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933413140144       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933413127447       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933413133094       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933413129977       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933413129392       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933413136238       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933413135200       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933413138993       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933413140509       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933413139349       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 5.256626e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933354029784       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933365893550       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933368110198       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933368746943       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933368869940       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933368932402       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933369040533       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933369139698       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933369160280       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933369248528       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933369303995       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933369324793       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933369350862       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933369395434       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933369384681       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933369432267       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933369445016       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933369473107       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933369488350       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933369503218       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933369555428       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933369558432       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933369577620       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933369561438       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933369560059       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933369569402       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933369587668       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933369588426       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933369587598       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933369587120       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933369589057       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933369595233       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933369600943       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933369601356       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933369604356       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933369604744       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933369601838       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933369602813       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933369602478       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933369602194       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933369603876       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933369603386       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933369604353       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933369605144       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933369604256       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 1.343609e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.613120 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6556e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.085094e-01 1 1  ON 0
  uu_1                 5.278286e-02 1 1  ON 1
  uu_2                -3.641550e-02 1 1  ON 2
  uu_3                -8.945450e-02 1 1  ON 3
  uu_4                -1.214147e-01 1 1  ON 4
  uu_5                -1.310117e-01 1 1  ON 5
  uu_6                -1.140422e-01 1 1  ON 6
  uu_7                -5.679808e-02 1 1  ON 7
  uu_8                 5.788832e-02 1 1  ON 8
  uu_9                 1.222737e-01 1 1  ON 9
  ud_0                 2.998387e-01 1 1  ON 10
  ud_1                 7.275373e-02 1 1  ON 11
  ud_2                -2.629463e-02 1 1  ON 12
  ud_3                -7.728146e-02 1 1  ON 13
  ud_4                -1.123152e-01 1 1  ON 14
  ud_5                -1.314690e-01 1 1  ON 15
  ud_6                -1.262863e-01 1 1  ON 16
  ud_7                -8.673704e-02 1 1  ON 17
  ud_8                -4.358059e-03 1 1  ON 18
  ud_9                 8.456879e-02 1 1  ON 19
  eO_0                -6.924309e-01 1 1  ON 20
  eO_1                -4.129019e-01 1 1  ON 21
  eO_2                -4.188763e-02 1 1  ON 22
  eO_3                 1.779104e-01 1 1  ON 23
  eO_4                 2.491312e-01 1 1  ON 24
  eO_5                 2.737800e-01 1 1  ON 25
  eO_6                 2.478406e-01 1 1  ON 26
  eO_7                 1.384847e-01 1 1  ON 27
  eO_8                 2.920843e-02 1 1  ON 28
  eO_9                 1.941532e-02 1 1  ON 29
 eH1_0                -2.052485e-01 1 1  ON 30
 eH1_1                -1.000765e-01 1 1  ON 31
 eH1_2                -4.896233e-02 1 1  ON 32
 eH1_3                -1.773353e-02 1 1  ON 33
 eH1_4                 1.684567e-02 1 1  ON 34
 eH1_5                 2.431847e-02 1 1  ON 35
 eH1_6                 7.867375e-02 1 1  ON 36
 eH1_7                 1.066817e-01 1 1  ON 37
 eH1_8                 1.033056e-01 1 1  ON 38
 eH1_9                 2.604657e-02 1 1  ON 39
 eH2_0                -2.021164e-01 1 1  ON 40
 eH2_1                -9.698135e-02 1 1  ON 41
 eH2_2                -4.651083e-02 1 1  ON 42
 eH2_3                -1.598110e-02 1 1  ON 43
 eH2_4                 1.721779e-02 1 1  ON 44
 eH2_5                 2.128286e-02 1 1  ON 45
 eH2_6                 7.060935e-02 1 1  ON 46
 eH2_7                 1.057038e-01 1 1  ON 47
 eH2_8                 1.052882e-01 1 1  ON 48
 eH2_9                 2.842223e-02 1 1  ON 49
ci_001                -4.212843e-02 3 1  ON 50
ci_002                -3.110561e-02 3 1  ON 51
ci_003                -2.577392e-02 3 1  ON 52
ci_004                 2.453836e-02 3 1  ON 53
ci_005                 2.465701e-02 3 1  ON 54
ci_006                -2.045874e-02 3 1  ON 55
ci_007                -2.044404e-02 3 1  ON 56
ci_008                -8.879717e-03 3 1  ON 57
ci_009                -1.489474e-02 3 1  ON 58
ci_010                -9.371925e-03 3 1  ON 59
ci_011                -1.031587e-02 3 1  ON 60
ci_012                -1.020459e-02 3 1  ON 61
ci_013                -1.945531e-02 3 1  ON 62
ci_014                 1.335560e-02 3 1  ON 63
ci_015                 1.324348e-02 3 1  ON 64
ci_016                 1.642201e-02 3 1  ON 65
ci_017                 1.620313e-02 3 1  ON 66
ci_018                 1.017146e-02 3 1  ON 67
ci_019                 1.026247e-02 3 1  ON 68
ci_020                 1.667186e-02 3 1  ON 69
ci_021                 1.655629e-02 3 1  ON 70
ci_022                 1.053220e-02 3 1  ON 71
ci_023                 9.576528e-03 3 1  ON 72
ci_024                 7.539203e-03 3 1  ON 73
ci_025                 6.359996e-03 3 1  ON 74
ci_026                 1.167535e-02 3 1  ON 75
ci_027                 1.178888e-02 3 1  ON 76
ci_028                -1.524525e-02 3 1  ON 77
ci_029                -1.532043e-02 3 1  ON 78
ci_030                -4.432903e-03 3 1  ON 79
ci_031                -4.805770e-03 3 1  ON 80
ci_032                -1.535948e-02 3 1  ON 81
ci_033                 6.744303e-03 3 1  ON 82
ci_034                 7.263921e-03 3 1  ON 83
ci_035                -4.580290e-03 3 1  ON 84
ci_036                -1.276772e-02 3 1  ON 85
ci_037                -1.276275e-02 3 1  ON 86
ci_038                 1.241827e-03 3 1  ON 87
ci_039                 1.420044e-03 3 1  ON 88
ci_040                -2.616848e-03 3 1  ON 89
ci_041                 8.395400e-03 3 1  ON 90
ci_042                 8.337887e-03 3 1  ON 91
ci_043                -3.589004e-03 3 1  ON 92
ci_044                -4.018756e-03 3 1  ON 93
ci_045                -2.808728e-03 3 1  ON 94
ci_046                 5.739200e-03 3 1  ON 95
ci_047                 5.624555e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.239461
====================================================
  Execution time = 2.7434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8344e-01
  Total weights = 1.9665e+06
  Execution time = 2.3332e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274917823838
                                         uncertainty =       0.001536043900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274917823838
                                         uncertainty =       0.001536043900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370737740
  error estimate for blocks of size 2^( 2) =       0.000385442249
  error estimate for blocks of size 2^( 3) =       0.000398501758
  error estimate for blocks of size 2^( 4) =       0.000408663379
  error estimate for blocks of size 2^( 5) =       0.000414238784
  error estimate for blocks of size 2^( 6) =       0.000416928663
  error estimate for blocks of size 2^( 7) =       0.000419483909

      target function =      -0.939060204043
              le_mean =     -17.210586724390
             les_mean =     296.487754280969
             stat err =       0.000414828684
             autocorr =       1.251998938279
   target nu stat err =       0.000414828684
   target dn stat err =       0.001824893891
      target stat err =       0.003144879477
              std dev =       0.524310728982
             le_variance =       0.274901740525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274803103375
                                         uncertainty =       0.001536656696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274803103375
                                         uncertainty =       0.001536656696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370660838
  error estimate for blocks of size 2^( 2) =       0.000385422399
  error estimate for blocks of size 2^( 3) =       0.000398536847
  error estimate for blocks of size 2^( 4) =       0.000408731267
  error estimate for blocks of size 2^( 5) =       0.000414327114
  error estimate for blocks of size 2^( 6) =       0.000417032774
  error estimate for blocks of size 2^( 7) =       0.000419586317

      target function =      -0.938329415089
              le_mean =     -17.210591263641
             les_mean =     296.488346649259
             stat err =       0.000414919368
             autocorr =       1.253066180490
   target nu stat err =       0.000414919368
   target dn stat err =       0.001896242202
      target stat err =       0.003256275023
              std dev =       0.524201971334
             le_variance =       0.274787706751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274839996903
                                         uncertainty =       0.001536309924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274839996903
                                         uncertainty =       0.001536309924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370685541
  error estimate for blocks of size 2^( 2) =       0.000385424123
  error estimate for blocks of size 2^( 3) =       0.000398516182
  error estimate for blocks of size 2^( 4) =       0.000408697198
  error estimate for blocks of size 2^( 5) =       0.000414284227
  error estimate for blocks of size 2^( 6) =       0.000416982640
  error estimate for blocks of size 2^( 7) =       0.000419536701

      target function =      -0.938644419770
              le_mean =     -17.210588208214
             les_mean =     296.488053568316
             stat err =       0.000414875191
             autocorr =       1.252632392259
   target nu stat err =       0.000414875191
   target dn stat err =       0.001843258163
      target stat err =       0.003172077982
              std dev =       0.524236907644
             le_variance =       0.274824335336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274905923074
                                         uncertainty =       0.001536060726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274905923074
                                         uncertainty =       0.001536060726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370729754
  error estimate for blocks of size 2^( 2) =       0.000385438738
  error estimate for blocks of size 2^( 3) =       0.000398502504
  error estimate for blocks of size 2^( 4) =       0.000408666681
  error estimate for blocks of size 2^( 5) =       0.000414243596
  error estimate for blocks of size 2^( 6) =       0.000416934526
  error estimate for blocks of size 2^( 7) =       0.000419489709

      target function =      -0.939086997077
              le_mean =     -17.210586700756
             les_mean =     296.487737469912
             stat err =       0.000414833628
             autocorr =       1.252082725632
   target nu stat err =       0.000414833628
   target dn stat err =       0.001825134243
      target stat err =       0.003145447214
              std dev =       0.524299434280
             le_variance =       0.274889896786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939060204043        initial
     2.5000e-01     2.5000e+00             1.9500e-03        -0.938329415089
     1.0000e+00     1.0000e+01             5.2566e-04        -0.938644419770
     4.0000e+00     4.0000e+01             1.3436e-04        -0.939086997077  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.9228e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.086422e-01 1 1  ON 0
  uu_1                 5.286792e-02 1 1  ON 1
  uu_2                -3.638786e-02 1 1  ON 2
  uu_3                -8.945842e-02 1 1  ON 3
  uu_4                -1.214367e-01 1 1  ON 4
  uu_5                -1.310802e-01 1 1  ON 5
  uu_6                -1.141598e-01 1 1  ON 6
  uu_7                -5.691217e-02 1 1  ON 7
  uu_8                 5.809599e-02 1 1  ON 8
  uu_9                 1.222396e-01 1 1  ON 9
  ud_0                 2.999459e-01 1 1  ON 10
  ud_1                 7.281210e-02 1 1  ON 11
  ud_2                -2.630060e-02 1 1  ON 12
  ud_3                -7.729415e-02 1 1  ON 13
  ud_4                -1.123429e-01 1 1  ON 14
  ud_5                -1.315144e-01 1 1  ON 15
  ud_6                -1.263379e-01 1 1  ON 16
  ud_7                -8.683546e-02 1 1  ON 17
  ud_8                -4.316386e-03 1 1  ON 18
  ud_9                 8.465898e-02 1 1  ON 19
  eO_0                -6.927169e-01 1 1  ON 20
  eO_1                -4.130608e-01 1 1  ON 21
  eO_2                -4.188104e-02 1 1  ON 22
  eO_3                 1.780933e-01 1 1  ON 23
  eO_4                 2.495225e-01 1 1  ON 24
  eO_5                 2.740739e-01 1 1  ON 25
  eO_6                 2.477011e-01 1 1  ON 26
  eO_7                 1.382165e-01 1 1  ON 27
  eO_8                 2.918754e-02 1 1  ON 28
  eO_9                 1.941094e-02 1 1  ON 29
 eH1_0                -2.052537e-01 1 1  ON 30
 eH1_1                -1.001491e-01 1 1  ON 31
 eH1_2                -4.903846e-02 1 1  ON 32
 eH1_3                -1.778562e-02 1 1  ON 33
 eH1_4                 1.691170e-02 1 1  ON 34
 eH1_5                 2.442848e-02 1 1  ON 35
 eH1_6                 7.872480e-02 1 1  ON 36
 eH1_7                 1.067588e-01 1 1  ON 37
 eH1_8                 1.032321e-01 1 1  ON 38
 eH1_9                 2.601951e-02 1 1  ON 39
 eH2_0                -2.020043e-01 1 1  ON 40
 eH2_1                -9.697761e-02 1 1  ON 41
 eH2_2                -4.657834e-02 1 1  ON 42
 eH2_3                -1.598196e-02 1 1  ON 43
 eH2_4                 1.717618e-02 1 1  ON 44
 eH2_5                 2.131474e-02 1 1  ON 45
 eH2_6                 7.071158e-02 1 1  ON 46
 eH2_7                 1.057561e-01 1 1  ON 47
 eH2_8                 1.051372e-01 1 1  ON 48
 eH2_9                 2.838178e-02 1 1  ON 49
ci_001                -4.216293e-02 3 1  ON 50
ci_002                -3.108830e-02 3 1  ON 51
ci_003                -2.583155e-02 3 1  ON 52
ci_004                 2.454503e-02 3 1  ON 53
ci_005                 2.464786e-02 3 1  ON 54
ci_006                -2.043683e-02 3 1  ON 55
ci_007                -2.042125e-02 3 1  ON 56
ci_008                -8.863503e-03 3 1  ON 57
ci_009                -1.497997e-02 3 1  ON 58
ci_010                -9.403303e-03 3 1  ON 59
ci_011                -1.019704e-02 3 1  ON 60
ci_012                -1.017237e-02 3 1  ON 61
ci_013                -1.946400e-02 3 1  ON 62
ci_014                 1.327985e-02 3 1  ON 63
ci_015                 1.321113e-02 3 1  ON 64
ci_016                 1.638418e-02 3 1  ON 65
ci_017                 1.622667e-02 3 1  ON 66
ci_018                 1.018051e-02 3 1  ON 67
ci_019                 1.024273e-02 3 1  ON 68
ci_020                 1.660296e-02 3 1  ON 69
ci_021                 1.650793e-02 3 1  ON 70
ci_022                 1.057352e-02 3 1  ON 71
ci_023                 9.550424e-03 3 1  ON 72
ci_024                 7.575631e-03 3 1  ON 73
ci_025                 6.332700e-03 3 1  ON 74
ci_026                 1.164358e-02 3 1  ON 75
ci_027                 1.176047e-02 3 1  ON 76
ci_028                -1.524869e-02 3 1  ON 77
ci_029                -1.527111e-02 3 1  ON 78
ci_030                -4.408595e-03 3 1  ON 79
ci_031                -4.804969e-03 3 1  ON 80
ci_032                -1.531023e-02 3 1  ON 81
ci_033                 6.804738e-03 3 1  ON 82
ci_034                 7.277195e-03 3 1  ON 83
ci_035                -4.572928e-03 3 1  ON 84
ci_036                -1.281257e-02 3 1  ON 85
ci_037                -1.275586e-02 3 1  ON 86
ci_038                 1.226257e-03 3 1  ON 87
ci_039                 1.411343e-03 3 1  ON 88
ci_040                -2.649603e-03 3 1  ON 89
ci_041                 8.410124e-03 3 1  ON 90
ci_042                 8.460129e-03 3 1  ON 91
ci_043                -3.610858e-03 3 1  ON 92
ci_044                -4.109149e-03 3 1  ON 93
ci_045                -2.804441e-03 3 1  ON 94
ci_046                 5.780181e-03 3 1  ON 95
ci_047                 5.626727e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.309856
====================================================
  Execution time = 2.7662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8957e-01
  Total weights = 1.966376202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3318e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279886308877
                                         uncertainty =       0.002050747331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279886308877
                                         uncertainty =       0.002050747331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374065321
  error estimate for blocks of size 2^( 2) =       0.000388131910
  error estimate for blocks of size 2^( 3) =       0.000401784478
  error estimate for blocks of size 2^( 4) =       0.000411166793
  error estimate for blocks of size 2^( 5) =       0.000417448679
  error estimate for blocks of size 2^( 6) =       0.000419581355
  error estimate for blocks of size 2^( 7) =       0.000421961696

      target function =      -0.928956317853
              le_mean =     -17.209598570077
             les_mean =     296.459856471730
             stat err =       0.000417539631
             autocorr =       1.245949700427
   target nu stat err =       0.000417539631
   target dn stat err =       0.002553627648
      target stat err =       0.004242066465
              std dev =       0.529016714760
             le_variance =       0.279858684496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720959857008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974798673       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929005189080       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929009745544       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929011991136       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929012717526       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929012921078       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929012959797       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929013093811       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929013622488       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929013753604       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929013825342       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929013871941       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929013925396       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929014033320       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929014235461       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929014344775       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929014278906       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929014368735       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929014446097       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929014585284       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929014506145       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929014549201       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929014668373       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929014644440       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929014644281       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929014611018       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929014640495       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929014617199       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929014607414       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929014617356       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929014606886       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929014633356       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929014658429       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929014678048       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929014663154       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929014668180       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929014677769       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929014681743       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929014677964       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929014674366       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929014666205       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929014660487       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929014662152       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929014670986       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 3.950255e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974798673       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928982838549       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928984032093       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928984616311       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928984805705       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928984857556       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928984867035       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928984902082       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928985038380       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928985073393       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928985092214       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928985104473       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928985118785       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928985146076       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928985196261       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928985222078       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928985205484       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928985229280       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928985249508       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928985284679       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928985262008       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928985276258       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928985302175       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928985294896       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928985294915       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928985287676       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928985295075       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928985289044       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928985286710       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928985288165       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928985285472       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928985293356       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928985299302       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928985303018       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928985299033       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928985300699       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928985303225       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928985303860       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928985303110       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928985302076       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928985299284       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928985298955       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.928985299886       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 1.012824e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974798673       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928976838325       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928977140314       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928977287863       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928977335733       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928977348758       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928977351108       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928977359976       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928977394312       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928977403221       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928977407989       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928977411089       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928977414731       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928977421567       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928977434084       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928977440433       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928977436281       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928977442324       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928977447440       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928977456228       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928977450375       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928977454225       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928977460385       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928977458502       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928977458513       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928977456773       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928977458621       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928977457103       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928977456525       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928977456806       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928977456154       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928977458217       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928977459628       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928977460514       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928977459524       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928977459919       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928977460557       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928977460758       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928977460541       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928977460277       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928977459728       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928977459486       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 2.550501e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.702188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6090e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.086642e-01 1 1  ON 0
  uu_1                 5.289336e-02 1 1  ON 1
  uu_2                -3.637527e-02 1 1  ON 2
  uu_3                -8.944484e-02 1 1  ON 3
  uu_4                -1.214198e-01 1 1  ON 4
  uu_5                -1.310791e-01 1 1  ON 5
  uu_6                -1.142107e-01 1 1  ON 6
  uu_7                -5.692908e-02 1 1  ON 7
  uu_8                 5.799819e-02 1 1  ON 8
  uu_9                 1.222618e-01 1 1  ON 9
  ud_0                 2.998847e-01 1 1  ON 10
  ud_1                 7.276621e-02 1 1  ON 11
  ud_2                -2.634528e-02 1 1  ON 12
  ud_3                -7.733543e-02 1 1  ON 13
  ud_4                -1.123703e-01 1 1  ON 14
  ud_5                -1.315190e-01 1 1  ON 15
  ud_6                -1.263165e-01 1 1  ON 16
  ud_7                -8.673418e-02 1 1  ON 17
  ud_8                -4.280679e-03 1 1  ON 18
  ud_9                 8.467038e-02 1 1  ON 19
  eO_0                -6.927233e-01 1 1  ON 20
  eO_1                -4.130734e-01 1 1  ON 21
  eO_2                -4.190460e-02 1 1  ON 22
  eO_3                 1.780689e-01 1 1  ON 23
  eO_4                 2.495050e-01 1 1  ON 24
  eO_5                 2.740577e-01 1 1  ON 25
  eO_6                 2.477030e-01 1 1  ON 26
  eO_7                 1.382835e-01 1 1  ON 27
  eO_8                 2.920545e-02 1 1  ON 28
  eO_9                 1.942018e-02 1 1  ON 29
 eH1_0                -2.052317e-01 1 1  ON 30
 eH1_1                -1.001368e-01 1 1  ON 31
 eH1_2                -4.902593e-02 1 1  ON 32
 eH1_3                -1.779482e-02 1 1  ON 33
 eH1_4                 1.687590e-02 1 1  ON 34
 eH1_5                 2.436227e-02 1 1  ON 35
 eH1_6                 7.871006e-02 1 1  ON 36
 eH1_7                 1.067819e-01 1 1  ON 37
 eH1_8                 1.032695e-01 1 1  ON 38
 eH1_9                 2.603154e-02 1 1  ON 39
 eH2_0                -2.020464e-01 1 1  ON 40
 eH2_1                -9.700183e-02 1 1  ON 41
 eH2_2                -4.658421e-02 1 1  ON 42
 eH2_3                -1.599637e-02 1 1  ON 43
 eH2_4                 1.715938e-02 1 1  ON 44
 eH2_5                 2.133976e-02 1 1  ON 45
 eH2_6                 7.075247e-02 1 1  ON 46
 eH2_7                 1.057381e-01 1 1  ON 47
 eH2_8                 1.051699e-01 1 1  ON 48
 eH2_9                 2.840123e-02 1 1  ON 49
ci_001                -4.217147e-02 3 1  ON 50
ci_002                -3.107972e-02 3 1  ON 51
ci_003                -2.585232e-02 3 1  ON 52
ci_004                 2.454468e-02 3 1  ON 53
ci_005                 2.466176e-02 3 1  ON 54
ci_006                -2.041548e-02 3 1  ON 55
ci_007                -2.041727e-02 3 1  ON 56
ci_008                -8.872045e-03 3 1  ON 57
ci_009                -1.496496e-02 3 1  ON 58
ci_010                -9.407725e-03 3 1  ON 59
ci_011                -1.018157e-02 3 1  ON 60
ci_012                -1.018912e-02 3 1  ON 61
ci_013                -1.947703e-02 3 1  ON 62
ci_014                 1.328238e-02 3 1  ON 63
ci_015                 1.320503e-02 3 1  ON 64
ci_016                 1.639577e-02 3 1  ON 65
ci_017                 1.623416e-02 3 1  ON 66
ci_018                 1.016798e-02 3 1  ON 67
ci_019                 1.024164e-02 3 1  ON 68
ci_020                 1.661051e-02 3 1  ON 69
ci_021                 1.651650e-02 3 1  ON 70
ci_022                 1.056373e-02 3 1  ON 71
ci_023                 9.577598e-03 3 1  ON 72
ci_024                 7.571286e-03 3 1  ON 73
ci_025                 6.347841e-03 3 1  ON 74
ci_026                 1.162593e-02 3 1  ON 75
ci_027                 1.173850e-02 3 1  ON 76
ci_028                -1.525787e-02 3 1  ON 77
ci_029                -1.528825e-02 3 1  ON 78
ci_030                -4.407583e-03 3 1  ON 79
ci_031                -4.797749e-03 3 1  ON 80
ci_032                -1.529789e-02 3 1  ON 81
ci_033                 6.802843e-03 3 1  ON 82
ci_034                 7.274318e-03 3 1  ON 83
ci_035                -4.575671e-03 3 1  ON 84
ci_036                -1.282700e-02 3 1  ON 85
ci_037                -1.273753e-02 3 1  ON 86
ci_038                 1.227722e-03 3 1  ON 87
ci_039                 1.405113e-03 3 1  ON 88
ci_040                -2.651972e-03 3 1  ON 89
ci_041                 8.395498e-03 3 1  ON 90
ci_042                 8.432050e-03 3 1  ON 91
ci_043                -3.612411e-03 3 1  ON 92
ci_044                -4.090478e-03 3 1  ON 93
ci_045                -2.804794e-03 3 1  ON 94
ci_046                 5.782884e-03 3 1  ON 95
ci_047                 5.630298e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.187
    reference variance = 0.178045
====================================================
  Execution time = 2.9613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8545e-01
  Total weights = 1.9665e+06
  Execution time = 2.3338e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276466498686
                                         uncertainty =       0.001619057726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276466498686
                                         uncertainty =       0.001619057726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371847722
  error estimate for blocks of size 2^( 2) =       0.000385936681
  error estimate for blocks of size 2^( 3) =       0.000399155151
  error estimate for blocks of size 2^( 4) =       0.000409187542
  error estimate for blocks of size 2^( 5) =       0.000414248440
  error estimate for blocks of size 2^( 6) =       0.000418756174
  error estimate for blocks of size 2^( 7) =       0.000422058523

      target function =      -0.935745992571
              le_mean =     -17.209418498330
             les_mean =     296.449543280695
             stat err =       0.000416062670
             autocorr =       1.251950774307
   target nu stat err =       0.000416062670
   target dn stat err =       0.002288409254
      target stat err =       0.003868570052
              std dev =       0.525880505056
             le_variance =       0.276550305598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276487485547
                                         uncertainty =       0.001617636669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276487485547
                                         uncertainty =       0.001617636669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371861899
  error estimate for blocks of size 2^( 2) =       0.000385960647
  error estimate for blocks of size 2^( 3) =       0.000399187835
  error estimate for blocks of size 2^( 4) =       0.000409227833
  error estimate for blocks of size 2^( 5) =       0.000414294958
  error estimate for blocks of size 2^( 6) =       0.000418806749
  error estimate for blocks of size 2^( 7) =       0.000422119626

      target function =      -0.935750837673
              le_mean =     -17.209416972610
             les_mean =     296.449487979314
             stat err =       0.000416112291
             autocorr =       1.252153936446
   target nu stat err =       0.000416112291
   target dn stat err =       0.002274438981
      target stat err =       0.003845858996
              std dev =       0.525900555282
             le_variance =       0.276571394046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276476897471
                                         uncertainty =       0.001618296875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276476897471
                                         uncertainty =       0.001618296875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371854749
  error estimate for blocks of size 2^( 2) =       0.000385948816
  error estimate for blocks of size 2^( 3) =       0.000399171827
  error estimate for blocks of size 2^( 4) =       0.000409208205
  error estimate for blocks of size 2^( 5) =       0.000414272324
  error estimate for blocks of size 2^( 6) =       0.000418782162
  error estimate for blocks of size 2^( 7) =       0.000422089944

      target function =      -0.935405680228
              le_mean =     -17.209417611343
             les_mean =     296.449717895801
             stat err =       0.000416088159
             autocorr =       1.252056852341
   target nu stat err =       0.000416088159
   target dn stat err =       0.002290761214
      target stat err =       0.003869638698
              std dev =       0.525890442649
             le_variance =       0.276560757669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276467737628
                                         uncertainty =       0.001618959929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276467737628
                                         uncertainty =       0.001618959929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848559
  error estimate for blocks of size 2^( 2) =       0.000385938166
  error estimate for blocks of size 2^( 3) =       0.000399157209
  error estimate for blocks of size 2^( 4) =       0.000409190101
  error estimate for blocks of size 2^( 5) =       0.000414251406
  error estimate for blocks of size 2^( 6) =       0.000418759404
  error estimate for blocks of size 2^( 7) =       0.000422062450

      target function =      -0.935751534751
              le_mean =     -17.209418378441
             les_mean =     296.449535825871
             stat err =       0.000416065840
             autocorr =       1.251964214848
   target nu stat err =       0.000416065840
   target dn stat err =       0.002287180626
      target stat err =       0.003866613722
              std dev =       0.525881689459
             le_variance =       0.276551551308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935745992571        initial
     1.0000e+00     1.0000e+01             3.9503e-04        -0.935750837673
     4.0000e+00     4.0000e+01             1.0128e-04        -0.935405680228
     1.6000e+01     1.6000e+02             2.5505e-05        -0.935751534751  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.1433e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.086477e-01 1 1  ON 0
  uu_1                 5.287435e-02 1 1  ON 1
  uu_2                -3.638469e-02 1 1  ON 2
  uu_3                -8.945499e-02 1 1  ON 3
  uu_4                -1.214324e-01 1 1  ON 4
  uu_5                -1.310799e-01 1 1  ON 5
  uu_6                -1.141727e-01 1 1  ON 6
  uu_7                -5.691641e-02 1 1  ON 7
  uu_8                 5.807155e-02 1 1  ON 8
  uu_9                 1.222451e-01 1 1  ON 9
  ud_0                 2.999305e-01 1 1  ON 10
  ud_1                 7.280059e-02 1 1  ON 11
  ud_2                -2.631181e-02 1 1  ON 12
  ud_3                -7.730451e-02 1 1  ON 13
  ud_4                -1.123498e-01 1 1  ON 14
  ud_5                -1.315156e-01 1 1  ON 15
  ud_6                -1.263324e-01 1 1  ON 16
  ud_7                -8.680995e-02 1 1  ON 17
  ud_8                -4.307485e-03 1 1  ON 18
  ud_9                 8.466181e-02 1 1  ON 19
  eO_0                -6.927184e-01 1 1  ON 20
  eO_1                -4.130639e-01 1 1  ON 21
  eO_2                -4.188693e-02 1 1  ON 22
  eO_3                 1.780872e-01 1 1  ON 23
  eO_4                 2.495181e-01 1 1  ON 24
  eO_5                 2.740698e-01 1 1  ON 25
  eO_6                 2.477016e-01 1 1  ON 26
  eO_7                 1.382332e-01 1 1  ON 27
  eO_8                 2.919200e-02 1 1  ON 28
  eO_9                 1.941324e-02 1 1  ON 29
 eH1_0                -2.052482e-01 1 1  ON 30
 eH1_1                -1.001460e-01 1 1  ON 31
 eH1_2                -4.903527e-02 1 1  ON 32
 eH1_3                -1.778792e-02 1 1  ON 33
 eH1_4                 1.690269e-02 1 1  ON 34
 eH1_5                 2.441188e-02 1 1  ON 35
 eH1_6                 7.872110e-02 1 1  ON 36
 eH1_7                 1.067646e-01 1 1  ON 37
 eH1_8                 1.032414e-01 1 1  ON 38
 eH1_9                 2.602251e-02 1 1  ON 39
 eH2_0                -2.020149e-01 1 1  ON 40
 eH2_1                -9.698368e-02 1 1  ON 41
 eH2_2                -4.657977e-02 1 1  ON 42
 eH2_3                -1.598554e-02 1 1  ON 43
 eH2_4                 1.717196e-02 1 1  ON 44
 eH2_5                 2.132103e-02 1 1  ON 45
 eH2_6                 7.072185e-02 1 1  ON 46
 eH2_7                 1.057516e-01 1 1  ON 47
 eH2_8                 1.051454e-01 1 1  ON 48
 eH2_9                 2.838663e-02 1 1  ON 49
ci_001                -4.216509e-02 3 1  ON 50
ci_002                -3.108613e-02 3 1  ON 51
ci_003                -2.583681e-02 3 1  ON 52
ci_004                 2.454495e-02 3 1  ON 53
ci_005                 2.465138e-02 3 1  ON 54
ci_006                -2.043144e-02 3 1  ON 55
ci_007                -2.042024e-02 3 1  ON 56
ci_008                -8.865670e-03 3 1  ON 57
ci_009                -1.497616e-02 3 1  ON 58
ci_010                -9.404415e-03 3 1  ON 59
ci_011                -1.019312e-02 3 1  ON 60
ci_012                -1.017660e-02 3 1  ON 61
ci_013                -1.946729e-02 3 1  ON 62
ci_014                 1.328049e-02 3 1  ON 63
ci_015                 1.320958e-02 3 1  ON 64
ci_016                 1.638711e-02 3 1  ON 65
ci_017                 1.622856e-02 3 1  ON 66
ci_018                 1.017733e-02 3 1  ON 67
ci_019                 1.024246e-02 3 1  ON 68
ci_020                 1.660486e-02 3 1  ON 69
ci_021                 1.651010e-02 3 1  ON 70
ci_022                 1.057105e-02 3 1  ON 71
ci_023                 9.557311e-03 3 1  ON 72
ci_024                 7.574530e-03 3 1  ON 73
ci_025                 6.336523e-03 3 1  ON 74
ci_026                 1.163912e-02 3 1  ON 75
ci_027                 1.175489e-02 3 1  ON 76
ci_028                -1.525101e-02 3 1  ON 77
ci_029                -1.527545e-02 3 1  ON 78
ci_030                -4.408344e-03 3 1  ON 79
ci_031                -4.803140e-03 3 1  ON 80
ci_032                -1.530711e-02 3 1  ON 81
ci_033                 6.804271e-03 3 1  ON 82
ci_034                 7.276462e-03 3 1  ON 83
ci_035                -4.573615e-03 3 1  ON 84
ci_036                -1.281622e-02 3 1  ON 85
ci_037                -1.275120e-02 3 1  ON 86
ci_038                 1.226627e-03 3 1  ON 87
ci_039                 1.409763e-03 3 1  ON 88
ci_040                -2.650203e-03 3 1  ON 89
ci_041                 8.406412e-03 3 1  ON 90
ci_042                 8.453004e-03 3 1  ON 91
ci_043                -3.611246e-03 3 1  ON 92
ci_044                -4.104419e-03 3 1  ON 93
ci_045                -2.804531e-03 3 1  ON 94
ci_046                 5.780860e-03 3 1  ON 95
ci_047                 5.627629e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.244662
====================================================
  Execution time = 2.7785e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0460e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8544e-01
  Total weights = 1.966076334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3398e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275060630998
                                         uncertainty =       0.001374249667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275060630998
                                         uncertainty =       0.001374249667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370827262
  error estimate for blocks of size 2^( 2) =       0.000385134265
  error estimate for blocks of size 2^( 3) =       0.000398722291
  error estimate for blocks of size 2^( 4) =       0.000408584596
  error estimate for blocks of size 2^( 5) =       0.000413869730
  error estimate for blocks of size 2^( 6) =       0.000416391892
  error estimate for blocks of size 2^( 7) =       0.000419544289

      target function =      -0.935783455162
              le_mean =     -17.209346198154
             les_mean =     296.447033513533
             stat err =       0.000414597627
             autocorr =       1.250000867312
   target nu stat err =       0.000414597627
   target dn stat err =       0.002245464231
      target stat err =       0.003797908544
              std dev =       0.524437334458
             le_variance =       0.275034517773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720934619815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935797843433       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935805522045       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935807096641       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935807669240       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935807852449       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935808045912       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935808044429       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935808185512       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935808233136       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935808221894       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935808289304       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935808279645       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935808326190       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935808352572       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935808356312       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935808362966       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935808384766       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935808357480       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935808359344       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935808385523       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935808404952       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935808423233       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935808437451       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935808445861       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935808439724       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935808460411       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935808451951       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935808456624       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935808446425       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935808452748       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935808460182       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935808457448       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935808456682       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935808456793       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935808460797       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935808459962       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935808462835       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935808462317       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935808462106       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935808463259       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 6.884980e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935797843433       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935799791533       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935800189687       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935800333814       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935800379959       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935800428589       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935800428138       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935800462853       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935800475697       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935800472531       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935800489750       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935800487311       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935800498956       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935800505606       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935800506456       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935800508088       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935800513508       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935800506646       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935800507250       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935800513803       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935800518683       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935800523236       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935800526726       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935800528835       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935800527285       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935800532539       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935800530372       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935800531447       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935800528917       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935800530457       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935800532313       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935800531606       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935800531467       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935800531480       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935800532475       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935800532243       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935800532960       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935800532801       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935800532790       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935800533052       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 1.725501e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935797843433       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935798332269       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935798432093       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935798468186       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935798479744       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935798491917       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935798491800       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935798500442       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935798503713       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935798502900       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935798507228       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935798506616       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935798509528       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935798511194       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935798511401       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935798511807       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935798513160       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935798511442       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935798511602       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935798513241       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935798514463       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935798515599       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935798516468       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935798516996       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935798516606       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935798517926       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935798517380       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935798517643       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935798517012       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935798517395       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935798517859       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935798517680       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935798517649       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935798517651       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935798517899       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935798517840       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935798518019       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935798517978       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935798517977       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935798518041       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.4000e+01 is 4.316433e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.774902 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6205e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.086472e-01 1 1  ON 0
  uu_1                 5.287380e-02 1 1  ON 1
  uu_2                -3.638263e-02 1 1  ON 2
  uu_3                -8.945584e-02 1 1  ON 3
  uu_4                -1.214350e-01 1 1  ON 4
  uu_5                -1.310815e-01 1 1  ON 5
  uu_6                -1.141649e-01 1 1  ON 6
  uu_7                -5.691180e-02 1 1  ON 7
  uu_8                 5.805429e-02 1 1  ON 8
  uu_9                 1.222472e-01 1 1  ON 9
  ud_0                 2.999179e-01 1 1  ON 10
  ud_1                 7.278897e-02 1 1  ON 11
  ud_2                -2.631919e-02 1 1  ON 12
  ud_3                -7.730902e-02 1 1  ON 13
  ud_4                -1.123503e-01 1 1  ON 14
  ud_5                -1.315089e-01 1 1  ON 15
  ud_6                -1.263165e-01 1 1  ON 16
  ud_7                -8.679345e-02 1 1  ON 17
  ud_8                -4.309356e-03 1 1  ON 18
  ud_9                 8.465568e-02 1 1  ON 19
  eO_0                -6.927145e-01 1 1  ON 20
  eO_1                -4.130640e-01 1 1  ON 21
  eO_2                -4.189732e-02 1 1  ON 22
  eO_3                 1.780765e-01 1 1  ON 23
  eO_4                 2.495087e-01 1 1  ON 24
  eO_5                 2.740704e-01 1 1  ON 25
  eO_6                 2.477088e-01 1 1  ON 26
  eO_7                 1.382500e-01 1 1  ON 27
  eO_8                 2.919331e-02 1 1  ON 28
  eO_9                 1.941389e-02 1 1  ON 29
 eH1_0                -2.052513e-01 1 1  ON 30
 eH1_1                -1.001426e-01 1 1  ON 31
 eH1_2                -4.903379e-02 1 1  ON 32
 eH1_3                -1.778928e-02 1 1  ON 33
 eH1_4                 1.689589e-02 1 1  ON 34
 eH1_5                 2.440700e-02 1 1  ON 35
 eH1_6                 7.872249e-02 1 1  ON 36
 eH1_7                 1.067650e-01 1 1  ON 37
 eH1_8                 1.032498e-01 1 1  ON 38
 eH1_9                 2.602372e-02 1 1  ON 39
 eH2_0                -2.020189e-01 1 1  ON 40
 eH2_1                -9.698400e-02 1 1  ON 41
 eH2_2                -4.657654e-02 1 1  ON 42
 eH2_3                -1.597922e-02 1 1  ON 43
 eH2_4                 1.717896e-02 1 1  ON 44
 eH2_5                 2.131787e-02 1 1  ON 45
 eH2_6                 7.071370e-02 1 1  ON 46
 eH2_7                 1.057434e-01 1 1  ON 47
 eH2_8                 1.051517e-01 1 1  ON 48
 eH2_9                 2.838759e-02 1 1  ON 49
ci_001                -4.216146e-02 3 1  ON 50
ci_002                -3.108726e-02 3 1  ON 51
ci_003                -2.583396e-02 3 1  ON 52
ci_004                 2.454944e-02 3 1  ON 53
ci_005                 2.465211e-02 3 1  ON 54
ci_006                -2.043268e-02 3 1  ON 55
ci_007                -2.042190e-02 3 1  ON 56
ci_008                -8.860580e-03 3 1  ON 57
ci_009                -1.497586e-02 3 1  ON 58
ci_010                -9.401413e-03 3 1  ON 59
ci_011                -1.019035e-02 3 1  ON 60
ci_012                -1.017384e-02 3 1  ON 61
ci_013                -1.946776e-02 3 1  ON 62
ci_014                 1.328769e-02 3 1  ON 63
ci_015                 1.320700e-02 3 1  ON 64
ci_016                 1.639020e-02 3 1  ON 65
ci_017                 1.622875e-02 3 1  ON 66
ci_018                 1.017856e-02 3 1  ON 67
ci_019                 1.024521e-02 3 1  ON 68
ci_020                 1.660629e-02 3 1  ON 69
ci_021                 1.650915e-02 3 1  ON 70
ci_022                 1.056620e-02 3 1  ON 71
ci_023                 9.559284e-03 3 1  ON 72
ci_024                 7.569860e-03 3 1  ON 73
ci_025                 6.339662e-03 3 1  ON 74
ci_026                 1.163850e-02 3 1  ON 75
ci_027                 1.175472e-02 3 1  ON 76
ci_028                -1.524954e-02 3 1  ON 77
ci_029                -1.527821e-02 3 1  ON 78
ci_030                -4.405513e-03 3 1  ON 79
ci_031                -4.800623e-03 3 1  ON 80
ci_032                -1.530686e-02 3 1  ON 81
ci_033                 6.810710e-03 3 1  ON 82
ci_034                 7.274405e-03 3 1  ON 83
ci_035                -4.575831e-03 3 1  ON 84
ci_036                -1.280636e-02 3 1  ON 85
ci_037                -1.274778e-02 3 1  ON 86
ci_038                 1.226078e-03 3 1  ON 87
ci_039                 1.411858e-03 3 1  ON 88
ci_040                -2.650350e-03 3 1  ON 89
ci_041                 8.408822e-03 3 1  ON 90
ci_042                 8.450857e-03 3 1  ON 91
ci_043                -3.611289e-03 3 1  ON 92
ci_044                -4.098514e-03 3 1  ON 93
ci_045                -2.802397e-03 3 1  ON 94
ci_046                 5.779964e-03 3 1  ON 95
ci_047                 5.629461e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0428
    reference variance = 3.25553
====================================================
  Execution time = 2.7577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8654e-01
  Total weights = 1.9667e+06
  Execution time = 2.3211e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277510156001
                                         uncertainty =       0.001934039362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277510156001
                                         uncertainty =       0.001934039362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457316
  error estimate for blocks of size 2^( 2) =       0.000386785106
  error estimate for blocks of size 2^( 3) =       0.000399839478
  error estimate for blocks of size 2^( 4) =       0.000409428164
  error estimate for blocks of size 2^( 5) =       0.000415594463
  error estimate for blocks of size 2^( 6) =       0.000418066868
  error estimate for blocks of size 2^( 7) =       0.000419877417

      target function =      -0.933955072730
              le_mean =     -17.209693705286
             les_mean =     296.460091579446
             stat err =       0.000415741728
             autocorr =       1.245931638086
   target nu stat err =       0.000415741728
   target dn stat err =       0.002423487915
      target stat err =       0.004075486774
              std dev =       0.526742615796
             le_variance =       0.277457783296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277504366006
                                         uncertainty =       0.001933391063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277504366006
                                         uncertainty =       0.001933391063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372453455
  error estimate for blocks of size 2^( 2) =       0.000386785024
  error estimate for blocks of size 2^( 3) =       0.000399842658
  error estimate for blocks of size 2^( 4) =       0.000409433310
  error estimate for blocks of size 2^( 5) =       0.000415600168
  error estimate for blocks of size 2^( 6) =       0.000418073720
  error estimate for blocks of size 2^( 7) =       0.000419886368

      target function =      -0.934046318216
              le_mean =     -17.209693549554
             les_mean =     296.460031109815
             stat err =       0.000415748392
             autocorr =       1.245997416361
   target nu stat err =       0.000415748392
   target dn stat err =       0.002417473957
      target stat err =       0.004066485810
              std dev =       0.526737154438
             le_variance =       0.277452029865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277507186934
                                         uncertainty =       0.001933710474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277507186934
                                         uncertainty =       0.001933710474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372455336
  error estimate for blocks of size 2^( 2) =       0.000386785040
  error estimate for blocks of size 2^( 3) =       0.000399841061
  error estimate for blocks of size 2^( 4) =       0.000409430754
  error estimate for blocks of size 2^( 5) =       0.000415597332
  error estimate for blocks of size 2^( 6) =       0.000418070321
  error estimate for blocks of size 2^( 7) =       0.000419881920

      target function =      -0.933948604074
              le_mean =     -17.209693622918
             les_mean =     296.460092683541
             stat err =       0.000415745082
             autocorr =       1.245964989233
   target nu stat err =       0.000415745082
   target dn stat err =       0.002420563339
      target stat err =       0.004070674011
              std dev =       0.526739815110
             le_variance =       0.277454832822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277509779461
                                         uncertainty =       0.001933998040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277509779461
                                         uncertainty =       0.001933998040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457065
  error estimate for blocks of size 2^( 2) =       0.000386785095
  error estimate for blocks of size 2^( 3) =       0.000399839673
  error estimate for blocks of size 2^( 4) =       0.000409428483
  error estimate for blocks of size 2^( 5) =       0.000415594817
  error estimate for blocks of size 2^( 6) =       0.000418067295
  error estimate for blocks of size 2^( 7) =       0.000419877978

      target function =      -0.933960942578
              le_mean =     -17.209693693979
             les_mean =     296.460087645512
             stat err =       0.000415742143
             autocorr =       1.245935807297
   target nu stat err =       0.000415742143
   target dn stat err =       0.002423020684
      target stat err =       0.004074777096
              std dev =       0.526742260590
             le_variance =       0.277457409092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933955072730        initial
     4.0000e+00     4.0000e+01             6.8850e-05        -0.934046318216  <--
     1.6000e+01     1.6000e+02             1.7255e-05        -0.933948604074
     6.4000e+01     6.4000e+02             4.3164e-06        -0.933960942578

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 3.9361e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.086458e-01 1 1  ON 0
  uu_1                 5.287218e-02 1 1  ON 1
  uu_2                -3.637658e-02 1 1  ON 2
  uu_3                -8.945832e-02 1 1  ON 3
  uu_4                -1.214426e-01 1 1  ON 4
  uu_5                -1.310861e-01 1 1  ON 5
  uu_6                -1.141418e-01 1 1  ON 6
  uu_7                -5.689803e-02 1 1  ON 7
  uu_8                 5.800270e-02 1 1  ON 8
  uu_9                 1.222534e-01 1 1  ON 9
  ud_0                 2.998802e-01 1 1  ON 10
  ud_1                 7.275444e-02 1 1  ON 11
  ud_2                -2.634121e-02 1 1  ON 12
  ud_3                -7.732250e-02 1 1  ON 13
  ud_4                -1.123519e-01 1 1  ON 14
  ud_5                -1.314894e-01 1 1  ON 15
  ud_6                -1.262694e-01 1 1  ON 16
  ud_7                -8.674417e-02 1 1  ON 17
  ud_8                -4.314796e-03 1 1  ON 18
  ud_9                 8.463732e-02 1 1  ON 19
  eO_0                -6.927029e-01 1 1  ON 20
  eO_1                -4.130643e-01 1 1  ON 21
  eO_2                -4.192827e-02 1 1  ON 22
  eO_3                 1.780444e-01 1 1  ON 23
  eO_4                 2.494806e-01 1 1  ON 24
  eO_5                 2.740721e-01 1 1  ON 25
  eO_6                 2.477303e-01 1 1  ON 26
  eO_7                 1.383001e-01 1 1  ON 27
  eO_8                 2.919724e-02 1 1  ON 28
  eO_9                 1.941585e-02 1 1  ON 29
 eH1_0                -2.052603e-01 1 1  ON 30
 eH1_1                -1.001328e-01 1 1  ON 31
 eH1_2                -4.902949e-02 1 1  ON 32
 eH1_3                -1.779340e-02 1 1  ON 33
 eH1_4                 1.687567e-02 1 1  ON 34
 eH1_5                 2.439241e-02 1 1  ON 35
 eH1_6                 7.872661e-02 1 1  ON 36
 eH1_7                 1.067662e-01 1 1  ON 37
 eH1_8                 1.032750e-01 1 1  ON 38
 eH1_9                 2.602737e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698484e-02 1 1  ON 41
 eH2_2                -4.656691e-02 1 1  ON 42
 eH2_3                -1.596048e-02 1 1  ON 43
 eH2_4                 1.719973e-02 1 1  ON 44
 eH2_5                 2.130853e-02 1 1  ON 45
 eH2_6                 7.068926e-02 1 1  ON 46
 eH2_7                 1.057187e-01 1 1  ON 47
 eH2_8                 1.051706e-01 1 1  ON 48
 eH2_9                 2.839046e-02 1 1  ON 49
ci_001                -4.215072e-02 3 1  ON 50
ci_002                -3.109062e-02 3 1  ON 51
ci_003                -2.582547e-02 3 1  ON 52
ci_004                 2.456269e-02 3 1  ON 53
ci_005                 2.465425e-02 3 1  ON 54
ci_006                -2.043634e-02 3 1  ON 55
ci_007                -2.042680e-02 3 1  ON 56
ci_008                -8.845582e-03 3 1  ON 57
ci_009                -1.497498e-02 3 1  ON 58
ci_010                -9.392560e-03 3 1  ON 59
ci_011                -1.018218e-02 3 1  ON 60
ci_012                -1.016569e-02 3 1  ON 61
ci_013                -1.946915e-02 3 1  ON 62
ci_014                 1.330893e-02 3 1  ON 63
ci_015                 1.319939e-02 3 1  ON 64
ci_016                 1.639935e-02 3 1  ON 65
ci_017                 1.622930e-02 3 1  ON 66
ci_018                 1.018218e-02 3 1  ON 67
ci_019                 1.025334e-02 3 1  ON 68
ci_020                 1.661052e-02 3 1  ON 69
ci_021                 1.650633e-02 3 1  ON 70
ci_022                 1.055191e-02 3 1  ON 71
ci_023                 9.565100e-03 3 1  ON 72
ci_024                 7.556063e-03 3 1  ON 73
ci_025                 6.348928e-03 3 1  ON 74
ci_026                 1.163671e-02 3 1  ON 75
ci_027                 1.175420e-02 3 1  ON 76
ci_028                -1.524522e-02 3 1  ON 77
ci_029                -1.528635e-02 3 1  ON 78
ci_030                -4.397187e-03 3 1  ON 79
ci_031                -4.793215e-03 3 1  ON 80
ci_032                -1.530613e-02 3 1  ON 81
ci_033                 6.829707e-03 3 1  ON 82
ci_034                 7.268332e-03 3 1  ON 83
ci_035                -4.582358e-03 3 1  ON 84
ci_036                -1.277732e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224464e-03 3 1  ON 87
ci_039                 1.418030e-03 3 1  ON 88
ci_040                -2.650783e-03 3 1  ON 89
ci_041                 8.415908e-03 3 1  ON 90
ci_042                 8.444554e-03 3 1  ON 91
ci_043                -3.611419e-03 3 1  ON 92
ci_044                -4.081109e-03 3 1  ON 93
ci_045                -2.796121e-03 3 1  ON 94
ci_046                 5.777324e-03 3 1  ON 95
ci_047                 5.634866e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2689
    reference variance = 0.322178
====================================================
  Execution time = 2.7863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0515e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8518e-01
  Total weights = 1.966514362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5916e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275741761334
                                         uncertainty =       0.001768710156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275741761334
                                         uncertainty =       0.001768710156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371277580
  error estimate for blocks of size 2^( 2) =       0.000385475981
  error estimate for blocks of size 2^( 3) =       0.000398632760
  error estimate for blocks of size 2^( 4) =       0.000408275497
  error estimate for blocks of size 2^( 5) =       0.000413793759
  error estimate for blocks of size 2^( 6) =       0.000417569880
  error estimate for blocks of size 2^( 7) =       0.000418825003

      target function =      -0.936188646164
              le_mean =     -17.210332614133
             les_mean =     296.480725480128
             stat err =       0.000414616035
             autocorr =       1.247081218514
   target nu stat err =       0.000414616035
   target dn stat err =       0.002544268206
      target stat err =       0.004297148261
              std dev =       0.525074189727
             le_variance =       0.275702904717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721033261413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936207356767       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936232663659       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936236053940       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936237181895       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936237458093       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936238251693       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936238340834       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936238748501       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936238730864       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936238995058       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936239111870       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936239207918       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936239274176       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936239337857       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936239791330       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936239908352       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936239757465       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936239806744       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936239982254       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936239956872       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936240013182       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936240153771       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936240250266       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936240255738       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936240268696       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936240265026       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936240277571       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936240237356       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936240215887       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936240202162       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936240214516       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936240243243       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936240238641       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936240207910       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936240218758       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936240218555       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936240223504       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936240230710       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936240221555       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936240229741       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936240237700       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936240238493       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936240236434       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936240234349       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936240231425       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 4.134152e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936207356767       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936214048377       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936214929575       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936215225029       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936215294278       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936215505724       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936215526247       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936215631095       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936215631607       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936215699243       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936215729466       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936215752779       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936215767824       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936215784123       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936215899891       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936215928891       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936215890746       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936215902583       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936215948827       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936215940573       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936215955072       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936215990640       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936216013906       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936216014359       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936216017269       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936216016201       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936216018260       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936216008406       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936216003029       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936215999554       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936216003446       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936216010162       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936216008380       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936216000901       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936216004130       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936216002780       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936216006447       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936216006279       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936216005023       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936216006429       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936216008770       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936216008514       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936216008200       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 1.038060e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936207356767       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936209054142       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936209276634       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936209351387       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936209368718       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936209422430       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936209427502       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936209453870       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936209454305       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936209471348       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936209478952       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936209484731       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936209488386       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936209492490       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936209521575       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936209528811       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936209519257       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936209522187       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936209533896       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936209531700       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936209535354       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936209544272       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936209550030       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936209550083       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936209550789       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936209550513       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936209550955       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936209548509       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936209547163       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936209546300       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936209547322       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936209548961       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936209548482       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936209546644       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936209547442       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936209547136       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936209547939       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936209548057       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936209547639       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936209548036       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936209548600       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936209548537       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936209548454       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+01 is 2.599819e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.867978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6555e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.086846e-01 1 1  ON 0
  uu_1                 5.290202e-02 1 1  ON 1
  uu_2                -3.634700e-02 1 1  ON 2
  uu_3                -8.943427e-02 1 1  ON 3
  uu_4                -1.214375e-01 1 1  ON 4
  uu_5                -1.311050e-01 1 1  ON 5
  uu_6                -1.141634e-01 1 1  ON 6
  uu_7                -5.690887e-02 1 1  ON 7
  uu_8                 5.789889e-02 1 1  ON 8
  uu_9                 1.222426e-01 1 1  ON 9
  ud_0                 2.998353e-01 1 1  ON 10
  ud_1                 7.271698e-02 1 1  ON 11
  ud_2                -2.636206e-02 1 1  ON 12
  ud_3                -7.733138e-02 1 1  ON 13
  ud_4                -1.123492e-01 1 1  ON 14
  ud_5                -1.314819e-01 1 1  ON 15
  ud_6                -1.262383e-01 1 1  ON 16
  ud_7                -8.668234e-02 1 1  ON 17
  ud_8                -4.330315e-03 1 1  ON 18
  ud_9                 8.462213e-02 1 1  ON 19
  eO_0                -6.926881e-01 1 1  ON 20
  eO_1                -4.130645e-01 1 1  ON 21
  eO_2                -4.194189e-02 1 1  ON 22
  eO_3                 1.780081e-01 1 1  ON 23
  eO_4                 2.494915e-01 1 1  ON 24
  eO_5                 2.740289e-01 1 1  ON 25
  eO_6                 2.477331e-01 1 1  ON 26
  eO_7                 1.383594e-01 1 1  ON 27
  eO_8                 2.920107e-02 1 1  ON 28
  eO_9                 1.941543e-02 1 1  ON 29
 eH1_0                -2.052505e-01 1 1  ON 30
 eH1_1                -1.000924e-01 1 1  ON 31
 eH1_2                -4.901557e-02 1 1  ON 32
 eH1_3                -1.779997e-02 1 1  ON 33
 eH1_4                 1.688350e-02 1 1  ON 34
 eH1_5                 2.434600e-02 1 1  ON 35
 eH1_6                 7.866466e-02 1 1  ON 36
 eH1_7                 1.067649e-01 1 1  ON 37
 eH1_8                 1.033140e-01 1 1  ON 38
 eH1_9                 2.603226e-02 1 1  ON 39
 eH2_0                -2.020656e-01 1 1  ON 40
 eH2_1                -9.700288e-02 1 1  ON 41
 eH2_2                -4.658075e-02 1 1  ON 42
 eH2_3                -1.598414e-02 1 1  ON 43
 eH2_4                 1.716232e-02 1 1  ON 44
 eH2_5                 2.134783e-02 1 1  ON 45
 eH2_6                 7.074910e-02 1 1  ON 46
 eH2_7                 1.057133e-01 1 1  ON 47
 eH2_8                 1.051949e-01 1 1  ON 48
 eH2_9                 2.839878e-02 1 1  ON 49
ci_001                -4.215646e-02 3 1  ON 50
ci_002                -3.108488e-02 3 1  ON 51
ci_003                -2.581547e-02 3 1  ON 52
ci_004                 2.456300e-02 3 1  ON 53
ci_005                 2.465314e-02 3 1  ON 54
ci_006                -2.043870e-02 3 1  ON 55
ci_007                -2.044541e-02 3 1  ON 56
ci_008                -8.844468e-03 3 1  ON 57
ci_009                -1.497560e-02 3 1  ON 58
ci_010                -9.389555e-03 3 1  ON 59
ci_011                -1.017936e-02 3 1  ON 60
ci_012                -1.018825e-02 3 1  ON 61
ci_013                -1.947360e-02 3 1  ON 62
ci_014                 1.332313e-02 3 1  ON 63
ci_015                 1.320261e-02 3 1  ON 64
ci_016                 1.641272e-02 3 1  ON 65
ci_017                 1.622317e-02 3 1  ON 66
ci_018                 1.018206e-02 3 1  ON 67
ci_019                 1.025362e-02 3 1  ON 68
ci_020                 1.659819e-02 3 1  ON 69
ci_021                 1.652953e-02 3 1  ON 70
ci_022                 1.052935e-02 3 1  ON 71
ci_023                 9.587850e-03 3 1  ON 72
ci_024                 7.570296e-03 3 1  ON 73
ci_025                 6.354256e-03 3 1  ON 74
ci_026                 1.164879e-02 3 1  ON 75
ci_027                 1.174707e-02 3 1  ON 76
ci_028                -1.524329e-02 3 1  ON 77
ci_029                -1.528159e-02 3 1  ON 78
ci_030                -4.404881e-03 3 1  ON 79
ci_031                -4.811118e-03 3 1  ON 80
ci_032                -1.530686e-02 3 1  ON 81
ci_033                 6.849666e-03 3 1  ON 82
ci_034                 7.289267e-03 3 1  ON 83
ci_035                -4.588960e-03 3 1  ON 84
ci_036                -1.279412e-02 3 1  ON 85
ci_037                -1.272623e-02 3 1  ON 86
ci_038                 1.225555e-03 3 1  ON 87
ci_039                 1.411958e-03 3 1  ON 88
ci_040                -2.663136e-03 3 1  ON 89
ci_041                 8.438122e-03 3 1  ON 90
ci_042                 8.437959e-03 3 1  ON 91
ci_043                -3.614909e-03 3 1  ON 92
ci_044                -4.083020e-03 3 1  ON 93
ci_045                -2.807497e-03 3 1  ON 94
ci_046                 5.789964e-03 3 1  ON 95
ci_047                 5.643578e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2116
    reference variance = 0.247005
====================================================
  Execution time = 2.7552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9180e-01
  Total weights = 1.9665e+06
  Execution time = 2.3303e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279052429929
                                         uncertainty =       0.002450567123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279052429929
                                         uncertainty =       0.002450567123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514388
  error estimate for blocks of size 2^( 2) =       0.000387486714
  error estimate for blocks of size 2^( 3) =       0.000400821308
  error estimate for blocks of size 2^( 4) =       0.000409740471
  error estimate for blocks of size 2^( 5) =       0.000415281749
  error estimate for blocks of size 2^( 6) =       0.000418563668
  error estimate for blocks of size 2^( 7) =       0.000420991662

      target function =      -0.925407375499
              le_mean =     -17.209473567356
             les_mean =     296.457728547226
             stat err =       0.000416144387
             autocorr =       1.241290439809
   target nu stat err =       0.000416144387
   target dn stat err =       0.003189330178
      target stat err =       0.005228123802
              std dev =       0.528237565512
             le_variance =       0.279034925618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058456031
                                         uncertainty =       0.002452130909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058456031
                                         uncertainty =       0.002452130909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373518418
  error estimate for blocks of size 2^( 2) =       0.000387489472
  error estimate for blocks of size 2^( 3) =       0.000400824523
  error estimate for blocks of size 2^( 4) =       0.000409743927
  error estimate for blocks of size 2^( 5) =       0.000415288410
  error estimate for blocks of size 2^( 6) =       0.000418569218
  error estimate for blocks of size 2^( 7) =       0.000420994953

      target function =      -0.924475859492
              le_mean =     -17.209474451375
             les_mean =     296.458332618462
             stat err =       0.000416149127
             autocorr =       1.241291929178
   target nu stat err =       0.000416149127
   target dn stat err =       0.003261993959
      target stat err =       0.005334304406
              std dev =       0.528243264651
             le_variance =       0.279040946649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279054840597
                                         uncertainty =       0.002451294644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279054840597
                                         uncertainty =       0.002451294644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373516000
  error estimate for blocks of size 2^( 2) =       0.000387487678
  error estimate for blocks of size 2^( 3) =       0.000400822510
  error estimate for blocks of size 2^( 4) =       0.000409741776
  error estimate for blocks of size 2^( 5) =       0.000415284696
  error estimate for blocks of size 2^( 6) =       0.000418566136
  error estimate for blocks of size 2^( 7) =       0.000420992948

      target function =      -0.925200151962
              le_mean =     -17.209473937706
             les_mean =     296.457868699409
             stat err =       0.000416146389
             autocorr =       1.241291666649
   target nu stat err =       0.000416146389
   target dn stat err =       0.003214697772
      target stat err =       0.005266570247
              std dev =       0.528239845186
             le_variance =       0.279037334042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279052651763
                                         uncertainty =       0.002450649797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279052651763
                                         uncertainty =       0.002450649797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514537
  error estimate for blocks of size 2^( 2) =       0.000387486783
  error estimate for blocks of size 2^( 3) =       0.000400821408
  error estimate for blocks of size 2^( 4) =       0.000409740582
  error estimate for blocks of size 2^( 5) =       0.000415282067
  error estimate for blocks of size 2^( 6) =       0.000418563928
  error estimate for blocks of size 2^( 7) =       0.000420991772

      target function =      -0.925392180127
              le_mean =     -17.209473603749
             les_mean =     296.457739132038
             stat err =       0.000416144587
             autocorr =       1.241290646998
   target nu stat err =       0.000416144587
   target dn stat err =       0.003191910903
      target stat err =       0.005232102349
              std dev =       0.528237775272
             le_variance =       0.279035147224


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925407375499        initial  <--
     1.0000e+00     1.0000e+01             4.1342e-04        -0.924475859492
     4.0000e+00     4.0000e+01             1.0381e-04        -0.925200151962
     1.6000e+01     1.6000e+02             2.5998e-05        -0.925392180127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3501
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.086458e-01 1 1  ON 0
  uu_1                 5.287218e-02 1 1  ON 1
  uu_2                -3.637658e-02 1 1  ON 2
  uu_3                -8.945832e-02 1 1  ON 3
  uu_4                -1.214426e-01 1 1  ON 4
  uu_5                -1.310861e-01 1 1  ON 5
  uu_6                -1.141418e-01 1 1  ON 6
  uu_7                -5.689803e-02 1 1  ON 7
  uu_8                 5.800270e-02 1 1  ON 8
  uu_9                 1.222534e-01 1 1  ON 9
  ud_0                 2.998802e-01 1 1  ON 10
  ud_1                 7.275444e-02 1 1  ON 11
  ud_2                -2.634121e-02 1 1  ON 12
  ud_3                -7.732250e-02 1 1  ON 13
  ud_4                -1.123519e-01 1 1  ON 14
  ud_5                -1.314894e-01 1 1  ON 15
  ud_6                -1.262694e-01 1 1  ON 16
  ud_7                -8.674417e-02 1 1  ON 17
  ud_8                -4.314796e-03 1 1  ON 18
  ud_9                 8.463732e-02 1 1  ON 19
  eO_0                -6.927029e-01 1 1  ON 20
  eO_1                -4.130643e-01 1 1  ON 21
  eO_2                -4.192827e-02 1 1  ON 22
  eO_3                 1.780444e-01 1 1  ON 23
  eO_4                 2.494806e-01 1 1  ON 24
  eO_5                 2.740721e-01 1 1  ON 25
  eO_6                 2.477303e-01 1 1  ON 26
  eO_7                 1.383001e-01 1 1  ON 27
  eO_8                 2.919724e-02 1 1  ON 28
  eO_9                 1.941585e-02 1 1  ON 29
 eH1_0                -2.052603e-01 1 1  ON 30
 eH1_1                -1.001328e-01 1 1  ON 31
 eH1_2                -4.902949e-02 1 1  ON 32
 eH1_3                -1.779340e-02 1 1  ON 33
 eH1_4                 1.687567e-02 1 1  ON 34
 eH1_5                 2.439241e-02 1 1  ON 35
 eH1_6                 7.872661e-02 1 1  ON 36
 eH1_7                 1.067662e-01 1 1  ON 37
 eH1_8                 1.032750e-01 1 1  ON 38
 eH1_9                 2.602737e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698484e-02 1 1  ON 41
 eH2_2                -4.656691e-02 1 1  ON 42
 eH2_3                -1.596048e-02 1 1  ON 43
 eH2_4                 1.719973e-02 1 1  ON 44
 eH2_5                 2.130853e-02 1 1  ON 45
 eH2_6                 7.068926e-02 1 1  ON 46
 eH2_7                 1.057187e-01 1 1  ON 47
 eH2_8                 1.051706e-01 1 1  ON 48
 eH2_9                 2.839046e-02 1 1  ON 49
ci_001                -4.215072e-02 3 1  ON 50
ci_002                -3.109062e-02 3 1  ON 51
ci_003                -2.582547e-02 3 1  ON 52
ci_004                 2.456269e-02 3 1  ON 53
ci_005                 2.465425e-02 3 1  ON 54
ci_006                -2.043634e-02 3 1  ON 55
ci_007                -2.042680e-02 3 1  ON 56
ci_008                -8.845582e-03 3 1  ON 57
ci_009                -1.497498e-02 3 1  ON 58
ci_010                -9.392560e-03 3 1  ON 59
ci_011                -1.018218e-02 3 1  ON 60
ci_012                -1.016569e-02 3 1  ON 61
ci_013                -1.946915e-02 3 1  ON 62
ci_014                 1.330893e-02 3 1  ON 63
ci_015                 1.319939e-02 3 1  ON 64
ci_016                 1.639935e-02 3 1  ON 65
ci_017                 1.622930e-02 3 1  ON 66
ci_018                 1.018218e-02 3 1  ON 67
ci_019                 1.025334e-02 3 1  ON 68
ci_020                 1.661052e-02 3 1  ON 69
ci_021                 1.650633e-02 3 1  ON 70
ci_022                 1.055191e-02 3 1  ON 71
ci_023                 9.565100e-03 3 1  ON 72
ci_024                 7.556063e-03 3 1  ON 73
ci_025                 6.348928e-03 3 1  ON 74
ci_026                 1.163671e-02 3 1  ON 75
ci_027                 1.175420e-02 3 1  ON 76
ci_028                -1.524522e-02 3 1  ON 77
ci_029                -1.528635e-02 3 1  ON 78
ci_030                -4.397187e-03 3 1  ON 79
ci_031                -4.793215e-03 3 1  ON 80
ci_032                -1.530613e-02 3 1  ON 81
ci_033                 6.829707e-03 3 1  ON 82
ci_034                 7.268332e-03 3 1  ON 83
ci_035                -4.582358e-03 3 1  ON 84
ci_036                -1.277732e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224464e-03 3 1  ON 87
ci_039                 1.418030e-03 3 1  ON 88
ci_040                -2.650783e-03 3 1  ON 89
ci_041                 8.415908e-03 3 1  ON 90
ci_042                 8.444554e-03 3 1  ON 91
ci_043                -3.611419e-03 3 1  ON 92
ci_044                -4.081109e-03 3 1  ON 93
ci_045                -2.796121e-03 3 1  ON 94
ci_046                 5.777324e-03 3 1  ON 95
ci_047                 5.634866e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.199186
====================================================
  Execution time = 2.7857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8807e-01
  Total weights = 1.966426391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3476e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277725482992
                                         uncertainty =       0.001759609694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277725482992
                                         uncertainty =       0.001759609694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372685212
  error estimate for blocks of size 2^( 2) =       0.000386760266
  error estimate for blocks of size 2^( 3) =       0.000399297668
  error estimate for blocks of size 2^( 4) =       0.000408467578
  error estimate for blocks of size 2^( 5) =       0.000413205060
  error estimate for blocks of size 2^( 6) =       0.000416499571
  error estimate for blocks of size 2^( 7) =       0.000420112842

      target function =      -0.931407556571
              le_mean =     -17.209911186538
             les_mean =     296.469115287404
             stat err =       0.000414571263
             autocorr =       1.237411269707
   target nu stat err =       0.000414571263
   target dn stat err =       0.002674530069
      target stat err =       0.004461919720
              std dev =       0.527064914663
             le_variance =       0.277797424269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720991118654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931427776561       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931431795984       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931432265658       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931432480530       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931432485942       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931432522355       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931432522441       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931432515767       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931432534154       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931432539189       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931432550911       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931432529766       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931432554282       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931432569675       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931432597258       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931432611606       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931432610399       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931432623491       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931432617526       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931432619898       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931432628378       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931432622890       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931432627527       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931432639311       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931432639719       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931432637630       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931432638290       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931432632133       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931432632937       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931432634747       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931432639976       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931432640804       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931432640203       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931432639325       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931432639199       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931432640002       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931432640826       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931432640841       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931432641398       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931432641686       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931432642558       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931432642330       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931432642629       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931432642395       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 4.510043e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931427776561       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931428787237       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931428905156       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931428959158       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931428960506       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931428969664       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931428969670       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931428968004       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931428972623       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931428973884       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931428976846       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931428971544       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931428977695       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931428981553       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931428988461       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931428992039       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931428991734       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931428995010       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931428993507       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931428994110       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931428996217       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931428994841       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931428996008       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931428998949       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931428999049       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931428998522       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931428998679       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931428997142       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931428997354       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931428997808       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931428999107       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931428999308       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931428999159       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931428998942       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931428998915       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931428999111       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931428999316       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931428999318       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931428999460       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931428999534       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931428999745       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931428999685       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931428999760       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931428999704       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+01 is 1.130655e-05

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931427776561       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931428029596       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931428059108       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931428072626       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931428072963       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931428075256       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931428075256       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931428074840       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931428075996       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931428076312       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931428077054       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931428075727       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931428077267       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931428078232       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931428079959       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931428080853       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931428080777       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931428081596       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931428081220       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931428081371       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931428081897       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931428081553       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931428081845       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931428082580       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931428082605       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931428082472       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931428082511       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931428082127       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931428082181       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931428082294       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931428082618       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931428082669       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931428082631       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931428082577       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931428082571       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931428082620       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931428082668       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931428082671       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931428082707       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931428082725       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931428082778       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931428082763       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931428082781       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931428082768       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+02 is 2.828611e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.961497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6305e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.086512e-01 1 1  ON 0
  uu_1                 5.287412e-02 1 1  ON 1
  uu_2                -3.637449e-02 1 1  ON 2
  uu_3                -8.945650e-02 1 1  ON 3
  uu_4                -1.214413e-01 1 1  ON 4
  uu_5                -1.310862e-01 1 1  ON 5
  uu_6                -1.141455e-01 1 1  ON 6
  uu_7                -5.690084e-02 1 1  ON 7
  uu_8                 5.799435e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998753e-01 1 1  ON 10
  ud_1                 7.275133e-02 1 1  ON 11
  ud_2                -2.634364e-02 1 1  ON 12
  ud_3                -7.732392e-02 1 1  ON 13
  ud_4                -1.123526e-01 1 1  ON 14
  ud_5                -1.314888e-01 1 1  ON 15
  ud_6                -1.262676e-01 1 1  ON 16
  ud_7                -8.673286e-02 1 1  ON 17
  ud_8                -4.317107e-03 1 1  ON 18
  ud_9                 8.463647e-02 1 1  ON 19
  eO_0                -6.927021e-01 1 1  ON 20
  eO_1                -4.130627e-01 1 1  ON 21
  eO_2                -4.192960e-02 1 1  ON 22
  eO_3                 1.780426e-01 1 1  ON 23
  eO_4                 2.494764e-01 1 1  ON 24
  eO_5                 2.740697e-01 1 1  ON 25
  eO_6                 2.477304e-01 1 1  ON 26
  eO_7                 1.383070e-01 1 1  ON 27
  eO_8                 2.919756e-02 1 1  ON 28
  eO_9                 1.941613e-02 1 1  ON 29
 eH1_0                -2.052593e-01 1 1  ON 30
 eH1_1                -1.001324e-01 1 1  ON 31
 eH1_2                -4.902939e-02 1 1  ON 32
 eH1_3                -1.779455e-02 1 1  ON 33
 eH1_4                 1.687400e-02 1 1  ON 34
 eH1_5                 2.439578e-02 1 1  ON 35
 eH1_6                 7.872450e-02 1 1  ON 36
 eH1_7                 1.067634e-01 1 1  ON 37
 eH1_8                 1.032760e-01 1 1  ON 38
 eH1_9                 2.602897e-02 1 1  ON 39
 eH2_0                -2.020319e-01 1 1  ON 40
 eH2_1                -9.698300e-02 1 1  ON 41
 eH2_2                -4.656511e-02 1 1  ON 42
 eH2_3                -1.596002e-02 1 1  ON 43
 eH2_4                 1.719781e-02 1 1  ON 44
 eH2_5                 2.130947e-02 1 1  ON 45
 eH2_6                 7.068613e-02 1 1  ON 46
 eH2_7                 1.057172e-01 1 1  ON 47
 eH2_8                 1.051730e-01 1 1  ON 48
 eH2_9                 2.839065e-02 1 1  ON 49
ci_001                -4.215038e-02 3 1  ON 50
ci_002                -3.108985e-02 3 1  ON 51
ci_003                -2.582333e-02 3 1  ON 52
ci_004                 2.456255e-02 3 1  ON 53
ci_005                 2.465586e-02 3 1  ON 54
ci_006                -2.043684e-02 3 1  ON 55
ci_007                -2.042643e-02 3 1  ON 56
ci_008                -8.846068e-03 3 1  ON 57
ci_009                -1.497017e-02 3 1  ON 58
ci_010                -9.391374e-03 3 1  ON 59
ci_011                -1.018037e-02 3 1  ON 60
ci_012                -1.016622e-02 3 1  ON 61
ci_013                -1.946935e-02 3 1  ON 62
ci_014                 1.330860e-02 3 1  ON 63
ci_015                 1.320275e-02 3 1  ON 64
ci_016                 1.639820e-02 3 1  ON 65
ci_017                 1.622858e-02 3 1  ON 66
ci_018                 1.018258e-02 3 1  ON 67
ci_019                 1.025276e-02 3 1  ON 68
ci_020                 1.660952e-02 3 1  ON 69
ci_021                 1.650547e-02 3 1  ON 70
ci_022                 1.055259e-02 3 1  ON 71
ci_023                 9.566166e-03 3 1  ON 72
ci_024                 7.556364e-03 3 1  ON 73
ci_025                 6.353642e-03 3 1  ON 74
ci_026                 1.163927e-02 3 1  ON 75
ci_027                 1.175327e-02 3 1  ON 76
ci_028                -1.524635e-02 3 1  ON 77
ci_029                -1.528602e-02 3 1  ON 78
ci_030                -4.397495e-03 3 1  ON 79
ci_031                -4.792189e-03 3 1  ON 80
ci_032                -1.530566e-02 3 1  ON 81
ci_033                 6.828024e-03 3 1  ON 82
ci_034                 7.268259e-03 3 1  ON 83
ci_035                -4.582155e-03 3 1  ON 84
ci_036                -1.277626e-02 3 1  ON 85
ci_037                -1.273804e-02 3 1  ON 86
ci_038                 1.224422e-03 3 1  ON 87
ci_039                 1.416836e-03 3 1  ON 88
ci_040                -2.650916e-03 3 1  ON 89
ci_041                 8.415782e-03 3 1  ON 90
ci_042                 8.443727e-03 3 1  ON 91
ci_043                -3.612107e-03 3 1  ON 92
ci_044                -4.082136e-03 3 1  ON 93
ci_045                -2.795936e-03 3 1  ON 94
ci_046                 5.777585e-03 3 1  ON 95
ci_047                 5.635438e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2766
    reference variance = 0.220142
====================================================
  Execution time = 2.7608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8416e-01
  Total weights = 1.9665e+06
  Execution time = 2.3227e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274164544739
                                         uncertainty =       0.001590953690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274164544739
                                         uncertainty =       0.001590953690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370281760
  error estimate for blocks of size 2^( 2) =       0.000384616794
  error estimate for blocks of size 2^( 3) =       0.000397438674
  error estimate for blocks of size 2^( 4) =       0.000407730087
  error estimate for blocks of size 2^( 5) =       0.000413037679
  error estimate for blocks of size 2^( 6) =       0.000414683927
  error estimate for blocks of size 2^( 7) =       0.000418730401

      target function =      -0.937906692956
              le_mean =     -17.209030342871
             les_mean =     296.434888515483
             stat err =       0.000413545524
             autocorr =       1.247331841096
   target nu stat err =       0.000413545524
   target dn stat err =       0.002291254317
      target stat err =       0.003887080675
              std dev =       0.523665866002
             le_variance =       0.274225939216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274166666141
                                         uncertainty =       0.001591029180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274166666141
                                         uncertainty =       0.001591029180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370283187
  error estimate for blocks of size 2^( 2) =       0.000384619316
  error estimate for blocks of size 2^( 3) =       0.000397442239
  error estimate for blocks of size 2^( 4) =       0.000407734217
  error estimate for blocks of size 2^( 5) =       0.000413042125
  error estimate for blocks of size 2^( 6) =       0.000414688679
  error estimate for blocks of size 2^( 7) =       0.000418734340

      target function =      -0.937897699888
              le_mean =     -17.209030344198
             les_mean =     296.434893958110
             stat err =       0.000413549840
             autocorr =       1.247348268716
   target nu stat err =       0.000413549840
   target dn stat err =       0.002291426383
      target stat err =       0.003887290410
              std dev =       0.523667883395
             le_variance =       0.274228052099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274165603487
                                         uncertainty =       0.001590991417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274165603487
                                         uncertainty =       0.001590991417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370282472
  error estimate for blocks of size 2^( 2) =       0.000384618057
  error estimate for blocks of size 2^( 3) =       0.000397440460
  error estimate for blocks of size 2^( 4) =       0.000407732157
  error estimate for blocks of size 2^( 5) =       0.000413039908
  error estimate for blocks of size 2^( 6) =       0.000414686310
  error estimate for blocks of size 2^( 7) =       0.000418732376

      target function =      -0.937902332340
              le_mean =     -17.209030342550
             les_mean =     296.434891121374
             stat err =       0.000413547688
             autocorr =       1.247340100554
   target nu stat err =       0.000413547688
   target dn stat err =       0.002291337014
      target stat err =       0.003887181188
              std dev =       0.523666872820
             le_variance =       0.274226993689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274164676395
                                         uncertainty =       0.001590958392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274164676395
                                         uncertainty =       0.001590958392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370281849
  error estimate for blocks of size 2^( 2) =       0.000384616952
  error estimate for blocks of size 2^( 3) =       0.000397438897
  error estimate for blocks of size 2^( 4) =       0.000407730346
  error estimate for blocks of size 2^( 5) =       0.000413037958
  error estimate for blocks of size 2^( 6) =       0.000414684225
  error estimate for blocks of size 2^( 7) =       0.000418730648

      target function =      -0.937906164898
              le_mean =     -17.209030342724
             les_mean =     296.434888827319
             stat err =       0.000413545794
             autocorr =       1.247332875580
   target nu stat err =       0.000413545794
   target dn stat err =       0.002291264257
      target stat err =       0.003887092727
              std dev =       0.523665991199
             le_variance =       0.274226070338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937906692956        initial  <--
     1.0000e+01     1.0000e+02             4.5100e-05        -0.937897699888
     4.0000e+01     4.0000e+02             1.1307e-05        -0.937902332340
     1.6000e+02     1.6000e+03             2.8286e-06        -0.937906164898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3757
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.086458e-01 1 1  ON 0
  uu_1                 5.287218e-02 1 1  ON 1
  uu_2                -3.637658e-02 1 1  ON 2
  uu_3                -8.945832e-02 1 1  ON 3
  uu_4                -1.214426e-01 1 1  ON 4
  uu_5                -1.310861e-01 1 1  ON 5
  uu_6                -1.141418e-01 1 1  ON 6
  uu_7                -5.689803e-02 1 1  ON 7
  uu_8                 5.800270e-02 1 1  ON 8
  uu_9                 1.222534e-01 1 1  ON 9
  ud_0                 2.998802e-01 1 1  ON 10
  ud_1                 7.275444e-02 1 1  ON 11
  ud_2                -2.634121e-02 1 1  ON 12
  ud_3                -7.732250e-02 1 1  ON 13
  ud_4                -1.123519e-01 1 1  ON 14
  ud_5                -1.314894e-01 1 1  ON 15
  ud_6                -1.262694e-01 1 1  ON 16
  ud_7                -8.674417e-02 1 1  ON 17
  ud_8                -4.314796e-03 1 1  ON 18
  ud_9                 8.463732e-02 1 1  ON 19
  eO_0                -6.927029e-01 1 1  ON 20
  eO_1                -4.130643e-01 1 1  ON 21
  eO_2                -4.192827e-02 1 1  ON 22
  eO_3                 1.780444e-01 1 1  ON 23
  eO_4                 2.494806e-01 1 1  ON 24
  eO_5                 2.740721e-01 1 1  ON 25
  eO_6                 2.477303e-01 1 1  ON 26
  eO_7                 1.383001e-01 1 1  ON 27
  eO_8                 2.919724e-02 1 1  ON 28
  eO_9                 1.941585e-02 1 1  ON 29
 eH1_0                -2.052603e-01 1 1  ON 30
 eH1_1                -1.001328e-01 1 1  ON 31
 eH1_2                -4.902949e-02 1 1  ON 32
 eH1_3                -1.779340e-02 1 1  ON 33
 eH1_4                 1.687567e-02 1 1  ON 34
 eH1_5                 2.439241e-02 1 1  ON 35
 eH1_6                 7.872661e-02 1 1  ON 36
 eH1_7                 1.067662e-01 1 1  ON 37
 eH1_8                 1.032750e-01 1 1  ON 38
 eH1_9                 2.602737e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698484e-02 1 1  ON 41
 eH2_2                -4.656691e-02 1 1  ON 42
 eH2_3                -1.596048e-02 1 1  ON 43
 eH2_4                 1.719973e-02 1 1  ON 44
 eH2_5                 2.130853e-02 1 1  ON 45
 eH2_6                 7.068926e-02 1 1  ON 46
 eH2_7                 1.057187e-01 1 1  ON 47
 eH2_8                 1.051706e-01 1 1  ON 48
 eH2_9                 2.839046e-02 1 1  ON 49
ci_001                -4.215072e-02 3 1  ON 50
ci_002                -3.109062e-02 3 1  ON 51
ci_003                -2.582547e-02 3 1  ON 52
ci_004                 2.456269e-02 3 1  ON 53
ci_005                 2.465425e-02 3 1  ON 54
ci_006                -2.043634e-02 3 1  ON 55
ci_007                -2.042680e-02 3 1  ON 56
ci_008                -8.845582e-03 3 1  ON 57
ci_009                -1.497498e-02 3 1  ON 58
ci_010                -9.392560e-03 3 1  ON 59
ci_011                -1.018218e-02 3 1  ON 60
ci_012                -1.016569e-02 3 1  ON 61
ci_013                -1.946915e-02 3 1  ON 62
ci_014                 1.330893e-02 3 1  ON 63
ci_015                 1.319939e-02 3 1  ON 64
ci_016                 1.639935e-02 3 1  ON 65
ci_017                 1.622930e-02 3 1  ON 66
ci_018                 1.018218e-02 3 1  ON 67
ci_019                 1.025334e-02 3 1  ON 68
ci_020                 1.661052e-02 3 1  ON 69
ci_021                 1.650633e-02 3 1  ON 70
ci_022                 1.055191e-02 3 1  ON 71
ci_023                 9.565100e-03 3 1  ON 72
ci_024                 7.556063e-03 3 1  ON 73
ci_025                 6.348928e-03 3 1  ON 74
ci_026                 1.163671e-02 3 1  ON 75
ci_027                 1.175420e-02 3 1  ON 76
ci_028                -1.524522e-02 3 1  ON 77
ci_029                -1.528635e-02 3 1  ON 78
ci_030                -4.397187e-03 3 1  ON 79
ci_031                -4.793215e-03 3 1  ON 80
ci_032                -1.530613e-02 3 1  ON 81
ci_033                 6.829707e-03 3 1  ON 82
ci_034                 7.268332e-03 3 1  ON 83
ci_035                -4.582358e-03 3 1  ON 84
ci_036                -1.277732e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224464e-03 3 1  ON 87
ci_039                 1.418030e-03 3 1  ON 88
ci_040                -2.650783e-03 3 1  ON 89
ci_041                 8.415908e-03 3 1  ON 90
ci_042                 8.444554e-03 3 1  ON 91
ci_043                -3.611419e-03 3 1  ON 92
ci_044                -4.081109e-03 3 1  ON 93
ci_045                -2.796121e-03 3 1  ON 94
ci_046                 5.777324e-03 3 1  ON 95
ci_047                 5.634866e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2199
    reference variance = 0.120425
====================================================
  Execution time = 2.7836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0476e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8784e-01
  Total weights = 1.966496898e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6947e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278226507462
                                         uncertainty =       0.001823624121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278226507462
                                         uncertainty =       0.001823624121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372958132
  error estimate for blocks of size 2^( 2) =       0.000386975837
  error estimate for blocks of size 2^( 3) =       0.000399674626
  error estimate for blocks of size 2^( 4) =       0.000408519446
  error estimate for blocks of size 2^( 5) =       0.000413975521
  error estimate for blocks of size 2^( 6) =       0.000416925618
  error estimate for blocks of size 2^( 7) =       0.000420427665

      target function =      -0.931783088702
              le_mean =     -17.210166939876
             les_mean =     296.477686030048
             stat err =       0.000414962063
             autocorr =       1.237931530681
   target nu stat err =       0.000414962063
   target dn stat err =       0.002579677812
      target stat err =       0.004313647823
              std dev =       0.527450887944
             le_variance =       0.278204439193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721016693988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931802191214       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931802681443       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931802725688       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931802746092       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931802754723       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931802761758       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931802762137       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931802768762       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931802775065       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931802777627       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931802782570       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931802783220       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931802786350       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931802788622       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931802792377       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931802791855       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931802793312       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931802794551       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931802794554       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931802794039       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931802794550       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931802796790       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931802797155       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931802798456       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931802799120       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931802798098       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931802799317       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931802799516       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931802799469       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931802799290       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931802799795       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931802799832       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931802799934       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931802799794       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931802800134       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931802800301       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931802800303       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931802800209       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931802800096       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931802800070       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931802800037       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931802800002       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931802799984       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931802800020       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+02 is 5.512917e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931802191214       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931802313845       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931802324912       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931802330014       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931802332175       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931802333933       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931802334028       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931802335686       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931802337261       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931802337903       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931802339139       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931802339300       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931802340084       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931802340650       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931802341590       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931802341459       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931802341825       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931802342134       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931802342134       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931802342005       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931802342132       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931802342693       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931802342785       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931802343109       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931802343276       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931802343022       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931802343324       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931802343377       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931802343364       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931802343319       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931802343445       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931802343453       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931802343480       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931802343443       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931802343528       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931802343572       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931802343570       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931802343548       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931802343519       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931802343512       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931802343504       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931802343496       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931802343491       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931802343502       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+02 is 1.378592e-06

solving harmonic davidson linear method for identity shift 1.6000e+03, overlap shift 1.6000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931802191214       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931802221877       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931802224644       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931802225920       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931802226458       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931802226900       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931802226923       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931802227336       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931802227729       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931802227889       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931802228198       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931802228242       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931802228434       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931802228581       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931802228818       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931802228782       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931802228875       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931802228948       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931802228952       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931802228918       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931802228954       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931802229090       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931802229116       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931802229190       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931802229228       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931802229167       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931802229247       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931802229250       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931802229259       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931802229248       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931802229278       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931802229277       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931802229274       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931802229281       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931802229297       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931802229311       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931802229307       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931802229301       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931802229292       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931802229299       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931802229294       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931802229289       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931802229289       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931802229286       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.6000e+03 is 3.446706e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.054410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6631e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.086455e-01 1 1  ON 0
  uu_1                 5.287225e-02 1 1  ON 1
  uu_2                -3.637644e-02 1 1  ON 2
  uu_3                -8.945816e-02 1 1  ON 3
  uu_4                -1.214424e-01 1 1  ON 4
  uu_5                -1.310858e-01 1 1  ON 5
  uu_6                -1.141417e-01 1 1  ON 6
  uu_7                -5.689873e-02 1 1  ON 7
  uu_8                 5.800186e-02 1 1  ON 8
  uu_9                 1.222534e-01 1 1  ON 9
  ud_0                 2.998795e-01 1 1  ON 10
  ud_1                 7.275378e-02 1 1  ON 11
  ud_2                -2.634178e-02 1 1  ON 12
  ud_3                -7.732295e-02 1 1  ON 13
  ud_4                -1.123520e-01 1 1  ON 14
  ud_5                -1.314891e-01 1 1  ON 15
  ud_6                -1.262687e-01 1 1  ON 16
  ud_7                -8.674324e-02 1 1  ON 17
  ud_8                -4.314564e-03 1 1  ON 18
  ud_9                 8.463709e-02 1 1  ON 19
  eO_0                -6.927020e-01 1 1  ON 20
  eO_1                -4.130638e-01 1 1  ON 21
  eO_2                -4.192820e-02 1 1  ON 22
  eO_3                 1.780439e-01 1 1  ON 23
  eO_4                 2.494792e-01 1 1  ON 24
  eO_5                 2.740714e-01 1 1  ON 25
  eO_6                 2.477307e-01 1 1  ON 26
  eO_7                 1.383010e-01 1 1  ON 27
  eO_8                 2.919729e-02 1 1  ON 28
  eO_9                 1.941587e-02 1 1  ON 29
 eH1_0                -2.052602e-01 1 1  ON 30
 eH1_1                -1.001326e-01 1 1  ON 31
 eH1_2                -4.902926e-02 1 1  ON 32
 eH1_3                -1.779338e-02 1 1  ON 33
 eH1_4                 1.687530e-02 1 1  ON 34
 eH1_5                 2.439206e-02 1 1  ON 35
 eH1_6                 7.872615e-02 1 1  ON 36
 eH1_7                 1.067663e-01 1 1  ON 37
 eH1_8                 1.032754e-01 1 1  ON 38
 eH1_9                 2.602748e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698463e-02 1 1  ON 41
 eH2_2                -4.656660e-02 1 1  ON 42
 eH2_3                -1.596045e-02 1 1  ON 43
 eH2_4                 1.719925e-02 1 1  ON 44
 eH2_5                 2.130772e-02 1 1  ON 45
 eH2_6                 7.068908e-02 1 1  ON 46
 eH2_7                 1.057189e-01 1 1  ON 47
 eH2_8                 1.051712e-01 1 1  ON 48
 eH2_9                 2.839054e-02 1 1  ON 49
ci_001                -4.215084e-02 3 1  ON 50
ci_002                -3.109060e-02 3 1  ON 51
ci_003                -2.582564e-02 3 1  ON 52
ci_004                 2.456271e-02 3 1  ON 53
ci_005                 2.465429e-02 3 1  ON 54
ci_006                -2.043635e-02 3 1  ON 55
ci_007                -2.042681e-02 3 1  ON 56
ci_008                -8.845549e-03 3 1  ON 57
ci_009                -1.497501e-02 3 1  ON 58
ci_010                -9.392329e-03 3 1  ON 59
ci_011                -1.018212e-02 3 1  ON 60
ci_012                -1.016575e-02 3 1  ON 61
ci_013                -1.946919e-02 3 1  ON 62
ci_014                 1.330912e-02 3 1  ON 63
ci_015                 1.319913e-02 3 1  ON 64
ci_016                 1.639947e-02 3 1  ON 65
ci_017                 1.622925e-02 3 1  ON 66
ci_018                 1.018194e-02 3 1  ON 67
ci_019                 1.025329e-02 3 1  ON 68
ci_020                 1.661037e-02 3 1  ON 69
ci_021                 1.650650e-02 3 1  ON 70
ci_022                 1.055210e-02 3 1  ON 71
ci_023                 9.564876e-03 3 1  ON 72
ci_024                 7.556279e-03 3 1  ON 73
ci_025                 6.349098e-03 3 1  ON 74
ci_026                 1.163670e-02 3 1  ON 75
ci_027                 1.175395e-02 3 1  ON 76
ci_028                -1.524530e-02 3 1  ON 77
ci_029                -1.528641e-02 3 1  ON 78
ci_030                -4.397457e-03 3 1  ON 79
ci_031                -4.793222e-03 3 1  ON 80
ci_032                -1.530624e-02 3 1  ON 81
ci_033                 6.829714e-03 3 1  ON 82
ci_034                 7.268407e-03 3 1  ON 83
ci_035                -4.582373e-03 3 1  ON 84
ci_036                -1.277682e-02 3 1  ON 85
ci_037                -1.273770e-02 3 1  ON 86
ci_038                 1.224479e-03 3 1  ON 87
ci_039                 1.418061e-03 3 1  ON 88
ci_040                -2.650848e-03 3 1  ON 89
ci_041                 8.415955e-03 3 1  ON 90
ci_042                 8.444670e-03 3 1  ON 91
ci_043                -3.611301e-03 3 1  ON 92
ci_044                -4.081119e-03 3 1  ON 93
ci_045                -2.796132e-03 3 1  ON 94
ci_046                 5.777178e-03 3 1  ON 95
ci_047                 5.634901e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.201501
====================================================
  Execution time = 2.7512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8894e-01
  Total weights = 1.9661e+06
  Execution time = 2.3198e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303628255
                                         uncertainty =       0.002559438020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303628255
                                         uncertainty =       0.002559438020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373671950
  error estimate for blocks of size 2^( 2) =       0.000388074742
  error estimate for blocks of size 2^( 3) =       0.000401740582
  error estimate for blocks of size 2^( 4) =       0.000410815126
  error estimate for blocks of size 2^( 5) =       0.000416287486
  error estimate for blocks of size 2^( 6) =       0.000418755029
  error estimate for blocks of size 2^( 7) =       0.000421889724

      target function =      -0.930005162727
              le_mean =     -17.209166981238
             les_mean =     296.444364017438
             stat err =       0.000416936841
             autocorr =       1.244971892738
   target nu stat err =       0.000416936841
   target dn stat err =       0.003153440287
      target stat err =       0.005218597991
              std dev =       0.528460394799
             le_variance =       0.279270388872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303195515
                                         uncertainty =       0.002559364117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303195515
                                         uncertainty =       0.002559364117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373671662
  error estimate for blocks of size 2^( 2) =       0.000388074611
  error estimate for blocks of size 2^( 3) =       0.000401740636
  error estimate for blocks of size 2^( 4) =       0.000410815284
  error estimate for blocks of size 2^( 5) =       0.000416287738
  error estimate for blocks of size 2^( 6) =       0.000418755276
  error estimate for blocks of size 2^( 7) =       0.000421889989

      target function =      -0.930005474732
              le_mean =     -17.209166991977
             les_mean =     296.444364196695
             stat err =       0.000416937072
             autocorr =       1.244975188578
   target nu stat err =       0.000416937072
   target dn stat err =       0.003153414785
      target stat err =       0.005218560251
              std dev =       0.528459987645
             le_variance =       0.279269958542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303411680
                                         uncertainty =       0.002559401048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303411680
                                         uncertainty =       0.002559401048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373671806
  error estimate for blocks of size 2^( 2) =       0.000388074676
  error estimate for blocks of size 2^( 3) =       0.000401740609
  error estimate for blocks of size 2^( 4) =       0.000410815205
  error estimate for blocks of size 2^( 5) =       0.000416287612
  error estimate for blocks of size 2^( 6) =       0.000418755153
  error estimate for blocks of size 2^( 7) =       0.000421889856

      target function =      -0.930005323345
              le_mean =     -17.209166986601
             les_mean =     296.444364104001
             stat err =       0.000416936956
             autocorr =       1.244973541347
   target nu stat err =       0.000416936956
   target dn stat err =       0.003153427501
      target stat err =       0.005218579116
              std dev =       0.528460191029
             le_variance =       0.279270173502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303601169
                                         uncertainty =       0.002559433398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279303601169
                                         uncertainty =       0.002559433398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373671932
  error estimate for blocks of size 2^( 2) =       0.000388074734
  error estimate for blocks of size 2^( 3) =       0.000401740585
  error estimate for blocks of size 2^( 4) =       0.000410815136
  error estimate for blocks of size 2^( 5) =       0.000416287502
  error estimate for blocks of size 2^( 6) =       0.000418755045
  error estimate for blocks of size 2^( 7) =       0.000421889741

      target function =      -0.930005183302
              le_mean =     -17.209166981908
             les_mean =     296.444364027919
             stat err =       0.000416936856
             autocorr =       1.244972098841
   target nu stat err =       0.000416936856
   target dn stat err =       0.003153438685
      target stat err =       0.005218595631
              std dev =       0.528460369315
             le_variance =       0.279270361936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930005162727        initial
     1.0000e+02     1.0000e+03             5.5129e-06        -0.930005474732  <--
     4.0000e+02     4.0000e+03             1.3786e-06        -0.930005323345
     1.6000e+03     1.6000e+04             3.4467e-07        -0.930005183302

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 3.9264e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.086449e-01 1 1  ON 0
  uu_1                 5.287247e-02 1 1  ON 1
  uu_2                -3.637603e-02 1 1  ON 2
  uu_3                -8.945768e-02 1 1  ON 3
  uu_4                -1.214416e-01 1 1  ON 4
  uu_5                -1.310849e-01 1 1  ON 5
  uu_6                -1.141413e-01 1 1  ON 6
  uu_7                -5.690084e-02 1 1  ON 7
  uu_8                 5.799935e-02 1 1  ON 8
  uu_9                 1.222536e-01 1 1  ON 9
  ud_0                 2.998771e-01 1 1  ON 10
  ud_1                 7.275179e-02 1 1  ON 11
  ud_2                -2.634349e-02 1 1  ON 12
  ud_3                -7.732428e-02 1 1  ON 13
  ud_4                -1.123523e-01 1 1  ON 14
  ud_5                -1.314881e-01 1 1  ON 15
  ud_6                -1.262667e-01 1 1  ON 16
  ud_7                -8.674046e-02 1 1  ON 17
  ud_8                -4.313868e-03 1 1  ON 18
  ud_9                 8.463643e-02 1 1  ON 19
  eO_0                -6.926996e-01 1 1  ON 20
  eO_1                -4.130624e-01 1 1  ON 21
  eO_2                -4.192797e-02 1 1  ON 22
  eO_3                 1.780422e-01 1 1  ON 23
  eO_4                 2.494751e-01 1 1  ON 24
  eO_5                 2.740692e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383034e-01 1 1  ON 27
  eO_8                 2.919744e-02 1 1  ON 28
  eO_9                 1.941593e-02 1 1  ON 29
 eH1_0                -2.052598e-01 1 1  ON 30
 eH1_1                -1.001320e-01 1 1  ON 31
 eH1_2                -4.902857e-02 1 1  ON 32
 eH1_3                -1.779329e-02 1 1  ON 33
 eH1_4                 1.687418e-02 1 1  ON 34
 eH1_5                 2.439100e-02 1 1  ON 35
 eH1_6                 7.872476e-02 1 1  ON 36
 eH1_7                 1.067666e-01 1 1  ON 37
 eH1_8                 1.032764e-01 1 1  ON 38
 eH1_9                 2.602781e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698399e-02 1 1  ON 41
 eH2_2                -4.656568e-02 1 1  ON 42
 eH2_3                -1.596037e-02 1 1  ON 43
 eH2_4                 1.719781e-02 1 1  ON 44
 eH2_5                 2.130529e-02 1 1  ON 45
 eH2_6                 7.068856e-02 1 1  ON 46
 eH2_7                 1.057193e-01 1 1  ON 47
 eH2_8                 1.051732e-01 1 1  ON 48
 eH2_9                 2.839079e-02 1 1  ON 49
ci_001                -4.215118e-02 3 1  ON 50
ci_002                -3.109056e-02 3 1  ON 51
ci_003                -2.582615e-02 3 1  ON 52
ci_004                 2.456278e-02 3 1  ON 53
ci_005                 2.465442e-02 3 1  ON 54
ci_006                -2.043640e-02 3 1  ON 55
ci_007                -2.042683e-02 3 1  ON 56
ci_008                -8.845450e-03 3 1  ON 57
ci_009                -1.497508e-02 3 1  ON 58
ci_010                -9.391639e-03 3 1  ON 59
ci_011                -1.018196e-02 3 1  ON 60
ci_012                -1.016593e-02 3 1  ON 61
ci_013                -1.946930e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319837e-02 3 1  ON 64
ci_016                 1.639982e-02 3 1  ON 65
ci_017                 1.622909e-02 3 1  ON 66
ci_018                 1.018122e-02 3 1  ON 67
ci_019                 1.025317e-02 3 1  ON 68
ci_020                 1.660990e-02 3 1  ON 69
ci_021                 1.650699e-02 3 1  ON 70
ci_022                 1.055267e-02 3 1  ON 71
ci_023                 9.564203e-03 3 1  ON 72
ci_024                 7.556927e-03 3 1  ON 73
ci_025                 6.349605e-03 3 1  ON 74
ci_026                 1.163667e-02 3 1  ON 75
ci_027                 1.175321e-02 3 1  ON 76
ci_028                -1.524554e-02 3 1  ON 77
ci_029                -1.528659e-02 3 1  ON 78
ci_030                -4.398265e-03 3 1  ON 79
ci_031                -4.793242e-03 3 1  ON 80
ci_032                -1.530658e-02 3 1  ON 81
ci_033                 6.829732e-03 3 1  ON 82
ci_034                 7.268630e-03 3 1  ON 83
ci_035                -4.582419e-03 3 1  ON 84
ci_036                -1.277529e-02 3 1  ON 85
ci_037                -1.273785e-02 3 1  ON 86
ci_038                 1.224525e-03 3 1  ON 87
ci_039                 1.418154e-03 3 1  ON 88
ci_040                -2.651044e-03 3 1  ON 89
ci_041                 8.416098e-03 3 1  ON 90
ci_042                 8.445017e-03 3 1  ON 91
ci_043                -3.610947e-03 3 1  ON 92
ci_044                -4.081147e-03 3 1  ON 93
ci_045                -2.796163e-03 3 1  ON 94
ci_046                 5.776740e-03 3 1  ON 95
ci_047                 5.635006e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.180609
====================================================
  Execution time = 2.7879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0513e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8834e-01
  Total weights = 1.966565103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4523e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278297569797
                                         uncertainty =       0.002520273924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278297569797
                                         uncertainty =       0.002520273924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373003819
  error estimate for blocks of size 2^( 2) =       0.000386966256
  error estimate for blocks of size 2^( 3) =       0.000400005369
  error estimate for blocks of size 2^( 4) =       0.000410293124
  error estimate for blocks of size 2^( 5) =       0.000415895276
  error estimate for blocks of size 2^( 6) =       0.000419060361
  error estimate for blocks of size 2^( 7) =       0.000422114087

      target function =      -0.930988279344
              le_mean =     -17.209549069814
             les_mean =     296.456914420186
             stat err =       0.000416840712
             autocorr =       1.248859841332
   target nu stat err =       0.000416840712
   target dn stat err =       0.002565815169
      target stat err =       0.004279477472
              std dev =       0.527515500191
             le_variance =       0.278272602942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720954906981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931006724546       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931008333460       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931008581025       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931008656663       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931008684806       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931008704703       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931008715356       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931008733575       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931008744063       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931008757291       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931008766279       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931008765765       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931008775805       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931008784784       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931008786874       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931008797508       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931008800930       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931008811968       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931008816153       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931008817709       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931008817925       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931008824164       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931008823756       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931008825493       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931008825561       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931008824312       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931008824182       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931008823015       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931008823920       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931008824415       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931008825124       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931008825348       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931008825265       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931008825228       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931008825264       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931008825633       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931008825767       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931008826133       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931008826140       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931008825504       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931008825228       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931008825245       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931008825656       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931008825779       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+01 is 1.633118e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931006724546       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931007127719       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931007189717       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931007208648       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931007215696       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931007220677       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931007223349       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931007227915       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931007230534       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931007233843       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931007236093       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931007235961       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931007238470       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931007240715       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931007241239       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931007243902       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931007244760       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931007247519       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931007248563       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931007248948       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931007249000       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931007250563       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931007250459       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931007250889       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931007250910       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931007250594       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931007250560       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931007250270       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931007250497       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931007250620       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931007250798       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931007250853       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931007250832       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931007250822       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931007250831       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931007250923       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931007250957       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931007251049       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931007251049       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931007250891       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931007250823       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931007250827       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931007250930       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931007250960       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+02 is 4.083980e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931006724546       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931006825398       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931006840905       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931006845639       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931006847401       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931006848647       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931006849316       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931006850458       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931006851112       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931006851940       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931006852501       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931006852469       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931006853095       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931006853657       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931006853789       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931006854455       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931006854670       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931006855359       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931006855621       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931006855717       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931006855729       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931006856120       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931006856094       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931006856200       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931006856205       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931006856128       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931006856119       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931006856046       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931006856104       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931006856136       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931006856177       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931006856192       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931006856188       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931006856185       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931006856188       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931006856210       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931006856220       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931006856243       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931006856241       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931006856201       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931006856183       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931006856187       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931006856212       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931006856218       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+02 is 1.021069e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.148124 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6432e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.086458e-01 1 1  ON 0
  uu_1                 5.287291e-02 1 1  ON 1
  uu_2                -3.637537e-02 1 1  ON 2
  uu_3                -8.945754e-02 1 1  ON 3
  uu_4                -1.214416e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141403e-01 1 1  ON 6
  uu_7                -5.690210e-02 1 1  ON 7
  uu_8                 5.799527e-02 1 1  ON 8
  uu_9                 1.222540e-01 1 1  ON 9
  ud_0                 2.998756e-01 1 1  ON 10
  ud_1                 7.275002e-02 1 1  ON 11
  ud_2                -2.634469e-02 1 1  ON 12
  ud_3                -7.732491e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314869e-01 1 1  ON 15
  ud_6                -1.262637e-01 1 1  ON 16
  ud_7                -8.673753e-02 1 1  ON 17
  ud_8                -4.316513e-03 1 1  ON 18
  ud_9                 8.463565e-02 1 1  ON 19
  eO_0                -6.926994e-01 1 1  ON 20
  eO_1                -4.130627e-01 1 1  ON 21
  eO_2                -4.192868e-02 1 1  ON 22
  eO_3                 1.780421e-01 1 1  ON 23
  eO_4                 2.494728e-01 1 1  ON 24
  eO_5                 2.740669e-01 1 1  ON 25
  eO_6                 2.477341e-01 1 1  ON 26
  eO_7                 1.383061e-01 1 1  ON 27
  eO_8                 2.919762e-02 1 1  ON 28
  eO_9                 1.941600e-02 1 1  ON 29
 eH1_0                -2.052595e-01 1 1  ON 30
 eH1_1                -1.001311e-01 1 1  ON 31
 eH1_2                -4.902747e-02 1 1  ON 32
 eH1_3                -1.779282e-02 1 1  ON 33
 eH1_4                 1.687315e-02 1 1  ON 34
 eH1_5                 2.438727e-02 1 1  ON 35
 eH1_6                 7.872354e-02 1 1  ON 36
 eH1_7                 1.067681e-01 1 1  ON 37
 eH1_8                 1.032780e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020293e-01 1 1  ON 40
 eH2_1                -9.698293e-02 1 1  ON 41
 eH2_2                -4.656405e-02 1 1  ON 42
 eH2_3                -1.595916e-02 1 1  ON 43
 eH2_4                 1.719841e-02 1 1  ON 44
 eH2_5                 2.130275e-02 1 1  ON 45
 eH2_6                 7.068572e-02 1 1  ON 46
 eH2_7                 1.057172e-01 1 1  ON 47
 eH2_8                 1.051744e-01 1 1  ON 48
 eH2_9                 2.839115e-02 1 1  ON 49
ci_001                -4.215045e-02 3 1  ON 50
ci_002                -3.109070e-02 3 1  ON 51
ci_003                -2.582700e-02 3 1  ON 52
ci_004                 2.456254e-02 3 1  ON 53
ci_005                 2.465429e-02 3 1  ON 54
ci_006                -2.043677e-02 3 1  ON 55
ci_007                -2.042610e-02 3 1  ON 56
ci_008                -8.845467e-03 3 1  ON 57
ci_009                -1.497514e-02 3 1  ON 58
ci_010                -9.391917e-03 3 1  ON 59
ci_011                -1.018121e-02 3 1  ON 60
ci_012                -1.016516e-02 3 1  ON 61
ci_013                -1.946964e-02 3 1  ON 62
ci_014                 1.330956e-02 3 1  ON 63
ci_015                 1.319838e-02 3 1  ON 64
ci_016                 1.639967e-02 3 1  ON 65
ci_017                 1.622927e-02 3 1  ON 66
ci_018                 1.018135e-02 3 1  ON 67
ci_019                 1.025352e-02 3 1  ON 68
ci_020                 1.660895e-02 3 1  ON 69
ci_021                 1.650597e-02 3 1  ON 70
ci_022                 1.055193e-02 3 1  ON 71
ci_023                 9.565182e-03 3 1  ON 72
ci_024                 7.555475e-03 3 1  ON 73
ci_025                 6.350197e-03 3 1  ON 74
ci_026                 1.163697e-02 3 1  ON 75
ci_027                 1.175328e-02 3 1  ON 76
ci_028                -1.524608e-02 3 1  ON 77
ci_029                -1.528743e-02 3 1  ON 78
ci_030                -4.398153e-03 3 1  ON 79
ci_031                -4.791353e-03 3 1  ON 80
ci_032                -1.530528e-02 3 1  ON 81
ci_033                 6.830856e-03 3 1  ON 82
ci_034                 7.268230e-03 3 1  ON 83
ci_035                -4.582097e-03 3 1  ON 84
ci_036                -1.277470e-02 3 1  ON 85
ci_037                -1.273816e-02 3 1  ON 86
ci_038                 1.224766e-03 3 1  ON 87
ci_039                 1.418357e-03 3 1  ON 88
ci_040                -2.651191e-03 3 1  ON 89
ci_041                 8.416242e-03 3 1  ON 90
ci_042                 8.444954e-03 3 1  ON 91
ci_043                -3.610969e-03 3 1  ON 92
ci_044                -4.080459e-03 3 1  ON 93
ci_045                -2.795964e-03 3 1  ON 94
ci_046                 5.776171e-03 3 1  ON 95
ci_047                 5.635084e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.306253
====================================================
  Execution time = 2.7593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9170e-01
  Total weights = 1.9664e+06
  Execution time = 2.3258e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526246895
                                         uncertainty =       0.001722307207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526246895
                                         uncertainty =       0.001722307207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373165879
  error estimate for blocks of size 2^( 2) =       0.000387338423
  error estimate for blocks of size 2^( 3) =       0.000400748664
  error estimate for blocks of size 2^( 4) =       0.000410644058
  error estimate for blocks of size 2^( 5) =       0.000417089548
  error estimate for blocks of size 2^( 6) =       0.000420849871
  error estimate for blocks of size 2^( 7) =       0.000423955930

      target function =      -0.925478605310
              le_mean =     -17.209430161313
             les_mean =     296.456181593587
             stat err =       0.000418134852
             autocorr =       1.255535168150
   target nu stat err =       0.000418134852
   target dn stat err =       0.003995536658
      target stat err =       0.006527467401
              std dev =       0.527744691099
             le_variance =       0.278514458984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526225742
                                         uncertainty =       0.001722475445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526225742
                                         uncertainty =       0.001722475445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373165865
  error estimate for blocks of size 2^( 2) =       0.000387338897
  error estimate for blocks of size 2^( 3) =       0.000400749640
  error estimate for blocks of size 2^( 4) =       0.000410645383
  error estimate for blocks of size 2^( 5) =       0.000417090953
  error estimate for blocks of size 2^( 6) =       0.000420851372
  error estimate for blocks of size 2^( 7) =       0.000423957216

      target function =      -0.925454338834
              le_mean =     -17.209429980811
             les_mean =     296.456190342320
             stat err =       0.000418136231
             autocorr =       1.255543545518
   target nu stat err =       0.000418136231
   target dn stat err =       0.003995067302
      target stat err =       0.006526368144
              std dev =       0.527744670754
             le_variance =       0.278514437509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526234842
                                         uncertainty =       0.001722391429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526234842
                                         uncertainty =       0.001722391429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373165871
  error estimate for blocks of size 2^( 2) =       0.000387338659
  error estimate for blocks of size 2^( 3) =       0.000400749152
  error estimate for blocks of size 2^( 4) =       0.000410644720
  error estimate for blocks of size 2^( 5) =       0.000417090251
  error estimate for blocks of size 2^( 6) =       0.000420850622
  error estimate for blocks of size 2^( 7) =       0.000423956573

      target function =      -0.925467107634
              le_mean =     -17.209430070706
             les_mean =     296.456185564490
             stat err =       0.000418135541
             autocorr =       1.255539364825
   target nu stat err =       0.000418135541
   target dn stat err =       0.003995269746
      target stat err =       0.006526874666
              std dev =       0.527744679528
             le_variance =       0.278514446770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526245210
                                         uncertainty =       0.001722317734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278526245210
                                         uncertainty =       0.001722317734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373165878
  error estimate for blocks of size 2^( 2) =       0.000387338452
  error estimate for blocks of size 2^( 3) =       0.000400748725
  error estimate for blocks of size 2^( 4) =       0.000410644141
  error estimate for blocks of size 2^( 5) =       0.000417089636
  error estimate for blocks of size 2^( 6) =       0.000420849965
  error estimate for blocks of size 2^( 7) =       0.000423956010

      target function =      -0.925477236037
              le_mean =     -17.209430149963
             les_mean =     296.456182047292
             stat err =       0.000418134938
             autocorr =       1.255535693058
   target nu stat err =       0.000418134938
   target dn stat err =       0.003995500140
      target stat err =       0.006527389171
              std dev =       0.527744689484
             le_variance =       0.278514457278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925478605310        initial  <--
     2.5000e+01     2.5000e+02             1.6331e-05        -0.925454338834
     1.0000e+02     1.0000e+03             4.0840e-06        -0.925467107634
     4.0000e+02     4.0000e+03             1.0211e-06        -0.925477236037

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3918
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.086449e-01 1 1  ON 0
  uu_1                 5.287247e-02 1 1  ON 1
  uu_2                -3.637603e-02 1 1  ON 2
  uu_3                -8.945768e-02 1 1  ON 3
  uu_4                -1.214416e-01 1 1  ON 4
  uu_5                -1.310849e-01 1 1  ON 5
  uu_6                -1.141413e-01 1 1  ON 6
  uu_7                -5.690084e-02 1 1  ON 7
  uu_8                 5.799935e-02 1 1  ON 8
  uu_9                 1.222536e-01 1 1  ON 9
  ud_0                 2.998771e-01 1 1  ON 10
  ud_1                 7.275179e-02 1 1  ON 11
  ud_2                -2.634349e-02 1 1  ON 12
  ud_3                -7.732428e-02 1 1  ON 13
  ud_4                -1.123523e-01 1 1  ON 14
  ud_5                -1.314881e-01 1 1  ON 15
  ud_6                -1.262667e-01 1 1  ON 16
  ud_7                -8.674046e-02 1 1  ON 17
  ud_8                -4.313868e-03 1 1  ON 18
  ud_9                 8.463643e-02 1 1  ON 19
  eO_0                -6.926996e-01 1 1  ON 20
  eO_1                -4.130624e-01 1 1  ON 21
  eO_2                -4.192797e-02 1 1  ON 22
  eO_3                 1.780422e-01 1 1  ON 23
  eO_4                 2.494751e-01 1 1  ON 24
  eO_5                 2.740692e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383034e-01 1 1  ON 27
  eO_8                 2.919744e-02 1 1  ON 28
  eO_9                 1.941593e-02 1 1  ON 29
 eH1_0                -2.052598e-01 1 1  ON 30
 eH1_1                -1.001320e-01 1 1  ON 31
 eH1_2                -4.902857e-02 1 1  ON 32
 eH1_3                -1.779329e-02 1 1  ON 33
 eH1_4                 1.687418e-02 1 1  ON 34
 eH1_5                 2.439100e-02 1 1  ON 35
 eH1_6                 7.872476e-02 1 1  ON 36
 eH1_7                 1.067666e-01 1 1  ON 37
 eH1_8                 1.032764e-01 1 1  ON 38
 eH1_9                 2.602781e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698399e-02 1 1  ON 41
 eH2_2                -4.656568e-02 1 1  ON 42
 eH2_3                -1.596037e-02 1 1  ON 43
 eH2_4                 1.719781e-02 1 1  ON 44
 eH2_5                 2.130529e-02 1 1  ON 45
 eH2_6                 7.068856e-02 1 1  ON 46
 eH2_7                 1.057193e-01 1 1  ON 47
 eH2_8                 1.051732e-01 1 1  ON 48
 eH2_9                 2.839079e-02 1 1  ON 49
ci_001                -4.215118e-02 3 1  ON 50
ci_002                -3.109056e-02 3 1  ON 51
ci_003                -2.582615e-02 3 1  ON 52
ci_004                 2.456278e-02 3 1  ON 53
ci_005                 2.465442e-02 3 1  ON 54
ci_006                -2.043640e-02 3 1  ON 55
ci_007                -2.042683e-02 3 1  ON 56
ci_008                -8.845450e-03 3 1  ON 57
ci_009                -1.497508e-02 3 1  ON 58
ci_010                -9.391639e-03 3 1  ON 59
ci_011                -1.018196e-02 3 1  ON 60
ci_012                -1.016593e-02 3 1  ON 61
ci_013                -1.946930e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319837e-02 3 1  ON 64
ci_016                 1.639982e-02 3 1  ON 65
ci_017                 1.622909e-02 3 1  ON 66
ci_018                 1.018122e-02 3 1  ON 67
ci_019                 1.025317e-02 3 1  ON 68
ci_020                 1.660990e-02 3 1  ON 69
ci_021                 1.650699e-02 3 1  ON 70
ci_022                 1.055267e-02 3 1  ON 71
ci_023                 9.564203e-03 3 1  ON 72
ci_024                 7.556927e-03 3 1  ON 73
ci_025                 6.349605e-03 3 1  ON 74
ci_026                 1.163667e-02 3 1  ON 75
ci_027                 1.175321e-02 3 1  ON 76
ci_028                -1.524554e-02 3 1  ON 77
ci_029                -1.528659e-02 3 1  ON 78
ci_030                -4.398265e-03 3 1  ON 79
ci_031                -4.793242e-03 3 1  ON 80
ci_032                -1.530658e-02 3 1  ON 81
ci_033                 6.829732e-03 3 1  ON 82
ci_034                 7.268630e-03 3 1  ON 83
ci_035                -4.582419e-03 3 1  ON 84
ci_036                -1.277529e-02 3 1  ON 85
ci_037                -1.273785e-02 3 1  ON 86
ci_038                 1.224525e-03 3 1  ON 87
ci_039                 1.418154e-03 3 1  ON 88
ci_040                -2.651044e-03 3 1  ON 89
ci_041                 8.416098e-03 3 1  ON 90
ci_042                 8.445017e-03 3 1  ON 91
ci_043                -3.610947e-03 3 1  ON 92
ci_044                -4.081147e-03 3 1  ON 93
ci_045                -2.796163e-03 3 1  ON 94
ci_046                 5.776740e-03 3 1  ON 95
ci_047                 5.635006e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.378656
====================================================
  Execution time = 2.8028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8736e-01
  Total weights = 1.966320716e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5334e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276826172361
                                         uncertainty =       0.001995273258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276826172361
                                         uncertainty =       0.001995273258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371970204
  error estimate for blocks of size 2^( 2) =       0.000386291597
  error estimate for blocks of size 2^( 3) =       0.000399418282
  error estimate for blocks of size 2^( 4) =       0.000409041535
  error estimate for blocks of size 2^( 5) =       0.000414693089
  error estimate for blocks of size 2^( 6) =       0.000416835585
  error estimate for blocks of size 2^( 7) =       0.000420480410

      target function =      -0.932604593642
              le_mean =     -17.208960852121
             les_mean =     296.435693483799
             stat err =       0.000415262655
             autocorr =       1.246319664753
   target nu stat err =       0.000415262655
   target dn stat err =       0.002876708990
      target stat err =       0.004794174883
              std dev =       0.526053723501
             le_variance =       0.276732520009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720896085212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932628183794       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932628244772       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932628257167       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932628260461       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932628260931       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932628262963       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932628263006       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932628263430       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932628264630       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932628265249       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932628265732       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932628265997       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932628267222       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932628268483       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932628269105       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932628270073       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932628269838       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932628269839       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932628269744       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932628269915       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932628270112       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932628269862       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932628269801       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932628269759       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932628269798       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932628269753       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932628269960       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932628269979       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932628269999       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932628270012       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932628270011       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932628270066       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932628270090       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932628270121       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932628270117       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932628270057       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932628270018       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932628270105       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932628270126       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932628270112       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932628270118       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 1.200159e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932628183794       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932628199042       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932628202141       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932628202965       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932628203082       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932628203588       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932628203600       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932628203708       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932628204007       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932628204160       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932628204284       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932628204348       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932628204654       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932628204969       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932628205126       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932628205369       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932628205308       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932628205307       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932628205285       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932628205328       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932628205377       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932628205318       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932628205300       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932628205290       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932628205298       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932628205291       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932628205339       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932628205342       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932628205350       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932628205349       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932628205353       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932628205362       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932628205371       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932628205378       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932628205379       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932628205368       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932628205356       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932628205374       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932628205381       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932628205381       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932628205376       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+03 is 3.000672e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932628183794       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932628187606       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932628188381       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932628188587       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932628188614       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932628188743       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932628188754       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932628188774       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932628188842       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932628188885       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932628188923       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932628188936       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932628189012       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932628189090       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932628189130       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932628189189       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932628189178       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932628189168       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932628189170       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932628189180       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932628189192       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932628189166       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932628189174       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932628189167       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932628189170       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932628189153       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932628189187       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932628189178       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932628189197       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932628189172       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932628189173       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932628189206       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932628189194       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932628189198       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932628189175       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932628189200       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932628189184       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932628189184       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932628189191       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932628189176       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932628189189       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+03 is 7.501853e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.223381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6646e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287246e-02 1 1  ON 1
  uu_2                -3.637599e-02 1 1  ON 2
  uu_3                -8.945765e-02 1 1  ON 3
  uu_4                -1.214415e-01 1 1  ON 4
  uu_5                -1.310848e-01 1 1  ON 5
  uu_6                -1.141413e-01 1 1  ON 6
  uu_7                -5.690098e-02 1 1  ON 7
  uu_8                 5.799910e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998770e-01 1 1  ON 10
  ud_1                 7.275168e-02 1 1  ON 11
  ud_2                -2.634359e-02 1 1  ON 12
  ud_3                -7.732438e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314880e-01 1 1  ON 15
  ud_6                -1.262665e-01 1 1  ON 16
  ud_7                -8.674016e-02 1 1  ON 17
  ud_8                -4.313966e-03 1 1  ON 18
  ud_9                 8.463633e-02 1 1  ON 19
  eO_0                -6.926993e-01 1 1  ON 20
  eO_1                -4.130623e-01 1 1  ON 21
  eO_2                -4.192794e-02 1 1  ON 22
  eO_3                 1.780420e-01 1 1  ON 23
  eO_4                 2.494748e-01 1 1  ON 24
  eO_5                 2.740689e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383036e-01 1 1  ON 27
  eO_8                 2.919747e-02 1 1  ON 28
  eO_9                 1.941593e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001319e-01 1 1  ON 31
 eH1_2                -4.902855e-02 1 1  ON 32
 eH1_3                -1.779327e-02 1 1  ON 33
 eH1_4                 1.687421e-02 1 1  ON 34
 eH1_5                 2.439084e-02 1 1  ON 35
 eH1_6                 7.872454e-02 1 1  ON 36
 eH1_7                 1.067667e-01 1 1  ON 37
 eH1_8                 1.032765e-01 1 1  ON 38
 eH1_9                 2.602784e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698405e-02 1 1  ON 41
 eH2_2                -4.656567e-02 1 1  ON 42
 eH2_3                -1.596044e-02 1 1  ON 43
 eH2_4                 1.719784e-02 1 1  ON 44
 eH2_5                 2.130528e-02 1 1  ON 45
 eH2_6                 7.068855e-02 1 1  ON 46
 eH2_7                 1.057192e-01 1 1  ON 47
 eH2_8                 1.051733e-01 1 1  ON 48
 eH2_9                 2.839081e-02 1 1  ON 49
ci_001                -4.215112e-02 3 1  ON 50
ci_002                -3.109052e-02 3 1  ON 51
ci_003                -2.582617e-02 3 1  ON 52
ci_004                 2.456279e-02 3 1  ON 53
ci_005                 2.465437e-02 3 1  ON 54
ci_006                -2.043644e-02 3 1  ON 55
ci_007                -2.042683e-02 3 1  ON 56
ci_008                -8.845470e-03 3 1  ON 57
ci_009                -1.497504e-02 3 1  ON 58
ci_010                -9.391726e-03 3 1  ON 59
ci_011                -1.018200e-02 3 1  ON 60
ci_012                -1.016589e-02 3 1  ON 61
ci_013                -1.946925e-02 3 1  ON 62
ci_014                 1.330970e-02 3 1  ON 63
ci_015                 1.319840e-02 3 1  ON 64
ci_016                 1.639981e-02 3 1  ON 65
ci_017                 1.622910e-02 3 1  ON 66
ci_018                 1.018119e-02 3 1  ON 67
ci_019                 1.025315e-02 3 1  ON 68
ci_020                 1.660989e-02 3 1  ON 69
ci_021                 1.650698e-02 3 1  ON 70
ci_022                 1.055259e-02 3 1  ON 71
ci_023                 9.564237e-03 3 1  ON 72
ci_024                 7.556944e-03 3 1  ON 73
ci_025                 6.349655e-03 3 1  ON 74
ci_026                 1.163665e-02 3 1  ON 75
ci_027                 1.175320e-02 3 1  ON 76
ci_028                -1.524558e-02 3 1  ON 77
ci_029                -1.528661e-02 3 1  ON 78
ci_030                -4.398305e-03 3 1  ON 79
ci_031                -4.793271e-03 3 1  ON 80
ci_032                -1.530651e-02 3 1  ON 81
ci_033                 6.829792e-03 3 1  ON 82
ci_034                 7.268660e-03 3 1  ON 83
ci_035                -4.582405e-03 3 1  ON 84
ci_036                -1.277533e-02 3 1  ON 85
ci_037                -1.273781e-02 3 1  ON 86
ci_038                 1.224545e-03 3 1  ON 87
ci_039                 1.418161e-03 3 1  ON 88
ci_040                -2.651073e-03 3 1  ON 89
ci_041                 8.416069e-03 3 1  ON 90
ci_042                 8.444974e-03 3 1  ON 91
ci_043                -3.610968e-03 3 1  ON 92
ci_044                -4.081177e-03 3 1  ON 93
ci_045                -2.796185e-03 3 1  ON 94
ci_046                 5.776767e-03 3 1  ON 95
ci_047                 5.635064e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.197415
====================================================
  Execution time = 2.7485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8767e-01
  Total weights = 1.9664e+06
  Execution time = 2.3198e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529113791
                                         uncertainty =       0.002231547176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529113791
                                         uncertainty =       0.002231547176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545580
  error estimate for blocks of size 2^( 2) =       0.000386540569
  error estimate for blocks of size 2^( 3) =       0.000400229185
  error estimate for blocks of size 2^( 4) =       0.000409489499
  error estimate for blocks of size 2^( 5) =       0.000414819710
  error estimate for blocks of size 2^( 6) =       0.000417827436
  error estimate for blocks of size 2^( 7) =       0.000419941185

      target function =      -0.932051624368
              le_mean =     -17.209532522420
             les_mean =     296.455678250129
             stat err =       0.000415519458
             autocorr =       1.244010081050
   target nu stat err =       0.000415519458
   target dn stat err =       0.004239297197
      target stat err =       0.007019843172
              std dev =       0.526867441935
             le_variance =       0.277589301371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529090160
                                         uncertainty =       0.002231536533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529090160
                                         uncertainty =       0.002231536533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545564
  error estimate for blocks of size 2^( 2) =       0.000386540565
  error estimate for blocks of size 2^( 3) =       0.000400229194
  error estimate for blocks of size 2^( 4) =       0.000409489519
  error estimate for blocks of size 2^( 5) =       0.000414819735
  error estimate for blocks of size 2^( 6) =       0.000417827461
  error estimate for blocks of size 2^( 7) =       0.000419941205

      target function =      -0.932051973852
              le_mean =     -17.209532518731
             les_mean =     296.455677911963
             stat err =       0.000415519480
             autocorr =       1.244010321103
   target nu stat err =       0.000415519480
   target dn stat err =       0.004239231093
      target stat err =       0.007019740087
              std dev =       0.526867419277
             le_variance =       0.277589277495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529101970
                                         uncertainty =       0.002231541853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529101970
                                         uncertainty =       0.002231541853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545572
  error estimate for blocks of size 2^( 2) =       0.000386540567
  error estimate for blocks of size 2^( 3) =       0.000400229189
  error estimate for blocks of size 2^( 4) =       0.000409489509
  error estimate for blocks of size 2^( 5) =       0.000414819723
  error estimate for blocks of size 2^( 6) =       0.000417827449
  error estimate for blocks of size 2^( 7) =       0.000419941195

      target function =      -0.932051799326
              le_mean =     -17.209532520574
             les_mean =     296.455678080878
             stat err =       0.000415519469
             autocorr =       1.244010201079
   target nu stat err =       0.000415519469
   target dn stat err =       0.004239264139
      target stat err =       0.007019791622
              std dev =       0.526867430601
             le_variance =       0.277589289428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529112313
                                         uncertainty =       0.002231546510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277529112313
                                         uncertainty =       0.002231546510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372545579
  error estimate for blocks of size 2^( 2) =       0.000386540569
  error estimate for blocks of size 2^( 3) =       0.000400229186
  error estimate for blocks of size 2^( 4) =       0.000409489500
  error estimate for blocks of size 2^( 5) =       0.000414819711
  error estimate for blocks of size 2^( 6) =       0.000417827438
  error estimate for blocks of size 2^( 7) =       0.000419941186

      target function =      -0.932051646260
              le_mean =     -17.209532522189
             les_mean =     296.455678228956
             stat err =       0.000415519459
             autocorr =       1.244010096055
   target nu stat err =       0.000415519459
   target dn stat err =       0.004239293065
      target stat err =       0.007019836728
              std dev =       0.526867440518
             le_variance =       0.277589299878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932051624368        initial
     2.5000e+02     2.5000e+03             1.2002e-06        -0.932051973852  <--
     1.0000e+03     1.0000e+04             3.0007e-07        -0.932051799326
     4.0000e+03     4.0000e+04             7.5019e-08        -0.932051646260

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 3.9258e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287243e-02 1 1  ON 1
  uu_2                -3.637587e-02 1 1  ON 2
  uu_3                -8.945757e-02 1 1  ON 3
  uu_4                -1.214413e-01 1 1  ON 4
  uu_5                -1.310845e-01 1 1  ON 5
  uu_6                -1.141411e-01 1 1  ON 6
  uu_7                -5.690141e-02 1 1  ON 7
  uu_8                 5.799835e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998767e-01 1 1  ON 10
  ud_1                 7.275135e-02 1 1  ON 11
  ud_2                -2.634389e-02 1 1  ON 12
  ud_3                -7.732468e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314878e-01 1 1  ON 15
  ud_6                -1.262660e-01 1 1  ON 16
  ud_7                -8.673926e-02 1 1  ON 17
  ud_8                -4.314258e-03 1 1  ON 18
  ud_9                 8.463604e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130619e-01 1 1  ON 21
  eO_2                -4.192785e-02 1 1  ON 22
  eO_3                 1.780415e-01 1 1  ON 23
  eO_4                 2.494740e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477319e-01 1 1  ON 26
  eO_7                 1.383045e-01 1 1  ON 27
  eO_8                 2.919756e-02 1 1  ON 28
  eO_9                 1.941594e-02 1 1  ON 29
 eH1_0                -2.052596e-01 1 1  ON 30
 eH1_1                -1.001319e-01 1 1  ON 31
 eH1_2                -4.902848e-02 1 1  ON 32
 eH1_3                -1.779319e-02 1 1  ON 33
 eH1_4                 1.687430e-02 1 1  ON 34
 eH1_5                 2.439036e-02 1 1  ON 35
 eH1_6                 7.872388e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032768e-01 1 1  ON 38
 eH1_9                 2.602795e-02 1 1  ON 39
 eH2_0                -2.020305e-01 1 1  ON 40
 eH2_1                -9.698422e-02 1 1  ON 41
 eH2_2                -4.656567e-02 1 1  ON 42
 eH2_3                -1.596066e-02 1 1  ON 43
 eH2_4                 1.719792e-02 1 1  ON 44
 eH2_5                 2.130524e-02 1 1  ON 45
 eH2_6                 7.068851e-02 1 1  ON 46
 eH2_7                 1.057192e-01 1 1  ON 47
 eH2_8                 1.051736e-01 1 1  ON 48
 eH2_9                 2.839087e-02 1 1  ON 49
ci_001                -4.215093e-02 3 1  ON 50
ci_002                -3.109041e-02 3 1  ON 51
ci_003                -2.582623e-02 3 1  ON 52
ci_004                 2.456281e-02 3 1  ON 53
ci_005                 2.465421e-02 3 1  ON 54
ci_006                -2.043658e-02 3 1  ON 55
ci_007                -2.042684e-02 3 1  ON 56
ci_008                -8.845530e-03 3 1  ON 57
ci_009                -1.497492e-02 3 1  ON 58
ci_010                -9.391989e-03 3 1  ON 59
ci_011                -1.018211e-02 3 1  ON 60
ci_012                -1.016578e-02 3 1  ON 61
ci_013                -1.946912e-02 3 1  ON 62
ci_014                 1.330969e-02 3 1  ON 63
ci_015                 1.319851e-02 3 1  ON 64
ci_016                 1.639978e-02 3 1  ON 65
ci_017                 1.622911e-02 3 1  ON 66
ci_018                 1.018110e-02 3 1  ON 67
ci_019                 1.025309e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650696e-02 3 1  ON 70
ci_022                 1.055233e-02 3 1  ON 71
ci_023                 9.564339e-03 3 1  ON 72
ci_024                 7.556997e-03 3 1  ON 73
ci_025                 6.349804e-03 3 1  ON 74
ci_026                 1.163658e-02 3 1  ON 75
ci_027                 1.175315e-02 3 1  ON 76
ci_028                -1.524569e-02 3 1  ON 77
ci_029                -1.528664e-02 3 1  ON 78
ci_030                -4.398424e-03 3 1  ON 79
ci_031                -4.793360e-03 3 1  ON 80
ci_032                -1.530629e-02 3 1  ON 81
ci_033                 6.829972e-03 3 1  ON 82
ci_034                 7.268747e-03 3 1  ON 83
ci_035                -4.582362e-03 3 1  ON 84
ci_036                -1.277546e-02 3 1  ON 85
ci_037                -1.273769e-02 3 1  ON 86
ci_038                 1.224607e-03 3 1  ON 87
ci_039                 1.418184e-03 3 1  ON 88
ci_040                -2.651158e-03 3 1  ON 89
ci_041                 8.415984e-03 3 1  ON 90
ci_042                 8.444843e-03 3 1  ON 91
ci_043                -3.611032e-03 3 1  ON 92
ci_044                -4.081268e-03 3 1  ON 93
ci_045                -2.796252e-03 3 1  ON 94
ci_046                 5.776846e-03 3 1  ON 95
ci_047                 5.635238e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2969
    reference variance = 0.122987
====================================================
  Execution time = 2.7927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8767e-01
  Total weights = 1.966229159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4256e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277886314542
                                         uncertainty =       0.001936964811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277886314542
                                         uncertainty =       0.001936964811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372754767
  error estimate for blocks of size 2^( 2) =       0.000386930120
  error estimate for blocks of size 2^( 3) =       0.000400350773
  error estimate for blocks of size 2^( 4) =       0.000410969949
  error estimate for blocks of size 2^( 5) =       0.000416443166
  error estimate for blocks of size 2^( 6) =       0.000419354151
  error estimate for blocks of size 2^( 7) =       0.000419527510

      target function =      -0.932059997870
              le_mean =     -17.210327596066
             les_mean =     296.483047054535
             stat err =       0.000416573694
             autocorr =       1.248927622266
   target nu stat err =       0.000416573694
   target dn stat err =       0.002326904093
      target stat err =       0.003907836343
              std dev =       0.527163281146
             le_variance =       0.277901124989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721032759607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932075404663       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932076978844       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932077207386       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932077270648       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932077298667       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932077303858       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932077303378       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932077305345       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932077307299       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932077311889       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932077313185       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932077316577       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932077318946       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932077321847       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932077323592       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932077324349       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932077324511       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932077325645       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932077325582       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932077324079       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932077322873       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932077323678       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932077322591       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932077323488       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932077324591       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932077324338       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932077324775       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932077325013       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932077325667       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932077325368       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932077325127       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932077325369       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932077325869       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932077326260       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932077326012       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932077325502       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932077325442       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932077325463       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932077325560       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932077325452       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932077325430       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+01 is 5.542790e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932075404663       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932075798559       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932075855742       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932075871565       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932075878575       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932075879870       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932075879751       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932075880243       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932075880731       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932075881880       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932075882204       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932075883053       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932075883646       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932075884370       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932075884807       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932075884996       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932075885037       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932075885320       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932075885304       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932075884930       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932075884627       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932075884828       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932075884556       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932075884782       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932075885057       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932075884992       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932075885102       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932075885163       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932075885326       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932075885249       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932075885191       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932075885251       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932075885376       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932075885473       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932075885411       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932075885284       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932075885270       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932075885273       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932075885298       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932075885272       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932075885266       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 1.385883e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932075404663       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932075503159       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932075517458       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932075521414       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932075523168       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932075523490       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932075523461       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932075523583       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932075523704       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932075523994       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932075524075       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932075524288       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932075524434       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932075524616       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932075524727       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932075524772       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932075524783       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932075524853       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932075524850       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932075524755       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932075524680       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932075524730       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932075524661       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932075524718       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932075524788       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932075524770       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932075524801       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932075524809       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932075524855       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932075524838       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932075524822       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932075524834       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932075524867       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932075524891       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932075524874       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932075524841       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932075524841       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932075524843       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932075524848       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932075524844       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932075524838       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+03 is 3.464823e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.299422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6436e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287238e-02 1 1  ON 1
  uu_2                -3.637602e-02 1 1  ON 2
  uu_3                -8.945776e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310841e-01 1 1  ON 5
  uu_6                -1.141407e-01 1 1  ON 6
  uu_7                -5.690087e-02 1 1  ON 7
  uu_8                 5.799697e-02 1 1  ON 8
  uu_9                 1.222536e-01 1 1  ON 9
  ud_0                 2.998765e-01 1 1  ON 10
  ud_1                 7.275122e-02 1 1  ON 11
  ud_2                -2.634402e-02 1 1  ON 12
  ud_3                -7.732473e-02 1 1  ON 13
  ud_4                -1.123525e-01 1 1  ON 14
  ud_5                -1.314881e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673864e-02 1 1  ON 17
  ud_8                -4.314162e-03 1 1  ON 18
  ud_9                 8.463584e-02 1 1  ON 19
  eO_0                -6.926987e-01 1 1  ON 20
  eO_1                -4.130623e-01 1 1  ON 21
  eO_2                -4.192801e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494735e-01 1 1  ON 24
  eO_5                 2.740682e-01 1 1  ON 25
  eO_6                 2.477317e-01 1 1  ON 26
  eO_7                 1.383053e-01 1 1  ON 27
  eO_8                 2.919766e-02 1 1  ON 28
  eO_9                 1.941598e-02 1 1  ON 29
 eH1_0                -2.052598e-01 1 1  ON 30
 eH1_1                -1.001317e-01 1 1  ON 31
 eH1_2                -4.902820e-02 1 1  ON 32
 eH1_3                -1.779302e-02 1 1  ON 33
 eH1_4                 1.687365e-02 1 1  ON 34
 eH1_5                 2.438960e-02 1 1  ON 35
 eH1_6                 7.872438e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032772e-01 1 1  ON 38
 eH1_9                 2.602801e-02 1 1  ON 39
 eH2_0                -2.020310e-01 1 1  ON 40
 eH2_1                -9.698443e-02 1 1  ON 41
 eH2_2                -4.656577e-02 1 1  ON 42
 eH2_3                -1.596061e-02 1 1  ON 43
 eH2_4                 1.719829e-02 1 1  ON 44
 eH2_5                 2.130553e-02 1 1  ON 45
 eH2_6                 7.068811e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051740e-01 1 1  ON 48
 eH2_9                 2.839104e-02 1 1  ON 49
ci_001                -4.215086e-02 3 1  ON 50
ci_002                -3.109046e-02 3 1  ON 51
ci_003                -2.582625e-02 3 1  ON 52
ci_004                 2.456290e-02 3 1  ON 53
ci_005                 2.465493e-02 3 1  ON 54
ci_006                -2.043595e-02 3 1  ON 55
ci_007                -2.042704e-02 3 1  ON 56
ci_008                -8.845341e-03 3 1  ON 57
ci_009                -1.497496e-02 3 1  ON 58
ci_010                -9.392099e-03 3 1  ON 59
ci_011                -1.018183e-02 3 1  ON 60
ci_012                -1.016574e-02 3 1  ON 61
ci_013                -1.946884e-02 3 1  ON 62
ci_014                 1.330979e-02 3 1  ON 63
ci_015                 1.319904e-02 3 1  ON 64
ci_016                 1.639984e-02 3 1  ON 65
ci_017                 1.622873e-02 3 1  ON 66
ci_018                 1.018093e-02 3 1  ON 67
ci_019                 1.025303e-02 3 1  ON 68
ci_020                 1.660985e-02 3 1  ON 69
ci_021                 1.650656e-02 3 1  ON 70
ci_022                 1.055246e-02 3 1  ON 71
ci_023                 9.564730e-03 3 1  ON 72
ci_024                 7.556859e-03 3 1  ON 73
ci_025                 6.350194e-03 3 1  ON 74
ci_026                 1.163648e-02 3 1  ON 75
ci_027                 1.175302e-02 3 1  ON 76
ci_028                -1.524515e-02 3 1  ON 77
ci_029                -1.528684e-02 3 1  ON 78
ci_030                -4.398251e-03 3 1  ON 79
ci_031                -4.793509e-03 3 1  ON 80
ci_032                -1.530614e-02 3 1  ON 81
ci_033                 6.830087e-03 3 1  ON 82
ci_034                 7.268955e-03 3 1  ON 83
ci_035                -4.582390e-03 3 1  ON 84
ci_036                -1.277568e-02 3 1  ON 85
ci_037                -1.273751e-02 3 1  ON 86
ci_038                 1.224679e-03 3 1  ON 87
ci_039                 1.417918e-03 3 1  ON 88
ci_040                -2.651048e-03 3 1  ON 89
ci_041                 8.416557e-03 3 1  ON 90
ci_042                 8.444471e-03 3 1  ON 91
ci_043                -3.610727e-03 3 1  ON 92
ci_044                -4.081517e-03 3 1  ON 93
ci_045                -2.796357e-03 3 1  ON 94
ci_046                 5.776524e-03 3 1  ON 95
ci_047                 5.634848e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.368137
====================================================
  Execution time = 2.7482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9576e-01
  Total weights = 1.9662e+06
  Execution time = 2.3252e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629853848
                                         uncertainty =       0.001813618066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629853848
                                         uncertainty =       0.001813618066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373891556
  error estimate for blocks of size 2^( 2) =       0.000388064343
  error estimate for blocks of size 2^( 3) =       0.000401448536
  error estimate for blocks of size 2^( 4) =       0.000410779951
  error estimate for blocks of size 2^( 5) =       0.000416355107
  error estimate for blocks of size 2^( 6) =       0.000420410107
  error estimate for blocks of size 2^( 7) =       0.000423686918

      target function =      -0.918871733375
              le_mean =     -17.210078548031
             les_mean =     296.482560355986
             stat err =       0.000417808021
             autocorr =       1.248711842261
   target nu stat err =       0.000417808021
   target dn stat err =       0.005011207710
      target stat err =       0.008062254085
              std dev =       0.528770970040
             le_variance =       0.279598738757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629884062
                                         uncertainty =       0.001813363486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629884062
                                         uncertainty =       0.001813363486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373891576
  error estimate for blocks of size 2^( 2) =       0.000388064434
  error estimate for blocks of size 2^( 3) =       0.000401448681
  error estimate for blocks of size 2^( 4) =       0.000410780171
  error estimate for blocks of size 2^( 5) =       0.000416355476
  error estimate for blocks of size 2^( 6) =       0.000420410478
  error estimate for blocks of size 2^( 7) =       0.000423687225

      target function =      -0.918871142215
              le_mean =     -17.210078541143
             les_mean =     296.482560453917
             stat err =       0.000417808337
             autocorr =       1.248713602781
   target nu stat err =       0.000417808337
   target dn stat err =       0.005013182665
      target stat err =       0.008065395631
              std dev =       0.528770997909
             le_variance =       0.279598768229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629868522
                                         uncertainty =       0.001813490606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629868522
                                         uncertainty =       0.001813490606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373891566
  error estimate for blocks of size 2^( 2) =       0.000388064389
  error estimate for blocks of size 2^( 3) =       0.000401448608
  error estimate for blocks of size 2^( 4) =       0.000410780060
  error estimate for blocks of size 2^( 5) =       0.000416355291
  error estimate for blocks of size 2^( 6) =       0.000420410293
  error estimate for blocks of size 2^( 7) =       0.000423687071

      target function =      -0.918845368156
              le_mean =     -17.210078544879
             les_mean =     296.482576687825
             stat err =       0.000417808179
             autocorr =       1.248712723736
   target nu stat err =       0.000417808179
   target dn stat err =       0.005012230646
      target stat err =       0.008063425726
              std dev =       0.528770983565
             le_variance =       0.279598753060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629855633
                                         uncertainty =       0.001813602124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279629855633
                                         uncertainty =       0.001813602124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373891558
  error estimate for blocks of size 2^( 2) =       0.000388064349
  error estimate for blocks of size 2^( 3) =       0.000401448545
  error estimate for blocks of size 2^( 4) =       0.000410779964
  error estimate for blocks of size 2^( 5) =       0.000416355130
  error estimate for blocks of size 2^( 6) =       0.000420410130
  error estimate for blocks of size 2^( 7) =       0.000423686937

      target function =      -0.918872128290
              le_mean =     -17.210078547620
             les_mean =     296.482560093288
             stat err =       0.000417808040
             autocorr =       1.248711952492
   target nu stat err =       0.000417808040
   target dn stat err =       0.005011328012
      target stat err =       0.008062452981
              std dev =       0.528770971684
             le_variance =       0.279598740495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918871733375        initial
     6.2500e+01     6.2500e+02             5.5428e-06        -0.918871142215
     2.5000e+02     2.5000e+03             1.3859e-06        -0.918845368156
     1.0000e+03     1.0000e+04             3.4648e-07        -0.918872128290  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+03     and shift_s =   1.0000e+04
*****************************************************************************

  Execution time = 3.9258e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673911e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793397e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2986
    reference variance = 0.168636
====================================================
  Execution time = 2.8443e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8939e-01
  Total weights = 1.966266616e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2064e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277829836328
                                         uncertainty =       0.001815809937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277829836328
                                         uncertainty =       0.001815809937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372711856
  error estimate for blocks of size 2^( 2) =       0.000387004026
  error estimate for blocks of size 2^( 3) =       0.000400205643
  error estimate for blocks of size 2^( 4) =       0.000409941744
  error estimate for blocks of size 2^( 5) =       0.000415478142
  error estimate for blocks of size 2^( 6) =       0.000418292669
  error estimate for blocks of size 2^( 7) =       0.000419485280

      target function =      -0.929246968474
              le_mean =     -17.209201855271
             les_mean =     296.446016489610
             stat err =       0.000415799459
             autocorr =       1.244576000844
   target nu stat err =       0.000415799459
   target dn stat err =       0.003983610918
      target stat err =       0.006557702663
              std dev =       0.527102595653
             le_variance =       0.277837146344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720920185527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929291912276       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929292034537       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929292062556       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929292077091       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929292079208       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929292083832       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929292085375       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929292090667       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929292094862       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929292098152       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929292101964       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929292104087       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929292105990       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929292107792       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929292110611       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929292111630       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929292112791       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929292113310       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929292113947       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929292114562       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929292114638       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929292115418       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929292115566       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929292115967       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929292115551       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929292115471       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929292115806       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929292115955       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929292115760       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929292115822       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929292115809       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929292115918       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929292116046       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929292115958       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929292115973       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929292115923       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929292116023       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929292116130       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929292116166       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929292116097       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929292116115       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929292116097       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929292116114       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929292116094       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929292116086       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 2.482068e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929291912276       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929291942848       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929291949855       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929291953489       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929291954017       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929291955175       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929291955563       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929291956883       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929291957932       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929291958756       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929291959705       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929291960239       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929291960716       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929291961166       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929291961871       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929291962124       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929291962413       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929291962542       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929291962703       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929291962859       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929291962876       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929291963071       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929291963110       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929291963210       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929291963102       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929291963086       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929291963174       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929291963206       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929291963157       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929291963172       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929291963170       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929291963192       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929291963226       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929291963204       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929291963213       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929291963198       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929291963222       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929291963248       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929291963255       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929291963245       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929291963246       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929291963244       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929291963244       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929291963237       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929291963235       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+03 is 6.205664e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929291912276       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929291919920       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929291921671       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929291922580       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929291922712       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929291923001       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929291923101       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929291923429       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929291923685       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929291923898       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929291924133       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929291924266       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929291924381       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929291924496       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929291924681       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929291924746       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929291924812       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929291924843       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929291924882       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929291924913       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929291924918       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929291924977       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929291924992       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929291925007       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929291924969       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929291924970       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929291924992       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929291925012       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929291925000       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929291924989       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929291924999       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929291925008       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929291925003       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929291925005       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929291925011       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929291925001       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929291925002       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929291925018       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929291925024       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929291925010       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929291925017       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929291925019       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929291925011       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929291925018       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929291925021       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+03 is 1.551447e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.395677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7753e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.086449e-01 1 1  ON 0
  uu_1                 5.287241e-02 1 1  ON 1
  uu_2                -3.637593e-02 1 1  ON 2
  uu_3                -8.945760e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310843e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690089e-02 1 1  ON 7
  uu_8                 5.799742e-02 1 1  ON 8
  uu_9                 1.222536e-01 1 1  ON 9
  ud_0                 2.998763e-01 1 1  ON 10
  ud_1                 7.275096e-02 1 1  ON 11
  ud_2                -2.634424e-02 1 1  ON 12
  ud_3                -7.732491e-02 1 1  ON 13
  ud_4                -1.123525e-01 1 1  ON 14
  ud_5                -1.314877e-01 1 1  ON 15
  ud_6                -1.262658e-01 1 1  ON 16
  ud_7                -8.673849e-02 1 1  ON 17
  ud_8                -4.314005e-03 1 1  ON 18
  ud_9                 8.463593e-02 1 1  ON 19
  eO_0                -6.926985e-01 1 1  ON 20
  eO_1                -4.130619e-01 1 1  ON 21
  eO_2                -4.192804e-02 1 1  ON 22
  eO_3                 1.780413e-01 1 1  ON 23
  eO_4                 2.494736e-01 1 1  ON 24
  eO_5                 2.740680e-01 1 1  ON 25
  eO_6                 2.477317e-01 1 1  ON 26
  eO_7                 1.383052e-01 1 1  ON 27
  eO_8                 2.919768e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001317e-01 1 1  ON 31
 eH1_2                -4.902837e-02 1 1  ON 32
 eH1_3                -1.779309e-02 1 1  ON 33
 eH1_4                 1.687419e-02 1 1  ON 34
 eH1_5                 2.438985e-02 1 1  ON 35
 eH1_6                 7.872357e-02 1 1  ON 36
 eH1_7                 1.067669e-01 1 1  ON 37
 eH1_8                 1.032772e-01 1 1  ON 38
 eH1_9                 2.602822e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698418e-02 1 1  ON 41
 eH2_2                -4.656557e-02 1 1  ON 42
 eH2_3                -1.596062e-02 1 1  ON 43
 eH2_4                 1.719808e-02 1 1  ON 44
 eH2_5                 2.130524e-02 1 1  ON 45
 eH2_6                 7.068814e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839092e-02 1 1  ON 49
ci_001                -4.215083e-02 3 1  ON 50
ci_002                -3.109033e-02 3 1  ON 51
ci_003                -2.582626e-02 3 1  ON 52
ci_004                 2.456291e-02 3 1  ON 53
ci_005                 2.465440e-02 3 1  ON 54
ci_006                -2.043639e-02 3 1  ON 55
ci_007                -2.042688e-02 3 1  ON 56
ci_008                -8.845432e-03 3 1  ON 57
ci_009                -1.497490e-02 3 1  ON 58
ci_010                -9.392086e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016582e-02 3 1  ON 61
ci_013                -1.946910e-02 3 1  ON 62
ci_014                 1.330978e-02 3 1  ON 63
ci_015                 1.319865e-02 3 1  ON 64
ci_016                 1.639977e-02 3 1  ON 65
ci_017                 1.622898e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025308e-02 3 1  ON 68
ci_020                 1.660987e-02 3 1  ON 69
ci_021                 1.650685e-02 3 1  ON 70
ci_022                 1.055227e-02 3 1  ON 71
ci_023                 9.564513e-03 3 1  ON 72
ci_024                 7.556840e-03 3 1  ON 73
ci_025                 6.349821e-03 3 1  ON 74
ci_026                 1.163654e-02 3 1  ON 75
ci_027                 1.175311e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528678e-02 3 1  ON 78
ci_030                -4.398385e-03 3 1  ON 79
ci_031                -4.793337e-03 3 1  ON 80
ci_032                -1.530626e-02 3 1  ON 81
ci_033                 6.830012e-03 3 1  ON 82
ci_034                 7.268835e-03 3 1  ON 83
ci_035                -4.582366e-03 3 1  ON 84
ci_036                -1.277555e-02 3 1  ON 85
ci_037                -1.273753e-02 3 1  ON 86
ci_038                 1.224639e-03 3 1  ON 87
ci_039                 1.418097e-03 3 1  ON 88
ci_040                -2.651145e-03 3 1  ON 89
ci_041                 8.416005e-03 3 1  ON 90
ci_042                 8.444795e-03 3 1  ON 91
ci_043                -3.610952e-03 3 1  ON 92
ci_044                -4.081293e-03 3 1  ON 93
ci_045                -2.796297e-03 3 1  ON 94
ci_046                 5.776781e-03 3 1  ON 95
ci_047                 5.635157e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2011
    reference variance = 0.247482
====================================================
  Execution time = 2.7453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8977e-01
  Total weights = 1.9662e+06
  Execution time = 2.3194e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529684569
                                         uncertainty =       0.002145936981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529684569
                                         uncertainty =       0.002145936981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373854892
  error estimate for blocks of size 2^( 2) =       0.000387953922
  error estimate for blocks of size 2^( 3) =       0.000401008457
  error estimate for blocks of size 2^( 4) =       0.000410712382
  error estimate for blocks of size 2^( 5) =       0.000416658378
  error estimate for blocks of size 2^( 6) =       0.000419532914
  error estimate for blocks of size 2^( 7) =       0.000420630969

      target function =      -0.928603516159
              le_mean =     -17.210134209607
             les_mean =     296.478492536946
             stat err =       0.000416883661
             autocorr =       1.243436499352
   target nu stat err =       0.000416883661
   target dn stat err =       0.002989100866
      target stat err =       0.004946449478
              std dev =       0.528719118070
             le_variance =       0.279543905813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529714135
                                         uncertainty =       0.002145935787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529714135
                                         uncertainty =       0.002145935787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373854911
  error estimate for blocks of size 2^( 2) =       0.000387954002
  error estimate for blocks of size 2^( 3) =       0.000401008603
  error estimate for blocks of size 2^( 4) =       0.000410712583
  error estimate for blocks of size 2^( 5) =       0.000416658606
  error estimate for blocks of size 2^( 6) =       0.000419533139
  error estimate for blocks of size 2^( 7) =       0.000420631179

      target function =      -0.928603151929
              le_mean =     -17.210134203039
             les_mean =     296.478492534168
             stat err =       0.000416883877
             autocorr =       1.243437658972
   target nu stat err =       0.000416883877
   target dn stat err =       0.002989048215
      target stat err =       0.004946360425
              std dev =       0.528719145369
             le_variance =       0.279543934680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529699350
                                         uncertainty =       0.002145936384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529699350
                                         uncertainty =       0.002145936384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373854902
  error estimate for blocks of size 2^( 2) =       0.000387953962
  error estimate for blocks of size 2^( 3) =       0.000401008530
  error estimate for blocks of size 2^( 4) =       0.000410712483
  error estimate for blocks of size 2^( 5) =       0.000416658492
  error estimate for blocks of size 2^( 6) =       0.000419533026
  error estimate for blocks of size 2^( 7) =       0.000420631074

      target function =      -0.928603335008
              le_mean =     -17.210134206320
             les_mean =     296.478492534879
             stat err =       0.000416883769
             autocorr =       1.243437079245
   target nu stat err =       0.000416883769
   target dn stat err =       0.002989074526
      target stat err =       0.004946404939
              std dev =       0.528719131718
             le_variance =       0.279543920244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529686416
                                         uncertainty =       0.002145936907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279529686416
                                         uncertainty =       0.002145936907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373854893
  error estimate for blocks of size 2^( 2) =       0.000387953927
  error estimate for blocks of size 2^( 3) =       0.000401008466
  error estimate for blocks of size 2^( 4) =       0.000410712395
  error estimate for blocks of size 2^( 5) =       0.000416658392
  error estimate for blocks of size 2^( 6) =       0.000419532928
  error estimate for blocks of size 2^( 7) =       0.000420630982

      target function =      -0.928603493623
              le_mean =     -17.210134209196
             les_mean =     296.478492536614
             stat err =       0.000416883674
             autocorr =       1.243436571837
   target nu stat err =       0.000416883674
   target dn stat err =       0.002989097572
      target stat err =       0.004946443910
              std dev =       0.528719119775
             le_variance =       0.279543907616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928603516159        initial  <--
     2.5000e+02     2.5000e+03             2.4821e-06        -0.928603151929
     1.0000e+03     1.0000e+04             6.2057e-07        -0.928603335008
     4.0000e+03     4.0000e+04             1.5514e-07        -0.928603493623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2083
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673911e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793397e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6968e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1499
    reference variance = 0.114166
====================================================
  Execution time = 2.8708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0466e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8319e-01
  Total weights = 1.966443138e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3930e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274554337788
                                         uncertainty =       0.001449996836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274554337788
                                         uncertainty =       0.001449996836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370530692
  error estimate for blocks of size 2^( 2) =       0.000384509381
  error estimate for blocks of size 2^( 3) =       0.000397531696
  error estimate for blocks of size 2^( 4) =       0.000407277142
  error estimate for blocks of size 2^( 5) =       0.000412904972
  error estimate for blocks of size 2^( 6) =       0.000415202777
  error estimate for blocks of size 2^( 7) =       0.000417364903

      target function =      -0.939525444256
              le_mean =     -17.209424391119
             les_mean =     296.447480709598
             stat err =       0.000413187448
             autocorr =       1.243500215644
   target nu stat err =       0.000413187448
   target dn stat err =       0.001884215284
      target stat err =       0.003236852621
              std dev =       0.524017914293
             le_variance =       0.274594774500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720942439112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939535432880       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939535442255       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939535443651       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939535443876       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939535444056       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939535444211       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939535444256       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939535444309       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939535444407       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939535444365       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939535444403       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939535444472       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939535444491       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939535444507       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939535444538       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939535444627       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939535444632       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939535444578       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939535444550       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939535444558       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939535444571       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939535444565       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939535444605       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939535444640       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939535444654       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939535444657       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939535444661       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939535444654       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939535444660       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939535444670       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939535444664       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939535444674       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939535444665       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939535444651       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939535444628       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939535444664       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939535444655       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939535444655       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939535444669       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939535444650       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939535444660       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+03 is 1.162706e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939535432880       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939535435224       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939535435573       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939535435628       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939535435674       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939535435715       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939535435703       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939535435743       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939535435746       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939535435743       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939535435737       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939535435780       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939535435774       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939535435771       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939535435792       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939535435823       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939535435807       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939535435776       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939535435807       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939535435783       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939535435758       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939535435786       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939535435807       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939535435813       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939535435834       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939535435816       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939535435790       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939535435821       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939535435806       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939535435796       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939535435835       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939535435806       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939535435835       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939535435811       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939535435813       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939535435833       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939535435794       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939535435826       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939535435830       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939535435824       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939535435846       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+04 is 2.906772e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939535432880       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939535433466       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939535433553       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939535433567       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939535433557       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939535433572       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939535433627       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939535433646       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939535433660       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939535433641       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939535433623       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939535433646       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939535433581       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939535433578       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939535433659       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939535433607       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939535433626       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939535433603       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939535433529       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939535433713       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939535433880       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939535433673       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939535433569       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939535433730       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939535433674       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939535433681       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939535433676       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939535433536       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939535433446       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939535433342       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939535433788       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939535433621       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939535433613       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939535433906       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939535433797       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939535433658       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939535433396       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939535433620       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939535433604       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939535433615       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939535433626       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+04 is 7.266934e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.470923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7184e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690129e-02 1 1  ON 7
  uu_8                 5.799798e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275131e-02 1 1  ON 11
  ud_2                -2.634393e-02 1 1  ON 12
  ud_3                -7.732470e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673908e-02 1 1  ON 17
  ud_8                -4.314242e-03 1 1  ON 18
  ud_9                 8.463598e-02 1 1  ON 19
  eO_0                -6.926987e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494738e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052596e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902840e-02 1 1  ON 32
 eH1_3                -1.779314e-02 1 1  ON 33
 eH1_4                 1.687412e-02 1 1  ON 34
 eH1_5                 2.439016e-02 1 1  ON 35
 eH1_6                 7.872398e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656570e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719800e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068842e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839092e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582623e-02 3 1  ON 52
ci_004                 2.456284e-02 3 1  ON 53
ci_005                 2.465440e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845481e-03 3 1  ON 57
ci_009                -1.497492e-02 3 1  ON 58
ci_010                -9.392022e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025308e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650685e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564439e-03 3 1  ON 72
ci_024                 7.556964e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175311e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398385e-03 3 1  ON 79
ci_031                -4.793392e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830000e-03 3 1  ON 82
ci_034                 7.268800e-03 3 1  ON 83
ci_035                -4.582367e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224624e-03 3 1  ON 87
ci_039                 1.418118e-03 3 1  ON 88
ci_040                -2.651135e-03 3 1  ON 89
ci_041                 8.416125e-03 3 1  ON 90
ci_042                 8.444752e-03 3 1  ON 91
ci_043                -3.610955e-03 3 1  ON 92
ci_044                -4.081327e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635144e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2
    reference variance = 0.183486
====================================================
  Execution time = 2.7428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8695e-01
  Total weights = 1.9663e+06
  Execution time = 2.3150e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820007052
                                         uncertainty =       0.001642516985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820007052
                                         uncertainty =       0.001642516985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371442437
  error estimate for blocks of size 2^( 2) =       0.000385793883
  error estimate for blocks of size 2^( 3) =       0.000398756476
  error estimate for blocks of size 2^( 4) =       0.000408002206
  error estimate for blocks of size 2^( 5) =       0.000413503165
  error estimate for blocks of size 2^( 6) =       0.000414674084
  error estimate for blocks of size 2^( 7) =       0.000415728709

      target function =      -0.933256455183
              le_mean =     -17.209941330621
             les_mean =     296.469032399805
             stat err =       0.000412977041
             autocorr =       1.236143177696
   target nu stat err =       0.000412977041
   target dn stat err =       0.002523087475
      target stat err =       0.004232521821
              std dev =       0.525307336878
             le_variance =       0.275947798177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820006593
                                         uncertainty =       0.001642517879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820006593
                                         uncertainty =       0.001642517879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371442437
  error estimate for blocks of size 2^( 2) =       0.000385793883
  error estimate for blocks of size 2^( 3) =       0.000398756476
  error estimate for blocks of size 2^( 4) =       0.000408002206
  error estimate for blocks of size 2^( 5) =       0.000413503164
  error estimate for blocks of size 2^( 6) =       0.000414674081
  error estimate for blocks of size 2^( 7) =       0.000415728707

      target function =      -0.933256360714
              le_mean =     -17.209941330465
             les_mean =     296.469032451432
             stat err =       0.000412977039
             autocorr =       1.236143170342
   target nu stat err =       0.000412977039
   target dn stat err =       0.002523108470
      target stat err =       0.004232555145
              std dev =       0.525307336426
             le_variance =       0.275947797703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820006822
                                         uncertainty =       0.001642517432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820006822
                                         uncertainty =       0.001642517432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371442437
  error estimate for blocks of size 2^( 2) =       0.000385793883
  error estimate for blocks of size 2^( 3) =       0.000398756476
  error estimate for blocks of size 2^( 4) =       0.000408002206
  error estimate for blocks of size 2^( 5) =       0.000413503165
  error estimate for blocks of size 2^( 6) =       0.000414674082
  error estimate for blocks of size 2^( 7) =       0.000415728708

      target function =      -0.933256407952
              le_mean =     -17.209941330543
             les_mean =     296.469032425616
             stat err =       0.000412977040
             autocorr =       1.236143174014
   target nu stat err =       0.000412977040
   target dn stat err =       0.002523097972
      target stat err =       0.004232538483
              std dev =       0.525307336651
             le_variance =       0.275947797940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820007023
                                         uncertainty =       0.001642517041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275820007023
                                         uncertainty =       0.001642517041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371442437
  error estimate for blocks of size 2^( 2) =       0.000385793883
  error estimate for blocks of size 2^( 3) =       0.000398756476
  error estimate for blocks of size 2^( 4) =       0.000408002206
  error estimate for blocks of size 2^( 5) =       0.000413503165
  error estimate for blocks of size 2^( 6) =       0.000414674083
  error estimate for blocks of size 2^( 7) =       0.000415728709

      target function =      -0.933256449280
              le_mean =     -17.209941330611
             les_mean =     296.469032403031
             stat err =       0.000412977041
             autocorr =       1.236143177225
   target nu stat err =       0.000412977041
   target dn stat err =       0.002523088787
      target stat err =       0.004232523904
              std dev =       0.525307336849
             le_variance =       0.275947798148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933256455183        initial  <--
     2.5000e+03     2.5000e+04             1.1627e-07        -0.933256360714
     1.0000e+04     1.0000e+05             2.9068e-08        -0.933256407952
     4.0000e+04     4.0000e+05             7.2669e-09        -0.933256449280

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1563
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673911e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793397e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1066
    reference variance = 0.226622
====================================================
  Execution time = 2.7648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0464e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9214e-01
  Total weights = 1.966214569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3881e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281249477080
                                         uncertainty =       0.002115200938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281249477080
                                         uncertainty =       0.002115200938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375023782
  error estimate for blocks of size 2^( 2) =       0.000389372346
  error estimate for blocks of size 2^( 3) =       0.000402386196
  error estimate for blocks of size 2^( 4) =       0.000413027232
  error estimate for blocks of size 2^( 5) =       0.000419013642
  error estimate for blocks of size 2^( 6) =       0.000421247809
  error estimate for blocks of size 2^( 7) =       0.000423698411

      target function =      -0.924757116954
              le_mean =     -17.209970718432
             les_mean =     296.475231809842
             stat err =       0.000419246774
             autocorr =       1.249746246622
   target nu stat err =       0.000419246774
   target dn stat err =       0.002819227869
      target stat err =       0.004632781386
              std dev =       0.530372203930
             le_variance =       0.281294674702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720997071843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924779122406       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924779124071       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924779124465       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924779124633       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924779124671       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924779124758       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924779124753       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924779124761       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924779124772       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924779124826       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924779124796       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924779124839       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924779124798       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924779124862       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924779124806       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924779124839       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924779124843       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924779124818       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924779124834       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924779124830       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924779124878       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924779124871       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924779124865       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924779124781       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924779124858       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924779124792       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924779124752       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924779124860       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924779124888       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924779124823       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924779124792       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924779124890       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924779124925       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924779124766       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924779124850       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924779124827       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924779124847       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924779124819       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.924779124842       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.924779124889       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.924779124859       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.924779124931       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+04 is 1.752393e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924779122406       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924779122822       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924779122921       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924779122997       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924779123082       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924779122914       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924779122926       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924779122903       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924779123045       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924779122945       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924779122930       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924779123178       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924779122990       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924779122980       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924779123165       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924779122952       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924779123082       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924779123138       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924779123055       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924779123138       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924779123034       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924779122878       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924779122879       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924779123047       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924779123140       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924779122934       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924779122853       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924779122848       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924779123147       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924779122744       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924779123466       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924779123123       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924779122665       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924779122788       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924779123150       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924779123162       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924779122989       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924779123166       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.924779123134       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.924779122934       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.924779122640       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.924779123418       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+05 is 4.380986e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924779122406       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924779122510       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924779122535       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924779122570       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924779122549       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924779122568       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924779121627       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924779122805       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924779122089       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924779122550       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924779123121       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924779122403       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924779121571       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924779122920       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924779122307       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924779123423       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924779122499       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924779122306       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924779123390       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924779122221       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924779122093       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924779122598       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924779122545       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924779123196       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924779122272       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924779123184       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924779121959       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924779122073       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924779121956       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924779122656       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924779121344       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924779121495       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924779122092       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924779121130       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924779123357       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924779122445       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924779122197       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924779124174       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.924779122248       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.924779121043       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.924779121893       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.924779123185       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+05 is 1.095247e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.550649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6124e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799800e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314235e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698428e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055236e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556963e-03 3 1  ON 73
ci_025                 6.349903e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268798e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416126e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081331e-03 3 1  ON 93
ci_045                -2.796279e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635141e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2904
    reference variance = 0.245756
====================================================
  Execution time = 2.7511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8737e-01
  Total weights = 1.9665e+06
  Execution time = 2.3243e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589143790
                                         uncertainty =       0.002072722589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589143790
                                         uncertainty =       0.002072722589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372558731
  error estimate for blocks of size 2^( 2) =       0.000386775273
  error estimate for blocks of size 2^( 3) =       0.000399771430
  error estimate for blocks of size 2^( 4) =       0.000409622237
  error estimate for blocks of size 2^( 5) =       0.000415035126
  error estimate for blocks of size 2^( 6) =       0.000418249084
  error estimate for blocks of size 2^( 7) =       0.000421036194

      target function =      -0.932565329816
              le_mean =     -17.209712687822
             les_mean =     296.461580108491
             stat err =       0.000415985660
             autocorr =       1.246715127692
   target nu stat err =       0.000415985660
   target dn stat err =       0.003034910365
      target stat err =       0.005058795675
              std dev =       0.526886039686
             le_variance =       0.277608898816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589146467
                                         uncertainty =       0.002072722511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589146467
                                         uncertainty =       0.002072722511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372558732
  error estimate for blocks of size 2^( 2) =       0.000386775275
  error estimate for blocks of size 2^( 3) =       0.000399771432
  error estimate for blocks of size 2^( 4) =       0.000409622241
  error estimate for blocks of size 2^( 5) =       0.000415035129
  error estimate for blocks of size 2^( 6) =       0.000418249088
  error estimate for blocks of size 2^( 7) =       0.000421036197

      target function =      -0.932565328367
              le_mean =     -17.209712687764
             les_mean =     296.461580107372
             stat err =       0.000415985664
             autocorr =       1.246715137028
   target nu stat err =       0.000415985664
   target dn stat err =       0.003034910680
      target stat err =       0.005058796174
              std dev =       0.526886042224
             le_variance =       0.277608901490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589145129
                                         uncertainty =       0.002072722550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589145129
                                         uncertainty =       0.002072722550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372558732
  error estimate for blocks of size 2^( 2) =       0.000386775274
  error estimate for blocks of size 2^( 3) =       0.000399771431
  error estimate for blocks of size 2^( 4) =       0.000409622239
  error estimate for blocks of size 2^( 5) =       0.000415035127
  error estimate for blocks of size 2^( 6) =       0.000418249086
  error estimate for blocks of size 2^( 7) =       0.000421036195

      target function =      -0.932565329093
              le_mean =     -17.209712687793
             les_mean =     296.461580107931
             stat err =       0.000415985662
             autocorr =       1.246715132357
   target nu stat err =       0.000415985662
   target dn stat err =       0.003034910523
      target stat err =       0.005058795925
              std dev =       0.526886040955
             le_variance =       0.277608900153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589143958
                                         uncertainty =       0.002072722584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277589143958
                                         uncertainty =       0.002072722584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372558731
  error estimate for blocks of size 2^( 2) =       0.000386775273
  error estimate for blocks of size 2^( 3) =       0.000399771430
  error estimate for blocks of size 2^( 4) =       0.000409622238
  error estimate for blocks of size 2^( 5) =       0.000415035126
  error estimate for blocks of size 2^( 6) =       0.000418249084
  error estimate for blocks of size 2^( 7) =       0.000421036194

      target function =      -0.932565329726
              le_mean =     -17.209712687819
             les_mean =     296.461580108421
             stat err =       0.000415985660
             autocorr =       1.246715128274
   target nu stat err =       0.000415985660
   target dn stat err =       0.003034910385
      target stat err =       0.005058795706
              std dev =       0.526886039845
             le_variance =       0.277608898983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932565329816        initial  <--
     2.5000e+04     2.5000e+05             1.7524e-08        -0.932565328367
     1.0000e+05     1.0000e+06             4.3810e-09        -0.932565329093
     4.0000e+05     4.0000e+06             1.0952e-09        -0.932565329726

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2916
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673911e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793397e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1839
    reference variance = 0.183723
====================================================
  Execution time = 2.7775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8625e-01
  Total weights = 1.966618200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4787e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277042372903
                                         uncertainty =       0.001390746448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277042372903
                                         uncertainty =       0.001390746448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372140322
  error estimate for blocks of size 2^( 2) =       0.000386408142
  error estimate for blocks of size 2^( 3) =       0.000399535074
  error estimate for blocks of size 2^( 4) =       0.000409175945
  error estimate for blocks of size 2^( 5) =       0.000414470214
  error estimate for blocks of size 2^( 6) =       0.000416771907
  error estimate for blocks of size 2^( 7) =       0.000416947081

      target function =      -0.934434657764
              le_mean =     -17.209649209968
             les_mean =     296.458274157182
             stat err =       0.000414341287
             autocorr =       1.239661068512
   target nu stat err =       0.000414341287
   target dn stat err =       0.002013652003
      target stat err =       0.003413554187
              std dev =       0.526294311142
             le_variance =       0.276985701940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720964920997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934446016963       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934446017059       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934446017081       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934446017087       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934446017098       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934446017083       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934446016997       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934446016989       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934446017140       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934446016987       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934446017328       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934446017128       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934446016915       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934446017344       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934446017346       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934446017321       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934446017142       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934446017350       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934446016986       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934446016430       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934446018313       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934446016569       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934446016517       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934446016465       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934446017705       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934446017099       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934446017066       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934446017269       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934446016879       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934446016537       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934446017728       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934446017613       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934446016986       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934446016833       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934446017406       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934446017343       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934446016996       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934446016658       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934446016334       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934446017012       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934446016202       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934446017548       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934446016189       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934446016435       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+05 is 2.155795e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934446016963       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934446016987       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934446016992       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934446016994       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934446017157       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934446017088       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934446015282       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934446017052       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934446017261       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934446016403       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934446017936       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934446014724       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934446019093       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934446017392       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934446015534       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934446016439       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934446016239       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934446017023       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934446016599       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934446015610       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934446018031       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934446014014       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934446015429       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934446017296       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934446013172       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934446017571       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934446017767       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934446017749       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934446020636       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934446016617       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934446019893       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934446017353       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934446012556       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934446017013       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934446019330       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934446014835       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934446019626       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934446017721       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934446019171       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934446011710       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934446012255       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934446016093       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934446017493       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934446012348       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+06 is 5.389486e-10

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934446016963       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934446016969       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934446016970       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934446017192       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934446018017       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934446006490       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934446016971       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934446022374       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934446020350       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934446017445       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934446016971       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934446033630       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934446011523       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934446019082       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934446019110       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934446023719       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934445997712       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934446022324       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934446011845       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934446016393       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934446016953       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934446009143       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934446012156       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934446028793       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934446010517       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934446001456       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934446021010       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934446013029       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934446017611       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934446021944       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934446018637       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934446012053       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934446011005       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934446026337       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934446008276       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934446009197       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934446019045       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934446029759       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934446021373       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934446022631       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934446003969       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934446017781       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934446038426       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934445993971       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+06 is 1.347375e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.641449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6352e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673911e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793397e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776766e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.286
    reference variance = 0.165813
====================================================
  Execution time = 2.7210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9058e-01
  Total weights = 1.9664e+06
  Execution time = 2.3273e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594222
                                         uncertainty =       0.002121075948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594222
                                         uncertainty =       0.002121075948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473845
  error estimate for blocks of size 2^( 2) =       0.000388584771
  error estimate for blocks of size 2^( 3) =       0.000401444508
  error estimate for blocks of size 2^( 4) =       0.000410760535
  error estimate for blocks of size 2^( 5) =       0.000416581875
  error estimate for blocks of size 2^( 6) =       0.000418426508
  error estimate for blocks of size 2^( 7) =       0.000421051420

      target function =      -0.927254412921
              le_mean =     -17.210752701824
             les_mean =     296.500592721182
             stat err =       0.000416705085
             autocorr =       1.238267915595
   target nu stat err =       0.000416705085
   target dn stat err =       0.002888066656
      target stat err =       0.004774829473
              std dev =       0.529594463535
             le_variance =       0.280470295807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594233
                                         uncertainty =       0.002121075966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594233
                                         uncertainty =       0.002121075966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473845
  error estimate for blocks of size 2^( 2) =       0.000388584771
  error estimate for blocks of size 2^( 3) =       0.000401444508
  error estimate for blocks of size 2^( 4) =       0.000410760536
  error estimate for blocks of size 2^( 5) =       0.000416581876
  error estimate for blocks of size 2^( 6) =       0.000418426508
  error estimate for blocks of size 2^( 7) =       0.000421051420

      target function =      -0.927254413107
              le_mean =     -17.210752701825
             les_mean =     296.500592721090
             stat err =       0.000416705085
             autocorr =       1.238267916618
   target nu stat err =       0.000416705085
   target dn stat err =       0.002888066723
      target stat err =       0.004774829583
              std dev =       0.529594463547
             le_variance =       0.280470295819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594227
                                         uncertainty =       0.002121075957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594227
                                         uncertainty =       0.002121075957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473845
  error estimate for blocks of size 2^( 2) =       0.000388584771
  error estimate for blocks of size 2^( 3) =       0.000401444508
  error estimate for blocks of size 2^( 4) =       0.000410760536
  error estimate for blocks of size 2^( 5) =       0.000416581876
  error estimate for blocks of size 2^( 6) =       0.000418426508
  error estimate for blocks of size 2^( 7) =       0.000421051420

      target function =      -0.927254413014
              le_mean =     -17.210752701824
             les_mean =     296.500592721136
             stat err =       0.000416705085
             autocorr =       1.238267916103
   target nu stat err =       0.000416705085
   target dn stat err =       0.002888066689
      target stat err =       0.004774829528
              std dev =       0.529594463541
             le_variance =       0.280470295813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594222
                                         uncertainty =       0.002121075949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280347594222
                                         uncertainty =       0.002121075949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473845
  error estimate for blocks of size 2^( 2) =       0.000388584771
  error estimate for blocks of size 2^( 3) =       0.000401444508
  error estimate for blocks of size 2^( 4) =       0.000410760535
  error estimate for blocks of size 2^( 5) =       0.000416581876
  error estimate for blocks of size 2^( 6) =       0.000418426508
  error estimate for blocks of size 2^( 7) =       0.000421051420

      target function =      -0.927254412933
              le_mean =     -17.210752701824
             les_mean =     296.500592721176
             stat err =       0.000416705085
             autocorr =       1.238267915659
   target nu stat err =       0.000416705085
   target dn stat err =       0.002888066660
      target stat err =       0.004774829479
              std dev =       0.529594463536
             le_variance =       0.280470295808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927254412921        initial
     2.5000e+05     2.5000e+06             2.1558e-09        -0.927254413107  <--
     1.0000e+06     1.0000e+07             5.3895e-10        -0.927254413014
     4.0000e+06     4.0000e+07             1.3474e-10        -0.927254412933

*****************************************************************************
Applying the update for shift_i =   2.5000e+05     and shift_s =   2.5000e+06
*****************************************************************************

  Execution time = 3.9013e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.337808
====================================================
  Execution time = 2.9670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0504e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8896e-01
  Total weights = 1.966472426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2118e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279465849079
                                         uncertainty =       0.002420235512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279465849079
                                         uncertainty =       0.002420235512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775129
  error estimate for blocks of size 2^( 2) =       0.000388475562
  error estimate for blocks of size 2^( 3) =       0.000401488764
  error estimate for blocks of size 2^( 4) =       0.000410151591
  error estimate for blocks of size 2^( 5) =       0.000415646453
  error estimate for blocks of size 2^( 6) =       0.000418578325
  error estimate for blocks of size 2^( 7) =       0.000419834047

      target function =      -0.929957357567
              le_mean =     -17.209309483585
             les_mean =     296.449293923000
             stat err =       0.000416052604
             autocorr =       1.239012502065
   target nu stat err =       0.000416052604
   target dn stat err =       0.003251085794
      target stat err =       0.005377739153
              std dev =       0.528606314555
             le_variance =       0.279424635787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720930948358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929987487758       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929987488775       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929987488891       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929987488969       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929987489003       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929987489049       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929987489058       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929987489091       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929987489072       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929987489072       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929987488880       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929987488985       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929987489029       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929987489013       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929987488923       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929987489111       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929987489039       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929987488870       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929987489096       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929987489199       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929987489042       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929987488992       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929987488960       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929987488941       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929987489244       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929987488870       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929987488946       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929987489361       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929987489303       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929987488944       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929987488773       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929987489116       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929987488898       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929987488871       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929987489020       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929987488764       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929987488792       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929987489182       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929987488980       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929987489106       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929987488981       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929987488957       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929987489038       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929987489029       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929987488981       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+04 is 6.636180e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929987487758       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929987488012       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929987488042       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929987487957       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929987488139       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929987487955       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929987486900       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929987487473       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929987487394       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929987488117       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929987487506       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929987487884       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929987488302       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929987488076       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929987487601       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929987488098       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929987488003       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929987487978       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929987487532       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929987488604       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929987487826       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929987487698       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929987486874       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929987487271       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929987488231       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929987487340       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929987488772       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929987487973       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929987487518       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929987487772       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929987487889       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929987488720       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929987488223       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929987487233       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929987487759       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929987488216       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929987487797       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929987488386       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929987488757       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929987487865       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929987488756       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929987487962       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929987488100       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929987486508       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929987488237       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+05 is 1.659046e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929987487758       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929987487822       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929987487829       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929987488214       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929987488079       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929987487995       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929987486770       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929987490286       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929987488243       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929987487008       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929987488232       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929987486451       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929987489071       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929987488523       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929987488911       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929987487123       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929987486873       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929987489771       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929987485766       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929987490991       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929987486148       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929987485451       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929987486801       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929987484039       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929987473083       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929987484117       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929987491013       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929987489016       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929987486497       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929987483225       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929987488125       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929987484870       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929987487582       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929987486247       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929987488456       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929987481380       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929987485161       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929987488790       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929987491168       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929987487497       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929987485810       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929987487816       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929987488067       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929987487686       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929987479204       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+06 is 4.147609e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.737285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7985e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799800e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314235e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416128e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796279e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1175
    reference variance = 0.167745
====================================================
  Execution time = 2.7259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8538e-01
  Total weights = 1.9666e+06
  Execution time = 2.3334e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396945
                                         uncertainty =       0.001570138523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396945
                                         uncertainty =       0.001570138523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370782893
  error estimate for blocks of size 2^( 2) =       0.000384780100
  error estimate for blocks of size 2^( 3) =       0.000397848810
  error estimate for blocks of size 2^( 4) =       0.000407813527
  error estimate for blocks of size 2^( 5) =       0.000413388105
  error estimate for blocks of size 2^( 6) =       0.000416637646
  error estimate for blocks of size 2^( 7) =       0.000417444556

      target function =      -0.935881733134
              le_mean =     -17.209188634804
             les_mean =     296.441550607284
             stat err =       0.000413820959
             autocorr =       1.245620045667
   target nu stat err =       0.000413820959
   target dn stat err =       0.002557646662
      target stat err =       0.004306696840
              std dev =       0.524374585070
             le_variance =       0.274968705468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396200
                                         uncertainty =       0.001570138453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396200
                                         uncertainty =       0.001570138453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370782892
  error estimate for blocks of size 2^( 2) =       0.000384780100
  error estimate for blocks of size 2^( 3) =       0.000397848810
  error estimate for blocks of size 2^( 4) =       0.000407813527
  error estimate for blocks of size 2^( 5) =       0.000413388105
  error estimate for blocks of size 2^( 6) =       0.000416637646
  error estimate for blocks of size 2^( 7) =       0.000417444557

      target function =      -0.935881732235
              le_mean =     -17.209188634804
             les_mean =     296.441550607819
             stat err =       0.000413820959
             autocorr =       1.245620050326
   target nu stat err =       0.000413820959
   target dn stat err =       0.002557647726
      target stat err =       0.004306698571
              std dev =       0.524374584360
             le_variance =       0.274968704723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396573
                                         uncertainty =       0.001570138488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396573
                                         uncertainty =       0.001570138488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370782892
  error estimate for blocks of size 2^( 2) =       0.000384780100
  error estimate for blocks of size 2^( 3) =       0.000397848810
  error estimate for blocks of size 2^( 4) =       0.000407813527
  error estimate for blocks of size 2^( 5) =       0.000413388105
  error estimate for blocks of size 2^( 6) =       0.000416637646
  error estimate for blocks of size 2^( 7) =       0.000417444557

      target function =      -0.935881732685
              le_mean =     -17.209188634804
             les_mean =     296.441550607552
             stat err =       0.000413820959
             autocorr =       1.245620048004
   target nu stat err =       0.000413820959
   target dn stat err =       0.002557647194
      target stat err =       0.004306697705
              std dev =       0.524374584715
             le_variance =       0.274968705095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396899
                                         uncertainty =       0.001570138519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274900396899
                                         uncertainty =       0.001570138519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370782892
  error estimate for blocks of size 2^( 2) =       0.000384780100
  error estimate for blocks of size 2^( 3) =       0.000397848810
  error estimate for blocks of size 2^( 4) =       0.000407813527
  error estimate for blocks of size 2^( 5) =       0.000413388105
  error estimate for blocks of size 2^( 6) =       0.000416637646
  error estimate for blocks of size 2^( 7) =       0.000417444556

      target function =      -0.935881733078
              le_mean =     -17.209188634804
             les_mean =     296.441550607317
             stat err =       0.000413820959
             autocorr =       1.245620045948
   target nu stat err =       0.000413820959
   target dn stat err =       0.002557646729
      target stat err =       0.004306696948
              std dev =       0.524374585026
             le_variance =       0.274968705421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935881733134        initial  <--
     6.2500e+04     6.2500e+05             6.6362e-09        -0.935881732235
     2.5000e+05     2.5000e+06             1.6590e-09        -0.935881732685
     1.0000e+06     1.0000e+07             4.1476e-10        -0.935881733078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0201
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1656
    reference variance = 0.176636
====================================================
  Execution time = 2.7382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9188e-01
  Total weights = 1.966447959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3835e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281653039188
                                         uncertainty =       0.004635677635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281653039188
                                         uncertainty =       0.004635677635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375243700
  error estimate for blocks of size 2^( 2) =       0.000389616081
  error estimate for blocks of size 2^( 3) =       0.000402581633
  error estimate for blocks of size 2^( 4) =       0.000412554416
  error estimate for blocks of size 2^( 5) =       0.000418150341
  error estimate for blocks of size 2^( 6) =       0.000420689670
  error estimate for blocks of size 2^( 7) =       0.000422750681

      target function =      -0.925146241028
              le_mean =     -17.209781540901
             les_mean =     296.468455771867
             stat err =       0.000418536277
             autocorr =       1.244054465391
   target nu stat err =       0.000418536277
   target dn stat err =       0.004975825026
      target stat err =       0.008110594751
              std dev =       0.530683220454
             le_variance =       0.281624680471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720978154090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925216739058       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925216739141       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925216739171       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925216739188       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925216739247       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925216738443       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925216739219       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925216737625       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925216737738       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925216738616       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925216739074       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925216737207       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925216739628       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925216737640       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925216738845       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925216737962       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925216740738       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925216737021       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925216739746       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925216740174       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925216739546       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925216736648       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925216739721       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925216739728       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925216736740       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925216738120       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.925216739867       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.925216737982       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.925216739561       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.925216737471       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925216740977       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925216740551       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.925216738201       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925216739809       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925216740043       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.925216740275       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.925216738886       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925216737917       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925216739415       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.925216738720       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925216738743       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925216737626       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.925216740118       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925216734797       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.925216736914       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.925216737531       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925216738807       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.925216735617       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.925216737377       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+05 is 2.661909e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925216739058       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925216739079       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925216739086       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925216739091       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925216739093       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925216739095       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925216739096       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925216739098       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925216739099       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925216741886       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925216740648       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925216735780       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925216739102       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925216736622       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925216731901       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925216736752       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925216742503       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925216746422       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925216721008       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925216740359       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925216750359       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925216744771       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925216733104       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925216740229       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925216734019       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925216724394       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.925216742285       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.925216744157       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.925216735846       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.925216743166       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925216743428       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925216738754       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.925216745321       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925216730691       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925216747660       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.925216738746       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.925216740951       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925216739977       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925216738593       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.925216739588       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925216736111       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925216744487       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.925216741248       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925216728986       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.925216743360       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.925216731742       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925216719615       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.925216729278       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.925216731575       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+06 is 6.654772e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925216739058       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925216739063       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925216739065       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925216739066       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925216740670       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925216739067       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925216739068       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925216742083       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925216736631       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925216726323       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925216739069       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925216742545       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925216753632       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925216736888       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925216738044       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925216760172       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925216746672       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925216709536       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925216724022       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925216762896       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925216746921       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925216708428       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925216765143       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925216700899       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925216716057       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925216760800       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.925216753000       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.925216744470       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.925216720701       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.925216734945       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925216750541       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925216729650       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.925216744307       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925216753444       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925216760837       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.925216743931       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.925216741686       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925216746478       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925216714008       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.925216698979       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925216716442       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925216702740       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.925216787820       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925216693834       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.925216729986       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.925216761053       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925216730693       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.925216678956       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.925216752247       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+07 is 1.663689e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.860150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5896e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314233e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556963e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2597
    reference variance = 0.441917
====================================================
  Execution time = 2.7467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8227e-01
  Total weights = 1.9662e+06
  Execution time = 2.3213e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263635
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263635
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369687381
  error estimate for blocks of size 2^( 2) =       0.000384429613
  error estimate for blocks of size 2^( 3) =       0.000398094712
  error estimate for blocks of size 2^( 4) =       0.000408280121
  error estimate for blocks of size 2^( 5) =       0.000413257525
  error estimate for blocks of size 2^( 6) =       0.000416035096
  error estimate for blocks of size 2^( 7) =       0.000418685252

      target function =      -0.941072019524
              le_mean =     -17.209803695074
             les_mean =     296.459610451616
             stat err =       0.000414064499
             autocorr =       1.254488659846
   target nu stat err =       0.000414064499
   target dn stat err =       0.001830051105
      target stat err =       0.003161407517
              std dev =       0.522825272747
             le_variance =       0.273346265823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263644
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263644
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369687381
  error estimate for blocks of size 2^( 2) =       0.000384429613
  error estimate for blocks of size 2^( 3) =       0.000398094712
  error estimate for blocks of size 2^( 4) =       0.000408280121
  error estimate for blocks of size 2^( 5) =       0.000413257525
  error estimate for blocks of size 2^( 6) =       0.000416035096
  error estimate for blocks of size 2^( 7) =       0.000418685252

      target function =      -0.941072019182
              le_mean =     -17.209803695073
             les_mean =     296.459610451792
             stat err =       0.000414064499
             autocorr =       1.254488660506
   target nu stat err =       0.000414064499
   target dn stat err =       0.001830051124
      target stat err =       0.003161407545
              std dev =       0.522825272756
             le_variance =       0.273346265832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263640
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263640
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369687381
  error estimate for blocks of size 2^( 2) =       0.000384429613
  error estimate for blocks of size 2^( 3) =       0.000398094712
  error estimate for blocks of size 2^( 4) =       0.000408280121
  error estimate for blocks of size 2^( 5) =       0.000413257525
  error estimate for blocks of size 2^( 6) =       0.000416035096
  error estimate for blocks of size 2^( 7) =       0.000418685252

      target function =      -0.941072019353
              le_mean =     -17.209803695074
             les_mean =     296.459610451704
             stat err =       0.000414064499
             autocorr =       1.254488660174
   target nu stat err =       0.000414064499
   target dn stat err =       0.001830051114
      target stat err =       0.003161407531
              std dev =       0.522825272751
             le_variance =       0.273346265827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263636
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273230263636
                                         uncertainty =       0.001431661130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369687381
  error estimate for blocks of size 2^( 2) =       0.000384429613
  error estimate for blocks of size 2^( 3) =       0.000398094712
  error estimate for blocks of size 2^( 4) =       0.000408280121
  error estimate for blocks of size 2^( 5) =       0.000413257525
  error estimate for blocks of size 2^( 6) =       0.000416035096
  error estimate for blocks of size 2^( 7) =       0.000418685252

      target function =      -0.941072019502
              le_mean =     -17.209803695074
             les_mean =     296.459610451627
             stat err =       0.000414064499
             autocorr =       1.254488659891
   target nu stat err =       0.000414064499
   target dn stat err =       0.001830051106
      target stat err =       0.003161407519
              std dev =       0.522825272747
             le_variance =       0.273346265823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941072019524        initial  <--
     6.2500e+05     6.2500e+06             2.6619e-09        -0.941072019182
     2.5000e+06     2.5000e+07             6.6548e-10        -0.941072019353
     1.0000e+07     1.0000e+08             1.6637e-10        -0.941072019502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2252
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.188941
====================================================
  Execution time = 2.7472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0454e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8602e-01
  Total weights = 1.966419567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3562e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277364174982
                                         uncertainty =       0.001768667551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277364174982
                                         uncertainty =       0.001768667551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372356830
  error estimate for blocks of size 2^( 2) =       0.000386528753
  error estimate for blocks of size 2^( 3) =       0.000399711341
  error estimate for blocks of size 2^( 4) =       0.000408869821
  error estimate for blocks of size 2^( 5) =       0.000415054895
  error estimate for blocks of size 2^( 6) =       0.000417730100
  error estimate for blocks of size 2^( 7) =       0.000418463384

      target function =      -0.934767716804
              le_mean =     -17.211007753816
             les_mean =     296.504809735984
             stat err =       0.000415029550
             autocorr =       1.242336913078
   target nu stat err =       0.000415029550
   target dn stat err =       0.002401229739
      target stat err =       0.004056075042
              std dev =       0.526600504783
             le_variance =       0.277308091637


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721100775382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934784355462       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934784355468       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934784355469       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934784355469       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934784355408       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934784352133       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934784360106       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934784335155       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934784358076       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934784356538       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934784359865       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934784347383       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934784351646       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934784352097       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934784352598       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934784338073       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934784349907       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934784360381       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934784354838       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934784353703       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934784346867       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934784346992       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934784328450       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934784369008       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934784370972       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934784366063       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934784347946       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934784360727       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934784374770       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934784359960       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934784367575       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934784356831       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934784336032       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934784350606       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934784335114       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934784352004       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934784356280       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934784344587       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934784371195       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934784325096       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+06 is 5.186846e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934784355462       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934784355463       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934784355464       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934784355464       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934784353005       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934784367109       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934784303673       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934784328702       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934784384180       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934784275638       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934784357942       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934784386694       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934784309616       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934784358773       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934784328905       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934784380343       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934784358727       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934784395529       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934784370932       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934784337782       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934784390638       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934784388399       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934784300325       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934784370731       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934784392219       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934784320229       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934784371998       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934784336671       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934784386938       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934784374237       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934784444568       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934784384644       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934784413325       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934784370613       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934784320190       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934784382979       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934784386383       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934784424923       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934784319391       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934784336824       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+07 is 1.296740e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934784355462       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934784355462       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934784355462       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934784355462       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934784355345       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934784296583       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934784301984       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934784378327       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934784237858       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934784262728       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934784130267       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934784540491       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934784379752       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934784377186       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934784399758       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934784316352       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934784225881       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934784277344       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934784203024       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934784576776       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934784391329       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934784412925       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934784449548       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934784266862       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934784168868       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934784147395       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934784294244       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934784662671       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934784665483       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934784392199       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934784306916       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934784227260       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934784573348       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934784274185       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934784223878       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934784226803       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934784129373       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934784377727       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934784659506       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934784275160       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+08 is 3.241567e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.930386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5906e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1746
    reference variance = 0.248021
====================================================
  Execution time = 2.7447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8309e-01
  Total weights = 1.9666e+06
  Execution time = 2.3280e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798150
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798150
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370434721
  error estimate for blocks of size 2^( 2) =       0.000384358353
  error estimate for blocks of size 2^( 3) =       0.000397812325
  error estimate for blocks of size 2^( 4) =       0.000407491446
  error estimate for blocks of size 2^( 5) =       0.000413156587
  error estimate for blocks of size 2^( 6) =       0.000415237086
  error estimate for blocks of size 2^( 7) =       0.000416702246

      target function =      -0.939677659633
              le_mean =     -17.210022746867
             les_mean =     296.467974498039
             stat err =       0.000413146841
             autocorr =       1.243900097252
   target nu stat err =       0.000413146841
   target dn stat err =       0.002477953058
      target stat err =       0.004216331752
              std dev =       0.523882187748
             le_variance =       0.274452546640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798147
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798147
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370434721
  error estimate for blocks of size 2^( 2) =       0.000384358353
  error estimate for blocks of size 2^( 3) =       0.000397812325
  error estimate for blocks of size 2^( 4) =       0.000407491446
  error estimate for blocks of size 2^( 5) =       0.000413156587
  error estimate for blocks of size 2^( 6) =       0.000415237086
  error estimate for blocks of size 2^( 7) =       0.000416702246

      target function =      -0.939677659574
              le_mean =     -17.210022746867
             les_mean =     296.467974498068
             stat err =       0.000413146841
             autocorr =       1.243900097284
   target nu stat err =       0.000413146841
   target dn stat err =       0.002477953061
      target stat err =       0.004216331757
              std dev =       0.523882187746
             le_variance =       0.274452546637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798148
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798148
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370434721
  error estimate for blocks of size 2^( 2) =       0.000384358353
  error estimate for blocks of size 2^( 3) =       0.000397812325
  error estimate for blocks of size 2^( 4) =       0.000407491446
  error estimate for blocks of size 2^( 5) =       0.000413156587
  error estimate for blocks of size 2^( 6) =       0.000415237086
  error estimate for blocks of size 2^( 7) =       0.000416702246

      target function =      -0.939677659603
              le_mean =     -17.210022746867
             les_mean =     296.467974498054
             stat err =       0.000413146841
             autocorr =       1.243900097272
   target nu stat err =       0.000413146841
   target dn stat err =       0.002477953059
      target stat err =       0.004216331754
              std dev =       0.523882187747
             le_variance =       0.274452546639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798150
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274492798150
                                         uncertainty =       0.001781263064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370434721
  error estimate for blocks of size 2^( 2) =       0.000384358353
  error estimate for blocks of size 2^( 3) =       0.000397812325
  error estimate for blocks of size 2^( 4) =       0.000407491446
  error estimate for blocks of size 2^( 5) =       0.000413156587
  error estimate for blocks of size 2^( 6) =       0.000415237086
  error estimate for blocks of size 2^( 7) =       0.000416702246

      target function =      -0.939677659629
              le_mean =     -17.210022746867
             les_mean =     296.467974498041
             stat err =       0.000413146841
             autocorr =       1.243900097256
   target nu stat err =       0.000413146841
   target dn stat err =       0.002477953058
      target stat err =       0.004216331752
              std dev =       0.523882187748
             le_variance =       0.274452546640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939677659633        initial  <--
     6.2500e+06     6.2500e+07             5.1868e-11        -0.939677659574
     2.5000e+07     2.5000e+08             1.2967e-11        -0.939677659603
     1.0000e+08     1.0000e+09             3.2416e-12        -0.939677659629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2251
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.253995
====================================================
  Execution time = 2.7170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9016e-01
  Total weights = 1.966631727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2384e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278841542988
                                         uncertainty =       0.002893485119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278841542988
                                         uncertainty =       0.002893485119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373396049
  error estimate for blocks of size 2^( 2) =       0.000387844475
  error estimate for blocks of size 2^( 3) =       0.000400875662
  error estimate for blocks of size 2^( 4) =       0.000409932140
  error estimate for blocks of size 2^( 5) =       0.000416050675
  error estimate for blocks of size 2^( 6) =       0.000417620884
  error estimate for blocks of size 2^( 7) =       0.000418601628

      target function =      -0.927961992089
              le_mean =     -17.209329283444
             les_mean =     296.451170870192
             stat err =       0.000415551332
             autocorr =       1.238539666122
   target nu stat err =       0.000415551332
   target dn stat err =       0.004966246550
      target stat err =       0.008136798130
              std dev =       0.528070206002
             le_variance =       0.278858142467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720932928344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928031831033       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928031831033       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928031831033       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928031829508       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928031829836       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928031795546       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928031877720       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928031866235       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928031774267       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928031933825       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928031769201       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928031791205       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928031659864       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928031830971       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928031698271       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928031841858       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928031809212       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928031865812       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928031816112       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928031700388       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928031782327       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928032001158       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928031398677       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928031709609       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928031906008       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928031945047       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928031878904       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928031463680       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928031876058       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928032042140       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928031721933       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928031669960       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928031828983       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928031872841       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928031739305       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928031870900       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928031717719       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928032069079       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928031853092       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928032052917       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928031902617       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+07 is 5.416546e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928031831033       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928031831033       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928031831033       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928031831033       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928031831033       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928031864337       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928031822476       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928031403525       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928031237775       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928031632508       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928031893808       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928031901362       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928031477255       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928031579498       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928031798211       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928031194086       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928031501784       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928031267741       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928031634335       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928031868962       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928033438303       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928031529486       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928033137270       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928031709242       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928030419436       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928032006237       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928032457636       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928031121865       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928032814933       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928031632058       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928032898164       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928031854340       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928031932142       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928032329995       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928032087573       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928031764425       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928032492663       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928032528180       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928031012783       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928031577768       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928031973284       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+08 is 1.355064e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928031831033       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928031831033       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928031831033       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928031831033       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928031864007       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928031719890       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928032866922       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928031713109       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928030921072       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928029340790       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928030073657       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928032948767       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928031716422       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928033569141       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928031582048       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928032461654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928031824249       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928032549671       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928030925595       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928031627160       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928033405432       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928032412873       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928035317700       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928029417156       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928029807265       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928031180341       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928033204241       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928030346834       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928031624047       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928031976287       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928034854928       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928030023376       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928029880408       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928030003780       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928030531865       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928028326498       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928034703357       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928034188090       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928030348830       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928030116159       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928029306570       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+09 is 3.386274e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.005651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5491e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.233828
====================================================
  Execution time = 2.7595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9176e-01
  Total weights = 1.9661e+06
  Execution time = 2.3167e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682201
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682201
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373593137
  error estimate for blocks of size 2^( 2) =       0.000387553410
  error estimate for blocks of size 2^( 3) =       0.000401014020
  error estimate for blocks of size 2^( 4) =       0.000410843947
  error estimate for blocks of size 2^( 5) =       0.000416736937
  error estimate for blocks of size 2^( 6) =       0.000418530845
  error estimate for blocks of size 2^( 7) =       0.000418802799

      target function =      -0.925337660670
              le_mean =     -17.210115159498
             les_mean =     296.479824270999
             stat err =       0.000416228632
             autocorr =       1.241269614286
   target nu stat err =       0.000416228632
   target dn stat err =       0.004247766082
      target stat err =       0.006941084865
              std dev =       0.528348934734
             le_variance =       0.279152596834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682203
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682203
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373593137
  error estimate for blocks of size 2^( 2) =       0.000387553410
  error estimate for blocks of size 2^( 3) =       0.000401014020
  error estimate for blocks of size 2^( 4) =       0.000410843947
  error estimate for blocks of size 2^( 5) =       0.000416736937
  error estimate for blocks of size 2^( 6) =       0.000418530845
  error estimate for blocks of size 2^( 7) =       0.000418802799

      target function =      -0.925337660667
              le_mean =     -17.210115159498
             les_mean =     296.479824271000
             stat err =       0.000416228632
             autocorr =       1.241269614291
   target nu stat err =       0.000416228632
   target dn stat err =       0.004247766083
      target stat err =       0.006941084866
              std dev =       0.528348934735
             le_variance =       0.279152596836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682202
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682202
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373593137
  error estimate for blocks of size 2^( 2) =       0.000387553410
  error estimate for blocks of size 2^( 3) =       0.000401014020
  error estimate for blocks of size 2^( 4) =       0.000410843947
  error estimate for blocks of size 2^( 5) =       0.000416736937
  error estimate for blocks of size 2^( 6) =       0.000418530845
  error estimate for blocks of size 2^( 7) =       0.000418802799

      target function =      -0.925337660669
              le_mean =     -17.210115159498
             les_mean =     296.479824271000
             stat err =       0.000416228632
             autocorr =       1.241269614280
   target nu stat err =       0.000416228632
   target dn stat err =       0.004247766083
      target stat err =       0.006941084866
              std dev =       0.528348934735
             le_variance =       0.279152596835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682201
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279174682201
                                         uncertainty =       0.002475563141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373593137
  error estimate for blocks of size 2^( 2) =       0.000387553410
  error estimate for blocks of size 2^( 3) =       0.000401014020
  error estimate for blocks of size 2^( 4) =       0.000410843947
  error estimate for blocks of size 2^( 5) =       0.000416736937
  error estimate for blocks of size 2^( 6) =       0.000418530845
  error estimate for blocks of size 2^( 7) =       0.000418802799

      target function =      -0.925337660670
              le_mean =     -17.210115159498
             les_mean =     296.479824270999
             stat err =       0.000416228632
             autocorr =       1.241269614280
   target nu stat err =       0.000416228632
   target dn stat err =       0.004247766082
      target stat err =       0.006941084866
              std dev =       0.528348934734
             le_variance =       0.279152596835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925337660670        initial  <--
     6.2500e+07     6.2500e+08             5.4165e-12        -0.925337660667
     2.5000e+08     2.5000e+09             1.3551e-12        -0.925337660669
     1.0000e+09     1.0000e+10             3.3863e-13        -0.925337660670

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3343
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2919
    reference variance = 0.171517
====================================================
  Execution time = 2.9933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8800e-01
  Total weights = 1.966342221e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3787e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276651185006
                                         uncertainty =       0.001748918210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276651185006
                                         uncertainty =       0.001748918210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371941238
  error estimate for blocks of size 2^( 2) =       0.000386400521
  error estimate for blocks of size 2^( 3) =       0.000399852602
  error estimate for blocks of size 2^( 4) =       0.000409522191
  error estimate for blocks of size 2^( 5) =       0.000415557103
  error estimate for blocks of size 2^( 6) =       0.000418760086
  error estimate for blocks of size 2^( 7) =       0.000423852269

      target function =      -0.931525602006
              le_mean =     -17.209525123058
             les_mean =     296.455759231057
             stat err =       0.000416922912
             autocorr =       1.256501065829
   target nu stat err =       0.000416922912
   target dn stat err =       0.003012010696
      target stat err =       0.005008823364
              std dev =       0.526012758693
             le_variance =       0.276689422307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720952512306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931551568732       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931551568732       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931551568732       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931551568732       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931551206520       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931551740718       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931551568732       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931549952398       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931551703809       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931551462938       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931550893166       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931551103716       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931551032703       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931551899758       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931550055126       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931551331451       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931552896860       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931551939343       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931552590192       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931549325136       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931547669594       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931554009825       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931552246767       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931549552018       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931548396691       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931552194395       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931551426347       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931551765177       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931553720995       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931551955376       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931553573395       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931553221014       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931551740103       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931549023097       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931551437467       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931551463847       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931550009457       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931551556028       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931550114965       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931553110037       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931551664989       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+08 is 6.729139e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931551568732       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931551568732       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931551568732       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931551568732       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931551568732       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931552663843       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931552947539       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931550886068       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931547908272       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931553218517       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931548440340       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931555354615       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931551752545       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931555975308       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931552039508       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931552540425       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931551465459       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931553273147       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931550988222       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931544062517       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931573517649       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931548622751       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931554444774       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931551610424       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931545333080       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931562400265       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931560229834       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931537072935       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931559581362       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931554180763       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931564119443       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931548160763       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931550248337       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931555989158       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931544516581       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931553143252       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931557999399       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931539526095       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931551649759       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931548729432       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931555565654       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931551758986       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+09 is 1.679025e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931551568732       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931551568732       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931551568732       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931548577778       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931552141384       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931549937928       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931556795148       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931547589047       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931536888103       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931562942850       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931559791893       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931548823120       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931538202384       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931560663490       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931570265059       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931522897209       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931571714622       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931563386999       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931531093011       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931542987946       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931551279195       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931551141870       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931582284685       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931525561837       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931546645497       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931548140553       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931544439196       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931509779911       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931568823817       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931565832364       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931547789001       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931546264079       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931559690827       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931576394769       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931552918436       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931489563524       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931529950735       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931532010182       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931583825637       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931502657810       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931507070174       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931561943424       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931539935809       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931546324521       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.931376467022       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.931429840302       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931585747716       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931673261228       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.931347670864       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.931464589735       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.931370121276       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931578943317       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.931553329118       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931464623080       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.931522267575       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.931448659878       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.931526392856       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.931488258344       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.931476050232       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.931629967516       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931755683552       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.931170046572       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931190708253       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.931526661863       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.931406313271       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.931811584309       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.931451572404       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.931545313964       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.931245369391       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.930875999209       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.930806746225       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.930917408738       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.931894968188       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.931578873741       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.931709782840       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.933485295372       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.933427117539       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.931790659370       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.929622891545       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.928930304657       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.931227702238       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.930501458321       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.934714307745       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.933208906468       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.924397146214       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.931146659036       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.934098874122       residual = 9.57e-04           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+10 is 4.189312e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.307162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8621e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1731
    reference variance = 0.190539
====================================================
  Execution time = 2.7234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8284e-01
  Total weights = 1.9667e+06
  Execution time = 2.3205e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370843503
  error estimate for blocks of size 2^( 2) =       0.000385440884
  error estimate for blocks of size 2^( 3) =       0.000399115556
  error estimate for blocks of size 2^( 4) =       0.000408726012
  error estimate for blocks of size 2^( 5) =       0.000414240688
  error estimate for blocks of size 2^( 6) =       0.000417772579
  error estimate for blocks of size 2^( 7) =       0.000420995228

      target function =      -0.940114500398
              le_mean =     -17.208956793856
             les_mean =     296.431034184808
             stat err =       0.000415433627
             autocorr =       1.254937059407
   target nu stat err =       0.000415433627
   target dn stat err =       0.002450967933
      target stat err =       0.004167934058
              std dev =       0.524460302340
             le_variance =       0.275058608730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370843503
  error estimate for blocks of size 2^( 2) =       0.000385440884
  error estimate for blocks of size 2^( 3) =       0.000399115556
  error estimate for blocks of size 2^( 4) =       0.000408726012
  error estimate for blocks of size 2^( 5) =       0.000414240688
  error estimate for blocks of size 2^( 6) =       0.000417772579
  error estimate for blocks of size 2^( 7) =       0.000420995228

      target function =      -0.940114500398
              le_mean =     -17.208956793856
             les_mean =     296.431034184808
             stat err =       0.000415433627
             autocorr =       1.254937059418
   target nu stat err =       0.000415433627
   target dn stat err =       0.002450967933
      target stat err =       0.004167934058
              std dev =       0.524460302339
             le_variance =       0.275058608730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370843503
  error estimate for blocks of size 2^( 2) =       0.000385440884
  error estimate for blocks of size 2^( 3) =       0.000399115556
  error estimate for blocks of size 2^( 4) =       0.000408726012
  error estimate for blocks of size 2^( 5) =       0.000414240688
  error estimate for blocks of size 2^( 6) =       0.000417772579
  error estimate for blocks of size 2^( 7) =       0.000420995228

      target function =      -0.940114500398
              le_mean =     -17.208956793856
             les_mean =     296.431034184808
             stat err =       0.000415433627
             autocorr =       1.254937059408
   target nu stat err =       0.000415433627
   target dn stat err =       0.002450967933
      target stat err =       0.004167934058
              std dev =       0.524460302340
             le_variance =       0.275058608730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275059822308
                                         uncertainty =       0.002130810496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370843503
  error estimate for blocks of size 2^( 2) =       0.000385440884
  error estimate for blocks of size 2^( 3) =       0.000399115556
  error estimate for blocks of size 2^( 4) =       0.000408726012
  error estimate for blocks of size 2^( 5) =       0.000414240688
  error estimate for blocks of size 2^( 6) =       0.000417772579
  error estimate for blocks of size 2^( 7) =       0.000420995228

      target function =      -0.940114500398
              le_mean =     -17.208956793856
             les_mean =     296.431034184808
             stat err =       0.000415433627
             autocorr =       1.254937059408
   target nu stat err =       0.000415433627
   target dn stat err =       0.002450967933
      target stat err =       0.004167934058
              std dev =       0.524460302340
             le_variance =       0.275058608730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940114500398        initial  <--
     6.2500e+08     6.2500e+09             6.7291e-13        -0.940114500398
     2.5000e+09     2.5000e+10             1.6790e-13        -0.940114500398
     1.0000e+10     1.0000e+11             4.1893e-14        -0.940114500398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0094
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1522
    reference variance = 0.177997
====================================================
  Execution time = 2.7374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8210e-01
  Total weights = 1.966380502e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4075e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272915212469
                                         uncertainty =       0.001552964215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272915212469
                                         uncertainty =       0.001552964215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369361700
  error estimate for blocks of size 2^( 2) =       0.000383798765
  error estimate for blocks of size 2^( 3) =       0.000397308901
  error estimate for blocks of size 2^( 4) =       0.000406509141
  error estimate for blocks of size 2^( 5) =       0.000412323440
  error estimate for blocks of size 2^( 6) =       0.000416268240
  error estimate for blocks of size 2^( 7) =       0.000416531475

      target function =      -0.941339942602
              le_mean =     -17.209920131392
             les_mean =     296.463455632811
             stat err =       0.000412908074
             autocorr =       1.249692112810
   target nu stat err =       0.000412908074
   target dn stat err =       0.002155717009
      target stat err =       0.003697945069
              std dev =       0.522364683305
             le_variance =       0.272864862364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720992013139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941353100889       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941353100889       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941353100889       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941353100889       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941353100889       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941353100889       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941353100889       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941343389930       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941335006811       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941353100889       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941348270081       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941346719084       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941344581902       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941355140841       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941354083452       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941368337451       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941357465102       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941354299111       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941343449018       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941354563329       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941349719411       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941361886978       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941326485470       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941362839855       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941338246850       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941334007517       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941335081516       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941342157595       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941335127820       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941339361947       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941348733382       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941337348545       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941345515512       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941360342235       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941370420903       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941369996388       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941336316285       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941351865597       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941368214438       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941351129010       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941354215073       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941358227256       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941372508365       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941364729797       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941359592083       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941371313091       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941321228671       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941305497370       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941264601868       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941380638422       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.941322554630       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941329839117       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941316715455       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941278821667       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.941309768710       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941387535772       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941293548466       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941373241157       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941361999094       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941264070323       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941413157469       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941281238255       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.941294624304       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.941252064238       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.941221556005       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941115740691       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.941345392041       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.941393936238       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.941271165010       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.941484248787       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.941318089941       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.941378926666       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941009904904       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.941005194249       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.941730763853       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.941749776321       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.940811184039       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.941157250106       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.940756601381       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940373723654       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.942786786834       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.940900486237       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.942205425594       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.942947144500       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.942204623068       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.939187658453       residual = 7.32e-04           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+09 is 6.680557e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941353100889       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941353100889       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941353100889       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941353100889       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941353100889       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941353100889       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941352867973       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941353100889       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941353100889       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941353100889       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941379967907       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941353100889       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941353100889       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941309018173       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941365862229       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941377039054       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941319254199       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941348886258       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941363241625       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941381447840       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941271909250       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941396773538       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941401212630       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941434357100       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941368135380       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941431064420       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941354435245       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941343704286       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941275284371       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941414752019       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941299629951       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941256368309       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941352474541       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941288522821       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941382803044       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941406418384       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941421759765       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941348614882       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941553221895       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940994408233       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941361801012       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941588630460       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941439106492       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941395726295       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941273388705       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941384491443       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940771641797       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941324549630       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941261592469       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941481281625       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.941341401721       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941213859074       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941601867060       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941549870091       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.941137417520       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941347931176       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941318269578       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941817681661       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941761255795       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941782737597       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941912802968       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941669970092       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.941293321961       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.943441399431       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.940728265277       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941242815078       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940647936224       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.938465239515       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.941752853924       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.941827654536       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.938946483774       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.945543497260       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.940906937800       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940204690454       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.939983635943       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.939781967075       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.939684986467       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.939446518509       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.936107544956       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.938888776805       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.946434550797       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.946000370072       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.940474053511       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.930151022475       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.918691978921       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.959951539738       residual = 5.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.947944305091       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.952196792234       residual = 1.63e-02           smallest_sin_value = 9.91e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+10 is 1.690503e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941353100889       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941353100889       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941353100889       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941353100889       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941353100889       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941353100889       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941393337048       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941270363139       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941353100889       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941638878792       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941403176772       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941232033170       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941265470883       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941422586744       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941314165526       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941320244266       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941541968188       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941399121608       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941424293613       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941424035632       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941192697160       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941316943933       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941046810003       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941438874368       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941769233035       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941447440700       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941671424436       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940814069973       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940865237442       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940804754496       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941456035467       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940395738351       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941724339198       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940998625666       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941306793250       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941480551898       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941797470918       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940490670474       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941264945663       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943050511578       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941824679651       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940881848912       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940504400616       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940379583339       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943677963139       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940702140329       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941240325568       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944297839087       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941525146850       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.940428914262       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940201890634       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.940903755473       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942133006731       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.942776449636       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.941981990944       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941977934758       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.942237264173       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942215969972       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.943353701961       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.939444461666       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939987941930       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.944632867149       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940239787813       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.939868700364       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.940421517281       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937037786657       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.943338618481       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.941328032889       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.941508536841       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.938364417526       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.940354352184       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944460193206       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.932826615266       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.942131371166       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943901031004       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.945440596359       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934061988824       residual = 9.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.940739962294       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.943162672947       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.944508558602       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.941857270736       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.962599682466       residual = 6.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.904163374017       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.896789950620       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.948232727737       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.026094326849       residual = 9.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.900291846013       residual = 1.24e+00           smallest_sin_value = 9.91e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.30e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+11 is 3.374422e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.030115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6511e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.249528
====================================================
  Execution time = 2.7688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8568e-01
  Total weights = 1.9665e+06
  Execution time = 2.3186e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371158686
  error estimate for blocks of size 2^( 2) =       0.000385470768
  error estimate for blocks of size 2^( 3) =       0.000398550286
  error estimate for blocks of size 2^( 4) =       0.000408853061
  error estimate for blocks of size 2^( 5) =       0.000414642956
  error estimate for blocks of size 2^( 6) =       0.000418428958
  error estimate for blocks of size 2^( 7) =       0.000418915262

      target function =      -0.935383221659
              le_mean =     -17.209414981493
             les_mean =     296.449640025392
             stat err =       0.000415210059
             autocorr =       1.251458565484
   target nu stat err =       0.000415210059
   target dn stat err =       0.002403735987
      target stat err =       0.004053214880
              std dev =       0.524906046142
             le_variance =       0.275526357276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371158686
  error estimate for blocks of size 2^( 2) =       0.000385470768
  error estimate for blocks of size 2^( 3) =       0.000398550286
  error estimate for blocks of size 2^( 4) =       0.000408853061
  error estimate for blocks of size 2^( 5) =       0.000414642956
  error estimate for blocks of size 2^( 6) =       0.000418428958
  error estimate for blocks of size 2^( 7) =       0.000418915262

      target function =      -0.935383221659
              le_mean =     -17.209414981493
             les_mean =     296.449640025392
             stat err =       0.000415210059
             autocorr =       1.251458565487
   target nu stat err =       0.000415210059
   target dn stat err =       0.002403735987
      target stat err =       0.004053214880
              std dev =       0.524906046142
             le_variance =       0.275526357276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371158686
  error estimate for blocks of size 2^( 2) =       0.000385470768
  error estimate for blocks of size 2^( 3) =       0.000398550286
  error estimate for blocks of size 2^( 4) =       0.000408853061
  error estimate for blocks of size 2^( 5) =       0.000414642956
  error estimate for blocks of size 2^( 6) =       0.000418428958
  error estimate for blocks of size 2^( 7) =       0.000418915262

      target function =      -0.935383221659
              le_mean =     -17.209414981493
             les_mean =     296.449640025392
             stat err =       0.000415210059
             autocorr =       1.251458565485
   target nu stat err =       0.000415210059
   target dn stat err =       0.002403735987
      target stat err =       0.004053214880
              std dev =       0.524906046142
             le_variance =       0.275526357276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275555153626
                                         uncertainty =       0.001545598283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371158686
  error estimate for blocks of size 2^( 2) =       0.000385470768
  error estimate for blocks of size 2^( 3) =       0.000398550286
  error estimate for blocks of size 2^( 4) =       0.000408853061
  error estimate for blocks of size 2^( 5) =       0.000414642956
  error estimate for blocks of size 2^( 6) =       0.000418428958
  error estimate for blocks of size 2^( 7) =       0.000418915262

      target function =      -0.935383221659
              le_mean =     -17.209414981493
             les_mean =     296.449640025392
             stat err =       0.000415210059
             autocorr =       1.251458565490
   target nu stat err =       0.000415210059
   target dn stat err =       0.002403735987
      target stat err =       0.004053214880
              std dev =       0.524906046142
             le_variance =       0.275526357276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935383221659        initial
     6.2500e+09     6.2500e+10             6.6806e-14        -0.935383221659  <--
     2.5000e+10     2.5000e+11             1.6905e-14        -0.935383221659
     1.0000e+11     1.0000e+12             3.3744e-15        -0.935383221659

*****************************************************************************
Applying the update for shift_i =   6.2500e+09     and shift_s =   6.2500e+10
*****************************************************************************

  Execution time = 3.9420e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.184807
====================================================
  Execution time = 2.7267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8551e-01
  Total weights = 1.966234929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2393e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747062123
                                         uncertainty =       0.001954190526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747062123
                                         uncertainty =       0.001954190526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372017989
  error estimate for blocks of size 2^( 2) =       0.000386218538
  error estimate for blocks of size 2^( 3) =       0.000399756099
  error estimate for blocks of size 2^( 4) =       0.000409520541
  error estimate for blocks of size 2^( 5) =       0.000415556032
  error estimate for blocks of size 2^( 6) =       0.000419100069
  error estimate for blocks of size 2^( 7) =       0.000419291902

      target function =      -0.935657265486
              le_mean =     -17.209668248278
             les_mean =     296.458188248608
             stat err =       0.000415867136
             autocorr =       1.249629650485
   target nu stat err =       0.000415867136
   target dn stat err =       0.002424855258
      target stat err =       0.004092189981
              std dev =       0.526121302973
             le_variance =       0.276803625442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720966824828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935674285207       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935674285207       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935674285208       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935674285208       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935674285212       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935673889267       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935673449259       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935672707009       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935674615961       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935673946608       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935676779400       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935673448925       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935670250742       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935671548347       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935672262117       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935672971429       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935674712936       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935671466319       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935671999941       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935672293167       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935672279517       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935669910454       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935668447807       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935672211859       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935676437178       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935678882593       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935672994262       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935677093524       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935672828686       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935680948984       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935670424931       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935673941236       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935676691044       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935674338006       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935669412170       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935679321794       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935676161639       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935666986272       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935672853878       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935674067621       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935673243269       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+09 is 2.409776e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935674285207       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935674285207       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935674285207       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935673710058       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935671081653       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935674285447       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935681252690       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935674926000       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935677428881       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935663909493       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935672065224       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935678190930       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935671931647       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935667309607       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935682777598       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935682821345       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935680438208       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935662482141       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935700100371       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935668918238       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935680537943       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935664986397       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935671270801       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935656862934       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935692895925       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935653763958       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935674737637       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935670746897       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935678479424       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935698625385       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935705571262       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935675547171       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935676792392       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935675935981       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935683232226       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935652612220       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935657196441       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935656235126       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935657749830       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935678341800       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935670088953       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935668294949       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935653691997       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935675600724       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935681083731       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935657465030       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.935659704047       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.935684580398       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.935653613176       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.935637291880       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.935735862070       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.935569471550       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.935494461800       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.935587191071       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.935613123936       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935721188341       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.935537600525       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.935587479604       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.935783318359       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.935593557937       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.935710832635       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.936036357864       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.935631799190       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935718354213       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.935765169753       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935628949977       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.935580693058       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.935583719301       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935481618036       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.935484491043       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.935583093103       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.935406345379       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.935693013582       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.935447939458       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.935375512423       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.935765619673       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.935165036430       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.935321644844       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.937075141527       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.935846269577       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.935548896160       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.935481392816       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936273947310       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.936418440164       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.934284460033       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.935835569044       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.937515815751       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.937192151801       residual = 7.12e-04           smallest_sin_value = 9.99e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.36e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+09 is 6.006556e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935674285207       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935674285207       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935674285207       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935674285207       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935674285396       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935664600705       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935654707442       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935738359486       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935681084765       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935664061616       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935633321473       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935750060841       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935683554323       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935663663018       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935639133979       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935657078399       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935739838650       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935630912948       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935582883897       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935722050475       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935643614834       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935619280647       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935618208671       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935623245158       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935667875370       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935736016439       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935691864016       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935709412305       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935709048045       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935668865369       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935777894911       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935715751639       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935644249263       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935739890199       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935712968554       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935720973516       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935694667936       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935682505505       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935612990198       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935684802042       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935496860947       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935537340220       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935487361268       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935526039519       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935706151370       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935634267754       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.935574184754       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.935650655994       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.935523714948       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.935798651826       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.935581684494       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.935320257886       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.935743791001       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.935832073999       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.935983393900       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935432027692       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.935873949211       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.935371530088       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.935594721154       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.935093172392       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.936027745139       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935644408085       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.936190210317       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935563774103       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.935819735990       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.934814949118       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.935780882341       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.934638448835       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935792070545       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.936206953685       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.935402256662       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.935763297153       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.935988345064       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.935138918121       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.935218434406       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.934081050295       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.936808242802       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.936236313193       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.935787575313       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.935867396288       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.936658957914       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.934034848867       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936132205753       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.940262274604       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.949338609886       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.939312242448       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.943277547704       residual = 7.44e-03           smallest_sin_value = 9.96e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+10 is 1.529305e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.534513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6018e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.296813
====================================================
  Execution time = 2.7411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8414e-01
  Total weights = 1.9662e+06
  Execution time = 2.3326e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370262482
  error estimate for blocks of size 2^( 2) =       0.000384772489
  error estimate for blocks of size 2^( 3) =       0.000398425832
  error estimate for blocks of size 2^( 4) =       0.000408486729
  error estimate for blocks of size 2^( 5) =       0.000414398304
  error estimate for blocks of size 2^( 6) =       0.000416595149
  error estimate for blocks of size 2^( 7) =       0.000417362628

      target function =      -0.937942582437
              le_mean =     -17.209789965940
             les_mean =     296.461006009162
             stat err =       0.000414210702
             autocorr =       1.251477987214
   target nu stat err =       0.000414210702
   target dn stat err =       0.002032787360
      target stat err =       0.003470699688
              std dev =       0.523638602374
             le_variance =       0.274197385896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370262482
  error estimate for blocks of size 2^( 2) =       0.000384772489
  error estimate for blocks of size 2^( 3) =       0.000398425832
  error estimate for blocks of size 2^( 4) =       0.000408486729
  error estimate for blocks of size 2^( 5) =       0.000414398304
  error estimate for blocks of size 2^( 6) =       0.000416595149
  error estimate for blocks of size 2^( 7) =       0.000417362628

      target function =      -0.937942582437
              le_mean =     -17.209789965940
             les_mean =     296.461006009162
             stat err =       0.000414210702
             autocorr =       1.251477987215
   target nu stat err =       0.000414210702
   target dn stat err =       0.002032787360
      target stat err =       0.003470699688
              std dev =       0.523638602374
             le_variance =       0.274197385896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370262482
  error estimate for blocks of size 2^( 2) =       0.000384772489
  error estimate for blocks of size 2^( 3) =       0.000398425832
  error estimate for blocks of size 2^( 4) =       0.000408486729
  error estimate for blocks of size 2^( 5) =       0.000414398304
  error estimate for blocks of size 2^( 6) =       0.000416595149
  error estimate for blocks of size 2^( 7) =       0.000417362628

      target function =      -0.937942582437
              le_mean =     -17.209789965940
             les_mean =     296.461006009162
             stat err =       0.000414210702
             autocorr =       1.251477987211
   target nu stat err =       0.000414210702
   target dn stat err =       0.002032787360
      target stat err =       0.003470699688
              std dev =       0.523638602374
             le_variance =       0.274197385896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274219849689
                                         uncertainty =       0.001484998980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370262482
  error estimate for blocks of size 2^( 2) =       0.000384772489
  error estimate for blocks of size 2^( 3) =       0.000398425832
  error estimate for blocks of size 2^( 4) =       0.000408486729
  error estimate for blocks of size 2^( 5) =       0.000414398304
  error estimate for blocks of size 2^( 6) =       0.000416595149
  error estimate for blocks of size 2^( 7) =       0.000417362628

      target function =      -0.937942582437
              le_mean =     -17.209789965940
             les_mean =     296.461006009162
             stat err =       0.000414210702
             autocorr =       1.251477987217
   target nu stat err =       0.000414210702
   target dn stat err =       0.002032787360
      target stat err =       0.003470699688
              std dev =       0.523638602374
             le_variance =       0.274197385896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937942582437        initial  <--
     1.5625e+09     1.5625e+10             2.4098e-13        -0.937942582437
     6.2500e+09     6.2500e+10             6.0066e-14        -0.937942582437
     2.5000e+10     2.5000e+11             1.5293e-14        -0.937942582437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2020
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.145
    reference variance = 0.156922
====================================================
  Execution time = 2.7525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8452e-01
  Total weights = 1.966402466e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5874e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275441604722
                                         uncertainty =       0.001501960148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275441604722
                                         uncertainty =       0.001501960148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371107783
  error estimate for blocks of size 2^( 2) =       0.000385482439
  error estimate for blocks of size 2^( 3) =       0.000399159945
  error estimate for blocks of size 2^( 4) =       0.000409466846
  error estimate for blocks of size 2^( 5) =       0.000414998610
  error estimate for blocks of size 2^( 6) =       0.000418191752
  error estimate for blocks of size 2^( 7) =       0.000418007701

      target function =      -0.937296318619
              le_mean =     -17.210135002137
             les_mean =     296.473265083488
             stat err =       0.000415166227
             autocorr =       1.251537625106
   target nu stat err =       0.000415166227
   target dn stat err =       0.002082138472
      target stat err =       0.003549095830
              std dev =       0.524834056781
             le_variance =       0.275450787157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721013500214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937308712135       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937308712135       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937308712135       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937308712135       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937308712135       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937309103618       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937307214345       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937303732951       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937327358967       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937261765314       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937275069180       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937302195971       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937318112137       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937282117298       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937349868062       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937321303690       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937274027639       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937317216818       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937285415185       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937325453372       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937266243087       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937287282720       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937294555565       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937276527653       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937312592882       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937290713050       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937291459096       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937364479152       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937354592505       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937254772307       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937319609656       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937321716409       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937281989498       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937264970178       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937325985338       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937321322877       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937313921243       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937272200311       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937309223559       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937345772478       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937379902279       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937287184102       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937444325551       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937195243992       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937336592520       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937187863234       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.937138309770       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.937282827838       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937423289859       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937324084069       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937081660792       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.936944940458       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.937300385735       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937328540103       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.937375681580       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937166002461       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937321969708       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.937473709001       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937161905308       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.937389155996       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937318205894       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937648978537       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.937370942163       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.937229145476       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.937170764606       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937177744026       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.937047291838       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936986800572       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.937227672644       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937181596382       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.937578378300       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.936749144365       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.938936255712       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.938999570110       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937225008643       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.939757350552       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.939125020256       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938390433210       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.938147022443       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940143925640       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.935201922014       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.930873659050       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.937036227120       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.943684816132       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.940267275210       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.940931563628       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.935730763459       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.932582995230       residual = 4.34e-03           smallest_sin_value = 9.99e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+10 is 1.981404e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937308712135       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937308712135       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937308712135       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937308712135       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937308712135       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937308714115       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937308760803       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937148722677       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937305483034       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937292177567       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937307566806       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937348621528       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937310268309       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937305144849       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937454167179       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937102231137       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937356468930       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937371655552       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937352298260       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937233935109       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937231166756       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937350444603       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937056315657       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937317697554       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937138144192       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937256362358       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937130963579       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937260554335       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937008841607       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937098197570       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937113444852       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937114393356       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937558274756       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936965628479       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937201950097       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937327452423       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937129953195       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937094132469       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937545528807       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937363038005       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936561736753       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937256219248       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937036569278       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936699573960       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937253440250       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937976533786       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.937498312585       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.937550000694       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.938424027337       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.936537379996       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.936928215096       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939106075061       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936635151637       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937866360219       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.936649929683       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937576359836       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937542191789       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.937628577586       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.934553550662       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941546785346       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.936568820810       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937453034029       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.935711658384       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.938763015369       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.937668210621       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937226134293       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934596326299       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.934220014641       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938227258274       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.936954358816       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.930646260210       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932053112655       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.939384791849       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.936889386439       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936805640425       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938949031542       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.942669837531       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.936171892666       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.938449451928       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.952434268599       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.942221274715       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.938678611693       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.939236713404       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.932862507771       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.934058904441       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.943131700068       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.917681022835       residual = 9.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.922705725550       residual = 1.52e-01           smallest_sin_value = 9.97e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.46e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+10 is 5.347947e-15

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937308712135       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937308712135       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937308712135       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937308712135       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937308713533       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937317066848       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937349091125       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937597312404       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936844863295       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937472215657       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937447846792       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937117822626       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937322389541       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937246675843       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936754900467       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937325411203       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937011981226       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936802198640       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936955751436       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936862324125       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937571449979       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936127557983       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938158649325       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936628344786       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936032959305       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935161625956       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937004383141       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938060478721       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936660594703       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936082986445       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937902964078       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937633560553       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938008224427       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937554737322       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938129328766       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938019842967       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936053127643       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934721355560       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935430180397       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939545030778       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937779707377       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937054591255       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940933653443       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933776222324       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936291176146       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937026635051       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934834092868       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.936640438824       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934058383803       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934486002713       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939577413627       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.938219461784       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.931773062386       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940477105117       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939199732869       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939276909191       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937664157745       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.927269515284       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932331240861       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.945919742099       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.950854393632       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.946131444892       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934820600189       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.941682935680       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930688452439       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.927610342609       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940395748607       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932007126485       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.939623140989       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.926988799184       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.931286257590       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.943767923349       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.930881167406       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.946246208892       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.938091760406       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.946345341775       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.941757724925       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.946147590852       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.933315993388       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940116103188       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.954798939799       residual = 5.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.938771097759       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.993456178314       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.952665544889       residual = 5.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.999735952119       residual = 5.47e-01           smallest_sin_value = 9.98e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.25e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+11 is 1.064275e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.260866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6850e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1825
    reference variance = 0.309357
====================================================
  Execution time = 2.7454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8691e-01
  Total weights = 1.9663e+06
  Execution time = 2.3275e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372626695
  error estimate for blocks of size 2^( 2) =       0.000386886827
  error estimate for blocks of size 2^( 3) =       0.000400046849
  error estimate for blocks of size 2^( 4) =       0.000409957597
  error estimate for blocks of size 2^( 5) =       0.000415500683
  error estimate for blocks of size 2^( 6) =       0.000418152506
  error estimate for blocks of size 2^( 7) =       0.000419716476

      target function =      -0.933337130474
              le_mean =     -17.209528866029
             les_mean =     296.454791623552
             stat err =       0.000415831816
             autocorr =       1.245338741653
   target nu stat err =       0.000415831816
   target dn stat err =       0.002734877738
      target stat err =       0.004575627979
              std dev =       0.526982157767
             le_variance =       0.277710194605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372626695
  error estimate for blocks of size 2^( 2) =       0.000386886827
  error estimate for blocks of size 2^( 3) =       0.000400046849
  error estimate for blocks of size 2^( 4) =       0.000409957597
  error estimate for blocks of size 2^( 5) =       0.000415500683
  error estimate for blocks of size 2^( 6) =       0.000418152506
  error estimate for blocks of size 2^( 7) =       0.000419716476

      target function =      -0.933337130474
              le_mean =     -17.209528866029
             les_mean =     296.454791623552
             stat err =       0.000415831816
             autocorr =       1.245338741653
   target nu stat err =       0.000415831816
   target dn stat err =       0.002734877738
      target stat err =       0.004575627979
              std dev =       0.526982157767
             le_variance =       0.277710194605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372626695
  error estimate for blocks of size 2^( 2) =       0.000386886827
  error estimate for blocks of size 2^( 3) =       0.000400046849
  error estimate for blocks of size 2^( 4) =       0.000409957597
  error estimate for blocks of size 2^( 5) =       0.000415500683
  error estimate for blocks of size 2^( 6) =       0.000418152506
  error estimate for blocks of size 2^( 7) =       0.000419716476

      target function =      -0.933337130474
              le_mean =     -17.209528866029
             les_mean =     296.454791623552
             stat err =       0.000415831816
             autocorr =       1.245338741653
   target nu stat err =       0.000415831816
   target dn stat err =       0.002734877738
      target stat err =       0.004575627979
              std dev =       0.526982157767
             le_variance =       0.277710194605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277714580343
                                         uncertainty =       0.002159115230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372626695
  error estimate for blocks of size 2^( 2) =       0.000386886827
  error estimate for blocks of size 2^( 3) =       0.000400046849
  error estimate for blocks of size 2^( 4) =       0.000409957597
  error estimate for blocks of size 2^( 5) =       0.000415500683
  error estimate for blocks of size 2^( 6) =       0.000418152506
  error estimate for blocks of size 2^( 7) =       0.000419716476

      target function =      -0.933337130474
              le_mean =     -17.209528866029
             les_mean =     296.454791623552
             stat err =       0.000415831816
             autocorr =       1.245338741653
   target nu stat err =       0.000415831816
   target dn stat err =       0.002734877738
      target stat err =       0.004575627979
              std dev =       0.526982157767
             le_variance =       0.277710194605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933337130474        initial
     1.5625e+10     1.5625e+11             1.9814e-14        -0.933337130474  <--
     6.2500e+10     6.2500e+11             5.3479e-15        -0.933337130474
     2.5000e+11     2.5000e+12             1.0643e-15        -0.933337130474

*****************************************************************************
Applying the update for shift_i =   1.5625e+10     and shift_s =   1.5625e+11
*****************************************************************************

  Execution time = 3.9226e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2383
    reference variance = 0.619928
====================================================
  Execution time = 2.9847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0455e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8637e-01
  Total weights = 1.966225830e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4612e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277713966705
                                         uncertainty =       0.002755063519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277713966705
                                         uncertainty =       0.002755063519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372620936
  error estimate for blocks of size 2^( 2) =       0.000386886535
  error estimate for blocks of size 2^( 3) =       0.000400567329
  error estimate for blocks of size 2^( 4) =       0.000410648061
  error estimate for blocks of size 2^( 5) =       0.000416514117
  error estimate for blocks of size 2^( 6) =       0.000418450511
  error estimate for blocks of size 2^( 7) =       0.000420445452

      target function =      -0.934205987138
              le_mean =     -17.210058962553
             les_mean =     296.472495829177
             stat err =       0.000416514535
             autocorr =       1.249469957666
   target nu stat err =       0.000416514535
   target dn stat err =       0.003413066468
      target stat err =       0.005700258442
              std dev =       0.526974012851
             le_variance =       0.277701610220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721005896255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934239712250       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934239712250       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934239712250       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934239712250       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934239004696       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934239712250       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934232292542       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934239825844       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934229457457       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934238010561       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934234802319       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934236001498       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934230155618       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934240982561       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934234597237       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934244244487       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934245994942       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934235406396       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934245234225       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934235663818       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934240305463       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934241194243       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934232618045       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934239578379       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934249882912       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934247522249       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934248034696       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934226382163       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934248724871       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934251869741       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934226133048       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934228985105       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934251969313       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934236394394       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934226558571       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934248276983       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934232399581       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934249048102       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934242844205       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934236967442       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934244547968       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934235587338       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934230055017       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934230947819       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934225118665       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934244915842       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934228049158       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934241933361       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         47 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+09 is 9.673203e-14

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934239712250       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934239712250       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934239712250       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934239712250       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934239712250       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934239712250       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934239712250       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934239712250       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934239712250       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934248744531       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934239712250       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934239712250       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934239712250       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934259743093       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934239712250       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934217176471       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934239712250       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934238431109       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934226983888       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934240608068       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934203261405       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934260439045       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934226765307       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934294575062       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934202701920       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934249778383       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934215880594       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934280440412       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934268090225       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934249938222       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934209014667       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934258898841       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934188038328       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934212081860       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934274899231       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934246507363       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934240612563       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934144087670       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934173796077       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934106897930       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934274622435       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934440911185       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934081563733       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934055736604       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934156965791       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934179702808       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934261812246       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934068856669       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934144917057       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934014864382       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.934202254766       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934200138671       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.934363266913       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934109276673       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934155634262       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.934242668943       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.934271222741       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.934185328301       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.934339955512       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.934286143718       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934350340046       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.934069278434       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934553589785       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933840326536       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.933935642331       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.934270916622       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934673593333       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.933774267010       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.934022986947       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.934373969248       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.934745152196       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.934529622474       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.935748123638       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.933332928747       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936869523314       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.935447619752       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.931760286123       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.931795963352       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.931564953649       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.931741867393       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.930237145487       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.934589757299       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.934373335846       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.923776385062       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.929654875374       residual = 2.54e-03           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.942162942244       residual = 8.13e-03           smallest_sin_value = 9.95e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.16e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+10 is 2.314805e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934239712250       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934239712250       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934239712250       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934243924124       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934254172583       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934239712250       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934201709624       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934335134705       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934220615259       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933932410451       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934591552551       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934210572268       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934291631812       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934324795559       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934187201593       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934628486628       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934141758438       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934272175234       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934168995864       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934326229077       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934317876663       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934352235229       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934232763970       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934422951233       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934256685219       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933870903525       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933826450115       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934480798614       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934206698467       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934688003300       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934180309978       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934693049447       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934030828122       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934228757522       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933797540202       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934363883972       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933695538687       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934119208107       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933937654536       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934402823007       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934210021008       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933545783318       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934428344548       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934062012388       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934319485939       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934668254462       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934509281928       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.933455645546       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934753675874       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933707546546       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.933415403823       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933745757120       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.934016461379       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.936229577114       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934277753679       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.932489877924       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932311023565       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932143505318       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.929516258275       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.934469816100       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.933163640788       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.932492681837       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931655139283       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.934905973196       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.935863986381       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.933405154634       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934377139271       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.933746010490       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935056219731       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.925540543903       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.931516473116       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.934174426704       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.933766864063       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.937004784339       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.935789629419       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.930100301153       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934815105532       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.930280679968       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.927549460469       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.919808776593       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.932786304968       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.903653820266       residual = 8.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.912852742343       residual = 6.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.962840664790       residual = 8.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.940777906472       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.937000596280       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.949691667340       residual = 3.18e-02           smallest_sin_value = 9.90e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.51e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+10 is 5.849842e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.769306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8824e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.459485
====================================================
  Execution time = 2.7288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8903e-01
  Total weights = 1.9662e+06
  Execution time = 2.3247e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372566184
  error estimate for blocks of size 2^( 2) =       0.000387161575
  error estimate for blocks of size 2^( 3) =       0.000400179988
  error estimate for blocks of size 2^( 4) =       0.000409715711
  error estimate for blocks of size 2^( 5) =       0.000415098144
  error estimate for blocks of size 2^( 6) =       0.000417608122
  error estimate for blocks of size 2^( 7) =       0.000418689287

      target function =      -0.929830443272
              le_mean =     -17.209861309359
             les_mean =     296.468359082929
             stat err =       0.000415277816
             autocorr =       1.242426186878
   target nu stat err =       0.000415277816
   target dn stat err =       0.002723395333
      target stat err =       0.004525874643
              std dev =       0.526896580364
             le_variance =       0.277620006399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372566184
  error estimate for blocks of size 2^( 2) =       0.000387161575
  error estimate for blocks of size 2^( 3) =       0.000400179988
  error estimate for blocks of size 2^( 4) =       0.000409715711
  error estimate for blocks of size 2^( 5) =       0.000415098144
  error estimate for blocks of size 2^( 6) =       0.000417608122
  error estimate for blocks of size 2^( 7) =       0.000418689287

      target function =      -0.929830443272
              le_mean =     -17.209861309359
             les_mean =     296.468359082930
             stat err =       0.000415277816
             autocorr =       1.242426186878
   target nu stat err =       0.000415277816
   target dn stat err =       0.002723395333
      target stat err =       0.004525874643
              std dev =       0.526896580364
             le_variance =       0.277620006399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372566184
  error estimate for blocks of size 2^( 2) =       0.000387161575
  error estimate for blocks of size 2^( 3) =       0.000400179988
  error estimate for blocks of size 2^( 4) =       0.000409715711
  error estimate for blocks of size 2^( 5) =       0.000415098144
  error estimate for blocks of size 2^( 6) =       0.000417608122
  error estimate for blocks of size 2^( 7) =       0.000418689287

      target function =      -0.929830443272
              le_mean =     -17.209861309359
             les_mean =     296.468359082929
             stat err =       0.000415277816
             autocorr =       1.242426186872
   target nu stat err =       0.000415277816
   target dn stat err =       0.002723395333
      target stat err =       0.004525874643
              std dev =       0.526896580364
             le_variance =       0.277620006399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658102219
                                         uncertainty =       0.001595919477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372566184
  error estimate for blocks of size 2^( 2) =       0.000387161575
  error estimate for blocks of size 2^( 3) =       0.000400179988
  error estimate for blocks of size 2^( 4) =       0.000409715711
  error estimate for blocks of size 2^( 5) =       0.000415098144
  error estimate for blocks of size 2^( 6) =       0.000417608122
  error estimate for blocks of size 2^( 7) =       0.000418689287

      target function =      -0.929830443272
              le_mean =     -17.209861309359
             les_mean =     296.468359082929
             stat err =       0.000415277816
             autocorr =       1.242426186878
   target nu stat err =       0.000415277816
   target dn stat err =       0.002723395333
      target stat err =       0.004525874643
              std dev =       0.526896580364
             le_variance =       0.277620006399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929830443272        initial  <--
     3.9062e+09     3.9062e+10             9.6732e-14        -0.929830443272
     1.5625e+10     1.5625e+11             2.3148e-14        -0.929830443272
     6.2500e+10     6.2500e+11             5.8498e-15        -0.929830443272

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1001
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.236627
====================================================
  Execution time = 2.7509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8194e-01
  Total weights = 1.966416135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3518e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273308375371
                                         uncertainty =       0.001677378524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273308375371
                                         uncertainty =       0.001677378524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369660231
  error estimate for blocks of size 2^( 2) =       0.000384089247
  error estimate for blocks of size 2^( 3) =       0.000396987332
  error estimate for blocks of size 2^( 4) =       0.000406281041
  error estimate for blocks of size 2^( 5) =       0.000412089974
  error estimate for blocks of size 2^( 6) =       0.000415133220
  error estimate for blocks of size 2^( 7) =       0.000418910997

      target function =      -0.941629321283
              le_mean =     -17.209378779787
             les_mean =     296.444653807199
             stat err =       0.000413103808
             autocorr =       1.248857639615
   target nu stat err =       0.000413103808
   target dn stat err =       0.002210209377
      target stat err =       0.003786218848
              std dev =       0.522786876990
             le_variance =       0.273306118753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720937877979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941643560006       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941643560006       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941643560006       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941643560006       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941666974272       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941627010692       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941573320545       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941643560006       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941551471875       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941624925783       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941668017532       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941739140624       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941654881404       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941631261950       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941707593455       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941643560006       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941639828270       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941629255341       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941562682168       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941503061709       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941630924967       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941579357163       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941721829460       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941621880533       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941729656373       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941594367045       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941633592630       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941821979531       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941407707754       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941512816090       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941649077825       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941609359039       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941780912428       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941554583547       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941649471300       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941482002896       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941698822192       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941883441334       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941410078757       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941740864742       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941717532357       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941754208698       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941589323103       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.942023476862       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941713313972       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941681399153       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941621666385       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941852087707       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941526261165       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941964384859       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.941533227005       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941317161057       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941798552844       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941106443869       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.942522582561       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.942811509798       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.942914627510       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942388693933       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941154274880       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.942458855803       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941767976311       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941037249089       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.941579310133       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.942228826197       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.942459170333       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.942039738215       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940928146990       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.941211011451       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.941948908454       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.941831248514       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.942209257724       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.941923957561       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941201472886       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.941052139198       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.941741641837       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.939716584806       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.942904933156       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.940509339691       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.940802511309       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940532302257       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.941972332031       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.954554699021       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.949419858585       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.960298421274       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946391848742       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.931389501718       residual = 1.58e-02           smallest_sin_value = 9.95e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+10 is 9.891812e-15

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941643560006       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941643560006       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941643560006       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941643560006       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941643560006       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941643560006       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941643560006       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941643560006       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941776005455       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941643560006       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941912517840       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941743720207       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941643560006       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941643560006       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941400981571       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941643560006       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941765862810       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941472947482       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941231125533       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941491682057       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941984844358       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942003011017       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941799189358       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941407062942       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941540637208       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940498180175       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941099025225       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941992242875       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941717536920       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941875568581       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942551072033       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942044379943       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940479296953       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941829931111       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940559322784       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941977254994       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939877494929       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941339265291       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940479763818       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941453901068       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942683136620       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941042637896       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942449847155       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941883707900       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940623704426       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940567535603       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943358787186       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942197286836       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941496191411       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943862985236       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940232559401       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941304166355       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942785746581       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941924014931       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.942362383558       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.941720267774       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941289059715       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.940344374664       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.942876695956       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936536383003       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937455924363       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.938892404504       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.941283521240       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.944849670662       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.943540857365       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.936922401701       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.942459961693       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.938597394732       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.941591856360       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.943841008028       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.938460508825       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.924927365688       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.938369840669       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940958618458       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937582499325       residual = 5.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.937629860820       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.944679822585       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943198220039       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.926672015493       residual = 3.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.938354511941       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.945237030871       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.932192712885       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.961232723958       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.973620772695       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.947013488032       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.947819902198       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.929809751854       residual = 1.69e-01           smallest_sin_value = 9.96e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.94e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+11 is 1.509410e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941643560006       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941643560006       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941643560006       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941643560006       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941643560006       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941433226454       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941451613746       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940212460542       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942202269228       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943135063380       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941025326214       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941416229896       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942737507122       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941969311390       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940997550696       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940336424862       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937300219556       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941970164659       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941100258955       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943260074260       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941990480565       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940459825151       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939228215599       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941627801583       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939413839468       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941254776121       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941663312779       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944378214993       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941030033003       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942270845172       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933270676617       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947800487035       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944068779377       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946050561612       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937337888618       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951618838996       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.956707894673       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939187880117       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942371090301       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943032814141       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941307880668       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931226349464       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939320541540       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946411216306       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942388694335       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.930474755881       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943584864739       residual = 7.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934547709212       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.935420058680       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.955560099836       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940980002279       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939732622447       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.932617145902       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.942855837040       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.946253723523       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.922768276544       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.945310917319       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.945570499645       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.953884124647       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.945466696779       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934298792484       residual = 3.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.959296951147       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.983123920749       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.968268701739       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.917298324897       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.902634184029       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.933804313594       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.980749098976       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938995388244       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.930934854780       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.912006196920       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.917151008493       residual = 6.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.893601097663       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.939778273351       residual = 6.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.924376801211       residual = 6.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.709982572484       residual = 5.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.620434848712       residual = 8.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.874622357135       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.732001178084       residual = 5.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.916643302888       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.864535525441       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.852814937622       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.087266634752       residual = 6.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.957615991711       residual = 1.10e+00           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.913107315344       residual = 1.41e+00           smallest_sin_value = 9.90e-01
davidson iteration   85 stopping due to small subspace S singular value of 6.89e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+11 is 3.814771e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.482821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6582e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1669
    reference variance = 0.21624
====================================================
  Execution time = 2.7501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8689e-01
  Total weights = 1.9666e+06
  Execution time = 2.3213e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372869264
  error estimate for blocks of size 2^( 2) =       0.000386867785
  error estimate for blocks of size 2^( 3) =       0.000400367126
  error estimate for blocks of size 2^( 4) =       0.000409601490
  error estimate for blocks of size 2^( 5) =       0.000414951045
  error estimate for blocks of size 2^( 6) =       0.000417923128
  error estimate for blocks of size 2^( 7) =       0.000419526380

      target function =      -0.933368893174
              le_mean =     -17.209566002877
             les_mean =     296.456052126390
             stat err =       0.000415500511
             autocorr =       1.241737946464
   target nu stat err =       0.000415500511
   target dn stat err =       0.002475154790
      target stat err =       0.004153352235
              std dev =       0.527325207059
             le_variance =       0.278071873999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372869264
  error estimate for blocks of size 2^( 2) =       0.000386867785
  error estimate for blocks of size 2^( 3) =       0.000400367126
  error estimate for blocks of size 2^( 4) =       0.000409601490
  error estimate for blocks of size 2^( 5) =       0.000414951045
  error estimate for blocks of size 2^( 6) =       0.000417923128
  error estimate for blocks of size 2^( 7) =       0.000419526380

      target function =      -0.933368893174
              le_mean =     -17.209566002877
             les_mean =     296.456052126390
             stat err =       0.000415500511
             autocorr =       1.241737946464
   target nu stat err =       0.000415500511
   target dn stat err =       0.002475154790
      target stat err =       0.004153352235
              std dev =       0.527325207059
             le_variance =       0.278071873999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372869264
  error estimate for blocks of size 2^( 2) =       0.000386867785
  error estimate for blocks of size 2^( 3) =       0.000400367126
  error estimate for blocks of size 2^( 4) =       0.000409601490
  error estimate for blocks of size 2^( 5) =       0.000414951045
  error estimate for blocks of size 2^( 6) =       0.000417923128
  error estimate for blocks of size 2^( 7) =       0.000419526380

      target function =      -0.933368893174
              le_mean =     -17.209566002877
             les_mean =     296.456052126390
             stat err =       0.000415500511
             autocorr =       1.241737946464
   target nu stat err =       0.000415500511
   target dn stat err =       0.002475154790
      target stat err =       0.004153352235
              std dev =       0.527325207059
             le_variance =       0.278071873999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278148398037
                                         uncertainty =       0.001900419707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372869264
  error estimate for blocks of size 2^( 2) =       0.000386867785
  error estimate for blocks of size 2^( 3) =       0.000400367126
  error estimate for blocks of size 2^( 4) =       0.000409601490
  error estimate for blocks of size 2^( 5) =       0.000414951045
  error estimate for blocks of size 2^( 6) =       0.000417923128
  error estimate for blocks of size 2^( 7) =       0.000419526380

      target function =      -0.933368893174
              le_mean =     -17.209566002877
             les_mean =     296.456052126390
             stat err =       0.000415500511
             autocorr =       1.241737946462
   target nu stat err =       0.000415500511
   target dn stat err =       0.002475154790
      target stat err =       0.004153352235
              std dev =       0.527325207059
             le_variance =       0.278071873999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933368893174        initial
     3.9062e+10     3.9062e+11             9.8918e-15        -0.933368893174  <--
     1.5625e+11     1.5625e+12             1.5094e-15        -0.933368893174
     6.2500e+11     6.2500e+12             3.8148e-16        -0.933368893174

*****************************************************************************
Applying the update for shift_i =   3.9062e+10     and shift_s =   3.9062e+11
*****************************************************************************

  Execution time = 3.9278e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.184
    reference variance = 0.235911
====================================================
  Execution time = 2.7425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0464e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8648e-01
  Total weights = 1.966325631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3449e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277928931162
                                         uncertainty =       0.001634033243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277928931162
                                         uncertainty =       0.001634033243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372768711
  error estimate for blocks of size 2^( 2) =       0.000387058248
  error estimate for blocks of size 2^( 3) =       0.000400037069
  error estimate for blocks of size 2^( 4) =       0.000409749750
  error estimate for blocks of size 2^( 5) =       0.000417107638
  error estimate for blocks of size 2^( 6) =       0.000420660412
  error estimate for blocks of size 2^( 7) =       0.000422266315

      target function =      -0.934048866549
              le_mean =     -17.209382541690
             les_mean =     296.449330541512
             stat err =       0.000417446029
             autocorr =       1.254069954642
   target nu stat err =       0.000417446029
   target dn stat err =       0.002329297856
      target stat err =       0.003921383826
              std dev =       0.527183001916
             le_variance =       0.277921917509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720938254169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934064196725       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934064196725       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934064196725       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934064196725       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934058567970       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934069714153       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934078161623       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934053458257       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934067568472       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934033414697       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934067267600       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934066189794       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934062903736       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934054862514       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934074769685       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934067248021       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934049502792       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934050941135       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934081416415       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934047412925       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934056485261       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934075810550       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934069739430       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934069767473       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934084406839       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934062134044       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934060229191       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934090050975       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934068864213       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934063004614       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934085063731       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934046604267       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934041010782       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934084963513       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934055555588       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934068029624       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934086959040       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934067339278       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934098101299       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934105502546       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934048492498       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934064049492       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934065715217       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934021397781       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934104940841       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934050303309       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934078195907       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934133891923       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934057167015       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933983585878       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.934078820299       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934082525111       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.934133490145       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934028441660       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.933978904077       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.934011879919       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.933959178755       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.934070455079       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.933931785696       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.933995875824       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934063156132       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.933938092147       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934056950836       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.934365203144       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.934136829414       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.934190015861       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934005645709       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.933739226913       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.934107883529       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.934143874269       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.933394511842       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.934065409994       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.933857553380       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.933856039355       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.934698630369       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.933943712284       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934542943745       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.933577608370       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934286238888       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.934968567080       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.934109905242       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.934570306882       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.932232232219       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.933495227100       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.935013113762       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.931092651755       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.933820940857       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.939351156612       residual = 2.52e-03           smallest_sin_value = 9.98e-01
davidson iteration   88 stopping due to small subspace S singular value of 8.73e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+09 is 3.689407e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934064196725       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934064196725       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934064196725       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934064196725       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934064196786       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934064193846       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934004907695       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934104094877       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934044816036       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934030321296       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934077287193       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934070103701       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934040845644       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934092635074       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934038242670       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933986931007       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933967037770       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934106228833       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934077178303       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934009093349       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934069112556       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934072455922       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933997387315       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934015207344       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934076869863       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934018938762       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934190575252       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934119390046       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934105355349       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934159455625       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934022390285       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934042172724       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934049756811       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934028360408       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933959525376       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934112940098       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933879322315       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934235313045       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934068085243       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934147657567       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934122348802       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934332525814       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933693661109       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933955047196       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933926614470       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.933923516735       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933934078346       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934540563791       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934214150033       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934154025766       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.933833335892       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933720174889       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.933971692273       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934054865704       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.933216839420       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.934233277388       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.934188617688       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.934756737094       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.933988962376       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.934209106346       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934729972828       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.934326347997       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932388324948       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.932842555685       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.932252347455       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935990035379       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.933130415285       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932299744449       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.933912136997       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.935982093646       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.934303415014       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.931885718315       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.932348555266       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.934695242950       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937748980235       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.939976857733       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.940856433026       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.935509815192       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934986931160       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.938063907279       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.939667484897       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.926974406865       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.930930420083       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.926742276129       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.948341224821       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.937375730498       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.935039666928       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.954669762517       residual = 1.50e-01           smallest_sin_value = 9.95e-01
davidson iteration   88 stopping due to small subspace S singular value of 8.00e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+10 is 8.814065e-15

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934064196725       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934064196725       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934064196725       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934019850326       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934027430706       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934054964101       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933920028680       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934323248856       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934400837579       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933386248560       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933915376084       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933929831346       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934227604208       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933767641593       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933890669901       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933847708251       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933977322444       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934028230614       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934222673278       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934129118403       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933866348618       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934459699852       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934318464416       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934579574221       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932452621942       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933798782803       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933930724156       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934366958784       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934479752297       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933796831910       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932782173407       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934308473094       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933297982812       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933586355183       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933055555171       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934267815900       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934261347592       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931798827110       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933750971987       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933620022431       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933618189151       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935294319285       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934214089391       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933576368578       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934465383330       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934026191282       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934415777646       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.930343934753       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932140843039       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933825470713       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.933520662312       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933918932286       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.933967560894       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.935296657982       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.930216638040       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.936277952052       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932891372030       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.935492043604       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.930361615028       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.932758085935       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934126732380       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.928584021116       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938880249779       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.931010676093       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.935361885171       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.947815463975       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.925354334301       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.933703509321       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935090415869       residual = 7.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937472888138       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.942686627632       residual = 5.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.928925227989       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.924920668738       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940276227460       residual = 7.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.945711532139       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.943992674566       residual = 4.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.915301848210       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.929961253412       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.922016427020       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.925786069731       residual = 4.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.941983357532       residual = 9.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.934954179515       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.924481742513       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.939542247845       residual = 5.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.920643847564       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.022588142993       residual = 1.36e+00           smallest_sin_value = 9.98e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.918121509192       residual = 3.67e-01           smallest_sin_value = 9.91e-01
davidson iteration   87 stopping due to small subspace S singular value of 7.31e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+11 is 1.264996e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.228486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6525e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2477
    reference variance = 0.760973
====================================================
  Execution time = 2.7421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8627e-01
  Total weights = 1.9663e+06
  Execution time = 2.3185e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372601442
  error estimate for blocks of size 2^( 2) =       0.000386878224
  error estimate for blocks of size 2^( 3) =       0.000399552658
  error estimate for blocks of size 2^( 4) =       0.000408817659
  error estimate for blocks of size 2^( 5) =       0.000414555743
  error estimate for blocks of size 2^( 6) =       0.000418091581
  error estimate for blocks of size 2^( 7) =       0.000421612753

      target function =      -0.934403797937
              le_mean =     -17.209222806278
             les_mean =     296.443621851624
             stat err =       0.000415769434
             autocorr =       1.245133887748
   target nu stat err =       0.000415769434
   target dn stat err =       0.002136275906
      target stat err =       0.003609446706
              std dev =       0.526946444106
             le_variance =       0.277672554956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372601442
  error estimate for blocks of size 2^( 2) =       0.000386878224
  error estimate for blocks of size 2^( 3) =       0.000399552658
  error estimate for blocks of size 2^( 4) =       0.000408817659
  error estimate for blocks of size 2^( 5) =       0.000414555743
  error estimate for blocks of size 2^( 6) =       0.000418091581
  error estimate for blocks of size 2^( 7) =       0.000421612753

      target function =      -0.934403797937
              le_mean =     -17.209222806278
             les_mean =     296.443621851624
             stat err =       0.000415769434
             autocorr =       1.245133887748
   target nu stat err =       0.000415769434
   target dn stat err =       0.002136275906
      target stat err =       0.003609446706
              std dev =       0.526946444106
             le_variance =       0.277672554956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372601442
  error estimate for blocks of size 2^( 2) =       0.000386878224
  error estimate for blocks of size 2^( 3) =       0.000399552658
  error estimate for blocks of size 2^( 4) =       0.000408817659
  error estimate for blocks of size 2^( 5) =       0.000414555743
  error estimate for blocks of size 2^( 6) =       0.000418091581
  error estimate for blocks of size 2^( 7) =       0.000421612753

      target function =      -0.934403797937
              le_mean =     -17.209222806278
             les_mean =     296.443621851624
             stat err =       0.000415769434
             autocorr =       1.245133887747
   target nu stat err =       0.000415769434
   target dn stat err =       0.002136275906
      target stat err =       0.003609446706
              std dev =       0.526946444106
             le_variance =       0.277672554956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277669707140
                                         uncertainty =       0.001874683191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372601442
  error estimate for blocks of size 2^( 2) =       0.000386878224
  error estimate for blocks of size 2^( 3) =       0.000399552658
  error estimate for blocks of size 2^( 4) =       0.000408817659
  error estimate for blocks of size 2^( 5) =       0.000414555743
  error estimate for blocks of size 2^( 6) =       0.000418091581
  error estimate for blocks of size 2^( 7) =       0.000421612753

      target function =      -0.934403797937
              le_mean =     -17.209222806278
             les_mean =     296.443621851624
             stat err =       0.000415769434
             autocorr =       1.245133887748
   target nu stat err =       0.000415769434
   target dn stat err =       0.002136275906
      target stat err =       0.003609446706
              std dev =       0.526946444106
             le_variance =       0.277672554956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934403797937        initial
     9.7656e+09     9.7656e+10             3.6894e-14        -0.934403797937
     3.9062e+10     3.9062e+11             8.8141e-15        -0.934403797937
     1.5625e+11     1.5625e+12             1.2650e-15        -0.934403797937  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+11     and shift_s =   1.5625e+12
*****************************************************************************

  Execution time = 3.9178e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1483
    reference variance = 0.267346
====================================================
  Execution time = 2.8199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8511e-01
  Total weights = 1.966485819e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3977e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276281771241
                                         uncertainty =       0.001839157219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276281771241
                                         uncertainty =       0.001839157219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371646805
  error estimate for blocks of size 2^( 2) =       0.000386201992
  error estimate for blocks of size 2^( 3) =       0.000399313590
  error estimate for blocks of size 2^( 4) =       0.000409119547
  error estimate for blocks of size 2^( 5) =       0.000414820737
  error estimate for blocks of size 2^( 6) =       0.000417639866
  error estimate for blocks of size 2^( 7) =       0.000420312526

      target function =      -0.936309064365
              le_mean =     -17.209851303682
             les_mean =     296.464093460030
             stat err =       0.000415473169
             autocorr =       1.249755789846
   target nu stat err =       0.000415473169
   target dn stat err =       0.002496024330
      target stat err =       0.004215565590
              std dev =       0.525596361517
             le_variance =       0.276251535240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720985130368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936327145596       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936327145596       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936327145596       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936327145596       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936327145596       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936327145459       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936265838964       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936362137099       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936353529950       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936328843490       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936331637036       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936335785986       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936248165403       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936280885769       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936358305438       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936260021008       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936355734288       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936292899275       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936343156292       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936282144463       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936428592987       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936331433127       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936343075669       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936275221395       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936363492276       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936349120243       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936410389318       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936412448441       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936258957805       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936402345672       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936310638414       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936425757814       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936411707738       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936256917005       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936353497179       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936333245957       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936196853921       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936026363997       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936329105966       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936394583998       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936172447974       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936157818220       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936401835858       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936338150032       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935895508542       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.936491261065       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.936102091457       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.935668500962       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.936419619435       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.935904571088       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.936725373104       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.935737992521       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936067321528       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.936506460675       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.936296583544       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937277592625       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.936353346779       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.936136063312       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.935963977154       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936096013698       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.936494609150       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935295490166       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.936164570071       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.934949436505       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.936528072126       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935266301692       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934996733817       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936238241307       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.935784133386       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937697209230       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.937126297866       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.936886013832       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937418365958       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.937873402975       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936910204108       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938486766426       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.937756188020       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.931326617985       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934020953067       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.935604846253       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.934982554968       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.935236800369       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.934454129332       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.929143487013       residual = 9.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.933896958026       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.927495497410       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   86 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+10 is 9.636198e-15

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936327145596       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936327145596       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936327145596       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936327142908       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936327145596       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936238440186       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936413922949       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936176916062       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936518171288       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936412085265       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936188849309       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936382074759       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936301842639       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936397914952       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935864400015       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936363476839       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936000055051       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935957636803       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936577785158       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936742067792       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936383894607       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936286814419       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936344473273       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936283411921       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935899021894       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935935359824       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936221826178       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936080909848       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936355702205       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936502321101       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936232865621       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936080593324       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936556757407       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935334848701       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937414837611       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936236005724       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936784704678       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933935823439       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937022840932       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936110841817       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935603268008       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934800096825       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934151141876       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935134482860       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935670797449       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938025229853       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.936666276001       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.936053104593       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.936789982513       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.936212524477       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937111542051       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934833666362       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940202309372       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937057112284       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934446900896       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937012637209       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.934121363227       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.937515646653       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.933502852224       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.935630216947       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937181564459       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937063394417       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932753875335       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935373386738       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.929731108641       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939710811853       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.939189058346       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.942106644316       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.926022476233       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.928062134544       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.909753400433       residual = 6.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.934169041620       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.931926201288       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.933278690459       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.935074963740       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.928405081272       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.939875695136       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.933660751328       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.951496545297       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.926056820996       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.932047940901       residual = 9.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.929455935417       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.904612157605       residual = 9.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.952101886089       residual = 5.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.949348034428       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.881494765949       residual = 5.69e-01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+11 is 1.475314e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936327145596       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936327145596       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936327145596       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936327145596       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936327145018       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937044185085       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936006843644       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934635556999       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936163389655       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936122616535       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936390875358       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935303569888       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936455838126       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936028717203       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935576950865       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936989939336       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932755082577       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934602366179       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932157405464       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933964683931       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937434908925       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935419708380       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934398177626       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935319716097       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934261246815       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935116731201       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936219936637       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933269480130       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936171047923       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936450411968       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935570558379       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937310814416       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936085090773       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936495995601       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935346081286       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934167780898       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939826565132       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937570705537       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929942850418       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933077093342       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943278734249       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931791961839       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940422633498       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940969452600       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.961369612443       residual = 6.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915108555695       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943240336240       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.938371239256       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906997097298       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911353508251       residual = 6.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.934553313875       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.933572891642       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.957001753828       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.929419266919       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.923977993999       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.962717100429       residual = 8.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.975586401164       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.973973832727       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.926180808900       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.928189250968       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.973821453694       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937507514724       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.900639670909       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.922067101676       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.906321403197       residual = 8.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.883842589430       residual = 3.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.969196147566       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.057864943620       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.974144208424       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.011375106978       residual = 7.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.906701713452       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.975678812082       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.966207841754       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.016669311067       residual = 8.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.087587444974       residual = 2.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.773806242976       residual = 3.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.984265520903       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.903193766427       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.941571883419       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.780900427359       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.150501047377       residual = 4.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.729149227631       residual = 6.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.070969827965       residual = 4.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.484504805622       residual = 3.09e+01           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.033269054302       residual = 2.50e+00           smallest_sin_value = 9.91e-01
davidson iteration   85 stopping due to small subspace S singular value of 8.37e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+11 is 2.278946e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.923966 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7299e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2745
    reference variance = 0.439443
====================================================
  Execution time = 2.7342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8524e-01
  Total weights = 1.9662e+06
  Execution time = 2.3232e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371512204
  error estimate for blocks of size 2^( 2) =       0.000385833297
  error estimate for blocks of size 2^( 3) =       0.000398577772
  error estimate for blocks of size 2^( 4) =       0.000407955704
  error estimate for blocks of size 2^( 5) =       0.000414137461
  error estimate for blocks of size 2^( 6) =       0.000416831507
  error estimate for blocks of size 2^( 7) =       0.000420162013

      target function =      -0.936085527639
              le_mean =     -17.210228694993
             les_mean =     296.477214198669
             stat err =       0.000414771671
             autocorr =       1.246441798503
   target nu stat err =       0.000414771671
   target dn stat err =       0.002298301612
      target stat err =       0.003892998770
              std dev =       0.525406003303
             le_variance =       0.276051468307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371512204
  error estimate for blocks of size 2^( 2) =       0.000385833297
  error estimate for blocks of size 2^( 3) =       0.000398577772
  error estimate for blocks of size 2^( 4) =       0.000407955704
  error estimate for blocks of size 2^( 5) =       0.000414137461
  error estimate for blocks of size 2^( 6) =       0.000416831507
  error estimate for blocks of size 2^( 7) =       0.000420162013

      target function =      -0.936085527639
              le_mean =     -17.210228694993
             les_mean =     296.477214198669
             stat err =       0.000414771671
             autocorr =       1.246441798501
   target nu stat err =       0.000414771671
   target dn stat err =       0.002298301612
      target stat err =       0.003892998770
              std dev =       0.525406003303
             le_variance =       0.276051468307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371512204
  error estimate for blocks of size 2^( 2) =       0.000385833297
  error estimate for blocks of size 2^( 3) =       0.000398577772
  error estimate for blocks of size 2^( 4) =       0.000407955704
  error estimate for blocks of size 2^( 5) =       0.000414137461
  error estimate for blocks of size 2^( 6) =       0.000416831507
  error estimate for blocks of size 2^( 7) =       0.000420162013

      target function =      -0.936085527639
              le_mean =     -17.210228694993
             les_mean =     296.477214198669
             stat err =       0.000414771671
             autocorr =       1.246441798506
   target nu stat err =       0.000414771671
   target dn stat err =       0.002298301612
      target stat err =       0.003892998770
              std dev =       0.525406003303
             le_variance =       0.276051468307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276054580149
                                         uncertainty =       0.001402870440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371512204
  error estimate for blocks of size 2^( 2) =       0.000385833297
  error estimate for blocks of size 2^( 3) =       0.000398577772
  error estimate for blocks of size 2^( 4) =       0.000407955704
  error estimate for blocks of size 2^( 5) =       0.000414137461
  error estimate for blocks of size 2^( 6) =       0.000416831507
  error estimate for blocks of size 2^( 7) =       0.000420162013

      target function =      -0.936085527639
              le_mean =     -17.210228694993
             les_mean =     296.477214198669
             stat err =       0.000414771671
             autocorr =       1.246441798505
   target nu stat err =       0.000414771671
   target dn stat err =       0.002298301612
      target stat err =       0.003892998770
              std dev =       0.525406003303
             le_variance =       0.276051468307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936085527639        initial
     3.9062e+10     3.9062e+11             9.6362e-15        -0.936085527639  <--
     1.5625e+11     1.5625e+12             1.4753e-15        -0.936085527639
     6.2500e+11     6.2500e+12             2.2789e-16        -0.936085527639

*****************************************************************************
Applying the update for shift_i =   3.9062e+10     and shift_s =   3.9062e+11
*****************************************************************************

  Execution time = 3.9135e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1411
    reference variance = 0.15934
====================================================
  Execution time = 2.9899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0462e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8236e-01
  Total weights = 1.966325819e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5204e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274106896052
                                         uncertainty =       0.001413009861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274106896052
                                         uncertainty =       0.001413009861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370173894
  error estimate for blocks of size 2^( 2) =       0.000384655180
  error estimate for blocks of size 2^( 3) =       0.000397990091
  error estimate for blocks of size 2^( 4) =       0.000407951580
  error estimate for blocks of size 2^( 5) =       0.000414635885
  error estimate for blocks of size 2^( 6) =       0.000416146344
  error estimate for blocks of size 2^( 7) =       0.000416609658

      target function =      -0.940934618104
              le_mean =     -17.209024976010
             les_mean =     296.432895642132
             stat err =       0.000413835867
             autocorr =       1.249811970776
   target nu stat err =       0.000413835867
   target dn stat err =       0.001803318269
      target stat err =       0.003112189093
              std dev =       0.523513317724
             le_variance =       0.274066193834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720902497601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940943873016       residual = 7.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940943873016       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940943873016       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940943873016       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940943873016       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940943873016       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940943873016       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940955286708       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940951031649       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940943873016       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940916680441       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940943873016       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940966440751       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940945045850       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940954113535       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940967641121       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940954351472       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940922988599       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940941647314       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940933445868       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940900419803       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940960514478       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940919399638       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940905659330       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940959817717       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940949734040       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940927522060       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940951797295       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940921575196       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940932722177       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940917919753       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940922440189       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940958222570       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940912770449       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940986449214       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940972384936       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940921199274       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940926288492       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940961113361       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940922206816       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940946635855       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940911777350       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940993150438       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940872185879       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940965275974       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940962843235       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940967918688       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940933750674       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.940961243459       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.940789553948       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940885232177       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.940960719272       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940939598416       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941195154024       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.940739702217       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.940866016958       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.940926362658       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941108941201       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941182587382       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.940905973646       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.940808944952       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.940648054871       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940971568461       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940737156000       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.941906586463       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941025165048       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940714031578       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.940469939589       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.940723127552       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.940586074116       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.940836688253       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.941021523911       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.941028600442       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940726170957       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.940921806818       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.941170810340       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.939855192879       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.941075939693       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.943359490207       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940172191811       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.940015369095       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.941723517316       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.940873400282       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.939949789096       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943208696115       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.939605428655       residual = 8.78e-04           smallest_sin_value = 9.95e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.937991230871       residual = 2.05e-03           smallest_sin_value = 9.91e-01
davidson iteration   87 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+09 is 5.731126e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940943873016       residual = 7.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940943873016       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940943873016       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940943873016       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940943873016       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940943873016       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940943873016       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940943873016       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940943873016       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940943873016       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940943873016       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940943873016       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940985344859       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940943873016       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940943873016       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940943873016       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940938240059       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940919217363       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941015014005       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940943873016       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940969844332       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940797218385       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940908164669       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940951123950       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941010587006       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940978246878       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940836849587       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940860381515       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940772335903       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940995694515       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940843891345       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941017548271       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941133105115       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941157138606       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940925666419       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940925687174       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941098249125       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941023217247       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940982803803       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941291045443       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940888336888       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940977378409       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940906058201       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940899582706       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940929651946       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940813678206       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940923469318       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941335725963       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941062019490       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941094711726       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940551333810       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.940848213744       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940440665350       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.941402691499       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.941501620819       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.940999717078       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941521138144       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941269325719       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941010028703       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.940772387222       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939632095241       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939567008075       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940985206466       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.942031722505       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.941922027514       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.940962697692       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.942552629447       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.939337408397       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.944311886053       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.940241597221       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.940491799761       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.942674388253       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.942843675623       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.943522013065       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.950625880490       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938713639871       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.950507723596       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943846115269       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.942807887726       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.942207959192       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.942636227162       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.928067266673       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.956657918447       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.940369205023       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.939115226425       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.945081609483       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.937202954435       residual = 7.86e-03           smallest_sin_value = 9.92e-01
davidson iteration   87 stopping due to small subspace S singular value of 7.46e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+10 is 1.405290e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940943873016       residual = 7.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940943873016       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940943873016       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940943873016       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940943873016       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941001461183       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940943873016       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940943873016       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940943873016       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940943873016       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940943873016       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940943873016       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940943873016       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941017355584       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940943873016       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941109364055       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940943873016       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940291256488       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941093433837       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941394205598       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940783225025       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941147292022       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940773499939       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940690142306       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940347788777       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940626602171       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941008042363       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941589166375       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941391888941       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942348309340       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940938396651       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939021502021       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942051175157       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940793439589       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941768412956       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941580094279       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941830822705       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941222482522       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940968728279       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941544506301       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941799930173       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940219349780       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942644792222       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939562253533       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939307499752       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940680233452       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938942532221       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.941158935073       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941727014896       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.938926428236       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943777200819       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.941633528696       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942742795389       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.936714930486       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.941300148806       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937447825365       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.942576933247       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942556813340       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938178590073       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.939077075918       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.942999754935       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941601861729       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931652296319       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940778699417       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.945552349977       residual = 9.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935680798570       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.937352768559       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.941110902342       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.943157024074       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.932783620453       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.944975761263       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944228224428       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.923697909965       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.973497462729       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.947992988620       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.925058756011       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.928027812837       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.957341561522       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934494064423       residual = 9.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.924749671226       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.941222879501       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.956605205890       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.920693212199       residual = 2.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.916567730969       residual = 9.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.825769437363       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.946077941463       residual = 2.49e-01           smallest_sin_value = 9.96e-01
davidson iteration   86 stopping due to small subspace S singular value of 7.95e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+11 is 3.440060e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.643436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9147e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.247472
====================================================
  Execution time = 2.7298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8816e-01
  Total weights = 1.9666e+06
  Execution time = 2.3252e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371923341
  error estimate for blocks of size 2^( 2) =       0.000386021779
  error estimate for blocks of size 2^( 3) =       0.000399044071
  error estimate for blocks of size 2^( 4) =       0.000409222918
  error estimate for blocks of size 2^( 5) =       0.000414856865
  error estimate for blocks of size 2^( 6) =       0.000417800113
  error estimate for blocks of size 2^( 7) =       0.000419820677

      target function =      -0.931277845663
              le_mean =     -17.209244524811
             les_mean =     296.446260233798
             stat err =       0.000415425143
             autocorr =       1.247609542411
   target nu stat err =       0.000415425143
   target dn stat err =       0.002725586521
      target stat err =       0.004538081478
              std dev =       0.525987448253
             le_variance =       0.276662795719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371923341
  error estimate for blocks of size 2^( 2) =       0.000386021779
  error estimate for blocks of size 2^( 3) =       0.000399044071
  error estimate for blocks of size 2^( 4) =       0.000409222918
  error estimate for blocks of size 2^( 5) =       0.000414856865
  error estimate for blocks of size 2^( 6) =       0.000417800113
  error estimate for blocks of size 2^( 7) =       0.000419820677

      target function =      -0.931277845663
              le_mean =     -17.209244524811
             les_mean =     296.446260233798
             stat err =       0.000415425143
             autocorr =       1.247609542409
   target nu stat err =       0.000415425143
   target dn stat err =       0.002725586521
      target stat err =       0.004538081478
              std dev =       0.525987448253
             le_variance =       0.276662795719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371923341
  error estimate for blocks of size 2^( 2) =       0.000386021779
  error estimate for blocks of size 2^( 3) =       0.000399044071
  error estimate for blocks of size 2^( 4) =       0.000409222918
  error estimate for blocks of size 2^( 5) =       0.000414856865
  error estimate for blocks of size 2^( 6) =       0.000417800113
  error estimate for blocks of size 2^( 7) =       0.000419820677

      target function =      -0.931277845663
              le_mean =     -17.209244524811
             les_mean =     296.446260233798
             stat err =       0.000415425143
             autocorr =       1.247609542412
   target nu stat err =       0.000415425143
   target dn stat err =       0.002725586521
      target stat err =       0.004538081478
              std dev =       0.525987448253
             le_variance =       0.276662795719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276685301471
                                         uncertainty =       0.001682493053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371923341
  error estimate for blocks of size 2^( 2) =       0.000386021779
  error estimate for blocks of size 2^( 3) =       0.000399044071
  error estimate for blocks of size 2^( 4) =       0.000409222918
  error estimate for blocks of size 2^( 5) =       0.000414856865
  error estimate for blocks of size 2^( 6) =       0.000417800113
  error estimate for blocks of size 2^( 7) =       0.000419820677

      target function =      -0.931277845663
              le_mean =     -17.209244524811
             les_mean =     296.446260233798
             stat err =       0.000415425143
             autocorr =       1.247609542414
   target nu stat err =       0.000415425143
   target dn stat err =       0.002725586521
      target stat err =       0.004538081478
              std dev =       0.525987448253
             le_variance =       0.276662795719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931277845663        initial  <--
     9.7656e+09     9.7656e+10             5.7311e-14        -0.931277845663
     3.9062e+10     3.9062e+11             1.4053e-14        -0.931277845663
     1.5625e+11     1.5625e+12             3.4401e-15        -0.931277845663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0848
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2
    reference variance = 0.25019
====================================================
  Execution time = 2.7435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8348e-01
  Total weights = 1.966453296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4500e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275969115933
                                         uncertainty =       0.002045216397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275969115933
                                         uncertainty =       0.002045216397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371436482
  error estimate for blocks of size 2^( 2) =       0.000385755557
  error estimate for blocks of size 2^( 3) =       0.000399069686
  error estimate for blocks of size 2^( 4) =       0.000408670315
  error estimate for blocks of size 2^( 5) =       0.000413705964
  error estimate for blocks of size 2^( 6) =       0.000417317584
  error estimate for blocks of size 2^( 7) =       0.000420108278

      target function =      -0.939040300348
              le_mean =     -17.209582464869
             les_mean =     296.453208214623
             stat err =       0.000414950535
             autocorr =       1.248025742367
   target nu stat err =       0.000414950535
   target dn stat err =       0.002115067919
      target stat err =       0.003612087424
              std dev =       0.525298915357
             le_variance =       0.275938950475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720958246487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939053365027       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939053365027       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939053365027       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939032135494       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938978117952       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939075415921       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939040563689       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939062872656       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939313788185       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939047254691       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938976703206       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938934816855       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939183340334       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939156888818       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938567934370       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939072162874       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939146470082       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939124316137       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938867940605       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939004269532       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938693868150       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939190803679       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938806896323       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938158967893       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938731305922       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938930537305       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939058329029       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939095830243       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939142206043       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938822699273       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938918076443       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939200767858       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939505151345       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937964600093       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939654424273       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939115928985       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938855945744       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938557403552       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939177675980       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938594558721       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940022962370       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938014163441       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938068334866       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940846788507       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939811178310       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939835976253       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939538899007       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939889087740       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.938750658699       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939989800662       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937770880588       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939800599402       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939618297762       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.938988843099       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939923546677       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.938908505561       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939561539557       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.938653464957       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937431878850       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.940327543728       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941199439611       residual = 8.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939017207404       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938859583709       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.936291778030       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.937380676858       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.933515480663       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.939018294540       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.940154588566       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.942381150744       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.929800697556       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.962090386392       residual = 5.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.952146674249       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.959084801561       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.932538982797       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.898532493607       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.922955102621       residual = 3.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.954860693546       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.911978693820       residual = 8.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.985464291793       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.947551908313       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.925319272949       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.964241115773       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.927664617386       residual = 8.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.924973438915       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.992244927640       residual = 2.40e-01           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.997912853901       residual = 5.51e-01           smallest_sin_value = 9.95e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.82e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+10 is 2.100515e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939053365027       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939053365027       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939053365027       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938968593822       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939053365027       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939220244032       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938655665639       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938721668839       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939561818565       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938628191639       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938933975322       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939565624800       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938785213021       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937811741240       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938319725670       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938413394389       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938281433437       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939706017101       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937851158074       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937822823944       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940684475329       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939198135805       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939274405524       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939864650298       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939125635542       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943579339440       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936359468567       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939905779431       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936686893950       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939024128957       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936853624033       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936028221517       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938823977692       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936392192758       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940167300666       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937667500295       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937868264537       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938484404703       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936616149162       residual = 9.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940918459185       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941236152534       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940209833376       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938933750422       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939888290101       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.942844005194       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938113222460       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.937278395852       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942301692569       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947183673748       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.949959044205       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.922060102865       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939121680258       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.947050476236       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937968940765       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.921145704057       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935819384501       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.941028280500       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941152206746       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.934975543013       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.926552567284       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.935750655246       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.931551465913       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934039487629       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.901029511319       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.947914060337       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.926250705663       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.941620847297       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.952590413725       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.921192229957       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.933470935808       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.003888556309       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.935936008539       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.891647188036       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.888417694453       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.011939455525       residual = 5.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.957687191403       residual = 7.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.908088951153       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.979790366452       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.978013586215       residual = 7.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.993548941376       residual = 3.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.905493334943       residual = 9.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.934095823021       residual = 7.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.991821496457       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.942963765999       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.956884457056       residual = 1.35e+00           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.849223895129       residual = 9.73e-01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.84e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 3.902013e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939053365027       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939053365027       residual = 9.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939053365027       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939367093287       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939053365248       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938532887307       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938089454872       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936914960164       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937965918991       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939430414912       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940877915683       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937968700186       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939984293377       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941043602040       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937949634409       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929590877727       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937904398402       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925628725234       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949946925433       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936909542975       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945403929391       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930835816730       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930930276218       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941544620575       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947365795615       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932490050792       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937010248604       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947016774691       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951944195524       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938447734412       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.949490516016       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924810546469       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.958317454040       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951897359637       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924510476725       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936576576587       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.956725156355       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951393240144       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927421757408       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947244082497       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941352346198       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929870692565       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.923575593837       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.963082330970       residual = 5.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943570775123       residual = 5.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.969529083285       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930844814761       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.964052745570       residual = 8.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.961044586691       residual = 5.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.916548885478       residual = 8.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.944686604615       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931039571216       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.896207584778       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.959153784387       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.901135460660       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.952473391952       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.889226357107       residual = 2.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.985712526175       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938513474006       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.956966360448       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.895691275904       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.931242343952       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.005475070191       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.970588661746       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930292063144       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.853548178664       residual = 8.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.995169548670       residual = 9.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.833992847580       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.833150899686       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.886281320269       residual = 2.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.990283866891       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.869392283651       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.971545661909       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.938180668506       residual = 7.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.071105582453       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.997510094692       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.644857570918       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.231305026115       residual = 4.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.835516410369       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.603203278139       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.505086527945       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.556892971271       residual = 2.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.818041047503       residual = 6.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.982431346898       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.172589884780       residual = 3.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.221829297799       residual = 1.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   86 stopping due to small subspace S singular value of 9.52e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 9.180795e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.356872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6606e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.189925
====================================================
  Execution time = 2.7420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9205e-01
  Total weights = 1.9664e+06
  Execution time = 2.3191e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373851546
  error estimate for blocks of size 2^( 2) =       0.000388141943
  error estimate for blocks of size 2^( 3) =       0.000401411416
  error estimate for blocks of size 2^( 4) =       0.000410609912
  error estimate for blocks of size 2^( 5) =       0.000416893963
  error estimate for blocks of size 2^( 6) =       0.000420716809
  error estimate for blocks of size 2^( 7) =       0.000421574946

      target function =      -0.924864832147
              le_mean =     -17.209948482593
             les_mean =     296.474377643403
             stat err =       0.000417448907
             autocorr =       1.246833021441
   target nu stat err =       0.000417448907
   target dn stat err =       0.004585105103
      target stat err =       0.007476726290
              std dev =       0.528714385739
             le_variance =       0.279538901687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373851546
  error estimate for blocks of size 2^( 2) =       0.000388141943
  error estimate for blocks of size 2^( 3) =       0.000401411416
  error estimate for blocks of size 2^( 4) =       0.000410609912
  error estimate for blocks of size 2^( 5) =       0.000416893963
  error estimate for blocks of size 2^( 6) =       0.000420716809
  error estimate for blocks of size 2^( 7) =       0.000421574946

      target function =      -0.924864832147
              le_mean =     -17.209948482593
             les_mean =     296.474377643403
             stat err =       0.000417448907
             autocorr =       1.246833021440
   target nu stat err =       0.000417448907
   target dn stat err =       0.004585105103
      target stat err =       0.007476726290
              std dev =       0.528714385739
             le_variance =       0.279538901687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373851546
  error estimate for blocks of size 2^( 2) =       0.000388141943
  error estimate for blocks of size 2^( 3) =       0.000401411416
  error estimate for blocks of size 2^( 4) =       0.000410609912
  error estimate for blocks of size 2^( 5) =       0.000416893963
  error estimate for blocks of size 2^( 6) =       0.000420716809
  error estimate for blocks of size 2^( 7) =       0.000421574946

      target function =      -0.924864832147
              le_mean =     -17.209948482593
             les_mean =     296.474377643403
             stat err =       0.000417448907
             autocorr =       1.246833021436
   target nu stat err =       0.000417448907
   target dn stat err =       0.004585105103
      target stat err =       0.007476726290
              std dev =       0.528714385739
             le_variance =       0.279538901687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279550748312
                                         uncertainty =       0.002264974807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373851546
  error estimate for blocks of size 2^( 2) =       0.000388141943
  error estimate for blocks of size 2^( 3) =       0.000401411416
  error estimate for blocks of size 2^( 4) =       0.000410609912
  error estimate for blocks of size 2^( 5) =       0.000416893963
  error estimate for blocks of size 2^( 6) =       0.000420716809
  error estimate for blocks of size 2^( 7) =       0.000421574946

      target function =      -0.924864832147
              le_mean =     -17.209948482593
             les_mean =     296.474377643403
             stat err =       0.000417448907
             autocorr =       1.246833021443
   target nu stat err =       0.000417448907
   target dn stat err =       0.004585105103
      target stat err =       0.007476726290
              std dev =       0.528714385739
             le_variance =       0.279538901687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924864832147        initial
     9.7656e+10     9.7656e+11             2.1005e-15        -0.924864832147
     3.9062e+11     3.9062e+12             3.9020e-16        -0.924864832147
     1.5625e+12     1.5625e+13             9.1808e-17        -0.924864832147  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 3.9183e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.177847
====================================================
  Execution time = 2.7520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8837e-01
  Total weights = 1.966263861e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5137e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276790797588
                                         uncertainty =       0.001546356254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276790797588
                                         uncertainty =       0.001546356254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372010652
  error estimate for blocks of size 2^( 2) =       0.000386397855
  error estimate for blocks of size 2^( 3) =       0.000400225821
  error estimate for blocks of size 2^( 4) =       0.000409931141
  error estimate for blocks of size 2^( 5) =       0.000415641710
  error estimate for blocks of size 2^( 6) =       0.000417042199
  error estimate for blocks of size 2^( 7) =       0.000416691239

      target function =      -0.930929328399
              le_mean =     -17.209867514740
             les_mean =     296.467907288659
             stat err =       0.000414826572
             autocorr =       1.243432990401
   target nu stat err =       0.000414826572
   target dn stat err =       0.002250924526
      target stat err =       0.003771946352
              std dev =       0.526110926609
             le_variance =       0.276792707098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720986751474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930943680283       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930943680283       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930943680283       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930943680283       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930943680273       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930943680283       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930824069246       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931460194740       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930910279178       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930765881869       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930815210096       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931248980594       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931095426715       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930239566382       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931815074301       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930882096841       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930604291619       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929770474497       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929047934590       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930911232214       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931754776060       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930772631602       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930580979956       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927583798587       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935551998683       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927956379182       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929260501462       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929719331739       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932093899033       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928908682285       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929021142799       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933009142734       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929961811251       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928669659183       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.926449599410       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927306975632       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927824810475       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933057284014       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933369337747       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929166225357       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932392337387       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933490202305       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935584009036       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.928226383972       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.930290019302       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.933768681838       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930631756063       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.930578096171       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929473042451       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.929029490629       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932128752683       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.927469783637       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.924960620607       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.952939501026       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.930790141816       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.924872148015       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.924525511567       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.925163163662       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.928171947980       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.922161660744       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.929443903032       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.919054691306       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.944284732898       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.864191079020       residual = 5.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.882824572445       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.920892939404       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.931159354918       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926373300878       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.898298649364       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.944209239402       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.881575566336       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932739879496       residual = 5.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.915135245242       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940936315813       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.931765369435       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.924078372607       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.889043350600       residual = 3.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.924166625727       residual = 7.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.984374723890       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.912743910189       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.965279937961       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.020813834617       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.879370592152       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.863901375734       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.692962481344       residual = 5.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.877003953528       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.967779922755       residual = 1.26e+00           smallest_sin_value = 9.99e-01
davidson iteration   87:   krylov dim =  88   tar_fn =      -1.204390632833       residual = 7.09e+00           smallest_sin_value = 9.97e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 1.188858e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930943680283       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930943680283       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930943680283       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930943680283       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930943680283       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930943321935       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930942773737       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932142127454       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927877404976       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931749060394       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930689061271       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935857548021       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930440430798       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933022617488       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929276669373       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930624240499       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938318035838       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930853296512       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934035411214       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933007331438       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928065838762       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.926922643620       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929812405124       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929593173910       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925644562336       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930386480988       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928670902379       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920994987396       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928913702758       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929707650334       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930765793630       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918156231483       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929683150850       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930173857622       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924140271869       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941639600739       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934378029823       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925905481854       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.926872606786       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912922998844       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925900565496       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937550810694       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932684866357       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.966334922623       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937481767661       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941883838028       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941992389293       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939608946998       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.901920753807       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.932973550228       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.936957681182       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.951539410775       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.961626375117       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.923459596566       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947063303180       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.962496953888       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.898136110408       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.945295878499       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.977942391965       residual = 3.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.994331855420       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.955875481146       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.922761513143       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934078312851       residual = 3.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.017578705596       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.978215697552       residual = 3.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.018094150544       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.898706125311       residual = 4.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.886541829630       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.880471972185       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.993602713186       residual = 8.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.871193569506       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.858101678572       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.966199222374       residual = 6.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.846291738419       residual = 4.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.899537762755       residual = 4.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.137126471059       residual = 8.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.258352541114       residual = 1.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.963252969857       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.799676249095       residual = 6.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.199418445254       residual = 5.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.747102384841       residual = 3.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.450060659722       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.371077249312       residual = 2.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.092836797935       residual = 5.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.075629993273       residual = 5.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.943258626658       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.936441848883       residual = 1.10e+02           smallest_sin_value = 9.95e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 9.953931e-17

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930943680283       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930943680283       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930943680283       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930943680283       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930943680283       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931524174901       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931100031524       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928897506687       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915049320876       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934331697042       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918964909952       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906241928449       residual = 7.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943092526596       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930671187907       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936923463290       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947771591372       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916610454447       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939761378740       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935334570775       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920979626979       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931808951429       residual = 6.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922998560494       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938492041047       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934518204501       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950667578539       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919266717073       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917054461424       residual = 2.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918135900249       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904166485639       residual = 9.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924154129791       residual = 5.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.967088053722       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915346477622       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917374165882       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.889858189236       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916862317311       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912877736253       residual = 2.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.844633974104       residual = 8.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912768041759       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.701624534442       residual = 4.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.856824043674       residual = 8.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.890485646831       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919412048746       residual = 7.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.849396878065       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.955591528316       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.894937596616       residual = 9.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948534524609       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.068843611083       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.047210782406       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.807282945993       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.856203827682       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906130806691       residual = 5.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.529877806255       residual = 3.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.556185278896       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.241815526397       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.816350129149       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.052568752064       residual = 5.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.012337598552       residual = 6.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.038417432956       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.953281714524       residual = 2.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.903309071655       residual = 5.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.472338601824       residual = 4.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.245707413420       residual = 2.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.230832238977       residual = 3.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.822261144808       residual = 7.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.044493759394       residual = 7.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.765593148791       residual = 6.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.900731700704       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.912516997581       residual = 2.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.731653157761       residual = 2.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.317222791174       residual = 3.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.195150105312       residual = 5.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =       1.030724529781       residual = 3.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.177630636440       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.686109509358       residual = 4.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.687218231075       residual = 3.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.524001165307       residual = 4.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.312498015750       residual = 1.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.088300700851       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.728388651832       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.018153237899       residual = 9.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.320787576717       residual = 1.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.889830885367       residual = 3.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.743338245524       residual = 1.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.287248714300       residual = 2.68e+02           smallest_sin_value = 9.98e-01
davidson iteration   84 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         84 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+12 is 2.488483e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               9.089432 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6774e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2904
    reference variance = 0.128729
====================================================
  Execution time = 2.7282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8566e-01
  Total weights = 1.9664e+06
  Execution time = 2.3202e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371740238
  error estimate for blocks of size 2^( 2) =       0.000386089273
  error estimate for blocks of size 2^( 3) =       0.000399636012
  error estimate for blocks of size 2^( 4) =       0.000408317464
  error estimate for blocks of size 2^( 5) =       0.000413406646
  error estimate for blocks of size 2^( 6) =       0.000418466212
  error estimate for blocks of size 2^( 7) =       0.000421230219

      target function =      -0.935413466684
              le_mean =     -17.209086788734
             les_mean =     296.438330997270
             stat err =       0.000415355135
             autocorr =       1.248418001567
   target nu stat err =       0.000415355135
   target dn stat err =       0.002335973042
      target stat err =       0.003940615499
              std dev =       0.525728497854
             le_variance =       0.276390453456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371740238
  error estimate for blocks of size 2^( 2) =       0.000386089273
  error estimate for blocks of size 2^( 3) =       0.000399636012
  error estimate for blocks of size 2^( 4) =       0.000408317464
  error estimate for blocks of size 2^( 5) =       0.000413406646
  error estimate for blocks of size 2^( 6) =       0.000418466212
  error estimate for blocks of size 2^( 7) =       0.000421230219

      target function =      -0.935413466684
              le_mean =     -17.209086788734
             les_mean =     296.438330997270
             stat err =       0.000415355135
             autocorr =       1.248418001569
   target nu stat err =       0.000415355135
   target dn stat err =       0.002335973042
      target stat err =       0.003940615499
              std dev =       0.525728497854
             le_variance =       0.276390453456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371740238
  error estimate for blocks of size 2^( 2) =       0.000386089273
  error estimate for blocks of size 2^( 3) =       0.000399636012
  error estimate for blocks of size 2^( 4) =       0.000408317464
  error estimate for blocks of size 2^( 5) =       0.000413406646
  error estimate for blocks of size 2^( 6) =       0.000418466212
  error estimate for blocks of size 2^( 7) =       0.000421230219

      target function =      -0.935413466684
              le_mean =     -17.209086788734
             les_mean =     296.438330997270
             stat err =       0.000415355135
             autocorr =       1.248418001570
   target nu stat err =       0.000415355135
   target dn stat err =       0.002335973042
      target stat err =       0.003940615499
              std dev =       0.525728497854
             le_variance =       0.276390453456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276362632233
                                         uncertainty =       0.001787301887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371740238
  error estimate for blocks of size 2^( 2) =       0.000386089273
  error estimate for blocks of size 2^( 3) =       0.000399636012
  error estimate for blocks of size 2^( 4) =       0.000408317464
  error estimate for blocks of size 2^( 5) =       0.000413406646
  error estimate for blocks of size 2^( 6) =       0.000418466212
  error estimate for blocks of size 2^( 7) =       0.000421230219

      target function =      -0.935413466684
              le_mean =     -17.209086788734
             les_mean =     296.438330997270
             stat err =       0.000415355135
             autocorr =       1.248418001569
   target nu stat err =       0.000415355135
   target dn stat err =       0.002335973042
      target stat err =       0.003940615499
              std dev =       0.525728497854
             le_variance =       0.276390453456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935413466684        initial
     3.9062e+11     3.9062e+12             1.1889e-15        -0.935413466684
     1.5625e+12     1.5625e+13             9.9539e-17        -0.935413466684  <--
     6.2500e+12     6.2500e+13             2.4885e-17        -0.935413466684

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 3.9040e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5821e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2361
    reference variance = 0.169198
====================================================
  Execution time = 2.7877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0467e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9013e-01
  Total weights = 1.966454080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4395e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277942499125
                                         uncertainty =       0.001736349400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277942499125
                                         uncertainty =       0.001736349400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372843660
  error estimate for blocks of size 2^( 2) =       0.000387159837
  error estimate for blocks of size 2^( 3) =       0.000400305171
  error estimate for blocks of size 2^( 4) =       0.000409080703
  error estimate for blocks of size 2^( 5) =       0.000414171674
  error estimate for blocks of size 2^( 6) =       0.000415749828
  error estimate for blocks of size 2^( 7) =       0.000417299827

      target function =      -0.928036507884
              le_mean =     -17.209788318614
             les_mean =     296.466942155852
             stat err =       0.000414075508
             autocorr =       1.233404595627
   target nu stat err =       0.000414075508
   target dn stat err =       0.002933969067
      target stat err =       0.004847453329
              std dev =       0.527288996771
             le_variance =       0.278033686116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720978831861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928061174677       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928061174677       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928061174677       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928070722317       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928060943630       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927894229320       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928301180483       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928230037340       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928423259346       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927761525655       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927985770636       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928088836231       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927644930709       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928050405927       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927807883736       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927697033538       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927192716573       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928762789638       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927780915613       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927690917936       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928885075798       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927048584640       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925295115991       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926562545294       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927716289140       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927138579708       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928428473221       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927459819393       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928639608903       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929253468040       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927127833805       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927826908364       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928031239608       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928038293552       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928572722838       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929682361941       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930203510901       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926883877879       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929962661419       residual = 9.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.926107208463       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928491742779       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928821047302       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.930532026598       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.927396433954       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.927786473952       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.927716774048       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925651650308       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.928812645983       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928596033439       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.927673603698       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.926476453414       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.930435374895       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.927308850984       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.928322644043       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.922885969428       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.928585855292       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.921771645681       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.931635814462       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932956150858       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.917917943912       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.908484698673       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941425089112       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.921637138911       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.923387426283       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.936290219774       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.924352468838       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.907963934074       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.939090971881       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.931309765659       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.899949357180       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.892488252106       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.914647059973       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.935573660302       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.947703492631       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.967898391249       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.890238461808       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.868492822567       residual = 5.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.914958662726       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.904158279399       residual = 9.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.886957923296       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.964939777661       residual = 3.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.880044566259       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.890637686590       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.894722644193       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.051195717233       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.862635914409       residual = 4.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.887046354786       residual = 3.37e-01           smallest_sin_value = 9.95e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.80e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 6.352123e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928061174677       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928061174677       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928061174677       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928061174677       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927707397418       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928119285476       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926066249653       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929789508024       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926031004556       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926378658607       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927726077304       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924517328275       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927061208144       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929830471718       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926666860104       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936547485522       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927850989011       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928994092026       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922980147938       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927880538556       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.921803822418       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929828236707       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924803547866       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.921748894390       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.926839782381       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.926809476390       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928063288612       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932572012107       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928459405343       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921342120659       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919817760679       residual = 8.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928359389349       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.926541720542       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915072201689       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935946135451       residual = 7.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928228294621       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.926467617081       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.920148562676       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934884610482       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909904847213       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940447146080       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915776852699       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.961621234416       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910324863899       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.900709034545       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904278902082       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917108382560       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.942369707040       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.917812863574       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918589393172       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.918674896801       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.917117608229       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.908743869836       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940946107006       residual = 6.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.917100901481       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.921928012820       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.921927988506       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.885396861540       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941524201670       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936085248440       residual = 8.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.858130577106       residual = 8.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912238461896       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.965628338102       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.909597912399       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.936794081104       residual = 3.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.934636122042       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.985106589277       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.934186469651       residual = 8.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.883932707316       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.856763080340       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.864817253590       residual = 4.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.848171082865       residual = 3.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.910145426803       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.006664132122       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.909221629143       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.852525377456       residual = 5.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.670325234339       residual = 9.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.778915338481       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.258633295808       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.124308308207       residual = 8.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.985313138601       residual = 8.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.839052301248       residual = 2.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.689093437544       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.895910796986       residual = 5.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.891618545794       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.619168371287       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.225192894407       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -1.441050025384       residual = 2.03e+02           smallest_sin_value = 9.97e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.30e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 8.727840e-17

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928061174677       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928061174677       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928061174677       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930429794705       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928061174660       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930002807255       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927848088433       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932791591413       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924287418554       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933065948695       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928737233409       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923092143088       residual = 6.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929353129531       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947005431521       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925342936887       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925699202121       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913670928544       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914807354385       residual = 7.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937530367524       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910742125624       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920762419940       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934896896217       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918155241476       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936450422387       residual = 6.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927371867535       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908276205270       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.890169042277       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932764670179       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911158180199       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939367542941       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928841798748       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908688743807       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911961387561       residual = 7.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905301490666       residual = 9.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902748348684       residual = 5.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.878493903789       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.989896661625       residual = 7.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.011805145977       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942029969637       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.955188947438       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905784096309       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.957873838778       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.968559655009       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.983957885967       residual = 6.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947380545116       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.907416283252       residual = 4.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.874575572590       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.897175603694       residual = 6.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.815035134229       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.970789799851       residual = 6.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.931700165104       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.051678837639       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.631185405344       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.978799174312       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.819622461814       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.320548837322       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.068933050031       residual = 6.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.927849535119       residual = 4.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.869926823470       residual = 5.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.981882374846       residual = 4.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.924716749344       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.884816799394       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.814499786974       residual = 7.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.800315195730       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.833574883505       residual = 8.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.883670494580       residual = 7.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.421807545177       residual = 2.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.502284256123       residual = 5.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.431007652449       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.200550228880       residual = 3.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.570167331615       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.200106251268       residual = 6.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.299165945269       residual = 2.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.592989713693       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.883731108428       residual = 5.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.633886282449       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -2.922162200373       residual = 3.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.265646054233       residual = 8.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -3.318703613981       residual = 6.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.570448629671       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =       0.719815460645       residual = 4.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -2.064818137697       residual = 2.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -2.221381573154       residual = 3.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =       0.643815877534       residual = 4.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.046287781769       residual = 8.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.487689407732       residual = 5.20e+01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+12 is 2.013638e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               9.834284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7069e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.231398
====================================================
  Execution time = 2.7332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8412e-01
  Total weights = 1.9662e+06
  Execution time = 2.3154e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370242704
  error estimate for blocks of size 2^( 2) =       0.000385092013
  error estimate for blocks of size 2^( 3) =       0.000398208730
  error estimate for blocks of size 2^( 4) =       0.000408339339
  error estimate for blocks of size 2^( 5) =       0.000414526128
  error estimate for blocks of size 2^( 6) =       0.000417180515
  error estimate for blocks of size 2^( 7) =       0.000417948698

      target function =      -0.937959376595
              le_mean =     -17.210462155156
             les_mean =     296.484123665414
             stat err =       0.000414498670
             autocorr =       1.253352596606
   target nu stat err =       0.000414498670
   target dn stat err =       0.002160909949
      target stat err =       0.003684807544
              std dev =       0.523610630470
             le_variance =       0.274168092341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370242704
  error estimate for blocks of size 2^( 2) =       0.000385092013
  error estimate for blocks of size 2^( 3) =       0.000398208730
  error estimate for blocks of size 2^( 4) =       0.000408339339
  error estimate for blocks of size 2^( 5) =       0.000414526128
  error estimate for blocks of size 2^( 6) =       0.000417180515
  error estimate for blocks of size 2^( 7) =       0.000417948698

      target function =      -0.937959376595
              le_mean =     -17.210462155156
             les_mean =     296.484123665414
             stat err =       0.000414498670
             autocorr =       1.253352596606
   target nu stat err =       0.000414498670
   target dn stat err =       0.002160909949
      target stat err =       0.003684807544
              std dev =       0.523610630470
             le_variance =       0.274168092341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370242704
  error estimate for blocks of size 2^( 2) =       0.000385092013
  error estimate for blocks of size 2^( 3) =       0.000398208730
  error estimate for blocks of size 2^( 4) =       0.000408339339
  error estimate for blocks of size 2^( 5) =       0.000414526128
  error estimate for blocks of size 2^( 6) =       0.000417180515
  error estimate for blocks of size 2^( 7) =       0.000417948698

      target function =      -0.937959376595
              le_mean =     -17.210462155156
             les_mean =     296.484123665414
             stat err =       0.000414498670
             autocorr =       1.253352596607
   target nu stat err =       0.000414498670
   target dn stat err =       0.002160909949
      target stat err =       0.003684807544
              std dev =       0.523610630470
             le_variance =       0.274168092341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274195682843
                                         uncertainty =       0.001602819827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370242704
  error estimate for blocks of size 2^( 2) =       0.000385092013
  error estimate for blocks of size 2^( 3) =       0.000398208730
  error estimate for blocks of size 2^( 4) =       0.000408339339
  error estimate for blocks of size 2^( 5) =       0.000414526128
  error estimate for blocks of size 2^( 6) =       0.000417180515
  error estimate for blocks of size 2^( 7) =       0.000417948698

      target function =      -0.937959376595
              le_mean =     -17.210462155156
             les_mean =     296.484123665414
             stat err =       0.000414498670
             autocorr =       1.253352596606
   target nu stat err =       0.000414498670
   target dn stat err =       0.002160909949
      target stat err =       0.003684807544
              std dev =       0.523610630470
             le_variance =       0.274168092341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937959376595        initial
     3.9062e+11     3.9062e+12             6.3521e-16        -0.937959376595  <--
     1.5625e+12     1.5625e+13             8.7278e-17        -0.937959376595
     6.2500e+12     6.2500e+13             2.0136e-17        -0.937959376595

*****************************************************************************
Applying the update for shift_i =   3.9062e+11     and shift_s =   3.9062e+12
*****************************************************************************

  Execution time = 3.9061e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1688
    reference variance = 0.202708
====================================================
  Execution time = 3.0121e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8408e-01
  Total weights = 1.966507909e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6845e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276390700954
                                         uncertainty =       0.001645976334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276390700954
                                         uncertainty =       0.001645976334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371722332
  error estimate for blocks of size 2^( 2) =       0.000385905893
  error estimate for blocks of size 2^( 3) =       0.000398806223
  error estimate for blocks of size 2^( 4) =       0.000408342486
  error estimate for blocks of size 2^( 5) =       0.000412758257
  error estimate for blocks of size 2^( 6) =       0.000416765519
  error estimate for blocks of size 2^( 7) =       0.000416238436

      target function =      -0.938040179486
              le_mean =     -17.209190667618
             les_mean =     296.440325595962
             stat err =       0.000413526174
             autocorr =       1.237566943545
   target nu stat err =       0.000413526174
   target dn stat err =       0.002198196959
      target stat err =       0.003737128374
              std dev =       0.525703174978
             le_variance =       0.276363828181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720919066762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938054095522       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938054095522       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938054095522       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938054095522       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938054095522       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938054107220       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938057757568       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938007357011       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937979411419       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937864645732       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937781022118       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938139121534       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938142150311       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938175840619       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938327600579       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937748185671       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938133173154       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938004292369       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937769007739       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937876036358       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938104372123       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937760508668       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937822630589       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938269390590       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937987984763       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937966767576       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937938111252       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938227927191       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937933468731       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938287146637       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938086428522       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938147681274       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938103972606       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937906915922       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937878267827       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938054711075       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937812386154       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938335468955       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937826723336       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938342368122       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937984734622       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938121512102       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938838304059       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937486758521       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938360009656       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938427731468       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939147635682       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.938567946939       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.938652522298       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.938189074864       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.938723294047       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.938780863972       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.938966504723       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.938037526018       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.936458073780       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.938036421171       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.938666002515       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939512766606       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937198404726       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.938316528323       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937816727143       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937103811214       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938467984277       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935678462147       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.940591183289       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941006767640       residual = 9.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.937594494396       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.938005957469       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.936547494004       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.936654488364       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.935428706288       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.937649760399       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937867595078       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.939652610661       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936739350970       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.933349635193       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.940549642353       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.940566105794       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.938726891253       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.952980046446       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.925036194764       residual = 8.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.927159803296       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936628298670       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.949727372565       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.935361584582       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.938084557285       residual = 5.78e-03           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+10 is 2.616658e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938054095522       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938054095522       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938054095522       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938054095522       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938054095895       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938054090584       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938059086456       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937723961438       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937448014337       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938174312065       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938673199029       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937667677206       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938003689383       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937795482814       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938234198062       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938800062924       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937979511364       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937891148200       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937881957996       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937763185196       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938652411825       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938068098592       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937085155476       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937404237549       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938323150813       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936329749074       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936374824100       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937664436756       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938542416311       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939283200427       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935768373637       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933397033341       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935744222899       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940627588178       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938525357816       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939043122767       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936970122605       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940873815564       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942748187436       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942084442532       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944757818173       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936502752668       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935407566809       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939342915721       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937884750187       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937134952982       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941504726831       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943689186301       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932873954840       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933054436051       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.940933977620       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939177139181       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939077214257       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937183254784       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.935238860488       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.931008725384       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.951758206757       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.935640096337       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.952627294557       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941124027791       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.967108358443       residual = 8.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.951300453405       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.897411674952       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.934268908739       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.957739677407       residual = 8.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.968048873712       residual = 9.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.909655608877       residual = 7.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.889709997984       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.998291481492       residual = 3.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.925503093678       residual = 5.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.940060916712       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.968986303157       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.923286908039       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.900626175166       residual = 3.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.965466569665       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.914730795323       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.879864783318       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.935618553285       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.974537314559       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.925575209603       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.760579288794       residual = 3.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.925962419192       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.890765660501       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.990548923253       residual = 3.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.873234744135       residual = 4.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.019911261893       residual = 8.54e-01           smallest_sin_value = 9.93e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 4.699689e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938054095522       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938054095522       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938054095522       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938054095522       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938054095677       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938054150360       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939129944974       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935030394580       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941181168066       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938624241463       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937954682118       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938845943040       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938620113385       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934813092471       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937371409489       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941362816005       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934204933398       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936286047225       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938500851308       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940128187797       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935209607802       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940099840593       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943188985287       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935329498563       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932149250239       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939729261391       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941240128192       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931829452888       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945086942645       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946383881359       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943953884784       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927954376208       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.965913598488       residual = 7.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939256019491       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945899678662       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937981673597       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902501995394       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951657630737       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946415051370       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917273046125       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.953815253253       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929960474977       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933823300555       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.903835401989       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939259678261       residual = 9.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.927069097009       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.969034995291       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.907166885139       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.063392964159       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.940420348516       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.956725351583       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.902737885773       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936115630480       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.914248213390       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.854896223276       residual = 8.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.017659895941       residual = 6.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.956356834738       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.956930704079       residual = 9.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941028921301       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.823465210976       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.976043718121       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.900106349758       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.013148743038       residual = 5.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.936291830657       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.088977288508       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.646591093716       residual = 8.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.832148376021       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.004382924595       residual = 4.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.078123992060       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.811164699392       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.031073488499       residual = 8.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.604517321386       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.950109269907       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.892493000750       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.068971464744       residual = 1.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.887383691503       residual = 3.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.402599847177       residual = 2.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.974088987794       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.433888769476       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.086759517095       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.804708723587       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.882712056759       residual = 8.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.900776162071       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.931384171777       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.764285033798       residual = 1.24e+01           smallest_sin_value = 9.99e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 1.206197e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              10.538738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9518e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.372105
====================================================
  Execution time = 2.7774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8679e-01
  Total weights = 1.9664e+06
  Execution time = 2.3187e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372156469
  error estimate for blocks of size 2^( 2) =       0.000386344179
  error estimate for blocks of size 2^( 3) =       0.000399378625
  error estimate for blocks of size 2^( 4) =       0.000408762179
  error estimate for blocks of size 2^( 5) =       0.000413999185
  error estimate for blocks of size 2^( 6) =       0.000416504920
  error estimate for blocks of size 2^( 7) =       0.000418521207

      target function =      -0.933527300715
              le_mean =     -17.209901697727
             les_mean =     296.467502407983
             stat err =       0.000414446873
             autocorr =       1.240185326235
   target nu stat err =       0.000414446873
   target dn stat err =       0.002791720309
      target stat err =       0.004673095958
              std dev =       0.526317146951
             le_variance =       0.277009739174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372156469
  error estimate for blocks of size 2^( 2) =       0.000386344179
  error estimate for blocks of size 2^( 3) =       0.000399378625
  error estimate for blocks of size 2^( 4) =       0.000408762179
  error estimate for blocks of size 2^( 5) =       0.000413999185
  error estimate for blocks of size 2^( 6) =       0.000416504920
  error estimate for blocks of size 2^( 7) =       0.000418521207

      target function =      -0.933527300715
              le_mean =     -17.209901697727
             les_mean =     296.467502407983
             stat err =       0.000414446873
             autocorr =       1.240185326238
   target nu stat err =       0.000414446873
   target dn stat err =       0.002791720309
      target stat err =       0.004673095958
              std dev =       0.526317146951
             le_variance =       0.277009739174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372156469
  error estimate for blocks of size 2^( 2) =       0.000386344179
  error estimate for blocks of size 2^( 3) =       0.000399378625
  error estimate for blocks of size 2^( 4) =       0.000408762179
  error estimate for blocks of size 2^( 5) =       0.000413999185
  error estimate for blocks of size 2^( 6) =       0.000416504920
  error estimate for blocks of size 2^( 7) =       0.000418521207

      target function =      -0.933527300715
              le_mean =     -17.209901697727
             les_mean =     296.467502407983
             stat err =       0.000414446873
             autocorr =       1.240185326237
   target nu stat err =       0.000414446873
   target dn stat err =       0.002791720309
      target stat err =       0.004673095958
              std dev =       0.526317146951
             le_variance =       0.277009739175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277068990164
                                         uncertainty =       0.001872645780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372156469
  error estimate for blocks of size 2^( 2) =       0.000386344179
  error estimate for blocks of size 2^( 3) =       0.000399378625
  error estimate for blocks of size 2^( 4) =       0.000408762179
  error estimate for blocks of size 2^( 5) =       0.000413999185
  error estimate for blocks of size 2^( 6) =       0.000416504920
  error estimate for blocks of size 2^( 7) =       0.000418521207

      target function =      -0.933527300715
              le_mean =     -17.209901697727
             les_mean =     296.467502407983
             stat err =       0.000414446873
             autocorr =       1.240185326238
   target nu stat err =       0.000414446873
   target dn stat err =       0.002791720309
      target stat err =       0.004673095958
              std dev =       0.526317146951
             le_variance =       0.277009739174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933527300715        initial
     9.7656e+10     9.7656e+11             2.6167e-15        -0.933527300715
     3.9062e+11     3.9062e+12             4.6997e-16        -0.933527300715  <--
     1.5625e+12     1.5625e+13             1.2062e-16        -0.933527300715

*****************************************************************************
Applying the update for shift_i =   3.9062e+11     and shift_s =   3.9062e+12
*****************************************************************************

  Execution time = 3.9529e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2509
    reference variance = 0.196031
====================================================
  Execution time = 2.7493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8927e-01
  Total weights = 1.966544074e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5243e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279154993440
                                         uncertainty =       0.001739124156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279154993440
                                         uncertainty =       0.001739124156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373600197
  error estimate for blocks of size 2^( 2) =       0.000388230376
  error estimate for blocks of size 2^( 3) =       0.000401573516
  error estimate for blocks of size 2^( 4) =       0.000410883114
  error estimate for blocks of size 2^( 5) =       0.000417238560
  error estimate for blocks of size 2^( 6) =       0.000418718629
  error estimate for blocks of size 2^( 7) =       0.000419760616

      target function =      -0.929429573533
              le_mean =     -17.210069129791
             les_mean =     296.475753815236
             stat err =       0.000416650230
             autocorr =       1.243738443070
   target nu stat err =       0.000416650230
   target dn stat err =       0.002547679344
      target stat err =       0.004240241480
              std dev =       0.528358918843
             le_variance =       0.279163147121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721006912979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929448004602       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929448004602       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929448004602       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929448004602       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929467007194       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929403566854       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929703047156       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929412874617       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929585263275       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929595533993       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929189143707       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929487173221       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929386052480       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929473255560       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929407498172       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929474104370       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929531148223       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929686483754       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929596640646       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929318631416       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929265698541       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929592194197       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929348710812       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929364571817       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929546165985       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929628307980       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929599778679       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929279598856       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929372455444       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929041191213       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929388591553       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928943533048       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928697071493       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929739720243       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930400276242       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929581780234       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928954998210       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928420718103       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930049449003       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929136623451       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929901377202       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929685614343       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.928354264040       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929735573742       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929100276620       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.928588919430       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929061249766       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.928969003147       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929634255424       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.930648470022       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930846598280       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.928990767475       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.928578327402       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.929134055035       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.930008291157       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.931222269371       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.930379483267       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.929098159906       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.929359659379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.930988639224       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931432505582       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.932825648637       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934017996237       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.926054964733       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.925335820566       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.930150697648       residual = 7.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.926974383174       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.927438075729       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.927413399823       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.934114643508       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.919222509797       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.918145454325       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.936791108497       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.926148215673       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.924293138248       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.929152930823       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.931963932500       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.932514244593       residual = 5.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.922806865242       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.961116749780       residual = 9.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.934304072686       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.926847321578       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.948478027044       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.943173245003       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.957411084790       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.956323598647       residual = 3.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.890847558999       residual = 2.05e-01           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.16e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+10 is 5.139993e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929448004602       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929448004602       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929448004602       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929448004602       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929251140484       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929696636207       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929457658457       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929298718431       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929766548015       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929921128379       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929042041837       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929791175147       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929982446484       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929410691013       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928958621511       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928898300234       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929054985163       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930175862673       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928926328500       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928558713105       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929169354606       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928599085862       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927973513759       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931000190907       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.926787523641       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927865172033       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927134540805       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929726860226       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.925306817986       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931391932181       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930680505052       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928687506330       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.926003683284       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924881722948       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933170712007       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931970829889       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927113496402       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930219351660       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931646546616       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931123055899       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929784600238       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.930768851962       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.930872196241       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.926378246099       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.928909480930       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.926853651283       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931295393459       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.927770703248       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929884155334       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.925059984987       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.920891509470       residual = 9.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.923241478465       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.932760049857       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.927652004738       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.924676057481       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.929211555445       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.927095886806       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932244808790       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932401944789       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.921225669076       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.906708215456       residual = 5.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939639654499       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.937593369259       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.921722415533       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.916216231057       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.922708753864       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913948900181       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936145940787       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.929821855927       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.916973442239       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.939273081615       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.909533865104       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.892124543564       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.909033976630       residual = 8.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.890437908762       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.932804811692       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.916187818856       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.039690331103       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.896575704113       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.918320881569       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.930531648116       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.839640902195       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.858609739178       residual = 7.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.892504431528       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.961597985709       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944394550173       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   86 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 2.581675e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929448004602       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929448004602       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929448004602       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929448004603       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929389427627       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930990212959       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929122015878       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932258640355       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928793999249       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929042467004       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930019021242       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924537620827       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929843690688       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926618466067       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934124436648       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916804440794       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929723025084       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929953814543       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936363012912       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926005086697       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924976724154       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927504523059       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931423120879       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927762398937       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919170705919       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931453737708       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931901035343       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913433886831       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928489472791       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937742579765       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925125221562       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925988040984       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923872737226       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930084189641       residual = 6.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920435009395       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916144548943       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930994225814       residual = 8.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924467342896       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928084100956       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914681449504       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.908804807186       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944111075649       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932299633751       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944080905670       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.961776719183       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.961204055344       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938076506080       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931666692480       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.962069521074       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.974113116024       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.893602908627       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.911235893230       residual = 7.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.949978385656       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.899835086654       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.909876509067       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.927631296180       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.943005619416       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.879176999322       residual = 2.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.996847559881       residual = 6.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.747385596311       residual = 3.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.885796144946       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912481382636       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.866082215255       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.798713093659       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.754395142127       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.883664328444       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.101206740161       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.429574973106       residual = 2.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.801832437355       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.899200526909       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.678406048920       residual = 7.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.985999301830       residual = 9.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.534100331346       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.350152974148       residual = 3.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.053730784163       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.764314613402       residual = 5.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.372752005215       residual = 2.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.519102421207       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.874996176903       residual = 2.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.029956126770       residual = 4.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.074927786012       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.966828419701       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.535560369610       residual = 3.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.544939910805       residual = 5.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.732733693950       residual = 1.27e+01           smallest_sin_value = 9.94e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 6.519609e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              11.257907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6746e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1403
    reference variance = 0.173754
====================================================
  Execution time = 2.7326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8623e-01
  Total weights = 1.9665e+06
  Execution time = 2.3237e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372088708
  error estimate for blocks of size 2^( 2) =       0.000386542127
  error estimate for blocks of size 2^( 3) =       0.000399488123
  error estimate for blocks of size 2^( 4) =       0.000409030917
  error estimate for blocks of size 2^( 5) =       0.000414932742
  error estimate for blocks of size 2^( 6) =       0.000417909149
  error estimate for blocks of size 2^( 7) =       0.000419919860

      target function =      -0.934456538187
              le_mean =     -17.209770024414
             les_mean =     296.462417123988
             stat err =       0.000415448167
             autocorr =       1.246639008482
   target nu stat err =       0.000415448167
   target dn stat err =       0.002050631383
      target stat err =       0.003474739567
              std dev =       0.526221317303
             le_variance =       0.276908874784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372088708
  error estimate for blocks of size 2^( 2) =       0.000386542127
  error estimate for blocks of size 2^( 3) =       0.000399488123
  error estimate for blocks of size 2^( 4) =       0.000409030917
  error estimate for blocks of size 2^( 5) =       0.000414932742
  error estimate for blocks of size 2^( 6) =       0.000417909149
  error estimate for blocks of size 2^( 7) =       0.000419919860

      target function =      -0.934456538187
              le_mean =     -17.209770024414
             les_mean =     296.462417123988
             stat err =       0.000415448167
             autocorr =       1.246639008482
   target nu stat err =       0.000415448167
   target dn stat err =       0.002050631383
      target stat err =       0.003474739567
              std dev =       0.526221317303
             le_variance =       0.276908874784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372088708
  error estimate for blocks of size 2^( 2) =       0.000386542127
  error estimate for blocks of size 2^( 3) =       0.000399488123
  error estimate for blocks of size 2^( 4) =       0.000409030917
  error estimate for blocks of size 2^( 5) =       0.000414932742
  error estimate for blocks of size 2^( 6) =       0.000417909149
  error estimate for blocks of size 2^( 7) =       0.000419919860

      target function =      -0.934456538187
              le_mean =     -17.209770024414
             les_mean =     296.462417123988
             stat err =       0.000415448167
             autocorr =       1.246639008481
   target nu stat err =       0.000415448167
   target dn stat err =       0.002050631383
      target stat err =       0.003474739567
              std dev =       0.526221317303
             le_variance =       0.276908874784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276979168252
                                         uncertainty =       0.001499576084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372088708
  error estimate for blocks of size 2^( 2) =       0.000386542127
  error estimate for blocks of size 2^( 3) =       0.000399488123
  error estimate for blocks of size 2^( 4) =       0.000409030917
  error estimate for blocks of size 2^( 5) =       0.000414932742
  error estimate for blocks of size 2^( 6) =       0.000417909149
  error estimate for blocks of size 2^( 7) =       0.000419919860

      target function =      -0.934456538187
              le_mean =     -17.209770024414
             les_mean =     296.462417123988
             stat err =       0.000415448167
             autocorr =       1.246639008481
   target nu stat err =       0.000415448167
   target dn stat err =       0.002050631383
      target stat err =       0.003474739567
              std dev =       0.526221317303
             le_variance =       0.276908874784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934456538187        initial
     9.7656e+10     9.7656e+11             5.1400e-15        -0.934456538187
     3.9062e+11     3.9062e+12             2.5817e-16        -0.934456538187
     1.5625e+12     1.5625e+13             6.5196e-17        -0.934456538187  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 3.9090e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5843e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.218145
====================================================
  Execution time = 2.7482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8654e-01
  Total weights = 1.966557738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4634e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276779704134
                                         uncertainty =       0.001637559922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276779704134
                                         uncertainty =       0.001637559922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371965210
  error estimate for blocks of size 2^( 2) =       0.000386211908
  error estimate for blocks of size 2^( 3) =       0.000399173328
  error estimate for blocks of size 2^( 4) =       0.000408600472
  error estimate for blocks of size 2^( 5) =       0.000413419916
  error estimate for blocks of size 2^( 6) =       0.000416168170
  error estimate for blocks of size 2^( 7) =       0.000417811002

      target function =      -0.933938089063
              le_mean =     -17.209902381720
             les_mean =     296.467282708353
             stat err =       0.000413999890
             autocorr =       1.238784624297
   target nu stat err =       0.000413999890
   target dn stat err =       0.002206524009
      target stat err =       0.003723819989
              std dev =       0.526046661594
             le_variance =       0.276725090174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720990238172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933951970524       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933951970524       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933951970524       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934096099871       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933746910810       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934000062535       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933951970524       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933295127379       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934391945294       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934434523068       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934675474651       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933429060880       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933774605509       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934041088075       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933532200067       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934300866841       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934397101213       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933636158461       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933991180539       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934410395103       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933551910303       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933241289516       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932758206192       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934368421831       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932412099466       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933282476905       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936318237030       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933175054312       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934468163262       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931206903332       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933960405114       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935256763508       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934293255957       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933349714007       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935684108877       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934611085259       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936360881773       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936009253392       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930659741067       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927498101184       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938619167610       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945681897793       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929366661816       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.945218960898       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936921517858       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938435451367       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931476631073       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914096876696       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928368293521       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937752469638       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932941432726       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934650396826       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941782942855       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934456419314       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.927097904442       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.930743722799       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.928733492300       residual = 6.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.936827036722       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.948637065676       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.940207404589       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.951156864256       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.950840652043       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.914176381909       residual = 6.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.954203630908       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930986657552       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.960384384598       residual = 8.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.948929151958       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.945850468205       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.918918975041       residual = 7.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.927824380798       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.878649959268       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.975903396403       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.933818816542       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.918175478391       residual = 9.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.962288766080       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.946079243903       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.950396030437       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.075336188253       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.972258218331       residual = 3.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.953954696846       residual = 8.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.825685456000       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.830579826303       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.904135993412       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.877195459291       residual = 2.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.818213062740       residual = 2.41e+00           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.982194484140       residual = 1.24e+00           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.44e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+11 is 3.310769e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933951970524       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933951970524       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933951970524       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933951970524       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933951970524       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934971378578       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933636086183       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938092679925       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933646187371       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936019269272       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932474350240       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935124467121       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938655516434       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934740813164       residual = 8.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932999809004       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931221677857       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929936274665       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927783957094       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931611972087       residual = 6.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930521718600       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939598726524       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929811073229       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930168931161       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942044820078       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927403521334       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935761307601       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932340024365       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936926651428       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941462887181       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906648212730       residual = 9.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943386197103       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922454019610       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935694579736       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940387852190       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948187504355       residual = 5.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934281187146       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931394438023       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941085191859       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946055547991       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941564907739       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938081453717       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.954900980746       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.954905042507       residual = 8.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919748487058       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948611066331       residual = 9.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941477005559       residual = 7.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.959616119649       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943576397418       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916623564750       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919153545329       residual = 3.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.969876913604       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.901809210811       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.945462376058       residual = 8.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.923716603995       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.868456902608       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.924929730859       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.010529880741       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.945786294842       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.977256382690       residual = 5.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.837718925483       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941999360730       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.868528282836       residual = 5.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.958773565343       residual = 3.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.009443785058       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.888872546617       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.924458131570       residual = 6.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.825361817054       residual = 3.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.982862916783       residual = 9.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.934553726489       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.829209613294       residual = 9.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.823116477274       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.836322761552       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.787585794471       residual = 7.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.895342274797       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.093791956596       residual = 7.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.810974262273       residual = 4.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.875001945459       residual = 4.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.942864359508       residual = 5.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.398851181488       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.651794095588       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.290477457282       residual = 4.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.758603575436       residual = 7.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.160786572130       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.363790384773       residual = 4.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.112202433579       residual = 2.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.364939582601       residual = 5.18e+01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+12 is 7.498651e-17

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933951970524       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933951970524       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933951970524       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933009365615       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932469006000       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930693223676       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936453532101       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932588495209       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922038543083       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931388713547       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939388207239       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931367601205       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946697512553       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911943391857       residual = 4.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.880776189188       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933908459243       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923025922478       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.959683240863       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910439113740       residual = 4.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952380339583       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919551203597       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931828690330       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920411906391       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912750803191       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905007139919       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.892436723808       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.870733128970       residual = 4.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908045472782       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909391805296       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915688625070       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927525868209       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.863391570427       residual = 5.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.885680130133       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910709693486       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.903336103666       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.925964789583       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934598118185       residual = 3.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919902880025       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927866320856       residual = 7.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.834192378092       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.854120873381       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.080900046960       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.920273713368       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.096450032211       residual = 2.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.028911158650       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.696415621919       residual = 7.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.140238689534       residual = 6.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.982090618852       residual = 5.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.766165245996       residual = 4.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.076696312335       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.893193365626       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.595071077017       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.262198922179       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.871970936440       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.143645191440       residual = 8.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.113487078686       residual = 7.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.876629693114       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.846700520503       residual = 9.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.988156389808       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.906030614660       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.072205399171       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.022156657123       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.109812549057       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.067009168304       residual = 6.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.193612100876       residual = 9.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.855512686952       residual = 8.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.171547227243       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -2.532192557480       residual = 2.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.748773148405       residual = 8.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.405360606452       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.183673163200       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -2.377331167827       residual = 2.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.688169322615       residual = 8.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -2.273047180028       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -2.470395867847       residual = 2.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.958262280549       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =       0.072002598532       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.210407093770       residual = 7.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -2.821705030740       residual = 3.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.359430142634       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =       2.228593504192       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -3.452678880954       residual = 6.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -3.693432556205       residual = 6.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -6.091861727234       residual = 2.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =       1.150427110083       residual = 9.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =       0.413799835449       residual = 3.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.024314645739       residual = 3.86e+02           smallest_sin_value = 9.98e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+12 is 1.686781e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              11.985571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6680e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2417
    reference variance = 0.165545
====================================================
  Execution time = 2.7506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8971e-01
  Total weights = 1.9664e+06
  Execution time = 2.3128e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373847003
  error estimate for blocks of size 2^( 2) =       0.000388060937
  error estimate for blocks of size 2^( 3) =       0.000401229290
  error estimate for blocks of size 2^( 4) =       0.000411385262
  error estimate for blocks of size 2^( 5) =       0.000415781261
  error estimate for blocks of size 2^( 6) =       0.000417335202
  error estimate for blocks of size 2^( 7) =       0.000421016865

      target function =      -0.928705942368
              le_mean =     -17.210156155032
             les_mean =     296.479187269864
             stat err =       0.000416379647
             autocorr =       1.240484032151
   target nu stat err =       0.000416379647
   target dn stat err =       0.002743197649
      target stat err =       0.004549908162
              std dev =       0.528707961723
             le_variance =       0.279532108789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373847003
  error estimate for blocks of size 2^( 2) =       0.000388060937
  error estimate for blocks of size 2^( 3) =       0.000401229290
  error estimate for blocks of size 2^( 4) =       0.000411385262
  error estimate for blocks of size 2^( 5) =       0.000415781261
  error estimate for blocks of size 2^( 6) =       0.000417335202
  error estimate for blocks of size 2^( 7) =       0.000421016865

      target function =      -0.928705942368
              le_mean =     -17.210156155032
             les_mean =     296.479187269864
             stat err =       0.000416379647
             autocorr =       1.240484032160
   target nu stat err =       0.000416379647
   target dn stat err =       0.002743197649
      target stat err =       0.004549908162
              std dev =       0.528707961723
             le_variance =       0.279532108789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373847003
  error estimate for blocks of size 2^( 2) =       0.000388060937
  error estimate for blocks of size 2^( 3) =       0.000401229290
  error estimate for blocks of size 2^( 4) =       0.000411385262
  error estimate for blocks of size 2^( 5) =       0.000415781261
  error estimate for blocks of size 2^( 6) =       0.000417335202
  error estimate for blocks of size 2^( 7) =       0.000421016865

      target function =      -0.928705942368
              le_mean =     -17.210156155032
             les_mean =     296.479187269864
             stat err =       0.000416379647
             autocorr =       1.240484032158
   target nu stat err =       0.000416379647
   target dn stat err =       0.002743197649
      target stat err =       0.004549908162
              std dev =       0.528707961723
             le_variance =       0.279532108789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279502433824
                                         uncertainty =       0.002177154201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373847003
  error estimate for blocks of size 2^( 2) =       0.000388060937
  error estimate for blocks of size 2^( 3) =       0.000401229290
  error estimate for blocks of size 2^( 4) =       0.000411385262
  error estimate for blocks of size 2^( 5) =       0.000415781261
  error estimate for blocks of size 2^( 6) =       0.000417335202
  error estimate for blocks of size 2^( 7) =       0.000421016865

      target function =      -0.928705942368
              le_mean =     -17.210156155032
             les_mean =     296.479187269864
             stat err =       0.000416379647
             autocorr =       1.240484032155
   target nu stat err =       0.000416379647
   target dn stat err =       0.002743197649
      target stat err =       0.004549908162
              std dev =       0.528707961723
             le_variance =       0.279532108789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928705942368        initial  <--
     3.9062e+11     3.9062e+12             3.3108e-16        -0.928705942368
     1.5625e+12     1.5625e+13             7.4987e-17        -0.928705942368
     6.2500e+12     6.2500e+13             1.6868e-17        -0.928705942368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2333
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1779
    reference variance = 0.161252
====================================================
  Execution time = 2.7595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8565e-01
  Total weights = 1.966343159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3396e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276763329766
                                         uncertainty =       0.001798067930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276763329766
                                         uncertainty =       0.001798067930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371974211
  error estimate for blocks of size 2^( 2) =       0.000386410090
  error estimate for blocks of size 2^( 3) =       0.000399304036
  error estimate for blocks of size 2^( 4) =       0.000408860588
  error estimate for blocks of size 2^( 5) =       0.000415404173
  error estimate for blocks of size 2^( 6) =       0.000418860230
  error estimate for blocks of size 2^( 7) =       0.000419309622

      target function =      -0.935411010812
              le_mean =     -17.209964556867
             les_mean =     296.468531178236
             stat err =       0.000415608653
             autocorr =       1.248370508440
   target nu stat err =       0.000415608653
   target dn stat err =       0.002450930091
      target stat err =       0.004134870662
              std dev =       0.526059390636
             le_variance =       0.276738482476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720996455687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935428015779       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935428015779       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935428015779       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935459449747       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935181691175       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935791496139       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934498470326       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940681273553       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936486653921       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933312554192       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917167767947       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936110291519       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938048611122       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932583898154       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938845703568       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928802721607       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938022673259       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932064381344       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919335788777       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937230805476       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924851364129       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936546991860       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948682855754       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.956677614238       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944750277164       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943003844644       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927264648226       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917091433213       residual = 5.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938404022888       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.963337313868       residual = 9.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914048581811       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922245552445       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941388747666       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919117581079       residual = 5.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.873537183241       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896190272060       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949989205382       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917779240829       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.896548651058       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.900859771455       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.960743956439       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.878692528302       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.959789736861       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931803442270       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.928753295223       residual = 6.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906660377715       residual = 6.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.920445306152       residual = 1.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.993021801297       residual = 3.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.917733414958       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.970095106015       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.805443089572       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.845725191823       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.918990598943       residual = 8.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.990981635510       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.923352920711       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.885322774908       residual = 4.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.948182554264       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.968785979051       residual = 4.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.589742469392       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.106465997122       residual = 8.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.824566824587       residual = 3.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.146222302889       residual = 4.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.248834700824       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.960217569465       residual = 5.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.837715535367       residual = 9.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.748230663477       residual = 5.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.861717292705       residual = 4.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.739103914335       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.190223143425       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.969607828883       residual = 7.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.632242094054       residual = 3.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.453549688811       residual = 3.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.876014129577       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.670041268691       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.572602137458       residual = 9.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -3.228589820210       residual = 7.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.477813389385       residual = 7.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.605038831418       residual = 6.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.477937658505       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.368906218374       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.395264357009       residual = 3.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.081414612986       residual = 3.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.960364666924       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =       0.271460901968       residual = 3.93e+02           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -2.587877409218       residual = 1.34e+03           smallest_sin_value = 9.95e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.44e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+12 is 5.379166e-17

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935428015779       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935428015779       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935428015779       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923983831882       residual = 7.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927248717400       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936647754064       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938344322109       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.959952830187       residual = 8.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933453825358       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930357412269       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.977453845228       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913738930203       residual = 8.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871086869284       residual = 4.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931398653044       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920136445379       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941724796524       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924976291786       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.899378629530       residual = 4.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.977882052507       residual = 4.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953632100520       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.035708396622       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916340403237       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.965978993759       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.890930686518       residual = 6.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.044559494703       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.796243868754       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.874580480946       residual = 7.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930206786224       residual = 7.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.096297887531       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.655654456844       residual = 7.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931982592232       residual = 9.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.168526242501       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.045071670589       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.798833942783       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.827010104564       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.815438492842       residual = 3.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.022500938659       residual = 8.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.161287755246       residual = 6.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.857813256023       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.822913055482       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.837245803233       residual = 3.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.408030760254       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.041904121903       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912798016339       residual = 3.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.862450286266       residual = 3.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745644139864       residual = 6.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.941949984961       residual = 7.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.850159751491       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.329771567476       residual = 1.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.171916358983       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.830253310222       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.972541516455       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.659855507448       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.851800443860       residual = 3.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.395063319357       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.202583761862       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.812732194162       residual = 8.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.107554107572       residual = 3.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.176905298127       residual = 8.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.812616376969       residual = 5.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.076586205649       residual = 3.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.794820813944       residual = 6.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.135038564025       residual = 9.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.356731145410       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.978497505775       residual = 5.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.836172408118       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -2.090470008900       residual = 2.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.039464924928       residual = 9.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.707752003028       residual = 1.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.539162253822       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =       0.200245317353       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.209206919918       residual = 2.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.840468813646       residual = 2.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =       0.500652179156       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.193664226209       residual = 2.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -2.897962137551       residual = 4.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -7.149277899414       residual = 3.40e+03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =       2.091349572176       residual = 8.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -4.075267244263       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =       0.962718558950       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -4.082497963493       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   81 stopping due to too large eigenvalue change
davidson solver did not converge after         81 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+13 is 9.952949e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935428015779       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935428015779       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935428015779       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935428015779       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.41e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+13 is 2.488237e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              12.427981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6385e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.23143
====================================================
  Execution time = 2.7968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8786e-01
  Total weights = 1.9666e+06
  Execution time = 2.3445e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373304656
  error estimate for blocks of size 2^( 2) =       0.000387473051
  error estimate for blocks of size 2^( 3) =       0.000400699694
  error estimate for blocks of size 2^( 4) =       0.000410477246
  error estimate for blocks of size 2^( 5) =       0.000416007164
  error estimate for blocks of size 2^( 6) =       0.000419585433
  error estimate for blocks of size 2^( 7) =       0.000422520752

      target function =      -0.931783264337
              le_mean =     -17.209321989488
             les_mean =     296.448619490846
             stat err =       0.000417147649
             autocorr =       1.248684691057
   target nu stat err =       0.000417147649
   target dn stat err =       0.002531139145
      target stat err =       0.004228740750
              std dev =       0.527940953743
             le_variance =       0.278721650639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373304656
  error estimate for blocks of size 2^( 2) =       0.000387473051
  error estimate for blocks of size 2^( 3) =       0.000400699694
  error estimate for blocks of size 2^( 4) =       0.000410477246
  error estimate for blocks of size 2^( 5) =       0.000416007164
  error estimate for blocks of size 2^( 6) =       0.000419585433
  error estimate for blocks of size 2^( 7) =       0.000422520752

      target function =      -0.931783264337
              le_mean =     -17.209321989488
             les_mean =     296.448619490846
             stat err =       0.000417147649
             autocorr =       1.248684691059
   target nu stat err =       0.000417147649
   target dn stat err =       0.002531139145
      target stat err =       0.004228740750
              std dev =       0.527940953743
             le_variance =       0.278721650639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373304656
  error estimate for blocks of size 2^( 2) =       0.000387473051
  error estimate for blocks of size 2^( 3) =       0.000400699694
  error estimate for blocks of size 2^( 4) =       0.000410477246
  error estimate for blocks of size 2^( 5) =       0.000416007164
  error estimate for blocks of size 2^( 6) =       0.000419585433
  error estimate for blocks of size 2^( 7) =       0.000422520752

      target function =      -0.931783264337
              le_mean =     -17.209321989488
             les_mean =     296.448619490846
             stat err =       0.000417147649
             autocorr =       1.248684691052
   target nu stat err =       0.000417147649
   target dn stat err =       0.002531139145
      target stat err =       0.004228740750
              std dev =       0.527940953743
             le_variance =       0.278721650639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768539908
                                         uncertainty =       0.001608121311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373304656
  error estimate for blocks of size 2^( 2) =       0.000387473051
  error estimate for blocks of size 2^( 3) =       0.000400699694
  error estimate for blocks of size 2^( 4) =       0.000410477246
  error estimate for blocks of size 2^( 5) =       0.000416007164
  error estimate for blocks of size 2^( 6) =       0.000419585433
  error estimate for blocks of size 2^( 7) =       0.000422520752

      target function =      -0.931783264337
              le_mean =     -17.209321989488
             les_mean =     296.448619490846
             stat err =       0.000417147649
             autocorr =       1.248684691062
   target nu stat err =       0.000417147649
   target dn stat err =       0.002531139145
      target stat err =       0.004228740750
              std dev =       0.527940953743
             le_variance =       0.278721650639


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931783264337        initial
     3.9062e+12     3.9062e+13             5.3792e-17        -0.931783264337
     1.5625e+13     1.5625e+14             9.9529e-18        -0.931783264337  <--
     6.2500e+13     6.2500e+14             2.4882e-18        -0.931783264337

*****************************************************************************
Applying the update for shift_i =   1.5625e+13     and shift_s =   1.5625e+14
*****************************************************************************

  Execution time = 4.2416e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.179305
====================================================
  Execution time = 2.7696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8532e-01
  Total weights = 1.966455592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4317e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276060175803
                                         uncertainty =       0.001482993034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276060175803
                                         uncertainty =       0.001482993034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371495661
  error estimate for blocks of size 2^( 2) =       0.000385929379
  error estimate for blocks of size 2^( 3) =       0.000399020326
  error estimate for blocks of size 2^( 4) =       0.000408708713
  error estimate for blocks of size 2^( 5) =       0.000413534387
  error estimate for blocks of size 2^( 6) =       0.000417461770
  error estimate for blocks of size 2^( 7) =       0.000419634570

      target function =      -0.935969445875
              le_mean =     -17.209747854272
             les_mean =     296.460740622804
             stat err =       0.000414834860
             autocorr =       1.246932651404
   target nu stat err =       0.000414834860
   target dn stat err =       0.002251834222
      target stat err =       0.003812748997
              std dev =       0.525382608163
             le_variance =       0.276026884960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720974785427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935984023734       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935984023734       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935984023734       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935986235957       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935254215936       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936010774120       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938948583484       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936167366670       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934753250279       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932925006876       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931753911821       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936865202128       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936006931656       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932456538877       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949493941119       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944989180400       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935327019353       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941307408667       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911767896797       residual = 7.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931804379720       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948036258410       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934761133965       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929779130768       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929001437544       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928383065132       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924172548478       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937522206519       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948156749424       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947159783938       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922474958998       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.949899420517       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946065581769       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950314696099       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941984745063       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924436897193       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.891741752528       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908657509172       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912184195457       residual = 8.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913625227101       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.903963167562       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947396649578       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.983073635836       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.018544983807       residual = 7.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.007257654983       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.818120671131       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.794135282656       residual = 3.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.864018810673       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.821739422834       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.953610373986       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.551628008706       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.498099285563       residual = 2.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.022176450499       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.950772410643       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.961090554425       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.618115085308       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.115857134381       residual = 4.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.082887237955       residual = 2.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.870968080723       residual = 5.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.030801775686       residual = 4.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.226212939393       residual = 8.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.106584345179       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.008400291346       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.046575919275       residual = 2.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.032837059448       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.112519381805       residual = 8.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.950038237564       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.600278413847       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.567071054498       residual = 3.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.183128908527       residual = 8.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.433781327248       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.193519884779       residual = 6.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.965175755923       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -2.589073882602       residual = 3.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.024839518271       residual = 9.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.074942412982       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.676439025819       residual = 8.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.452389651352       residual = 9.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.122404412482       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.232950959634       residual = 5.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.487411255875       residual = 9.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.384733118247       residual = 4.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.258776924047       residual = 5.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.569693738965       residual = 4.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.366276066685       residual = 1.24e+02           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -2.143501184949       residual = 4.59e+02           smallest_sin_value = 9.90e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.02e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+12 is 2.503403e-17

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935984023734       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935984023734       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935984023734       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935984023734       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              12.663717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6371e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1549
    reference variance = 0.168221
====================================================
  Execution time = 2.7573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8882e-01
  Total weights = 1.9664e+06
  Execution time = 2.3447e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373052064
  error estimate for blocks of size 2^( 2) =       0.000387322427
  error estimate for blocks of size 2^( 3) =       0.000400598733
  error estimate for blocks of size 2^( 4) =       0.000410380154
  error estimate for blocks of size 2^( 5) =       0.000416402314
  error estimate for blocks of size 2^( 6) =       0.000419663090
  error estimate for blocks of size 2^( 7) =       0.000421751537

      target function =      -0.930190747461
              le_mean =     -17.209613950731
             les_mean =     296.459628727569
             stat err =       0.000417049274
             autocorr =       1.249786540927
   target nu stat err =       0.000417049274
   target dn stat err =       0.002897367924
      target stat err =       0.004809560083
              std dev =       0.527583729827
             le_variance =       0.278344591978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373052064
  error estimate for blocks of size 2^( 2) =       0.000387322427
  error estimate for blocks of size 2^( 3) =       0.000400598733
  error estimate for blocks of size 2^( 4) =       0.000410380154
  error estimate for blocks of size 2^( 5) =       0.000416402314
  error estimate for blocks of size 2^( 6) =       0.000419663090
  error estimate for blocks of size 2^( 7) =       0.000421751537

      target function =      -0.930190747461
              le_mean =     -17.209613950731
             les_mean =     296.459628727569
             stat err =       0.000417049274
             autocorr =       1.249786540928
   target nu stat err =       0.000417049274
   target dn stat err =       0.002897367924
      target stat err =       0.004809560083
              std dev =       0.527583729827
             le_variance =       0.278344591978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373052064
  error estimate for blocks of size 2^( 2) =       0.000387322427
  error estimate for blocks of size 2^( 3) =       0.000400598733
  error estimate for blocks of size 2^( 4) =       0.000410380154
  error estimate for blocks of size 2^( 5) =       0.000416402314
  error estimate for blocks of size 2^( 6) =       0.000419663090
  error estimate for blocks of size 2^( 7) =       0.000421751537

      target function =      -0.930190747461
              le_mean =     -17.209613950731
             les_mean =     296.459628727569
             stat err =       0.000417049274
             autocorr =       1.249786540927
   target nu stat err =       0.000417049274
   target dn stat err =       0.002897367924
      target stat err =       0.004809560083
              std dev =       0.527583729827
             le_variance =       0.278344591978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278348399391
                                         uncertainty =       0.001791273484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373052064
  error estimate for blocks of size 2^( 2) =       0.000387322427
  error estimate for blocks of size 2^( 3) =       0.000400598733
  error estimate for blocks of size 2^( 4) =       0.000410380154
  error estimate for blocks of size 2^( 5) =       0.000416402314
  error estimate for blocks of size 2^( 6) =       0.000419663090
  error estimate for blocks of size 2^( 7) =       0.000421751537

      target function =      -0.930190747461
              le_mean =     -17.209613950731
             les_mean =     296.459628727569
             stat err =       0.000417049274
             autocorr =       1.249786540927
   target nu stat err =       0.000417049274
   target dn stat err =       0.002897367924
      target stat err =       0.004809560083
              std dev =       0.527583729827
             le_variance =       0.278344591978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930190747461        initial
     3.9062e+12     3.9062e+13             2.5034e-17        -0.930190747461  <--
     1.5625e+13     1.5625e+14             0.0000e+00        -0.930190747461
     6.2500e+13     6.2500e+14             0.0000e+00        -0.930190747461

*****************************************************************************
Applying the update for shift_i =   3.9062e+12     and shift_s =   3.9062e+13
*****************************************************************************

  Execution time = 3.9444e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2781
    reference variance = 0.308907
====================================================
  Execution time = 2.7735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9000e-01
  Total weights = 1.966693829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5210e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280113255078
                                         uncertainty =       0.002054599938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280113255078
                                         uncertainty =       0.002054599938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374201374
  error estimate for blocks of size 2^( 2) =       0.000388563319
  error estimate for blocks of size 2^( 3) =       0.000402163358
  error estimate for blocks of size 2^( 4) =       0.000411824735
  error estimate for blocks of size 2^( 5) =       0.000418104541
  error estimate for blocks of size 2^( 6) =       0.000421283283
  error estimate for blocks of size 2^( 7) =       0.000424295892

      target function =      -0.928270294627
              le_mean =     -17.209043546764
             les_mean =     296.441182497346
             stat err =       0.000418877113
             autocorr =       1.253032993572
   target nu stat err =       0.000418877113
   target dn stat err =       0.002843875678
      target stat err =       0.004699029675
              std dev =       0.529209125834
             le_variance =       0.280062298866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720904354676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928292874382       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928292874382       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928292874382       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928292874382       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928292874382       residual = 9.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929252976024       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928864427934       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928474045114       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930381805193       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926611043298       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927337287250       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928175494962       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928524500185       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926961648401       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930120968714       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928844043927       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928909552554       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929574054763       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928690124197       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926911502017       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930476930451       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931755190481       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928901654887       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925437733941       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928053904206       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927956425298       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911940475437       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915943400615       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924713567287       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933160234248       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932327713349       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923840753180       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922609974076       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919358809724       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925814431857       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931973288092       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932072894587       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926152610816       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930667677869       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914773207654       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942459683504       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.920286319106       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943296249142       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946489594658       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932272098166       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935552057915       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912816717828       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.928921964537       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912678302928       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.931322848423       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.918981876844       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.923581114196       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.931560376755       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.924117994620       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.916399287934       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.971708054214       residual = 2.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.944235964961       residual = 9.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.929099832940       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.870660379582       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.950557443637       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.900218198347       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.897895171593       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.863895269144       residual = 4.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.869359550273       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.885800512804       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.968466889525       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.947824834352       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.968631301098       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932555829570       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.986613125638       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.014956468895       residual = 9.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.841004585276       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.237682472663       residual = 1.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.706353093036       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.077021028861       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.988357101377       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.861174582401       residual = 7.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.201847578478       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.931598050403       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.107208300793       residual = 6.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.905692176081       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.938029535437       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.819348938339       residual = 8.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.286326205497       residual = 5.90e+01           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.730889839228       residual = 6.50e+00           smallest_sin_value = 9.99e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+11 is 1.197397e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928292874382       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928292874382       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928292874382       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928560600108       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930044687974       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926476485872       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928297539221       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932941587996       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935061145252       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926789454665       residual = 7.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928905540244       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940206490428       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932488555208       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930120620295       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908953837840       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937770973617       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933991137797       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923247551248       residual = 7.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928508958387       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926472827806       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930710713026       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933736392149       residual = 9.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923892482460       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927589814590       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941194786230       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928215652809       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916969408745       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.945219451983       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.974763424366       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.974676210850       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922215020747       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.844211256932       residual = 7.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896990271619       residual = 9.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941235538220       residual = 8.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.980563532694       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931799268218       residual = 5.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.873519898510       residual = 5.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.901768559762       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.881445076123       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933577805777       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.869820897686       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.878854795000       residual = 5.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.854559221355       residual = 9.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.926764743260       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.967470748753       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941546429347       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.950868357061       residual = 5.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.597987845057       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.879014830200       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.076041460763       residual = 3.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.968652741076       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.847787482888       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.023508889159       residual = 6.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.795363530890       residual = 2.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.807531344498       residual = 2.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.960768618103       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.989198459034       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.803013186050       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.957214930689       residual = 3.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.191001957192       residual = 2.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.869599442607       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.983721541875       residual = 3.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.872295127651       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.066161298787       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.987603774982       residual = 1.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.004350419625       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.787137028519       residual = 3.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.815068639171       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.027066012924       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.649612907497       residual = 8.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.278583772079       residual = 4.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.807519806491       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.900367033959       residual = 7.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.826802986998       residual = 6.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =       0.090651094049       residual = 9.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.162703340389       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.374819572592       residual = 4.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.209743910025       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.796713866718       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.383604145972       residual = 6.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -2.639454240431       residual = 2.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -2.373194662435       residual = 5.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -2.472294538774       residual = 2.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.429344750414       residual = 2.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.508831957246       residual = 9.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.913059238632       residual = 8.43e+00           smallest_sin_value = 9.97e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.00e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+12 is 2.506914e-17

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928292874382       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928292874382       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.36e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              13.138359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6738e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.161
    reference variance = 0.183177
====================================================
  Execution time = 2.7523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8643e-01
  Total weights = 1.9665e+06
  Execution time = 2.3438e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212413
  error estimate for blocks of size 2^( 2) =       0.000385525906
  error estimate for blocks of size 2^( 3) =       0.000398897090
  error estimate for blocks of size 2^( 4) =       0.000408125867
  error estimate for blocks of size 2^( 5) =       0.000412886632
  error estimate for blocks of size 2^( 6) =       0.000416071791
  error estimate for blocks of size 2^( 7) =       0.000418118853

      target function =      -0.934139858829
              le_mean =     -17.209153607882
             les_mean =     296.441393748994
             stat err =       0.000413800786
             autocorr =       1.242618005740
   target nu stat err =       0.000413800786
   target dn stat err =       0.002925259607
      target stat err =       0.004890487239
              std dev =       0.524982028144
             le_variance =       0.275606129874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212413
  error estimate for blocks of size 2^( 2) =       0.000385525906
  error estimate for blocks of size 2^( 3) =       0.000398897090
  error estimate for blocks of size 2^( 4) =       0.000408125867
  error estimate for blocks of size 2^( 5) =       0.000412886632
  error estimate for blocks of size 2^( 6) =       0.000416071791
  error estimate for blocks of size 2^( 7) =       0.000418118853

      target function =      -0.934139858829
              le_mean =     -17.209153607882
             les_mean =     296.441393748994
             stat err =       0.000413800786
             autocorr =       1.242618005739
   target nu stat err =       0.000413800786
   target dn stat err =       0.002925259607
      target stat err =       0.004890487239
              std dev =       0.524982028144
             le_variance =       0.275606129874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212413
  error estimate for blocks of size 2^( 2) =       0.000385525906
  error estimate for blocks of size 2^( 3) =       0.000398897090
  error estimate for blocks of size 2^( 4) =       0.000408125867
  error estimate for blocks of size 2^( 5) =       0.000412886632
  error estimate for blocks of size 2^( 6) =       0.000416071791
  error estimate for blocks of size 2^( 7) =       0.000418118853

      target function =      -0.934139858829
              le_mean =     -17.209153607882
             les_mean =     296.441393748994
             stat err =       0.000413800786
             autocorr =       1.242618005739
   target nu stat err =       0.000413800786
   target dn stat err =       0.002925259607
      target stat err =       0.004890487239
              std dev =       0.524982028144
             le_variance =       0.275606129874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275683989399
                                         uncertainty =       0.001565903296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212413
  error estimate for blocks of size 2^( 2) =       0.000385525906
  error estimate for blocks of size 2^( 3) =       0.000398897090
  error estimate for blocks of size 2^( 4) =       0.000408125867
  error estimate for blocks of size 2^( 5) =       0.000412886632
  error estimate for blocks of size 2^( 6) =       0.000416071791
  error estimate for blocks of size 2^( 7) =       0.000418118853

      target function =      -0.934139858829
              le_mean =     -17.209153607882
             les_mean =     296.441393748994
             stat err =       0.000413800786
             autocorr =       1.242618005740
   target nu stat err =       0.000413800786
   target dn stat err =       0.002925259607
      target stat err =       0.004890487239
              std dev =       0.524982028144
             le_variance =       0.275606129874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934139858829        initial
     9.7656e+11     9.7656e+12             1.1974e-16        -0.934139858829
     3.9062e+12     3.9062e+13             2.5069e-17        -0.934139858829  <--
     1.5625e+13     1.5625e+14             0.0000e+00        -0.934139858829

*****************************************************************************
Applying the update for shift_i =   3.9062e+12     and shift_s =   3.9062e+13
*****************************************************************************

  Execution time = 3.9379e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1572
    reference variance = 0.162047
====================================================
  Execution time = 2.7617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8661e-01
  Total weights = 1.966501557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3773e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277576900964
                                         uncertainty =       0.001483159593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277576900964
                                         uncertainty =       0.001483159593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372537358
  error estimate for blocks of size 2^( 2) =       0.000386968191
  error estimate for blocks of size 2^( 3) =       0.000399794664
  error estimate for blocks of size 2^( 4) =       0.000409888089
  error estimate for blocks of size 2^( 5) =       0.000415478051
  error estimate for blocks of size 2^( 6) =       0.000419757928
  error estimate for blocks of size 2^( 7) =       0.000422179836

      target function =      -0.933830379192
              le_mean =     -17.209452500332
             les_mean =     296.451869624408
             stat err =       0.000416825976
             autocorr =       1.251900726311
   target nu stat err =       0.000416825976
   target dn stat err =       0.002300749426
      target stat err =       0.003873563160
              std dev =       0.526855813409
             le_variance =       0.277577048123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720945250033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933845549219       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933845549219       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933845549219       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933845549219       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933845549218       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933845405986       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934041365884       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934583989557       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933711422717       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934635615796       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934246133563       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935954736857       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937179952702       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933513707746       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932651627321       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934229561020       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933424561240       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932648908491       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932663594298       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933724195248       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934444150599       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932331239919       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932558986053       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935000675660       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933345296476       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931143681286       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934852391808       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935687823692       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935408417159       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936729305556       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931665948408       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938201606428       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933486819538       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935795190086       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927765837376       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931480328193       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923343858137       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.924162101079       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932379942039       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945104462864       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938649472254       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.910660755465       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.974890812967       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.902351236558       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.979841031050       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919589480236       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.924089456308       residual = 4.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915319619181       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916043972824       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933790008674       residual = 6.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.922051545096       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.960629692234       residual = 7.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.908351633938       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.984457324118       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.928799720442       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.960964909423       residual = 8.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.935128006155       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.992568767025       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.011665563803       residual = 5.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.985706735501       residual = 6.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.905941868374       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.009122493291       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.010246539775       residual = 7.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.930590399155       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.916895594699       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.945665778310       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.845543379432       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.899888916186       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.937082598823       residual = 7.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.979651536033       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.913771835254       residual = 6.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.002215598348       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.973563071886       residual = 7.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.690809917499       residual = 9.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.093435389640       residual = 2.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.963645548898       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.859755845800       residual = 5.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.967541542554       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.006778996803       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.961712682331       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.718738256576       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.353227683205       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.995903990076       residual = 2.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.940730891566       residual = 4.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.353381245205       residual = 3.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.111479362350       residual = 5.72e+00           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+11 is 1.201066e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933845549219       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933845549219       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933845549219       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933845549224       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933845549219       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933845555570       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932818140116       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931748650592       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940824550796       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941694971385       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935861283871       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928829318866       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927044221810       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932301186237       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934199238419       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932066237359       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933785376484       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933772824355       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955590746267       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939862994641       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947716651463       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946927915616       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927460213207       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934298535908       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919533611913       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930142713741       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.960526061168       residual = 8.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.925341625474       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928627950365       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929971215089       residual = 7.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918855601789       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939178143845       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944422756978       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942602553833       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940375885020       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941136358707       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.882384393075       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.859417599994       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.815556467926       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.972751983157       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.052835222500       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.860137505438       residual = 6.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.841293643900       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906456575950       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.909326925750       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.953036376841       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.836924599368       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.896442046226       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937786776251       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.968449393926       residual = 8.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.821961486380       residual = 3.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.962723075787       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.984134788585       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.850573226718       residual = 9.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.027421144613       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.984343505969       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913911932852       residual = 6.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.718400277616       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.819406084143       residual = 2.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.004932838594       residual = 8.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.963013679933       residual = 6.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.975489747200       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.953898228893       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.932814925383       residual = 7.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.603080545055       residual = 4.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.689055108538       residual = 3.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.199567283005       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.325136335136       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.999481840114       residual = 5.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.877117022745       residual = 3.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.710381657243       residual = 5.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.652237005194       residual = 8.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.932980685014       residual = 3.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.386575372031       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.221567220712       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.340144116418       residual = 4.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.046002481917       residual = 6.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.528933760873       residual = 4.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =       0.004147502125       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =       0.466162560056       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -5.617960274230       residual = 1.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.398726848388       residual = 1.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.382383584121       residual = 2.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.046445445014       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.144655762878       residual = 2.35e+01           smallest_sin_value = 9.99e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+12 is 3.022210e-17

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933845549219       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933845549219       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              13.617444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6481e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.3663
    reference variance = 0.612599
====================================================
  Execution time = 2.7575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8978e-01
  Total weights = 1.9664e+06
  Execution time = 2.3343e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374342401
  error estimate for blocks of size 2^( 2) =       0.000388444913
  error estimate for blocks of size 2^( 3) =       0.000401645394
  error estimate for blocks of size 2^( 4) =       0.000411082503
  error estimate for blocks of size 2^( 5) =       0.000417021209
  error estimate for blocks of size 2^( 6) =       0.000420332340
  error estimate for blocks of size 2^( 7) =       0.000421182341

      target function =      -0.928596210685
              le_mean =     -17.209960890002
             les_mean =     296.472535714750
             stat err =       0.000417404598
             autocorr =       1.243301376271
   target nu stat err =       0.000417404598
   target dn stat err =       0.002948341972
      target stat err =       0.004878952286
              std dev =       0.529408571201
             le_variance =       0.280273435261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374342401
  error estimate for blocks of size 2^( 2) =       0.000388444913
  error estimate for blocks of size 2^( 3) =       0.000401645394
  error estimate for blocks of size 2^( 4) =       0.000411082503
  error estimate for blocks of size 2^( 5) =       0.000417021209
  error estimate for blocks of size 2^( 6) =       0.000420332340
  error estimate for blocks of size 2^( 7) =       0.000421182341

      target function =      -0.928596210685
              le_mean =     -17.209960890002
             les_mean =     296.472535714750
             stat err =       0.000417404598
             autocorr =       1.243301376268
   target nu stat err =       0.000417404598
   target dn stat err =       0.002948341972
      target stat err =       0.004878952286
              std dev =       0.529408571201
             le_variance =       0.280273435261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374342401
  error estimate for blocks of size 2^( 2) =       0.000388444913
  error estimate for blocks of size 2^( 3) =       0.000401645394
  error estimate for blocks of size 2^( 4) =       0.000411082503
  error estimate for blocks of size 2^( 5) =       0.000417021209
  error estimate for blocks of size 2^( 6) =       0.000420332340
  error estimate for blocks of size 2^( 7) =       0.000421182341

      target function =      -0.928596210685
              le_mean =     -17.209960890002
             les_mean =     296.472535714750
             stat err =       0.000417404598
             autocorr =       1.243301376267
   target nu stat err =       0.000417404598
   target dn stat err =       0.002948341972
      target stat err =       0.004878952286
              std dev =       0.529408571201
             le_variance =       0.280273435261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280227774046
                                         uncertainty =       0.002551575792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374342401
  error estimate for blocks of size 2^( 2) =       0.000388444913
  error estimate for blocks of size 2^( 3) =       0.000401645394
  error estimate for blocks of size 2^( 4) =       0.000411082503
  error estimate for blocks of size 2^( 5) =       0.000417021209
  error estimate for blocks of size 2^( 6) =       0.000420332340
  error estimate for blocks of size 2^( 7) =       0.000421182341

      target function =      -0.928596210685
              le_mean =     -17.209960890002
             les_mean =     296.472535714750
             stat err =       0.000417404598
             autocorr =       1.243301376271
   target nu stat err =       0.000417404598
   target dn stat err =       0.002948341972
      target stat err =       0.004878952286
              std dev =       0.529408571201
             le_variance =       0.280273435261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928596210685        initial
     9.7656e+11     9.7656e+12             1.2011e-16        -0.928596210685  <--
     3.9062e+12     3.9062e+13             3.0222e-17        -0.928596210685
     1.5625e+13     1.5625e+14             0.0000e+00        -0.928596210685

*****************************************************************************
Applying the update for shift_i =   9.7656e+11     and shift_s =   9.7656e+12
*****************************************************************************

  Execution time = 3.9387e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1689
    reference variance = 0.173086
====================================================
  Execution time = 2.7576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8180e-01
  Total weights = 1.966258214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4883e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273976529350
                                         uncertainty =       0.001638083194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273976529350
                                         uncertainty =       0.001638083194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370062663
  error estimate for blocks of size 2^( 2) =       0.000384456669
  error estimate for blocks of size 2^( 3) =       0.000397557792
  error estimate for blocks of size 2^( 4) =       0.000407278246
  error estimate for blocks of size 2^( 5) =       0.000413121768
  error estimate for blocks of size 2^( 6) =       0.000415774135
  error estimate for blocks of size 2^( 7) =       0.000417726379

      target function =      -0.941863655262
              le_mean =     -17.209389887558
             les_mean =     296.444897886127
             stat err =       0.000413475132
             autocorr =       1.248384159543
   target nu stat err =       0.000413475132
   target dn stat err =       0.002053948778
      target stat err =       0.003530975601
              std dev =       0.523356010504
             le_variance =       0.273901513731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720938988756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941875779730       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941875779730       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941875779730       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942002343209       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941875779730       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941875763394       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941875917511       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942326846623       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941668972481       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941876617182       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941860006724       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941694732939       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941913766664       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941920943462       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941750355628       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941785235720       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941727283316       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941769559085       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942406943712       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942637312255       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941836172783       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941255843232       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942655068134       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939531819576       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941640185912       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941625638658       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942061095520       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943536727809       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940474122511       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942661987198       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940831260451       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941269472755       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943084418238       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943054986828       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941536030788       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943461484321       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942858571438       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942928196505       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940475930985       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943073723277       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944441954137       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939176572189       residual = 9.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943299169991       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940932775960       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943299352148       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944243576662       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.940472798578       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943567513128       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941273775744       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.943318355955       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939290642874       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.946077230634       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.945730679971       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.949241163921       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.945250388792       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.943904008503       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.936393623433       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942169623883       residual = 8.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.939870747024       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941005098367       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.941288866298       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.937695872089       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931784397767       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.938809761904       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.944389391236       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941257732731       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.946952568709       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.945639835043       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.943996117673       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.947752435788       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.937315730007       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932239338635       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.935835563414       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.923698094390       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937239918040       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.932874873869       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.963580237312       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.950397747595       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.925040734554       residual = 5.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.967964601711       residual = 7.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.949623890849       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.968842360347       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.910917696499       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.934640299164       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.955800179083       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.879550512638       residual = 5.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.962431882908       residual = 4.97e-01           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+11 is 1.027412e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941875779730       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941875779730       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941875779730       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941875779729       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941875779605       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941861775275       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941888105542       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940840650538       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943599242439       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940043368570       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942432168277       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944810440905       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944377729705       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942633782784       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943440806331       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938692338800       residual = 9.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942511024853       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942288917244       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942159293292       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941297299946       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946542640356       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941973764555       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942094970840       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940446516320       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939206337170       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944811162877       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941501306576       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933956510045       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944215553215       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.945885740060       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945921509755       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945439251696       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948300512286       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948039238985       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934849533450       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943290834669       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951437949268       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928684609982       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949361393403       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930962513586       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947075487404       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.923148985221       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936174633278       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.941623375513       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.967077409706       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.942207826417       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.951088804701       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.946427104135       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.941271085077       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.952645832843       residual = 9.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.942978130605       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.940745048453       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.952498255049       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.951273978766       residual = 4.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.937845239004       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.921808301249       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.940555469072       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.955068135473       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938489758158       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.933649821041       residual = 9.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.949630577924       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.904254770799       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.855538149956       residual = 7.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.980396946426       residual = 2.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.931873000940       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.931637749154       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.768012571268       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.903016922748       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.966028093761       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.916898079965       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.885887341103       residual = 7.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.980973937320       residual = 6.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.090049552326       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.945563670495       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.881519436356       residual = 5.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.836886784920       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.957591469511       residual = 6.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.958817783159       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.918711850124       residual = 7.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.977087113773       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.953749325301       residual = 9.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.916307760138       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.772985222367       residual = 7.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.223013138955       residual = 4.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.935430961802       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.661965664518       residual = 1.60e+01           smallest_sin_value = 9.91e-01
davidson iteration   86 stopping due to small subspace S singular value of 7.71e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+11 is 1.273070e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941875779730       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941875779730       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941875779730       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941875779730       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940924677743       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941875721532       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943115526251       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937623896655       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941240304226       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939454161046       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944089129288       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938924730690       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939712589634       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950456048013       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939279017608       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.956464366420       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946101535901       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950574169717       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948551572451       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943799428967       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951277525194       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942262055349       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929017010269       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904900243524       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914772998824       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934005091220       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947476467421       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.925237481906       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922826713108       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932068593601       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918344453684       residual = 6.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938108190513       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939534652212       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.952426608950       residual = 5.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915861995507       residual = 6.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908799683602       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.959332371553       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.977510988124       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933897349411       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.980529088355       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917953264337       residual = 3.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.898104846951       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.982616664164       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.159210439389       residual = 6.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.026058120100       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.917517865898       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.831165965510       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.827495922592       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.798682732387       residual = 2.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.889106093484       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.900437217927       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.164661182477       residual = 7.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.993048748258       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.074840006329       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.077775317798       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.187211650852       residual = 6.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.053203714691       residual = 2.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.766796516407       residual = 3.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.972152555571       residual = 8.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.822665161713       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.860494787226       residual = 9.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.779276032076       residual = 3.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.039307730736       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.690996109661       residual = 9.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.165488654628       residual = 6.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.885891969769       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.197365557634       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.617380369074       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.259700295594       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.018521147752       residual = 5.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.140469533381       residual = 9.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.391185209850       residual = 2.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.250831581076       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.215334070268       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.320536671963       residual = 3.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.196378960039       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.198458889763       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.002907688063       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -2.870033919525       residual = 4.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.083533648370       residual = 3.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.422461075193       residual = 6.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.509409244401       residual = 2.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.165608344180       residual = 3.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.015015767306       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.464886632564       residual = 4.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   85 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+12 is 3.342225e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.333485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6788e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2085
    reference variance = 0.289649
====================================================
  Execution time = 2.7636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8701e-01
  Total weights = 1.9665e+06
  Execution time = 2.3435e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371708616
  error estimate for blocks of size 2^( 2) =       0.000385829044
  error estimate for blocks of size 2^( 3) =       0.000398367191
  error estimate for blocks of size 2^( 4) =       0.000407105339
  error estimate for blocks of size 2^( 5) =       0.000411840336
  error estimate for blocks of size 2^( 6) =       0.000415203364
  error estimate for blocks of size 2^( 7) =       0.000414501530

      target function =      -0.933166992607
              le_mean =     -17.209627682909
             les_mean =     296.458296922396
             stat err =       0.000412162642
             autocorr =       1.229509803326
   target nu stat err =       0.000412162642
   target dn stat err =       0.002448391212
      target stat err =       0.004107531584
              std dev =       0.525683776397
             le_variance =       0.276343432767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371708616
  error estimate for blocks of size 2^( 2) =       0.000385829044
  error estimate for blocks of size 2^( 3) =       0.000398367191
  error estimate for blocks of size 2^( 4) =       0.000407105339
  error estimate for blocks of size 2^( 5) =       0.000411840336
  error estimate for blocks of size 2^( 6) =       0.000415203364
  error estimate for blocks of size 2^( 7) =       0.000414501530

      target function =      -0.933166992607
              le_mean =     -17.209627682909
             les_mean =     296.458296922396
             stat err =       0.000412162642
             autocorr =       1.229509803330
   target nu stat err =       0.000412162642
   target dn stat err =       0.002448391212
      target stat err =       0.004107531584
              std dev =       0.525683776397
             le_variance =       0.276343432767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371708616
  error estimate for blocks of size 2^( 2) =       0.000385829044
  error estimate for blocks of size 2^( 3) =       0.000398367191
  error estimate for blocks of size 2^( 4) =       0.000407105339
  error estimate for blocks of size 2^( 5) =       0.000411840336
  error estimate for blocks of size 2^( 6) =       0.000415203364
  error estimate for blocks of size 2^( 7) =       0.000414501530

      target function =      -0.933166992607
              le_mean =     -17.209627682909
             les_mean =     296.458296922396
             stat err =       0.000412162642
             autocorr =       1.229509803326
   target nu stat err =       0.000412162642
   target dn stat err =       0.002448391212
      target stat err =       0.004107531584
              std dev =       0.525683776397
             le_variance =       0.276343432767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276394213995
                                         uncertainty =       0.001844626191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371708616
  error estimate for blocks of size 2^( 2) =       0.000385829044
  error estimate for blocks of size 2^( 3) =       0.000398367191
  error estimate for blocks of size 2^( 4) =       0.000407105339
  error estimate for blocks of size 2^( 5) =       0.000411840336
  error estimate for blocks of size 2^( 6) =       0.000415203364
  error estimate for blocks of size 2^( 7) =       0.000414501530

      target function =      -0.933166992607
              le_mean =     -17.209627682909
             les_mean =     296.458296922396
             stat err =       0.000412162642
             autocorr =       1.229509803326
   target nu stat err =       0.000412162642
   target dn stat err =       0.002448391212
      target stat err =       0.004107531584
              std dev =       0.525683776397
             le_variance =       0.276343432767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933166992607        initial  <--
     2.4414e+11     2.4414e+12             1.0274e-15        -0.933166992607
     9.7656e+11     9.7656e+12             1.2731e-16        -0.933166992607
     3.9062e+12     3.9062e+13             3.3422e-17        -0.933166992607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6120
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2446
    reference variance = 0.233685
====================================================
  Execution time = 2.7783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0505e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8299e-01
  Total weights = 1.966347220e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5014e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275368698684
                                         uncertainty =       0.001835505709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275368698684
                                         uncertainty =       0.001835505709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371021055
  error estimate for blocks of size 2^( 2) =       0.000385643250
  error estimate for blocks of size 2^( 3) =       0.000398682482
  error estimate for blocks of size 2^( 4) =       0.000408414392
  error estimate for blocks of size 2^( 5) =       0.000413985225
  error estimate for blocks of size 2^( 6) =       0.000416909515
  error estimate for blocks of size 2^( 7) =       0.000419601940

      target function =      -0.939853890560
              le_mean =     -17.209892159526
             les_mean =     296.463378282347
             stat err =       0.000414727768
             autocorr =       1.249479447753
   target nu stat err =       0.000414727768
   target dn stat err =       0.002165339265
      target stat err =       0.003702762678
              std dev =       0.524711403215
             le_variance =       0.275322056664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720989215953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939867493051       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939867493051       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939867493051       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939160719589       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939867493051       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940238646606       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939867493051       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939867493051       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939867493051       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941587533252       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937476281177       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935600909126       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939953131694       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941416529201       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933381686097       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936798758383       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924978314811       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947217470842       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931403543955       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949234418681       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933279460675       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951507786530       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934497601314       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928659186748       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.954102120886       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934704617750       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943667402538       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943451147312       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939063167354       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.949403543346       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951529196524       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931283786068       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939536370861       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943018798713       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934554950115       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931777545275       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929015133209       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948782684530       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954775038494       residual = 7.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930029643203       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.954352290293       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.894422647424       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.014258160247       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.958282868239       residual = 3.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.955151029414       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.896829131397       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.976349089429       residual = 7.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914764348368       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943710612848       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.903994224187       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.062319633546       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.956258477273       residual = 8.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.989306425310       residual = 4.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.980967654116       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.915850893602       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.979446150767       residual = 7.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.511180689805       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.039833734007       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.761536080758       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.186003405574       residual = 7.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.999230244916       residual = 7.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.985732277172       residual = 2.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.990306935560       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.917460238889       residual = 2.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.849498209536       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.869755955377       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940059328032       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.862624000713       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.029151199906       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.683423757808       residual = 8.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.503386060598       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.768626103773       residual = 4.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.000348993710       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.911015473928       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.173790182762       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.369374066640       residual = 3.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.543859872666       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.447802879156       residual = 3.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.393905122718       residual = 4.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.301846973959       residual = 4.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -2.263338937571       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.900710966940       residual = 7.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.031500276504       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.698946004700       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.419929781543       residual = 9.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.338596257184       residual = 3.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.182847345514       residual = 4.37e+01           smallest_sin_value = 9.95e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.26e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+12 is 5.547718e-17

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939867493051       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939867493051       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939867493051       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939867493051       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.586784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6545e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.0966
    reference variance = 3.11578
====================================================
  Execution time = 2.7590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8999e-01
  Total weights = 1.9662e+06
  Execution time = 2.3405e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371880870
  error estimate for blocks of size 2^( 2) =       0.000386135895
  error estimate for blocks of size 2^( 3) =       0.000399028570
  error estimate for blocks of size 2^( 4) =       0.000408295820
  error estimate for blocks of size 2^( 5) =       0.000413274025
  error estimate for blocks of size 2^( 6) =       0.000416412374
  error estimate for blocks of size 2^( 7) =       0.000417090124

      target function =      -0.928276319856
              le_mean =     -17.209575714926
             les_mean =     296.459482356942
             stat err =       0.000413768086
             autocorr =       1.237959119250
   target nu stat err =       0.000413768086
   target dn stat err =       0.002960733629
      target stat err =       0.004891126234
              std dev =       0.525927384615
             le_variance =       0.276599613888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371880870
  error estimate for blocks of size 2^( 2) =       0.000386135895
  error estimate for blocks of size 2^( 3) =       0.000399028570
  error estimate for blocks of size 2^( 4) =       0.000408295820
  error estimate for blocks of size 2^( 5) =       0.000413274025
  error estimate for blocks of size 2^( 6) =       0.000416412374
  error estimate for blocks of size 2^( 7) =       0.000417090124

      target function =      -0.928276319856
              le_mean =     -17.209575714926
             les_mean =     296.459482356942
             stat err =       0.000413768086
             autocorr =       1.237959119251
   target nu stat err =       0.000413768086
   target dn stat err =       0.002960733629
      target stat err =       0.004891126234
              std dev =       0.525927384615
             le_variance =       0.276599613888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371880870
  error estimate for blocks of size 2^( 2) =       0.000386135895
  error estimate for blocks of size 2^( 3) =       0.000399028570
  error estimate for blocks of size 2^( 4) =       0.000408295820
  error estimate for blocks of size 2^( 5) =       0.000413274025
  error estimate for blocks of size 2^( 6) =       0.000416412374
  error estimate for blocks of size 2^( 7) =       0.000417090124

      target function =      -0.928276319856
              le_mean =     -17.209575714926
             les_mean =     296.459482356942
             stat err =       0.000413768086
             autocorr =       1.237959119250
   target nu stat err =       0.000413768086
   target dn stat err =       0.002960733629
      target stat err =       0.004891126234
              std dev =       0.525927384615
             le_variance =       0.276599613888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276587869650
                                         uncertainty =       0.001763222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371880870
  error estimate for blocks of size 2^( 2) =       0.000386135895
  error estimate for blocks of size 2^( 3) =       0.000399028570
  error estimate for blocks of size 2^( 4) =       0.000408295820
  error estimate for blocks of size 2^( 5) =       0.000413274025
  error estimate for blocks of size 2^( 6) =       0.000416412374
  error estimate for blocks of size 2^( 7) =       0.000417090124

      target function =      -0.928276319856
              le_mean =     -17.209575714926
             les_mean =     296.459482356942
             stat err =       0.000413768086
             autocorr =       1.237959119250
   target nu stat err =       0.000413768086
   target dn stat err =       0.002960733629
      target stat err =       0.004891126234
              std dev =       0.525927384615
             le_variance =       0.276599613888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928276319856        initial  <--
     2.4414e+12     2.4414e+13             5.5477e-17        -0.928276319856
     9.7656e+12     9.7656e+13             0.0000e+00        -0.928276319856
     3.9062e+13     3.9062e+14             0.0000e+00        -0.928276319856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4648
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.237564
====================================================
  Execution time = 2.7836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8684e-01
  Total weights = 1.966101979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5289e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277680845245
                                         uncertainty =       0.001641712757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277680845245
                                         uncertainty =       0.001641712757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372583972
  error estimate for blocks of size 2^( 2) =       0.000387087323
  error estimate for blocks of size 2^( 3) =       0.000400221846
  error estimate for blocks of size 2^( 4) =       0.000410144073
  error estimate for blocks of size 2^( 5) =       0.000415373990
  error estimate for blocks of size 2^( 6) =       0.000420144090
  error estimate for blocks of size 2^( 7) =       0.000424925970

      target function =      -0.933460429767
              le_mean =     -17.209550090318
             les_mean =     296.455451142004
             stat err =       0.000417647031
             autocorr =       1.256523051888
   target nu stat err =       0.000417647031
   target dn stat err =       0.002273868696
      target stat err =       0.003827966502
              std dev =       0.526921736597
             le_variance =       0.277646516499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720955009032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933475232377       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.588081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6374e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.340314
====================================================
  Execution time = 2.7649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8410e-01
  Total weights = 1.9662e+06
  Execution time = 2.3308e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370451108
  error estimate for blocks of size 2^( 2) =       0.000384682410
  error estimate for blocks of size 2^( 3) =       0.000397661987
  error estimate for blocks of size 2^( 4) =       0.000406742012
  error estimate for blocks of size 2^( 5) =       0.000413114965
  error estimate for blocks of size 2^( 6) =       0.000416823802
  error estimate for blocks of size 2^( 7) =       0.000419975401

      target function =      -0.937995660348
              le_mean =     -17.209671707317
             les_mean =     296.456901276391
             stat err =       0.000414164045
             autocorr =       1.249922224191
   target nu stat err =       0.000414164045
   target dn stat err =       0.002518046641
      target stat err =       0.004264870234
              std dev =       0.523905363979
             le_variance =       0.274476830406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370451108
  error estimate for blocks of size 2^( 2) =       0.000384682410
  error estimate for blocks of size 2^( 3) =       0.000397661987
  error estimate for blocks of size 2^( 4) =       0.000406742012
  error estimate for blocks of size 2^( 5) =       0.000413114965
  error estimate for blocks of size 2^( 6) =       0.000416823802
  error estimate for blocks of size 2^( 7) =       0.000419975401

      target function =      -0.937995660348
              le_mean =     -17.209671707317
             les_mean =     296.456901276391
             stat err =       0.000414164045
             autocorr =       1.249922224191
   target nu stat err =       0.000414164045
   target dn stat err =       0.002518046641
      target stat err =       0.004264870234
              std dev =       0.523905363979
             le_variance =       0.274476830406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370451108
  error estimate for blocks of size 2^( 2) =       0.000384682410
  error estimate for blocks of size 2^( 3) =       0.000397661987
  error estimate for blocks of size 2^( 4) =       0.000406742012
  error estimate for blocks of size 2^( 5) =       0.000413114965
  error estimate for blocks of size 2^( 6) =       0.000416823802
  error estimate for blocks of size 2^( 7) =       0.000419975401

      target function =      -0.937995660348
              le_mean =     -17.209671707317
             les_mean =     296.456901276391
             stat err =       0.000414164045
             autocorr =       1.249922224191
   target nu stat err =       0.000414164045
   target dn stat err =       0.002518046641
      target stat err =       0.004264870234
              std dev =       0.523905363979
             le_variance =       0.274476830406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274484762219
                                         uncertainty =       0.001757013293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370451108
  error estimate for blocks of size 2^( 2) =       0.000384682410
  error estimate for blocks of size 2^( 3) =       0.000397661987
  error estimate for blocks of size 2^( 4) =       0.000406742012
  error estimate for blocks of size 2^( 5) =       0.000413114965
  error estimate for blocks of size 2^( 6) =       0.000416823802
  error estimate for blocks of size 2^( 7) =       0.000419975401

      target function =      -0.937995660348
              le_mean =     -17.209671707317
             les_mean =     296.456901276391
             stat err =       0.000414164045
             autocorr =       1.249922224191
   target nu stat err =       0.000414164045
   target dn stat err =       0.002518046641
      target stat err =       0.004264870234
              std dev =       0.523905363979
             le_variance =       0.274476830406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937995660348        initial  <--
     2.4414e+13     2.4414e+14             0.0000e+00        -0.937995660348
     9.7656e+13     9.7656e+14             0.0000e+00        -0.937995660348
     3.9062e+14     3.9062e+15             0.0000e+00        -0.937995660348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4466
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1576
    reference variance = 0.247755
====================================================
  Execution time = 2.7950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9063e-01
  Total weights = 1.966363528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5693e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279341069294
                                         uncertainty =       0.002566425993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279341069294
                                         uncertainty =       0.002566425993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373713310
  error estimate for blocks of size 2^( 2) =       0.000387937737
  error estimate for blocks of size 2^( 3) =       0.000400745696
  error estimate for blocks of size 2^( 4) =       0.000409922322
  error estimate for blocks of size 2^( 5) =       0.000416129976
  error estimate for blocks of size 2^( 6) =       0.000419018163
  error estimate for blocks of size 2^( 7) =       0.000421561320

      target function =      -0.927218355678
              le_mean =     -17.209236591396
             les_mean =     296.448457319739
             stat err =       0.000416657945
             autocorr =       1.243031699032
   target nu stat err =       0.000416657945
   target dn stat err =       0.003720312438
      target stat err =       0.006103860629
              std dev =       0.528518887486
             le_variance =       0.279332214430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720923659140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927257871792       residual = 5.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.589350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6528e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.248356
====================================================
  Execution time = 2.7624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8686e-01
  Total weights = 1.9663e+06
  Execution time = 2.3270e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372328488
  error estimate for blocks of size 2^( 2) =       0.000386774016
  error estimate for blocks of size 2^( 3) =       0.000399709001
  error estimate for blocks of size 2^( 4) =       0.000409562225
  error estimate for blocks of size 2^( 5) =       0.000415506288
  error estimate for blocks of size 2^( 6) =       0.000418337915
  error estimate for blocks of size 2^( 7) =       0.000420899143

      target function =      -0.933429422463
              le_mean =     -17.209381465068
             les_mean =     296.449668552517
             stat err =       0.000416076393
             autocorr =       1.248802094084
   target nu stat err =       0.000416076393
   target dn stat err =       0.002300561632
      target stat err =       0.003869219694
              std dev =       0.526560421989
             le_variance =       0.277265878005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372328488
  error estimate for blocks of size 2^( 2) =       0.000386774016
  error estimate for blocks of size 2^( 3) =       0.000399709001
  error estimate for blocks of size 2^( 4) =       0.000409562225
  error estimate for blocks of size 2^( 5) =       0.000415506288
  error estimate for blocks of size 2^( 6) =       0.000418337915
  error estimate for blocks of size 2^( 7) =       0.000420899143

      target function =      -0.933429422463
              le_mean =     -17.209381465068
             les_mean =     296.449668552517
             stat err =       0.000416076393
             autocorr =       1.248802094084
   target nu stat err =       0.000416076393
   target dn stat err =       0.002300561632
      target stat err =       0.003869219694
              std dev =       0.526560421989
             le_variance =       0.277265878005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372328488
  error estimate for blocks of size 2^( 2) =       0.000386774016
  error estimate for blocks of size 2^( 3) =       0.000399709001
  error estimate for blocks of size 2^( 4) =       0.000409562225
  error estimate for blocks of size 2^( 5) =       0.000415506288
  error estimate for blocks of size 2^( 6) =       0.000418337915
  error estimate for blocks of size 2^( 7) =       0.000420899143

      target function =      -0.933429422463
              le_mean =     -17.209381465068
             les_mean =     296.449668552517
             stat err =       0.000416076393
             autocorr =       1.248802094084
   target nu stat err =       0.000416076393
   target dn stat err =       0.002300561632
      target stat err =       0.003869219694
              std dev =       0.526560421989
             le_variance =       0.277265878005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277314750731
                                         uncertainty =       0.001922303877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372328488
  error estimate for blocks of size 2^( 2) =       0.000386774016
  error estimate for blocks of size 2^( 3) =       0.000399709001
  error estimate for blocks of size 2^( 4) =       0.000409562225
  error estimate for blocks of size 2^( 5) =       0.000415506288
  error estimate for blocks of size 2^( 6) =       0.000418337915
  error estimate for blocks of size 2^( 7) =       0.000420899143

      target function =      -0.933429422463
              le_mean =     -17.209381465068
             les_mean =     296.449668552517
             stat err =       0.000416076393
             autocorr =       1.248802094084
   target nu stat err =       0.000416076393
   target dn stat err =       0.002300561632
      target stat err =       0.003869219694
              std dev =       0.526560421989
             le_variance =       0.277265878005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933429422463        initial  <--
     2.4414e+14     2.4414e+15             0.0000e+00        -0.933429422463
     9.7656e+14     9.7656e+15             0.0000e+00        -0.933429422463
     3.9062e+15     3.9062e+16             0.0000e+00        -0.933429422463

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4123
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.256131
====================================================
  Execution time = 2.7608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0492e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8680e-01
  Total weights = 1.966319501e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4354e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277617577328
                                         uncertainty =       0.001659609133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277617577328
                                         uncertainty =       0.001659609133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372563365
  error estimate for blocks of size 2^( 2) =       0.000387085172
  error estimate for blocks of size 2^( 3) =       0.000400352535
  error estimate for blocks of size 2^( 4) =       0.000409479369
  error estimate for blocks of size 2^( 5) =       0.000414967219
  error estimate for blocks of size 2^( 6) =       0.000417106807
  error estimate for blocks of size 2^( 7) =       0.000419535270

      target function =      -0.933513068765
              le_mean =     -17.209615351077
             les_mean =     296.457664759957
             stat err =       0.000415272166
             autocorr =       1.242411179156
   target nu stat err =       0.000415272166
   target dn stat err =       0.002247313396
      target stat err =       0.003785004084
              std dev =       0.526892594175
             le_variance =       0.277615805797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720961535108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.42e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.42e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933527340968       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.42e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.590679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6053e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1484
    reference variance = 0.206293
====================================================
  Execution time = 2.9918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.0290e-01
  Total weights = 1.9663e+06
  Execution time = 2.3443e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631928
  error estimate for blocks of size 2^( 2) =       0.000390778272
  error estimate for blocks of size 2^( 3) =       0.000404276741
  error estimate for blocks of size 2^( 4) =       0.000414209813
  error estimate for blocks of size 2^( 5) =       0.000419997888
  error estimate for blocks of size 2^( 6) =       0.000422961280
  error estimate for blocks of size 2^( 7) =       0.000425432722

      target function =      -0.907137193201
              le_mean =     -17.210178113276
             les_mean =     296.493132620825
             stat err =       0.000420650426
             autocorr =       1.247407638645
   target nu stat err =       0.000420650426
   target dn stat err =       0.013510248727
      target stat err =       0.021123779410
              std dev =       0.532646502482
             le_variance =       0.283712296607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631928
  error estimate for blocks of size 2^( 2) =       0.000390778272
  error estimate for blocks of size 2^( 3) =       0.000404276741
  error estimate for blocks of size 2^( 4) =       0.000414209813
  error estimate for blocks of size 2^( 5) =       0.000419997888
  error estimate for blocks of size 2^( 6) =       0.000422961280
  error estimate for blocks of size 2^( 7) =       0.000425432722

      target function =      -0.907137193201
              le_mean =     -17.210178113276
             les_mean =     296.493132620825
             stat err =       0.000420650426
             autocorr =       1.247407638644
   target nu stat err =       0.000420650426
   target dn stat err =       0.013510248727
      target stat err =       0.021123779410
              std dev =       0.532646502482
             le_variance =       0.283712296607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631928
  error estimate for blocks of size 2^( 2) =       0.000390778272
  error estimate for blocks of size 2^( 3) =       0.000404276741
  error estimate for blocks of size 2^( 4) =       0.000414209813
  error estimate for blocks of size 2^( 5) =       0.000419997888
  error estimate for blocks of size 2^( 6) =       0.000422961280
  error estimate for blocks of size 2^( 7) =       0.000425432722

      target function =      -0.907137193201
              le_mean =     -17.210178113276
             les_mean =     296.493132620825
             stat err =       0.000420650426
             autocorr =       1.247407638644
   target nu stat err =       0.000420650426
   target dn stat err =       0.013510248727
      target stat err =       0.021123779410
              std dev =       0.532646502482
             le_variance =       0.283712296607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283744758294
                                         uncertainty =       0.005012948395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631928
  error estimate for blocks of size 2^( 2) =       0.000390778272
  error estimate for blocks of size 2^( 3) =       0.000404276741
  error estimate for blocks of size 2^( 4) =       0.000414209813
  error estimate for blocks of size 2^( 5) =       0.000419997888
  error estimate for blocks of size 2^( 6) =       0.000422961280
  error estimate for blocks of size 2^( 7) =       0.000425432722

      target function =      -0.907137193201
              le_mean =     -17.210178113276
             les_mean =     296.493132620825
             stat err =       0.000420650426
             autocorr =       1.247407638644
   target nu stat err =       0.000420650426
   target dn stat err =       0.013510248727
      target stat err =       0.021123779410
              std dev =       0.532646502482
             le_variance =       0.283712296607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907137193201        initial  <--
     2.4414e+15     2.4414e+16             0.0000e+00        -0.907137193201
     9.7656e+15     9.7656e+16             0.0000e+00        -0.907137193201
     3.9062e+16     3.9062e+17             0.0000e+00        -0.907137193201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.7838
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7843e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2692
    reference variance = 0.170462
====================================================
  Execution time = 2.7543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8206e-01
  Total weights = 1.966575627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3372e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274822913054
                                         uncertainty =       0.001606735144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274822913054
                                         uncertainty =       0.001606735144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370650667
  error estimate for blocks of size 2^( 2) =       0.000385009092
  error estimate for blocks of size 2^( 3) =       0.000398199930
  error estimate for blocks of size 2^( 4) =       0.000408187319
  error estimate for blocks of size 2^( 5) =       0.000414360416
  error estimate for blocks of size 2^( 6) =       0.000417098641
  error estimate for blocks of size 2^( 7) =       0.000419649328

      target function =      -0.941418265637
              le_mean =     -17.209460400564
             les_mean =     296.447590586714
             stat err =       0.000414823926
             autocorr =       1.252558509108
   target nu stat err =       0.000414823926
   target dn stat err =       0.001887378094
      target stat err =       0.003255630273
              std dev =       0.524187587580
             le_variance =       0.274772626973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720946040056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941428446636       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.593870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5893e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.158916
====================================================
  Execution time = 2.7247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8633e-01
  Total weights = 1.9665e+06
  Execution time = 2.3411e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371815614
  error estimate for blocks of size 2^( 2) =       0.000386198161
  error estimate for blocks of size 2^( 3) =       0.000399351356
  error estimate for blocks of size 2^( 4) =       0.000409351905
  error estimate for blocks of size 2^( 5) =       0.000414918558
  error estimate for blocks of size 2^( 6) =       0.000417146427
  error estimate for blocks of size 2^( 7) =       0.000417633146

      target function =      -0.934302392444
              le_mean =     -17.209482317428
             les_mean =     296.452611033902
             stat err =       0.000414762509
             autocorr =       1.244353403323
   target nu stat err =       0.000414762509
   target dn stat err =       0.002181457144
      target stat err =       0.003683316027
              std dev =       0.525835096770
             le_variance =       0.276502548995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371815614
  error estimate for blocks of size 2^( 2) =       0.000386198161
  error estimate for blocks of size 2^( 3) =       0.000399351356
  error estimate for blocks of size 2^( 4) =       0.000409351905
  error estimate for blocks of size 2^( 5) =       0.000414918558
  error estimate for blocks of size 2^( 6) =       0.000417146427
  error estimate for blocks of size 2^( 7) =       0.000417633146

      target function =      -0.934302392444
              le_mean =     -17.209482317428
             les_mean =     296.452611033902
             stat err =       0.000414762509
             autocorr =       1.244353403323
   target nu stat err =       0.000414762509
   target dn stat err =       0.002181457144
      target stat err =       0.003683316027
              std dev =       0.525835096770
             le_variance =       0.276502548995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371815614
  error estimate for blocks of size 2^( 2) =       0.000386198161
  error estimate for blocks of size 2^( 3) =       0.000399351356
  error estimate for blocks of size 2^( 4) =       0.000409351905
  error estimate for blocks of size 2^( 5) =       0.000414918558
  error estimate for blocks of size 2^( 6) =       0.000417146427
  error estimate for blocks of size 2^( 7) =       0.000417633146

      target function =      -0.934302392444
              le_mean =     -17.209482317428
             les_mean =     296.452611033902
             stat err =       0.000414762509
             autocorr =       1.244353403323
   target nu stat err =       0.000414762509
   target dn stat err =       0.002181457144
      target stat err =       0.003683316027
              std dev =       0.525835096770
             le_variance =       0.276502548995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276606492464
                                         uncertainty =       0.001724076404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371815614
  error estimate for blocks of size 2^( 2) =       0.000386198161
  error estimate for blocks of size 2^( 3) =       0.000399351356
  error estimate for blocks of size 2^( 4) =       0.000409351905
  error estimate for blocks of size 2^( 5) =       0.000414918558
  error estimate for blocks of size 2^( 6) =       0.000417146427
  error estimate for blocks of size 2^( 7) =       0.000417633146

      target function =      -0.934302392444
              le_mean =     -17.209482317428
             les_mean =     296.452611033902
             stat err =       0.000414762509
             autocorr =       1.244353403323
   target nu stat err =       0.000414762509
   target dn stat err =       0.002181457144
      target stat err =       0.003683316027
              std dev =       0.525835096770
             le_variance =       0.276502548995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934302392444        initial  <--
     2.4414e+16     2.4414e+17             0.0000e+00        -0.934302392444
     9.7656e+16     9.7656e+17             0.0000e+00        -0.934302392444
     3.9062e+17     3.9062e+18             0.0000e+00        -0.934302392444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1079
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.3264
    reference variance = 0.663367
====================================================
  Execution time = 2.7564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0476e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8387e-01
  Total weights = 1.966117967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3935e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274477786695
                                         uncertainty =       0.001552108531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274477786695
                                         uncertainty =       0.001552108531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370456732
  error estimate for blocks of size 2^( 2) =       0.000384961460
  error estimate for blocks of size 2^( 3) =       0.000398057977
  error estimate for blocks of size 2^( 4) =       0.000408003257
  error estimate for blocks of size 2^( 5) =       0.000414738368
  error estimate for blocks of size 2^( 6) =       0.000416403673
  error estimate for blocks of size 2^( 7) =       0.000418834661

      target function =      -0.938387901255
              le_mean =     -17.209367909404
             les_mean =     296.446218151778
             stat err =       0.000414494990
             autocorr =       1.251882554933
   target nu stat err =       0.000414494990
   target dn stat err =       0.001858355960
      target stat err =       0.003187408336
              std dev =       0.523913317343
             le_variance =       0.274485164089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720936790940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938397721862       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.597119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5970e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2349
    reference variance = 0.289042
====================================================
  Execution time = 2.7422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8996e-01
  Total weights = 1.9662e+06
  Execution time = 2.3390e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374102412
  error estimate for blocks of size 2^( 2) =       0.000388415917
  error estimate for blocks of size 2^( 3) =       0.000401330493
  error estimate for blocks of size 2^( 4) =       0.000410362528
  error estimate for blocks of size 2^( 5) =       0.000416297788
  error estimate for blocks of size 2^( 6) =       0.000419318992
  error estimate for blocks of size 2^( 7) =       0.000423277578

      target function =      -0.928332891236
              le_mean =     -17.209206114771
             les_mean =     296.446739527669
             stat err =       0.000417314221
             autocorr =       1.244358024965
   target nu stat err =       0.000417314221
   target dn stat err =       0.002457448003
      target stat err =       0.004078677177
              std dev =       0.529069169752
             le_variance =       0.279914186382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374102412
  error estimate for blocks of size 2^( 2) =       0.000388415917
  error estimate for blocks of size 2^( 3) =       0.000401330493
  error estimate for blocks of size 2^( 4) =       0.000410362528
  error estimate for blocks of size 2^( 5) =       0.000416297788
  error estimate for blocks of size 2^( 6) =       0.000419318992
  error estimate for blocks of size 2^( 7) =       0.000423277578

      target function =      -0.928332891236
              le_mean =     -17.209206114771
             les_mean =     296.446739527669
             stat err =       0.000417314221
             autocorr =       1.244358024965
   target nu stat err =       0.000417314221
   target dn stat err =       0.002457448003
      target stat err =       0.004078677177
              std dev =       0.529069169752
             le_variance =       0.279914186382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374102412
  error estimate for blocks of size 2^( 2) =       0.000388415917
  error estimate for blocks of size 2^( 3) =       0.000401330493
  error estimate for blocks of size 2^( 4) =       0.000410362528
  error estimate for blocks of size 2^( 5) =       0.000416297788
  error estimate for blocks of size 2^( 6) =       0.000419318992
  error estimate for blocks of size 2^( 7) =       0.000423277578

      target function =      -0.928332891236
              le_mean =     -17.209206114771
             les_mean =     296.446739527669
             stat err =       0.000417314221
             autocorr =       1.244358024965
   target nu stat err =       0.000417314221
   target dn stat err =       0.002457448003
      target stat err =       0.004078677177
              std dev =       0.529069169752
             le_variance =       0.279914186382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279936494878
                                         uncertainty =       0.001824568714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374102412
  error estimate for blocks of size 2^( 2) =       0.000388415917
  error estimate for blocks of size 2^( 3) =       0.000401330493
  error estimate for blocks of size 2^( 4) =       0.000410362528
  error estimate for blocks of size 2^( 5) =       0.000416297788
  error estimate for blocks of size 2^( 6) =       0.000419318992
  error estimate for blocks of size 2^( 7) =       0.000423277578

      target function =      -0.928332891236
              le_mean =     -17.209206114771
             les_mean =     296.446739527669
             stat err =       0.000417314221
             autocorr =       1.244358024965
   target nu stat err =       0.000417314221
   target dn stat err =       0.002457448003
      target stat err =       0.004078677177
              std dev =       0.529069169752
             le_variance =       0.279914186382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928332891236        initial  <--
     2.4414e+17     2.4414e+18             0.0000e+00        -0.928332891236
     9.7656e+17     9.7656e+18             0.0000e+00        -0.928332891236
     3.9062e+18     3.9062e+19             0.0000e+00        -0.928332891236

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2761
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1611
    reference variance = 0.134512
====================================================
  Execution time = 2.7447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8681e-01
  Total weights = 1.966078845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3443e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277626821188
                                         uncertainty =       0.001778088385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277626821188
                                         uncertainty =       0.001778088385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372579080
  error estimate for blocks of size 2^( 2) =       0.000386815631
  error estimate for blocks of size 2^( 3) =       0.000399935476
  error estimate for blocks of size 2^( 4) =       0.000410396864
  error estimate for blocks of size 2^( 5) =       0.000417919646
  error estimate for blocks of size 2^( 6) =       0.000420639670
  error estimate for blocks of size 2^( 7) =       0.000420056186

      target function =      -0.933497889268
              le_mean =     -17.209757560444
             les_mean =     296.462565676541
             stat err =       0.000417253092
             autocorr =       1.254186709428
   target nu stat err =       0.000417253092
   target dn stat err =       0.002320964514
      target stat err =       0.003906038733
              std dev =       0.526914818487
             le_variance =       0.277639225942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720975756044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933513301539       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933513301539       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933513301539       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933513301539       residual = 2.26e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933513301539       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933513301539       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+18 is 6.476707e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933513301539       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933513301539       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933513301539       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933513301538       residual = 9.01e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+18 is 1.734648e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933513301539       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933513301539       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933513301539       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933513301539       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933553042679       residual = 3.57e+04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+19 is 4.336620e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.602147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5806e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.215413
====================================================
  Execution time = 2.7407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8456e-01
  Total weights = 1.9664e+06
  Execution time = 2.3337e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371296835
  error estimate for blocks of size 2^( 2) =       0.000385561456
  error estimate for blocks of size 2^( 3) =       0.000398946376
  error estimate for blocks of size 2^( 4) =       0.000409154313
  error estimate for blocks of size 2^( 5) =       0.000414722237
  error estimate for blocks of size 2^( 6) =       0.000417271991
  error estimate for blocks of size 2^( 7) =       0.000418969078

      target function =      -0.937232802404
              le_mean =     -17.209809055452
             les_mean =     296.462089107112
             stat err =       0.000415029405
             autocorr =       1.249439527927
   target nu stat err =       0.000415029405
   target dn stat err =       0.001965945361
      target stat err =       0.003357276974
              std dev =       0.525101420442
             le_variance =       0.275731501751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371296835
  error estimate for blocks of size 2^( 2) =       0.000385561456
  error estimate for blocks of size 2^( 3) =       0.000398946376
  error estimate for blocks of size 2^( 4) =       0.000409154313
  error estimate for blocks of size 2^( 5) =       0.000414722237
  error estimate for blocks of size 2^( 6) =       0.000417271991
  error estimate for blocks of size 2^( 7) =       0.000418969078

      target function =      -0.937232802404
              le_mean =     -17.209809055452
             les_mean =     296.462089107112
             stat err =       0.000415029405
             autocorr =       1.249439527927
   target nu stat err =       0.000415029405
   target dn stat err =       0.001965945361
      target stat err =       0.003357276974
              std dev =       0.525101420442
             le_variance =       0.275731501751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371296835
  error estimate for blocks of size 2^( 2) =       0.000385561456
  error estimate for blocks of size 2^( 3) =       0.000398946376
  error estimate for blocks of size 2^( 4) =       0.000409154313
  error estimate for blocks of size 2^( 5) =       0.000414722237
  error estimate for blocks of size 2^( 6) =       0.000417271991
  error estimate for blocks of size 2^( 7) =       0.000418969078

      target function =      -0.937232802404
              le_mean =     -17.209809055452
             les_mean =     296.462089107112
             stat err =       0.000415029405
             autocorr =       1.249439527927
   target nu stat err =       0.000415029405
   target dn stat err =       0.001965945361
      target stat err =       0.003357276974
              std dev =       0.525101420442
             le_variance =       0.275731501751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275767450037
                                         uncertainty =       0.001489793325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371296835
  error estimate for blocks of size 2^( 2) =       0.000385561456
  error estimate for blocks of size 2^( 3) =       0.000398946376
  error estimate for blocks of size 2^( 4) =       0.000409154313
  error estimate for blocks of size 2^( 5) =       0.000414722237
  error estimate for blocks of size 2^( 6) =       0.000417271991
  error estimate for blocks of size 2^( 7) =       0.000418969078

      target function =      -0.937232802404
              le_mean =     -17.209809055452
             les_mean =     296.462089107112
             stat err =       0.000415029405
             autocorr =       1.249439527927
   target nu stat err =       0.000415029405
   target dn stat err =       0.001965945361
      target stat err =       0.003357276974
              std dev =       0.525101420442
             le_variance =       0.275731501751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937232802404        initial  <--
     2.4414e+18     2.4414e+19             6.4767e-23        -0.937232802404
     9.7656e+18     9.7656e+19             1.7346e-23        -0.937232802404
     3.9062e+19     3.9062e+20             4.3366e-24        -0.937232802404

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2219
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.186
    reference variance = 0.292422
====================================================
  Execution time = 2.7422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9073e-01
  Total weights = 1.966164533e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3967e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279095974706
                                         uncertainty =       0.002055675757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279095974706
                                         uncertainty =       0.002055675757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373513720
  error estimate for blocks of size 2^( 2) =       0.000388027718
  error estimate for blocks of size 2^( 3) =       0.000401331261
  error estimate for blocks of size 2^( 4) =       0.000411303808
  error estimate for blocks of size 2^( 5) =       0.000416140417
  error estimate for blocks of size 2^( 6) =       0.000419677999
  error estimate for blocks of size 2^( 7) =       0.000421645019

      target function =      -0.927082161537
              le_mean =     -17.209111493996
             les_mean =     296.444247610833
             stat err =       0.000417191811
             autocorr =       1.247551353215
   target nu stat err =       0.000417191811
   target dn stat err =       0.002926946632
      target stat err =       0.004820923828
              std dev =       0.528236620025
             le_variance =       0.279033926736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720911149400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927106273030       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.603422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5828e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1511
    reference variance = 0.190352
====================================================
  Execution time = 2.9440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8829e-01
  Total weights = 1.9663e+06
  Execution time = 2.3184e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373009086
  error estimate for blocks of size 2^( 2) =       0.000387443961
  error estimate for blocks of size 2^( 3) =       0.000400830913
  error estimate for blocks of size 2^( 4) =       0.000410342025
  error estimate for blocks of size 2^( 5) =       0.000416054439
  error estimate for blocks of size 2^( 6) =       0.000419413841
  error estimate for blocks of size 2^( 7) =       0.000423133586

      target function =      -0.931059222085
              le_mean =     -17.209660556847
             les_mean =     296.460703452271
             stat err =       0.000417235973
             autocorr =       1.251194040835
   target nu stat err =       0.000417235973
   target dn stat err =       0.002880252306
      target stat err =       0.004791113295
              std dev =       0.527522948759
             le_variance =       0.278280461468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373009086
  error estimate for blocks of size 2^( 2) =       0.000387443961
  error estimate for blocks of size 2^( 3) =       0.000400830913
  error estimate for blocks of size 2^( 4) =       0.000410342025
  error estimate for blocks of size 2^( 5) =       0.000416054439
  error estimate for blocks of size 2^( 6) =       0.000419413841
  error estimate for blocks of size 2^( 7) =       0.000423133586

      target function =      -0.931059222085
              le_mean =     -17.209660556847
             les_mean =     296.460703452271
             stat err =       0.000417235973
             autocorr =       1.251194040835
   target nu stat err =       0.000417235973
   target dn stat err =       0.002880252306
      target stat err =       0.004791113295
              std dev =       0.527522948759
             le_variance =       0.278280461468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373009086
  error estimate for blocks of size 2^( 2) =       0.000387443961
  error estimate for blocks of size 2^( 3) =       0.000400830913
  error estimate for blocks of size 2^( 4) =       0.000410342025
  error estimate for blocks of size 2^( 5) =       0.000416054439
  error estimate for blocks of size 2^( 6) =       0.000419413841
  error estimate for blocks of size 2^( 7) =       0.000423133586

      target function =      -0.931059222085
              le_mean =     -17.209660556847
             les_mean =     296.460703452271
             stat err =       0.000417235973
             autocorr =       1.251194040835
   target nu stat err =       0.000417235973
   target dn stat err =       0.002880252306
      target stat err =       0.004791113295
              std dev =       0.527522948759
             le_variance =       0.278280461468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278253443916
                                         uncertainty =       0.001925524934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373009086
  error estimate for blocks of size 2^( 2) =       0.000387443961
  error estimate for blocks of size 2^( 3) =       0.000400830913
  error estimate for blocks of size 2^( 4) =       0.000410342025
  error estimate for blocks of size 2^( 5) =       0.000416054439
  error estimate for blocks of size 2^( 6) =       0.000419413841
  error estimate for blocks of size 2^( 7) =       0.000423133586

      target function =      -0.931059222085
              le_mean =     -17.209660556847
             les_mean =     296.460703452271
             stat err =       0.000417235973
             autocorr =       1.251194040835
   target nu stat err =       0.000417235973
   target dn stat err =       0.002880252306
      target stat err =       0.004791113295
              std dev =       0.527522948759
             le_variance =       0.278280461468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931059222085        initial  <--
     2.4414e+19     2.4414e+20             0.0000e+00        -0.931059222085
     9.7656e+19     9.7656e+20             0.0000e+00        -0.931059222085
     3.9062e+20     3.9062e+21             0.0000e+00        -0.931059222085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1770
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7011e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2768
    reference variance = 0.219028
====================================================
  Execution time = 2.8093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8876e-01
  Total weights = 1.966467766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3816e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280323782839
                                         uncertainty =       0.001979172297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280323782839
                                         uncertainty =       0.001979172297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374425610
  error estimate for blocks of size 2^( 2) =       0.000388682271
  error estimate for blocks of size 2^( 3) =       0.000401482709
  error estimate for blocks of size 2^( 4) =       0.000410638416
  error estimate for blocks of size 2^( 5) =       0.000415842868
  error estimate for blocks of size 2^( 6) =       0.000419973023
  error estimate for blocks of size 2^( 7) =       0.000422727155

      target function =      -0.930285116395
              le_mean =     -17.209782604659
             les_mean =     296.465377551876
             stat err =       0.000417295365
             autocorr =       1.242098480085
   target nu stat err =       0.000417295365
   target dn stat err =       0.002393814366
      target stat err =       0.003997340025
              std dev =       0.529526248166
             le_variance =       0.280398047497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720978260466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930301206327       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930301206327       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930301206327       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930301206357       residual = 2.53e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+20 is 7.317223e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930301206327       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930301206327       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930301206327       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930301206327       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+20 is 1.829306e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930301206327       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930301206327       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930301206327       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930301206327       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+21 is 4.573264e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.605432 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6484e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.300144
====================================================
  Execution time = 2.7650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8498e-01
  Total weights = 1.9663e+06
  Execution time = 2.3126e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371207700
  error estimate for blocks of size 2^( 2) =       0.000385393906
  error estimate for blocks of size 2^( 3) =       0.000398272466
  error estimate for blocks of size 2^( 4) =       0.000407972041
  error estimate for blocks of size 2^( 5) =       0.000413648896
  error estimate for blocks of size 2^( 6) =       0.000415036768
  error estimate for blocks of size 2^( 7) =       0.000414942473

      target function =      -0.936547748228
              le_mean =     -17.209201688924
             les_mean =     296.441599148100
             stat err =       0.000412900045
             autocorr =       1.237245566719
   target nu stat err =       0.000412900045
   target dn stat err =       0.002510126815
      target stat err =       0.004234772612
              std dev =       0.524975363575
             le_variance =       0.275599132361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371207700
  error estimate for blocks of size 2^( 2) =       0.000385393906
  error estimate for blocks of size 2^( 3) =       0.000398272466
  error estimate for blocks of size 2^( 4) =       0.000407972041
  error estimate for blocks of size 2^( 5) =       0.000413648896
  error estimate for blocks of size 2^( 6) =       0.000415036768
  error estimate for blocks of size 2^( 7) =       0.000414942473

      target function =      -0.936547748228
              le_mean =     -17.209201688924
             les_mean =     296.441599148100
             stat err =       0.000412900045
             autocorr =       1.237245566716
   target nu stat err =       0.000412900045
   target dn stat err =       0.002510126815
      target stat err =       0.004234772612
              std dev =       0.524975363575
             le_variance =       0.275599132361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371207700
  error estimate for blocks of size 2^( 2) =       0.000385393906
  error estimate for blocks of size 2^( 3) =       0.000398272466
  error estimate for blocks of size 2^( 4) =       0.000407972041
  error estimate for blocks of size 2^( 5) =       0.000413648896
  error estimate for blocks of size 2^( 6) =       0.000415036768
  error estimate for blocks of size 2^( 7) =       0.000414942473

      target function =      -0.936547748228
              le_mean =     -17.209201688924
             les_mean =     296.441599148100
             stat err =       0.000412900045
             autocorr =       1.237245566716
   target nu stat err =       0.000412900045
   target dn stat err =       0.002510126815
      target stat err =       0.004234772612
              std dev =       0.524975363575
             le_variance =       0.275599132361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275562618227
                                         uncertainty =       0.001741291659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371207700
  error estimate for blocks of size 2^( 2) =       0.000385393906
  error estimate for blocks of size 2^( 3) =       0.000398272466
  error estimate for blocks of size 2^( 4) =       0.000407972041
  error estimate for blocks of size 2^( 5) =       0.000413648896
  error estimate for blocks of size 2^( 6) =       0.000415036768
  error estimate for blocks of size 2^( 7) =       0.000414942473

      target function =      -0.936547748228
              le_mean =     -17.209201688924
             les_mean =     296.441599148100
             stat err =       0.000412900045
             autocorr =       1.237245566716
   target nu stat err =       0.000412900045
   target dn stat err =       0.002510126815
      target stat err =       0.004234772612
              std dev =       0.524975363575
             le_variance =       0.275599132361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936547748228        initial  <--
     2.4414e+20     2.4414e+21             7.3172e-25        -0.936547748228
     9.7656e+20     9.7656e+21             1.8293e-25        -0.936547748228
     3.9062e+21     3.9062e+22             4.5733e-26        -0.936547748228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3052
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5796e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.12393
====================================================
  Execution time = 2.7358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0485e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9174e-01
  Total weights = 1.966621233e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5783e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278942341580
                                         uncertainty =       0.001727075238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278942341580
                                         uncertainty =       0.001727075238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373382702
  error estimate for blocks of size 2^( 2) =       0.000387139007
  error estimate for blocks of size 2^( 3) =       0.000400097324
  error estimate for blocks of size 2^( 4) =       0.000409606872
  error estimate for blocks of size 2^( 5) =       0.000415592288
  error estimate for blocks of size 2^( 6) =       0.000417797333
  error estimate for blocks of size 2^( 7) =       0.000418077517

      target function =      -0.925401728736
              le_mean =     -17.209846865394
             les_mean =     296.470566958440
             stat err =       0.000415268503
             autocorr =       1.236942741737
   target nu stat err =       0.000415268503
   target dn stat err =       0.003535332916
      target stat err =       0.005788659589
              std dev =       0.528051329119
             le_variance =       0.278838206185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720984686539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925436856025       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.606760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5948e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.220096
====================================================
  Execution time = 2.7122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8284e-01
  Total weights = 1.9664e+06
  Execution time = 2.3006e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371009682
  error estimate for blocks of size 2^( 2) =       0.000385492444
  error estimate for blocks of size 2^( 3) =       0.000399247838
  error estimate for blocks of size 2^( 4) =       0.000408749176
  error estimate for blocks of size 2^( 5) =       0.000413873904
  error estimate for blocks of size 2^( 6) =       0.000416505972
  error estimate for blocks of size 2^( 7) =       0.000419134756

      target function =      -0.940110034799
              le_mean =     -17.209839736978
             les_mean =     296.461423041745
             stat err =       0.000414565952
             autocorr =       1.248581155759
   target nu stat err =       0.000414565952
   target dn stat err =       0.001967175224
      target stat err =       0.003379450947
              std dev =       0.524695318564
             le_variance =       0.275305177323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371009682
  error estimate for blocks of size 2^( 2) =       0.000385492444
  error estimate for blocks of size 2^( 3) =       0.000399247838
  error estimate for blocks of size 2^( 4) =       0.000408749176
  error estimate for blocks of size 2^( 5) =       0.000413873904
  error estimate for blocks of size 2^( 6) =       0.000416505972
  error estimate for blocks of size 2^( 7) =       0.000419134756

      target function =      -0.940110034799
              le_mean =     -17.209839736978
             les_mean =     296.461423041745
             stat err =       0.000414565952
             autocorr =       1.248581155756
   target nu stat err =       0.000414565952
   target dn stat err =       0.001967175224
      target stat err =       0.003379450947
              std dev =       0.524695318564
             le_variance =       0.275305177323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371009682
  error estimate for blocks of size 2^( 2) =       0.000385492444
  error estimate for blocks of size 2^( 3) =       0.000399247838
  error estimate for blocks of size 2^( 4) =       0.000408749176
  error estimate for blocks of size 2^( 5) =       0.000413873904
  error estimate for blocks of size 2^( 6) =       0.000416505972
  error estimate for blocks of size 2^( 7) =       0.000419134756

      target function =      -0.940110034799
              le_mean =     -17.209839736978
             les_mean =     296.461423041745
             stat err =       0.000414565952
             autocorr =       1.248581155756
   target nu stat err =       0.000414565952
   target dn stat err =       0.001967175224
      target stat err =       0.003379450947
              std dev =       0.524695318564
             le_variance =       0.275305177323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275344387990
                                         uncertainty =       0.001806096585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371009682
  error estimate for blocks of size 2^( 2) =       0.000385492444
  error estimate for blocks of size 2^( 3) =       0.000399247838
  error estimate for blocks of size 2^( 4) =       0.000408749176
  error estimate for blocks of size 2^( 5) =       0.000413873904
  error estimate for blocks of size 2^( 6) =       0.000416505972
  error estimate for blocks of size 2^( 7) =       0.000419134756

      target function =      -0.940110034799
              le_mean =     -17.209839736978
             les_mean =     296.461423041745
             stat err =       0.000414565952
             autocorr =       1.248581155756
   target nu stat err =       0.000414565952
   target dn stat err =       0.001967175224
      target stat err =       0.003379450947
              std dev =       0.524695318564
             le_variance =       0.275305177323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940110034799        initial  <--
     2.4414e+21     2.4414e+22             0.0000e+00        -0.940110034799
     9.7656e+21     9.7656e+22             0.0000e+00        -0.940110034799
     3.9062e+22     3.9062e+23             0.0000e+00        -0.940110034799

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7099
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1398
    reference variance = 0.251713
====================================================
  Execution time = 2.7258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0473e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8385e-01
  Total weights = 1.966516776e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3076e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275461366334
                                         uncertainty =       0.001813494933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275461366334
                                         uncertainty =       0.001813494933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371046406
  error estimate for blocks of size 2^( 2) =       0.000385128448
  error estimate for blocks of size 2^( 3) =       0.000398563679
  error estimate for blocks of size 2^( 4) =       0.000407832409
  error estimate for blocks of size 2^( 5) =       0.000414386237
  error estimate for blocks of size 2^( 6) =       0.000415353471
  error estimate for blocks of size 2^( 7) =       0.000416641275

      target function =      -0.938424175147
              le_mean =     -17.209334679135
             les_mean =     296.445052333114
             stat err =       0.000413553348
             autocorr =       1.242243186150
   target nu stat err =       0.000413553348
   target dn stat err =       0.001955312868
      target stat err =       0.003344700185
              std dev =       0.524747255779
             le_variance =       0.275359682448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720933467913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938435125347       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.608040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5575e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.237
    reference variance = 0.213426
====================================================
  Execution time = 2.7443e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8727e-01
  Total weights = 1.9666e+06
  Execution time = 2.3151e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372442700
  error estimate for blocks of size 2^( 2) =       0.000386690128
  error estimate for blocks of size 2^( 3) =       0.000399591550
  error estimate for blocks of size 2^( 4) =       0.000408682745
  error estimate for blocks of size 2^( 5) =       0.000413405864
  error estimate for blocks of size 2^( 6) =       0.000416904017
  error estimate for blocks of size 2^( 7) =       0.000418171198

      target function =      -0.932721032644
              le_mean =     -17.209981552792
             les_mean =     296.470737876909
             stat err =       0.000414290956
             autocorr =       1.237348322168
   target nu stat err =       0.000414290956
   target dn stat err =       0.002777163063
      target stat err =       0.004642061758
              std dev =       0.526721944319
             le_variance =       0.277436006627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372442700
  error estimate for blocks of size 2^( 2) =       0.000386690128
  error estimate for blocks of size 2^( 3) =       0.000399591550
  error estimate for blocks of size 2^( 4) =       0.000408682745
  error estimate for blocks of size 2^( 5) =       0.000413405864
  error estimate for blocks of size 2^( 6) =       0.000416904017
  error estimate for blocks of size 2^( 7) =       0.000418171198

      target function =      -0.932721032644
              le_mean =     -17.209981552792
             les_mean =     296.470737876909
             stat err =       0.000414290956
             autocorr =       1.237348322168
   target nu stat err =       0.000414290956
   target dn stat err =       0.002777163063
      target stat err =       0.004642061758
              std dev =       0.526721944319
             le_variance =       0.277436006627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372442700
  error estimate for blocks of size 2^( 2) =       0.000386690128
  error estimate for blocks of size 2^( 3) =       0.000399591550
  error estimate for blocks of size 2^( 4) =       0.000408682745
  error estimate for blocks of size 2^( 5) =       0.000413405864
  error estimate for blocks of size 2^( 6) =       0.000416904017
  error estimate for blocks of size 2^( 7) =       0.000418171198

      target function =      -0.932721032644
              le_mean =     -17.209981552792
             les_mean =     296.470737876909
             stat err =       0.000414290956
             autocorr =       1.237348322168
   target nu stat err =       0.000414290956
   target dn stat err =       0.002777163063
      target stat err =       0.004642061758
              std dev =       0.526721944319
             le_variance =       0.277436006627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277408066148
                                         uncertainty =       0.001758377175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372442700
  error estimate for blocks of size 2^( 2) =       0.000386690128
  error estimate for blocks of size 2^( 3) =       0.000399591550
  error estimate for blocks of size 2^( 4) =       0.000408682745
  error estimate for blocks of size 2^( 5) =       0.000413405864
  error estimate for blocks of size 2^( 6) =       0.000416904017
  error estimate for blocks of size 2^( 7) =       0.000418171198

      target function =      -0.932721032644
              le_mean =     -17.209981552792
             les_mean =     296.470737876909
             stat err =       0.000414290956
             autocorr =       1.237348322168
   target nu stat err =       0.000414290956
   target dn stat err =       0.002777163063
      target stat err =       0.004642061758
              std dev =       0.526721944319
             le_variance =       0.277436006627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932721032644        initial  <--
     2.4414e+22     2.4414e+23             0.0000e+00        -0.932721032644
     9.7656e+22     9.7656e+23             0.0000e+00        -0.932721032644
     3.9062e+23     3.9062e+24             0.0000e+00        -0.932721032644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0696
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.299118
====================================================
  Execution time = 2.7338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0488e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9166e-01
  Total weights = 1.966416895e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3469e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277755366602
                                         uncertainty =       0.001610809337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277755366602
                                         uncertainty =       0.001610809337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372674824
  error estimate for blocks of size 2^( 2) =       0.000386508194
  error estimate for blocks of size 2^( 3) =       0.000399174225
  error estimate for blocks of size 2^( 4) =       0.000409033169
  error estimate for blocks of size 2^( 5) =       0.000414599284
  error estimate for blocks of size 2^( 6) =       0.000418869250
  error estimate for blocks of size 2^( 7) =       0.000421139201

      target function =      -0.925513461627
              le_mean =     -17.208993002247
             les_mean =     296.441103881665
             stat err =       0.000415910226
             autocorr =       1.245486680351
   target nu stat err =       0.000415910226
   target dn stat err =       0.005268718713
      target stat err =       0.008577850472
              std dev =       0.527050222591
             le_variance =       0.277781937134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720899300225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925592027421       residual = 7.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.609307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5694e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2455
    reference variance = 0.289225
====================================================
  Execution time = 2.9634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8536e-01
  Total weights = 1.9665e+06
  Execution time = 2.2923e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371935574
  error estimate for blocks of size 2^( 2) =       0.000386123179
  error estimate for blocks of size 2^( 3) =       0.000399043501
  error estimate for blocks of size 2^( 4) =       0.000408903299
  error estimate for blocks of size 2^( 5) =       0.000415237198
  error estimate for blocks of size 2^( 6) =       0.000417623016
  error estimate for blocks of size 2^( 7) =       0.000419425654

      target function =      -0.935903760794
              le_mean =     -17.209513409935
             les_mean =     296.452716056865
             stat err =       0.000415297292
             autocorr =       1.246759713380
   target nu stat err =       0.000415297292
   target dn stat err =       0.001984111131
      target stat err =       0.003375648055
              std dev =       0.526004748785
             le_variance =       0.276680995744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371935574
  error estimate for blocks of size 2^( 2) =       0.000386123179
  error estimate for blocks of size 2^( 3) =       0.000399043501
  error estimate for blocks of size 2^( 4) =       0.000408903299
  error estimate for blocks of size 2^( 5) =       0.000415237198
  error estimate for blocks of size 2^( 6) =       0.000417623016
  error estimate for blocks of size 2^( 7) =       0.000419425654

      target function =      -0.935903760794
              le_mean =     -17.209513409935
             les_mean =     296.452716056865
             stat err =       0.000415297292
             autocorr =       1.246759713380
   target nu stat err =       0.000415297292
   target dn stat err =       0.001984111131
      target stat err =       0.003375648055
              std dev =       0.526004748785
             le_variance =       0.276680995744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371935574
  error estimate for blocks of size 2^( 2) =       0.000386123179
  error estimate for blocks of size 2^( 3) =       0.000399043501
  error estimate for blocks of size 2^( 4) =       0.000408903299
  error estimate for blocks of size 2^( 5) =       0.000415237198
  error estimate for blocks of size 2^( 6) =       0.000417623016
  error estimate for blocks of size 2^( 7) =       0.000419425654

      target function =      -0.935903760794
              le_mean =     -17.209513409935
             les_mean =     296.452716056865
             stat err =       0.000415297292
             autocorr =       1.246759713380
   target nu stat err =       0.000415297292
   target dn stat err =       0.001984111131
      target stat err =       0.003375648055
              std dev =       0.526004748785
             le_variance =       0.276680995744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276747770677
                                         uncertainty =       0.001518119560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371935574
  error estimate for blocks of size 2^( 2) =       0.000386123179
  error estimate for blocks of size 2^( 3) =       0.000399043501
  error estimate for blocks of size 2^( 4) =       0.000408903299
  error estimate for blocks of size 2^( 5) =       0.000415237198
  error estimate for blocks of size 2^( 6) =       0.000417623016
  error estimate for blocks of size 2^( 7) =       0.000419425654

      target function =      -0.935903760794
              le_mean =     -17.209513409935
             les_mean =     296.452716056865
             stat err =       0.000415297292
             autocorr =       1.246759713380
   target nu stat err =       0.000415297292
   target dn stat err =       0.001984111131
      target stat err =       0.003375648055
              std dev =       0.526004748785
             le_variance =       0.276680995744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935903760794        initial  <--
     2.4414e+23     2.4414e+24             0.0000e+00        -0.935903760794
     9.7656e+23     9.7656e+24             0.0000e+00        -0.935903760794
     3.9062e+24     3.9062e+25             0.0000e+00        -0.935903760794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2252
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.236582
====================================================
  Execution time = 2.7574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0466e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8972e-01
  Total weights = 1.966238425e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5757e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279006943250
                                         uncertainty =       0.002446520236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279006943250
                                         uncertainty =       0.002446520236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373494318
  error estimate for blocks of size 2^( 2) =       0.000387932684
  error estimate for blocks of size 2^( 3) =       0.000401491094
  error estimate for blocks of size 2^( 4) =       0.000411133304
  error estimate for blocks of size 2^( 5) =       0.000417805951
  error estimate for blocks of size 2^( 6) =       0.000420054369
  error estimate for blocks of size 2^( 7) =       0.000423088477

      target function =      -0.928716896553
              le_mean =     -17.209288892141
             les_mean =     296.449342695124
             stat err =       0.000418020525
             autocorr =       1.252642706347
   target nu stat err =       0.000418020525
   target dn stat err =       0.003346910811
      target stat err =       0.005518974072
              std dev =       0.528209181695
             le_variance =       0.279004939627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720928889214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928748501589       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.612788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6163e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1793
    reference variance = 0.202118
====================================================
  Execution time = 2.7411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8283e-01
  Total weights = 1.9663e+06
  Execution time = 2.2929e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369424357
  error estimate for blocks of size 2^( 2) =       0.000383747459
  error estimate for blocks of size 2^( 3) =       0.000397077392
  error estimate for blocks of size 2^( 4) =       0.000406825261
  error estimate for blocks of size 2^( 5) =       0.000411937840
  error estimate for blocks of size 2^( 6) =       0.000415286887
  error estimate for blocks of size 2^( 7) =       0.000415541368

      target function =      -0.940132646209
              le_mean =     -17.209112434567
             les_mean =     296.436383201164
             stat err =       0.000412397839
             autocorr =       1.246182679241
   target nu stat err =       0.000412397839
   target dn stat err =       0.001910366573
      target stat err =       0.003281351174
              std dev =       0.522453294395
             le_variance =       0.272957444824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369424357
  error estimate for blocks of size 2^( 2) =       0.000383747459
  error estimate for blocks of size 2^( 3) =       0.000397077392
  error estimate for blocks of size 2^( 4) =       0.000406825261
  error estimate for blocks of size 2^( 5) =       0.000411937840
  error estimate for blocks of size 2^( 6) =       0.000415286887
  error estimate for blocks of size 2^( 7) =       0.000415541368

      target function =      -0.940132646209
              le_mean =     -17.209112434567
             les_mean =     296.436383201164
             stat err =       0.000412397839
             autocorr =       1.246182679245
   target nu stat err =       0.000412397839
   target dn stat err =       0.001910366573
      target stat err =       0.003281351174
              std dev =       0.522453294395
             le_variance =       0.272957444824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369424357
  error estimate for blocks of size 2^( 2) =       0.000383747459
  error estimate for blocks of size 2^( 3) =       0.000397077392
  error estimate for blocks of size 2^( 4) =       0.000406825261
  error estimate for blocks of size 2^( 5) =       0.000411937840
  error estimate for blocks of size 2^( 6) =       0.000415286887
  error estimate for blocks of size 2^( 7) =       0.000415541368

      target function =      -0.940132646209
              le_mean =     -17.209112434567
             les_mean =     296.436383201164
             stat err =       0.000412397839
             autocorr =       1.246182679245
   target nu stat err =       0.000412397839
   target dn stat err =       0.001910366573
      target stat err =       0.003281351174
              std dev =       0.522453294395
             le_variance =       0.272957444824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273019326319
                                         uncertainty =       0.001560226678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369424357
  error estimate for blocks of size 2^( 2) =       0.000383747459
  error estimate for blocks of size 2^( 3) =       0.000397077392
  error estimate for blocks of size 2^( 4) =       0.000406825261
  error estimate for blocks of size 2^( 5) =       0.000411937840
  error estimate for blocks of size 2^( 6) =       0.000415286887
  error estimate for blocks of size 2^( 7) =       0.000415541368

      target function =      -0.940132646209
              le_mean =     -17.209112434567
             les_mean =     296.436383201164
             stat err =       0.000412397839
             autocorr =       1.246182679245
   target nu stat err =       0.000412397839
   target dn stat err =       0.001910366573
      target stat err =       0.003281351174
              std dev =       0.522453294395
             le_variance =       0.272957444824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940132646209        initial  <--
     2.4414e+24     2.4414e+25             0.0000e+00        -0.940132646209
     9.7656e+24     9.7656e+25             0.0000e+00        -0.940132646209
     3.9062e+25     3.9062e+26             0.0000e+00        -0.940132646209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9859
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2953
    reference variance = 0.258209
====================================================
  Execution time = 2.7558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0461e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8636e-01
  Total weights = 1.966371160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6077e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278134109721
                                         uncertainty =       0.001613986006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278134109721
                                         uncertainty =       0.001613986006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372866490
  error estimate for blocks of size 2^( 2) =       0.000387370527
  error estimate for blocks of size 2^( 3) =       0.000401054551
  error estimate for blocks of size 2^( 4) =       0.000411043935
  error estimate for blocks of size 2^( 5) =       0.000416976389
  error estimate for blocks of size 2^( 6) =       0.000421050654
  error estimate for blocks of size 2^( 7) =       0.000423785460

      target function =      -0.934238659871
              le_mean =     -17.209934835183
             les_mean =     296.468219729651
             stat err =       0.000418214110
             autocorr =       1.258029004458
   target nu stat err =       0.000418214110
   target dn stat err =       0.001916629280
      target stat err =       0.003258853798
              std dev =       0.527321283432
             le_variance =       0.278067735961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720993483518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934249068825       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.616272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6179e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.201981
====================================================
  Execution time = 2.7450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8672e-01
  Total weights = 1.9663e+06
  Execution time = 2.2960e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372696863
  error estimate for blocks of size 2^( 2) =       0.000386994538
  error estimate for blocks of size 2^( 3) =       0.000400428566
  error estimate for blocks of size 2^( 4) =       0.000410052465
  error estimate for blocks of size 2^( 5) =       0.000416355594
  error estimate for blocks of size 2^( 6) =       0.000417863884
  error estimate for blocks of size 2^( 7) =       0.000417428964

      target function =      -0.933655770175
              le_mean =     -17.209564259381
             les_mean =     296.455818622272
             stat err =       0.000415425227
             autocorr =       1.242436657468
   target nu stat err =       0.000415425227
   target dn stat err =       0.002492558500
      target stat err =       0.004184137039
              std dev =       0.527081391428
             le_variance =       0.277814793190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372696863
  error estimate for blocks of size 2^( 2) =       0.000386994538
  error estimate for blocks of size 2^( 3) =       0.000400428566
  error estimate for blocks of size 2^( 4) =       0.000410052465
  error estimate for blocks of size 2^( 5) =       0.000416355594
  error estimate for blocks of size 2^( 6) =       0.000417863884
  error estimate for blocks of size 2^( 7) =       0.000417428964

      target function =      -0.933655770175
              le_mean =     -17.209564259381
             les_mean =     296.455818622272
             stat err =       0.000415425227
             autocorr =       1.242436657468
   target nu stat err =       0.000415425227
   target dn stat err =       0.002492558500
      target stat err =       0.004184137039
              std dev =       0.527081391428
             le_variance =       0.277814793190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372696863
  error estimate for blocks of size 2^( 2) =       0.000386994538
  error estimate for blocks of size 2^( 3) =       0.000400428566
  error estimate for blocks of size 2^( 4) =       0.000410052465
  error estimate for blocks of size 2^( 5) =       0.000416355594
  error estimate for blocks of size 2^( 6) =       0.000417863884
  error estimate for blocks of size 2^( 7) =       0.000417428964

      target function =      -0.933655770175
              le_mean =     -17.209564259381
             les_mean =     296.455818622272
             stat err =       0.000415425227
             autocorr =       1.242436657468
   target nu stat err =       0.000415425227
   target dn stat err =       0.002492558500
      target stat err =       0.004184137039
              std dev =       0.527081391428
             le_variance =       0.277814793190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831006693
                                         uncertainty =       0.001814770482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372696863
  error estimate for blocks of size 2^( 2) =       0.000386994538
  error estimate for blocks of size 2^( 3) =       0.000400428566
  error estimate for blocks of size 2^( 4) =       0.000410052465
  error estimate for blocks of size 2^( 5) =       0.000416355594
  error estimate for blocks of size 2^( 6) =       0.000417863884
  error estimate for blocks of size 2^( 7) =       0.000417428964

      target function =      -0.933655770175
              le_mean =     -17.209564259381
             les_mean =     296.455818622272
             stat err =       0.000415425227
             autocorr =       1.242436657468
   target nu stat err =       0.000415425227
   target dn stat err =       0.002492558500
      target stat err =       0.004184137039
              std dev =       0.527081391428
             le_variance =       0.277814793190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933655770175        initial  <--
     2.4414e+25     2.4414e+26             0.0000e+00        -0.933655770175
     9.7656e+25     9.7656e+26             0.0000e+00        -0.933655770175
     3.9062e+26     3.9062e+27             0.0000e+00        -0.933655770175

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0435
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.381353
====================================================
  Execution time = 2.7410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8550e-01
  Total weights = 1.966521921e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5020e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275860188337
                                         uncertainty =       0.001622223103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275860188337
                                         uncertainty =       0.001622223103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371349597
  error estimate for blocks of size 2^( 2) =       0.000385503147
  error estimate for blocks of size 2^( 3) =       0.000399051026
  error estimate for blocks of size 2^( 4) =       0.000408410007
  error estimate for blocks of size 2^( 5) =       0.000414265867
  error estimate for blocks of size 2^( 6) =       0.000416888445
  error estimate for blocks of size 2^( 7) =       0.000419863978

      target function =      -0.935695192435
              le_mean =     -17.208909457418
             les_mean =     296.432060173150
             stat err =       0.000414857074
             autocorr =       1.248047420694
   target nu stat err =       0.000414857074
   target dn stat err =       0.002274984528
      target stat err =       0.003842176892
              std dev =       0.525176038879
             le_variance =       0.275809871812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720890945742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935710037690       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935710037690       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935710037687       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+26 is 5.111423e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935710037690       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935710037690       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935710037695       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+26 is 1.277856e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935710037690       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935710037690       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935710037680       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+27 is 3.194640e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.621317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5926e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.199207
====================================================
  Execution time = 2.7571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9154e-01
  Total weights = 1.9665e+06
  Execution time = 2.3008e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373885731
  error estimate for blocks of size 2^( 2) =       0.000388205546
  error estimate for blocks of size 2^( 3) =       0.000401300280
  error estimate for blocks of size 2^( 4) =       0.000411118128
  error estimate for blocks of size 2^( 5) =       0.000417840643
  error estimate for blocks of size 2^( 6) =       0.000420258518
  error estimate for blocks of size 2^( 7) =       0.000422557455

      target function =      -0.925732753589
              le_mean =     -17.209924206448
             les_mean =     296.473029936931
             stat err =       0.000417943686
             autocorr =       1.249561846059
   target nu stat err =       0.000417943686
   target dn stat err =       0.002948452033
      target stat err =       0.004849231584
              std dev =       0.528762730863
             le_variance =       0.279590025550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373885731
  error estimate for blocks of size 2^( 2) =       0.000388205546
  error estimate for blocks of size 2^( 3) =       0.000401300280
  error estimate for blocks of size 2^( 4) =       0.000411118128
  error estimate for blocks of size 2^( 5) =       0.000417840643
  error estimate for blocks of size 2^( 6) =       0.000420258518
  error estimate for blocks of size 2^( 7) =       0.000422557455

      target function =      -0.925732753589
              le_mean =     -17.209924206448
             les_mean =     296.473029936931
             stat err =       0.000417943686
             autocorr =       1.249561846059
   target nu stat err =       0.000417943686
   target dn stat err =       0.002948452033
      target stat err =       0.004849231584
              std dev =       0.528762730863
             le_variance =       0.279590025550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373885731
  error estimate for blocks of size 2^( 2) =       0.000388205546
  error estimate for blocks of size 2^( 3) =       0.000401300280
  error estimate for blocks of size 2^( 4) =       0.000411118128
  error estimate for blocks of size 2^( 5) =       0.000417840643
  error estimate for blocks of size 2^( 6) =       0.000420258518
  error estimate for blocks of size 2^( 7) =       0.000422557455

      target function =      -0.925732753589
              le_mean =     -17.209924206448
             les_mean =     296.473029936931
             stat err =       0.000417943686
             autocorr =       1.249561846059
   target nu stat err =       0.000417943686
   target dn stat err =       0.002948452033
      target stat err =       0.004849231584
              std dev =       0.528762730863
             le_variance =       0.279590025550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279585573733
                                         uncertainty =       0.001894560567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373885731
  error estimate for blocks of size 2^( 2) =       0.000388205546
  error estimate for blocks of size 2^( 3) =       0.000401300280
  error estimate for blocks of size 2^( 4) =       0.000411118128
  error estimate for blocks of size 2^( 5) =       0.000417840643
  error estimate for blocks of size 2^( 6) =       0.000420258518
  error estimate for blocks of size 2^( 7) =       0.000422557455

      target function =      -0.925732753589
              le_mean =     -17.209924206448
             les_mean =     296.473029936931
             stat err =       0.000417943686
             autocorr =       1.249561846059
   target nu stat err =       0.000417943686
   target dn stat err =       0.002948452033
      target stat err =       0.004849231584
              std dev =       0.528762730863
             le_variance =       0.279590025550


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925732753589        initial  <--
     2.4414e+26     2.4414e+27             5.1114e-31        -0.925732753589
     9.7656e+26     9.7656e+27             1.2779e-31        -0.925732753589
     3.9062e+27     3.9062e+28             3.1946e-32        -0.925732753589

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1920
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.3006
    reference variance = 0.617636
====================================================
  Execution time = 2.7395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8964e-01
  Total weights = 1.966429686e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3559e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274516344030
                                         uncertainty =       0.001519974189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274516344030
                                         uncertainty =       0.001519974189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370431345
  error estimate for blocks of size 2^( 2) =       0.000384524001
  error estimate for blocks of size 2^( 3) =       0.000397800729
  error estimate for blocks of size 2^( 4) =       0.000407466518
  error estimate for blocks of size 2^( 5) =       0.000413136594
  error estimate for blocks of size 2^( 6) =       0.000415860330
  error estimate for blocks of size 2^( 7) =       0.000417717269

      target function =      -0.928814699705
              le_mean =     -17.209299144585
             les_mean =     296.449618319846
             stat err =       0.000413545178
             autocorr =       1.246322581505
   target nu stat err =       0.000413545178
   target dn stat err =       0.004588472557
      target stat err =       0.007535953511
              std dev =       0.523877414452
             le_variance =       0.274447545373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720929914458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928874414088       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.624831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5764e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.3345
    reference variance = 0.508591
====================================================
  Execution time = 2.9969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9123e-01
  Total weights = 1.9665e+06
  Execution time = 2.2937e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373392584
  error estimate for blocks of size 2^( 2) =       0.000387284825
  error estimate for blocks of size 2^( 3) =       0.000400166590
  error estimate for blocks of size 2^( 4) =       0.000409686439
  error estimate for blocks of size 2^( 5) =       0.000415433049
  error estimate for blocks of size 2^( 6) =       0.000418490012
  error estimate for blocks of size 2^( 7) =       0.000421160434

      target function =      -0.926252315197
              le_mean =     -17.209478713820
             les_mean =     296.457382774463
             stat err =       0.000416192484
             autocorr =       1.242387543836
   target nu stat err =       0.000416192484
   target dn stat err =       0.003410496259
      target stat err =       0.005594035526
              std dev =       0.528065305709
             le_variance =       0.278852967094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373392584
  error estimate for blocks of size 2^( 2) =       0.000387284825
  error estimate for blocks of size 2^( 3) =       0.000400166590
  error estimate for blocks of size 2^( 4) =       0.000409686439
  error estimate for blocks of size 2^( 5) =       0.000415433049
  error estimate for blocks of size 2^( 6) =       0.000418490012
  error estimate for blocks of size 2^( 7) =       0.000421160434

      target function =      -0.926252315197
              le_mean =     -17.209478713820
             les_mean =     296.457382774463
             stat err =       0.000416192484
             autocorr =       1.242387543836
   target nu stat err =       0.000416192484
   target dn stat err =       0.003410496259
      target stat err =       0.005594035526
              std dev =       0.528065305709
             le_variance =       0.278852967094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373392584
  error estimate for blocks of size 2^( 2) =       0.000387284825
  error estimate for blocks of size 2^( 3) =       0.000400166590
  error estimate for blocks of size 2^( 4) =       0.000409686439
  error estimate for blocks of size 2^( 5) =       0.000415433049
  error estimate for blocks of size 2^( 6) =       0.000418490012
  error estimate for blocks of size 2^( 7) =       0.000421160434

      target function =      -0.926252315197
              le_mean =     -17.209478713820
             les_mean =     296.457382774463
             stat err =       0.000416192484
             autocorr =       1.242387543836
   target nu stat err =       0.000416192484
   target dn stat err =       0.003410496259
      target stat err =       0.005594035526
              std dev =       0.528065305709
             le_variance =       0.278852967094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278881761321
                                         uncertainty =       0.001932238935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373392584
  error estimate for blocks of size 2^( 2) =       0.000387284825
  error estimate for blocks of size 2^( 3) =       0.000400166590
  error estimate for blocks of size 2^( 4) =       0.000409686439
  error estimate for blocks of size 2^( 5) =       0.000415433049
  error estimate for blocks of size 2^( 6) =       0.000418490012
  error estimate for blocks of size 2^( 7) =       0.000421160434

      target function =      -0.926252315197
              le_mean =     -17.209478713820
             les_mean =     296.457382774463
             stat err =       0.000416192484
             autocorr =       1.242387543836
   target nu stat err =       0.000416192484
   target dn stat err =       0.003410496259
      target stat err =       0.005594035526
              std dev =       0.528065305709
             le_variance =       0.278852967094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926252315197        initial  <--
     2.4414e+27     2.4414e+28             0.0000e+00        -0.926252315197
     9.7656e+27     9.7656e+28             0.0000e+00        -0.926252315197
     3.9062e+28     3.9062e+29             0.0000e+00        -0.926252315197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.5361
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2199
    reference variance = 0.286724
====================================================
  Execution time = 2.7471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8957e-01
  Total weights = 1.966730209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2974e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278736954898
                                         uncertainty =       0.002036008006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278736954898
                                         uncertainty =       0.002036008006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373257899
  error estimate for blocks of size 2^( 2) =       0.000387315787
  error estimate for blocks of size 2^( 3) =       0.000399962022
  error estimate for blocks of size 2^( 4) =       0.000409707724
  error estimate for blocks of size 2^( 5) =       0.000415718861
  error estimate for blocks of size 2^( 6) =       0.000418685204
  error estimate for blocks of size 2^( 7) =       0.000420560578

      target function =      -0.928947981570
              le_mean =     -17.209907580195
             les_mean =     296.470486025826
             stat err =       0.000416168092
             autocorr =       1.243138576447
   target nu stat err =       0.000416168092
   target dn stat err =       0.003048463212
      target stat err =       0.005043891831
              std dev =       0.527874829281
             le_variance =       0.278651835388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720990758020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928974277978       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.628272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5781e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.193441
====================================================
  Execution time = 2.7278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8366e-01
  Total weights = 1.9665e+06
  Execution time = 2.2978e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370833724
  error estimate for blocks of size 2^( 2) =       0.000385096996
  error estimate for blocks of size 2^( 3) =       0.000398677441
  error estimate for blocks of size 2^( 4) =       0.000408202365
  error estimate for blocks of size 2^( 5) =       0.000413083250
  error estimate for blocks of size 2^( 6) =       0.000416983459
  error estimate for blocks of size 2^( 7) =       0.000420334259

      target function =      -0.938738851315
              le_mean =     -17.209828366186
             les_mean =     296.461849920281
             stat err =       0.000414650833
             autocorr =       1.250278142434
   target nu stat err =       0.000414650833
   target dn stat err =       0.002120678898
      target stat err =       0.003620571509
              std dev =       0.524446473135
             le_variance =       0.275044103184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370833724
  error estimate for blocks of size 2^( 2) =       0.000385096996
  error estimate for blocks of size 2^( 3) =       0.000398677441
  error estimate for blocks of size 2^( 4) =       0.000408202365
  error estimate for blocks of size 2^( 5) =       0.000413083250
  error estimate for blocks of size 2^( 6) =       0.000416983459
  error estimate for blocks of size 2^( 7) =       0.000420334259

      target function =      -0.938738851315
              le_mean =     -17.209828366186
             les_mean =     296.461849920281
             stat err =       0.000414650833
             autocorr =       1.250278142434
   target nu stat err =       0.000414650833
   target dn stat err =       0.002120678898
      target stat err =       0.003620571509
              std dev =       0.524446473135
             le_variance =       0.275044103184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370833724
  error estimate for blocks of size 2^( 2) =       0.000385096996
  error estimate for blocks of size 2^( 3) =       0.000398677441
  error estimate for blocks of size 2^( 4) =       0.000408202365
  error estimate for blocks of size 2^( 5) =       0.000413083250
  error estimate for blocks of size 2^( 6) =       0.000416983459
  error estimate for blocks of size 2^( 7) =       0.000420334259

      target function =      -0.938738851315
              le_mean =     -17.209828366186
             les_mean =     296.461849920281
             stat err =       0.000414650833
             autocorr =       1.250278142434
   target nu stat err =       0.000414650833
   target dn stat err =       0.002120678898
      target stat err =       0.003620571509
              std dev =       0.524446473135
             le_variance =       0.275044103184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275046297123
                                         uncertainty =       0.001597530510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370833724
  error estimate for blocks of size 2^( 2) =       0.000385096996
  error estimate for blocks of size 2^( 3) =       0.000398677441
  error estimate for blocks of size 2^( 4) =       0.000408202365
  error estimate for blocks of size 2^( 5) =       0.000413083250
  error estimate for blocks of size 2^( 6) =       0.000416983459
  error estimate for blocks of size 2^( 7) =       0.000420334259

      target function =      -0.938738851315
              le_mean =     -17.209828366186
             les_mean =     296.461849920281
             stat err =       0.000414650833
             autocorr =       1.250278142434
   target nu stat err =       0.000414650833
   target dn stat err =       0.002120678898
      target stat err =       0.003620571509
              std dev =       0.524446473135
             le_variance =       0.275044103184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938738851315        initial  <--
     2.4414e+28     2.4414e+29             0.0000e+00        -0.938738851315
     9.7656e+28     9.7656e+29             0.0000e+00        -0.938738851315
     3.9062e+29     3.9062e+30             0.0000e+00        -0.938738851315

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8821
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.839578
====================================================
  Execution time = 2.7541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9186e-01
  Total weights = 1.966202703e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3698e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277640618696
                                         uncertainty =       0.001902105087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277640618696
                                         uncertainty =       0.001902105087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372568935
  error estimate for blocks of size 2^( 2) =       0.000386483278
  error estimate for blocks of size 2^( 3) =       0.000400147900
  error estimate for blocks of size 2^( 4) =       0.000409636414
  error estimate for blocks of size 2^( 5) =       0.000415132134
  error estimate for blocks of size 2^( 6) =       0.000417445335
  error estimate for blocks of size 2^( 7) =       0.000420814397

      target function =      -0.925191670781
              le_mean =     -17.209184497882
             les_mean =     296.447890924499
             stat err =       0.000415757070
             autocorr =       1.245277111162
   target nu stat err =       0.000415757070
   target dn stat err =       0.005143252996
      target stat err =       0.008372252806
              std dev =       0.526900471136
             le_variance =       0.277624106483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720918449788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925266282351       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.631714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5924e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.164205
====================================================
  Execution time = 2.7379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8529e-01
  Total weights = 1.9664e+06
  Execution time = 2.2964e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370733027
  error estimate for blocks of size 2^( 2) =       0.000384983883
  error estimate for blocks of size 2^( 3) =       0.000398258677
  error estimate for blocks of size 2^( 4) =       0.000407353963
  error estimate for blocks of size 2^( 5) =       0.000413008241
  error estimate for blocks of size 2^( 6) =       0.000414764534
  error estimate for blocks of size 2^( 7) =       0.000416986192

      target function =      -0.936013766412
              le_mean =     -17.209590214692
             les_mean =     296.455288353325
             stat err =       0.000413028233
             autocorr =       1.241186157537
   target nu stat err =       0.000413028233
   target dn stat err =       0.002475138991
      target stat err =       0.004175947464
              std dev =       0.524304063670
             le_variance =       0.274894751181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370733027
  error estimate for blocks of size 2^( 2) =       0.000384983883
  error estimate for blocks of size 2^( 3) =       0.000398258677
  error estimate for blocks of size 2^( 4) =       0.000407353963
  error estimate for blocks of size 2^( 5) =       0.000413008241
  error estimate for blocks of size 2^( 6) =       0.000414764534
  error estimate for blocks of size 2^( 7) =       0.000416986192

      target function =      -0.936013766412
              le_mean =     -17.209590214692
             les_mean =     296.455288353325
             stat err =       0.000413028233
             autocorr =       1.241186157537
   target nu stat err =       0.000413028233
   target dn stat err =       0.002475138991
      target stat err =       0.004175947464
              std dev =       0.524304063670
             le_variance =       0.274894751181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370733027
  error estimate for blocks of size 2^( 2) =       0.000384983883
  error estimate for blocks of size 2^( 3) =       0.000398258677
  error estimate for blocks of size 2^( 4) =       0.000407353963
  error estimate for blocks of size 2^( 5) =       0.000413008241
  error estimate for blocks of size 2^( 6) =       0.000414764534
  error estimate for blocks of size 2^( 7) =       0.000416986192

      target function =      -0.936013766412
              le_mean =     -17.209590214692
             les_mean =     296.455288353325
             stat err =       0.000413028233
             autocorr =       1.241186157537
   target nu stat err =       0.000413028233
   target dn stat err =       0.002475138991
      target stat err =       0.004175947464
              std dev =       0.524304063670
             le_variance =       0.274894751181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274923826188
                                         uncertainty =       0.001621822419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370733027
  error estimate for blocks of size 2^( 2) =       0.000384983883
  error estimate for blocks of size 2^( 3) =       0.000398258677
  error estimate for blocks of size 2^( 4) =       0.000407353963
  error estimate for blocks of size 2^( 5) =       0.000413008241
  error estimate for blocks of size 2^( 6) =       0.000414764534
  error estimate for blocks of size 2^( 7) =       0.000416986192

      target function =      -0.936013766412
              le_mean =     -17.209590214692
             les_mean =     296.455288353325
             stat err =       0.000413028233
             autocorr =       1.241186157537
   target nu stat err =       0.000413028233
   target dn stat err =       0.002475138991
      target stat err =       0.004175947464
              std dev =       0.524304063670
             le_variance =       0.274894751181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936013766412        initial  <--
     2.4414e+29     2.4414e+30             0.0000e+00        -0.936013766412
     9.7656e+29     9.7656e+30             0.0000e+00        -0.936013766412
     3.9062e+30     3.9062e+31             0.0000e+00        -0.936013766412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9767
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4917e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2717
    reference variance = 0.20511
====================================================
  Execution time = 2.7779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8799e-01
  Total weights = 1.966413602e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5269e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275441575504
                                         uncertainty =       0.001802540636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275441575504
                                         uncertainty =       0.001802540636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102104
  error estimate for blocks of size 2^( 2) =       0.000385469183
  error estimate for blocks of size 2^( 3) =       0.000398603224
  error estimate for blocks of size 2^( 4) =       0.000407881246
  error estimate for blocks of size 2^( 5) =       0.000413665484
  error estimate for blocks of size 2^( 6) =       0.000417268603
  error estimate for blocks of size 2^( 7) =       0.000418491857

      target function =      -0.931556763405
              le_mean =     -17.209214843688
             les_mean =     296.445061455381
             stat err =       0.000414326798
             autocorr =       1.246519890064
   target nu stat err =       0.000414326798
   target dn stat err =       0.003453210091
      target stat err =       0.005724135481
              std dev =       0.524826025965
             le_variance =       0.275442357530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720921484369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+30, overlap shift 2.4414e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+30, overlap shift 9.7656e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+31, overlap shift 3.9062e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931590952051       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.635123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6319e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.264027
====================================================
  Execution time = 2.7582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8675e-01
  Total weights = 1.9665e+06
  Execution time = 2.2981e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372097781
  error estimate for blocks of size 2^( 2) =       0.000386134246
  error estimate for blocks of size 2^( 3) =       0.000399218397
  error estimate for blocks of size 2^( 4) =       0.000408739810
  error estimate for blocks of size 2^( 5) =       0.000414543591
  error estimate for blocks of size 2^( 6) =       0.000416217426
  error estimate for blocks of size 2^( 7) =       0.000418700381

      target function =      -0.933600832029
              le_mean =     -17.209901602662
             les_mean =     296.467459789748
             stat err =       0.000414550302
             autocorr =       1.241195843244
   target nu stat err =       0.000414550302
   target dn stat err =       0.002220906804
      target stat err =       0.003744685910
              std dev =       0.526234147464
             le_variance =       0.276922377957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372097781
  error estimate for blocks of size 2^( 2) =       0.000386134246
  error estimate for blocks of size 2^( 3) =       0.000399218397
  error estimate for blocks of size 2^( 4) =       0.000408739810
  error estimate for blocks of size 2^( 5) =       0.000414543591
  error estimate for blocks of size 2^( 6) =       0.000416217426
  error estimate for blocks of size 2^( 7) =       0.000418700381

      target function =      -0.933600832029
              le_mean =     -17.209901602662
             les_mean =     296.467459789748
             stat err =       0.000414550302
             autocorr =       1.241195843244
   target nu stat err =       0.000414550302
   target dn stat err =       0.002220906804
      target stat err =       0.003744685910
              std dev =       0.526234147464
             le_variance =       0.276922377957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372097781
  error estimate for blocks of size 2^( 2) =       0.000386134246
  error estimate for blocks of size 2^( 3) =       0.000399218397
  error estimate for blocks of size 2^( 4) =       0.000408739810
  error estimate for blocks of size 2^( 5) =       0.000414543591
  error estimate for blocks of size 2^( 6) =       0.000416217426
  error estimate for blocks of size 2^( 7) =       0.000418700381

      target function =      -0.933600832029
              le_mean =     -17.209901602662
             les_mean =     296.467459789748
             stat err =       0.000414550302
             autocorr =       1.241195843244
   target nu stat err =       0.000414550302
   target dn stat err =       0.002220906804
      target stat err =       0.003744685910
              std dev =       0.526234147464
             le_variance =       0.276922377957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276937187197
                                         uncertainty =       0.001675849078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372097781
  error estimate for blocks of size 2^( 2) =       0.000386134246
  error estimate for blocks of size 2^( 3) =       0.000399218397
  error estimate for blocks of size 2^( 4) =       0.000408739810
  error estimate for blocks of size 2^( 5) =       0.000414543591
  error estimate for blocks of size 2^( 6) =       0.000416217426
  error estimate for blocks of size 2^( 7) =       0.000418700381

      target function =      -0.933600832029
              le_mean =     -17.209901602662
             les_mean =     296.467459789748
             stat err =       0.000414550302
             autocorr =       1.241195843244
   target nu stat err =       0.000414550302
   target dn stat err =       0.002220906804
      target stat err =       0.003744685910
              std dev =       0.526234147464
             le_variance =       0.276922377957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933600832029        initial  <--
     2.4414e+30     2.4414e+31             0.0000e+00        -0.933600832029
     9.7656e+30     9.7656e+31             0.0000e+00        -0.933600832029
     3.9062e+31     3.9062e+32             0.0000e+00        -0.933600832029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1784
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2808
    reference variance = 0.139415
====================================================
  Execution time = 2.7523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8700e-01
  Total weights = 1.966440962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4298e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279544877965
                                         uncertainty =       0.002734246562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279544877965
                                         uncertainty =       0.002734246562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373797618
  error estimate for blocks of size 2^( 2) =       0.000388349260
  error estimate for blocks of size 2^( 3) =       0.000401211570
  error estimate for blocks of size 2^( 4) =       0.000411327165
  error estimate for blocks of size 2^( 5) =       0.000416413098
  error estimate for blocks of size 2^( 6) =       0.000419057909
  error estimate for blocks of size 2^( 7) =       0.000420955592

      target function =      -0.933158572609
              le_mean =     -17.209983781940
             les_mean =     296.470545611438
             stat err =       0.000416938441
             autocorr =       1.244144478985
   target nu stat err =       0.000416938441
   target dn stat err =       0.003144848131
      target stat err =       0.005247786524
              std dev =       0.528638119233
             le_variance =       0.279458261106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720998378194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+31, overlap shift 2.4414e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933187297719       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933187297719       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933187297719       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933187297719       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+31 is 3.627784e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+31, overlap shift 9.7656e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933187297719       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933187297719       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933187297719       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933187297719       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+31 is 9.069460e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+32, overlap shift 3.9062e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933187297719       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933187297719       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933187297719       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933187297719       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+32 is 2.267365e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.637116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5962e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2337
    reference variance = 0.179911
====================================================
  Execution time = 2.9685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8561e-01
  Total weights = 1.9666e+06
  Execution time = 2.2993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372444584
  error estimate for blocks of size 2^( 2) =       0.000386821447
  error estimate for blocks of size 2^( 3) =       0.000400423200
  error estimate for blocks of size 2^( 4) =       0.000410374692
  error estimate for blocks of size 2^( 5) =       0.000415711149
  error estimate for blocks of size 2^( 6) =       0.000418726348
  error estimate for blocks of size 2^( 7) =       0.000420427320

      target function =      -0.935477750031
              le_mean =     -17.209809236127
             les_mean =     296.463147439878
             stat err =       0.000416309877
             autocorr =       1.249424747404
   target nu stat err =       0.000416309877
   target dn stat err =       0.002419608188
      target stat err =       0.004083313255
              std dev =       0.526724609193
             le_variance =       0.277438813930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372444584
  error estimate for blocks of size 2^( 2) =       0.000386821447
  error estimate for blocks of size 2^( 3) =       0.000400423200
  error estimate for blocks of size 2^( 4) =       0.000410374692
  error estimate for blocks of size 2^( 5) =       0.000415711149
  error estimate for blocks of size 2^( 6) =       0.000418726348
  error estimate for blocks of size 2^( 7) =       0.000420427320

      target function =      -0.935477750031
              le_mean =     -17.209809236127
             les_mean =     296.463147439878
             stat err =       0.000416309877
             autocorr =       1.249424747398
   target nu stat err =       0.000416309877
   target dn stat err =       0.002419608188
      target stat err =       0.004083313255
              std dev =       0.526724609193
             le_variance =       0.277438813930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372444584
  error estimate for blocks of size 2^( 2) =       0.000386821447
  error estimate for blocks of size 2^( 3) =       0.000400423200
  error estimate for blocks of size 2^( 4) =       0.000410374692
  error estimate for blocks of size 2^( 5) =       0.000415711149
  error estimate for blocks of size 2^( 6) =       0.000418726348
  error estimate for blocks of size 2^( 7) =       0.000420427320

      target function =      -0.935477750031
              le_mean =     -17.209809236127
             les_mean =     296.463147439878
             stat err =       0.000416309877
             autocorr =       1.249424747398
   target nu stat err =       0.000416309877
   target dn stat err =       0.002419608188
      target stat err =       0.004083313255
              std dev =       0.526724609193
             le_variance =       0.277438813930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277421675946
                                         uncertainty =       0.001616576110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372444584
  error estimate for blocks of size 2^( 2) =       0.000386821447
  error estimate for blocks of size 2^( 3) =       0.000400423200
  error estimate for blocks of size 2^( 4) =       0.000410374692
  error estimate for blocks of size 2^( 5) =       0.000415711149
  error estimate for blocks of size 2^( 6) =       0.000418726348
  error estimate for blocks of size 2^( 7) =       0.000420427320

      target function =      -0.935477750031
              le_mean =     -17.209809236127
             les_mean =     296.463147439878
             stat err =       0.000416309877
             autocorr =       1.249424747398
   target nu stat err =       0.000416309877
   target dn stat err =       0.002419608188
      target stat err =       0.004083313255
              std dev =       0.526724609193
             le_variance =       0.277438813930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935477750031        initial  <--
     2.4414e+31     2.4414e+32             3.6278e-36        -0.935477750031
     9.7656e+31     9.7656e+32             9.0695e-37        -0.935477750031
     3.9062e+32     3.9062e+33             2.2674e-37        -0.935477750031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2811
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.19766
====================================================
  Execution time = 2.7515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9219e-01
  Total weights = 1.966251929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5287e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279843129429
                                         uncertainty =       0.002017116509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279843129429
                                         uncertainty =       0.002017116509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374036133
  error estimate for blocks of size 2^( 2) =       0.000388507911
  error estimate for blocks of size 2^( 3) =       0.000401655785
  error estimate for blocks of size 2^( 4) =       0.000411463184
  error estimate for blocks of size 2^( 5) =       0.000417875617
  error estimate for blocks of size 2^( 6) =       0.000421793988
  error estimate for blocks of size 2^( 7) =       0.000424162137

      target function =      -0.924624932197
              le_mean =     -17.210542677431
             les_mean =     296.494964941044
             stat err =       0.000418823732
             autocorr =       1.253820735270
   target nu stat err =       0.000418823732
   target dn stat err =       0.004373538526
      target stat err =       0.007139695683
              std dev =       0.528975435186
             le_variance =       0.279815011030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721054267743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+32, overlap shift 2.4414e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924678669937       residual = 8.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924678669937       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924678669937       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924678669937       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924678669937       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+32 is 6.938386e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+32, overlap shift 9.7656e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924678669937       residual = 8.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924678669937       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924678669937       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924678669937       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924678669937       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -7.797445143864       residual = 2.84e+15           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+32 is 1.734596e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+33, overlap shift 3.9062e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924678669937       residual = 8.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924678669937       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924678669937       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924678669937       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924678669937       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+33 is 4.336491e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.639662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6054e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.156083
====================================================
  Execution time = 2.7719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8223e-01
  Total weights = 1.9663e+06
  Execution time = 2.3011e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370881497
  error estimate for blocks of size 2^( 2) =       0.000385265990
  error estimate for blocks of size 2^( 3) =       0.000398717029
  error estimate for blocks of size 2^( 4) =       0.000408233609
  error estimate for blocks of size 2^( 5) =       0.000413085828
  error estimate for blocks of size 2^( 6) =       0.000417339225
  error estimate for blocks of size 2^( 7) =       0.000420390912

      target function =      -0.941136558250
              le_mean =     -17.209967354328
             les_mean =     296.465203598168
             stat err =       0.000414762394
             autocorr =       1.250628756883
   target nu stat err =       0.000414762394
   target dn stat err =       0.001858734479
      target stat err =       0.003209983069
              std dev =       0.524514034551
             le_variance =       0.275114972441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370881497
  error estimate for blocks of size 2^( 2) =       0.000385265990
  error estimate for blocks of size 2^( 3) =       0.000398717029
  error estimate for blocks of size 2^( 4) =       0.000408233609
  error estimate for blocks of size 2^( 5) =       0.000413085828
  error estimate for blocks of size 2^( 6) =       0.000417339225
  error estimate for blocks of size 2^( 7) =       0.000420390912

      target function =      -0.941136558250
              le_mean =     -17.209967354328
             les_mean =     296.465203598168
             stat err =       0.000414762394
             autocorr =       1.250628756883
   target nu stat err =       0.000414762394
   target dn stat err =       0.001858734479
      target stat err =       0.003209983069
              std dev =       0.524514034551
             le_variance =       0.275114972441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370881497
  error estimate for blocks of size 2^( 2) =       0.000385265990
  error estimate for blocks of size 2^( 3) =       0.000398717029
  error estimate for blocks of size 2^( 4) =       0.000408233609
  error estimate for blocks of size 2^( 5) =       0.000413085828
  error estimate for blocks of size 2^( 6) =       0.000417339225
  error estimate for blocks of size 2^( 7) =       0.000420390912

      target function =      -0.941136558250
              le_mean =     -17.209967354328
             les_mean =     296.465203598168
             stat err =       0.000414762394
             autocorr =       1.250628756883
   target nu stat err =       0.000414762394
   target dn stat err =       0.001858734479
      target stat err =       0.003209983069
              std dev =       0.524514034551
             le_variance =       0.275114972441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275090238561
                                         uncertainty =       0.001427288942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370881497
  error estimate for blocks of size 2^( 2) =       0.000385265990
  error estimate for blocks of size 2^( 3) =       0.000398717029
  error estimate for blocks of size 2^( 4) =       0.000408233609
  error estimate for blocks of size 2^( 5) =       0.000413085828
  error estimate for blocks of size 2^( 6) =       0.000417339225
  error estimate for blocks of size 2^( 7) =       0.000420390912

      target function =      -0.941136558250
              le_mean =     -17.209967354328
             les_mean =     296.465203598168
             stat err =       0.000414762394
             autocorr =       1.250628756883
   target nu stat err =       0.000414762394
   target dn stat err =       0.001858734479
      target stat err =       0.003209983069
              std dev =       0.524514034551
             le_variance =       0.275114972441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941136558250        initial  <--
     2.4414e+32     2.4414e+33             6.9384e-37        -0.941136558250
     9.7656e+32     9.7656e+33             1.7346e-37        -0.941136558250
     3.9062e+33     3.9062e+34             4.3365e-38        -0.941136558250

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2988
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2732
    reference variance = 0.211798
====================================================
  Execution time = 2.7600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8675e-01
  Total weights = 1.966203371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4395e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278143101591
                                         uncertainty =       0.001952351485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278143101591
                                         uncertainty =       0.001952351485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372926340
  error estimate for blocks of size 2^( 2) =       0.000387361161
  error estimate for blocks of size 2^( 3) =       0.000400664721
  error estimate for blocks of size 2^( 4) =       0.000410856557
  error estimate for blocks of size 2^( 5) =       0.000415408151
  error estimate for blocks of size 2^( 6) =       0.000418175092
  error estimate for blocks of size 2^( 7) =       0.000419031996

      target function =      -0.933597844048
              le_mean =     -17.209559382360
             les_mean =     296.455686172819
             stat err =       0.000415867949
             autocorr =       1.243554383026
   target nu stat err =       0.000415867949
   target dn stat err =       0.002451094136
      target stat err =       0.004116297176
              std dev =       0.527405926580
             le_variance =       0.278157011392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720955938236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+33, overlap shift 2.4414e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933615069643       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933615069643       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933615069643       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933615058661       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933615207672       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+33 is 3.733975e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+33, overlap shift 9.7656e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933615069643       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933615069643       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933615069643       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933615088463       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933616638184       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.07e+18           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+33 is 9.334937e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+34, overlap shift 3.9062e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933615069643       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933615069643       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933615069643       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933615088463       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933616638184       residual = 2.07e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+34 is 2.333734e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.642199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6050e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1816
    reference variance = 0.204969
====================================================
  Execution time = 2.7457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8368e-01
  Total weights = 1.9664e+06
  Execution time = 2.3064e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370204272
  error estimate for blocks of size 2^( 2) =       0.000385149696
  error estimate for blocks of size 2^( 3) =       0.000398416942
  error estimate for blocks of size 2^( 4) =       0.000407833321
  error estimate for blocks of size 2^( 5) =       0.000413333582
  error estimate for blocks of size 2^( 6) =       0.000416571725
  error estimate for blocks of size 2^( 7) =       0.000420466453

      target function =      -0.938699375887
              le_mean =     -17.210025115532
             les_mean =     296.468643069606
             stat err =       0.000414551270
             autocorr =       1.253931030133
   target nu stat err =       0.000414551270
   target dn stat err =       0.002208928248
      target stat err =       0.003766155240
              std dev =       0.523556278477
             le_variance =       0.274111176732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370204272
  error estimate for blocks of size 2^( 2) =       0.000385149696
  error estimate for blocks of size 2^( 3) =       0.000398416942
  error estimate for blocks of size 2^( 4) =       0.000407833321
  error estimate for blocks of size 2^( 5) =       0.000413333582
  error estimate for blocks of size 2^( 6) =       0.000416571725
  error estimate for blocks of size 2^( 7) =       0.000420466453

      target function =      -0.938699375887
              le_mean =     -17.210025115532
             les_mean =     296.468643069606
             stat err =       0.000414551270
             autocorr =       1.253931030133
   target nu stat err =       0.000414551270
   target dn stat err =       0.002208928248
      target stat err =       0.003766155240
              std dev =       0.523556278477
             le_variance =       0.274111176732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370204272
  error estimate for blocks of size 2^( 2) =       0.000385149696
  error estimate for blocks of size 2^( 3) =       0.000398416942
  error estimate for blocks of size 2^( 4) =       0.000407833321
  error estimate for blocks of size 2^( 5) =       0.000413333582
  error estimate for blocks of size 2^( 6) =       0.000416571725
  error estimate for blocks of size 2^( 7) =       0.000420466453

      target function =      -0.938699375887
              le_mean =     -17.210025115532
             les_mean =     296.468643069606
             stat err =       0.000414551270
             autocorr =       1.253931030133
   target nu stat err =       0.000414551270
   target dn stat err =       0.002208928248
      target stat err =       0.003766155240
              std dev =       0.523556278477
             le_variance =       0.274111176732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274127908751
                                         uncertainty =       0.001532432630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370204272
  error estimate for blocks of size 2^( 2) =       0.000385149696
  error estimate for blocks of size 2^( 3) =       0.000398416942
  error estimate for blocks of size 2^( 4) =       0.000407833321
  error estimate for blocks of size 2^( 5) =       0.000413333582
  error estimate for blocks of size 2^( 6) =       0.000416571725
  error estimate for blocks of size 2^( 7) =       0.000420466453

      target function =      -0.938699375887
              le_mean =     -17.210025115532
             les_mean =     296.468643069606
             stat err =       0.000414551270
             autocorr =       1.253931030133
   target nu stat err =       0.000414551270
   target dn stat err =       0.002208928248
      target stat err =       0.003766155240
              std dev =       0.523556278477
             le_variance =       0.274111176732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938699375887        initial  <--
     2.4414e+33     2.4414e+34             3.7340e-38        -0.938699375887
     9.7656e+33     9.7656e+34             9.3349e-39        -0.938699375887
     3.9062e+34     3.9062e+35             2.3337e-39        -0.938699375887

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0909
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.279
    reference variance = 0.275263
====================================================
  Execution time = 2.7391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0465e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8199e-01
  Total weights = 1.966631621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273721866944
                                         uncertainty =       0.001554282725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273721866944
                                         uncertainty =       0.001554282725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369922774
  error estimate for blocks of size 2^( 2) =       0.000384198986
  error estimate for blocks of size 2^( 3) =       0.000397078386
  error estimate for blocks of size 2^( 4) =       0.000406547786
  error estimate for blocks of size 2^( 5) =       0.000412303081
  error estimate for blocks of size 2^( 6) =       0.000415119671
  error estimate for blocks of size 2^( 7) =       0.000418780523

      target function =      -0.941525373774
              le_mean =     -17.210237417873
             les_mean =     296.474265793544
             stat err =       0.000413187765
             autocorr =       1.247592540338
   target nu stat err =       0.000413187765
   target dn stat err =       0.001851137099
      target stat err =       0.003201123882
              std dev =       0.523158173709
             le_variance =       0.273694474719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721023741787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+34, overlap shift 2.4414e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+34, overlap shift 9.7656e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+35, overlap shift 3.9062e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941535222026       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.643508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5899e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.230473
====================================================
  Execution time = 2.7958e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8537e-01
  Total weights = 1.9665e+06
  Execution time = 2.2993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371684309
  error estimate for blocks of size 2^( 2) =       0.000385796859
  error estimate for blocks of size 2^( 3) =       0.000398701550
  error estimate for blocks of size 2^( 4) =       0.000408314004
  error estimate for blocks of size 2^( 5) =       0.000414370133
  error estimate for blocks of size 2^( 6) =       0.000417337340
  error estimate for blocks of size 2^( 7) =       0.000420134709

      target function =      -0.935876305880
              le_mean =     -17.209808950565
             les_mean =     296.462893128201
             stat err =       0.000415039047
             autocorr =       1.246893782952
   target nu stat err =       0.000415039047
   target dn stat err =       0.002897399881
      target stat err =       0.004869155490
              std dev =       0.525649400473
             le_variance =       0.276307292217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371684309
  error estimate for blocks of size 2^( 2) =       0.000385796859
  error estimate for blocks of size 2^( 3) =       0.000398701550
  error estimate for blocks of size 2^( 4) =       0.000408314004
  error estimate for blocks of size 2^( 5) =       0.000414370133
  error estimate for blocks of size 2^( 6) =       0.000417337340
  error estimate for blocks of size 2^( 7) =       0.000420134709

      target function =      -0.935876305880
              le_mean =     -17.209808950565
             les_mean =     296.462893128201
             stat err =       0.000415039047
             autocorr =       1.246893782952
   target nu stat err =       0.000415039047
   target dn stat err =       0.002897399881
      target stat err =       0.004869155490
              std dev =       0.525649400473
             le_variance =       0.276307292217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371684309
  error estimate for blocks of size 2^( 2) =       0.000385796859
  error estimate for blocks of size 2^( 3) =       0.000398701550
  error estimate for blocks of size 2^( 4) =       0.000408314004
  error estimate for blocks of size 2^( 5) =       0.000414370133
  error estimate for blocks of size 2^( 6) =       0.000417337340
  error estimate for blocks of size 2^( 7) =       0.000420134709

      target function =      -0.935876305880
              le_mean =     -17.209808950565
             les_mean =     296.462893128201
             stat err =       0.000415039047
             autocorr =       1.246893782952
   target nu stat err =       0.000415039047
   target dn stat err =       0.002897399881
      target stat err =       0.004869155490
              std dev =       0.525649400473
             le_variance =       0.276307292217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276306880824
                                         uncertainty =       0.001836184809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371684309
  error estimate for blocks of size 2^( 2) =       0.000385796859
  error estimate for blocks of size 2^( 3) =       0.000398701550
  error estimate for blocks of size 2^( 4) =       0.000408314004
  error estimate for blocks of size 2^( 5) =       0.000414370133
  error estimate for blocks of size 2^( 6) =       0.000417337340
  error estimate for blocks of size 2^( 7) =       0.000420134709

      target function =      -0.935876305880
              le_mean =     -17.209808950565
             les_mean =     296.462893128201
             stat err =       0.000415039047
             autocorr =       1.246893782952
   target nu stat err =       0.000415039047
   target dn stat err =       0.002897399881
      target stat err =       0.004869155490
              std dev =       0.525649400473
             le_variance =       0.276307292217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935876305880        initial  <--
     2.4414e+34     2.4414e+35             0.0000e+00        -0.935876305880
     9.7656e+34     9.7656e+35             0.0000e+00        -0.935876305880
     3.9062e+35     3.9062e+36             0.0000e+00        -0.935876305880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5701
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1827
    reference variance = 0.308072
====================================================
  Execution time = 2.7514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0499e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8650e-01
  Total weights = 1.966472786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3633e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277433820535
                                         uncertainty =       0.001867043007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277433820535
                                         uncertainty =       0.001867043007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372427484
  error estimate for blocks of size 2^( 2) =       0.000386554448
  error estimate for blocks of size 2^( 3) =       0.000400055045
  error estimate for blocks of size 2^( 4) =       0.000409166395
  error estimate for blocks of size 2^( 5) =       0.000414605216
  error estimate for blocks of size 2^( 6) =       0.000417306486
  error estimate for blocks of size 2^( 7) =       0.000419738862

      target function =      -0.933998934929
              le_mean =     -17.209949961225
             les_mean =     296.468880228495
             stat err =       0.000415204240
             autocorr =       1.242911229742
   target nu stat err =       0.000415204240
   target dn stat err =       0.002520188595
      target stat err =       0.004235186950
              std dev =       0.526700426415
             le_variance =       0.277413339185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720994996123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+35, overlap shift 2.4414e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+35, overlap shift 9.7656e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+36, overlap shift 3.9062e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934017137063       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.644807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5886e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.181582
====================================================
  Execution time = 2.9752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8370e-01
  Total weights = 1.9665e+06
  Execution time = 2.2942e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370597536
  error estimate for blocks of size 2^( 2) =       0.000384915685
  error estimate for blocks of size 2^( 3) =       0.000398131089
  error estimate for blocks of size 2^( 4) =       0.000407362135
  error estimate for blocks of size 2^( 5) =       0.000412989820
  error estimate for blocks of size 2^( 6) =       0.000415071683
  error estimate for blocks of size 2^( 7) =       0.000418613716

      target function =      -0.938678626204
              le_mean =     -17.209302369222
             les_mean =     296.443786616810
             stat err =       0.000413509339
             autocorr =       1.244989213417
   target nu stat err =       0.000413509339
   target dn stat err =       0.002163317353
      target stat err =       0.003685824079
              std dev =       0.524112447385
             le_variance =       0.274693857504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370597536
  error estimate for blocks of size 2^( 2) =       0.000384915685
  error estimate for blocks of size 2^( 3) =       0.000398131089
  error estimate for blocks of size 2^( 4) =       0.000407362135
  error estimate for blocks of size 2^( 5) =       0.000412989820
  error estimate for blocks of size 2^( 6) =       0.000415071683
  error estimate for blocks of size 2^( 7) =       0.000418613716

      target function =      -0.938678626204
              le_mean =     -17.209302369222
             les_mean =     296.443786616810
             stat err =       0.000413509339
             autocorr =       1.244989213417
   target nu stat err =       0.000413509339
   target dn stat err =       0.002163317353
      target stat err =       0.003685824079
              std dev =       0.524112447385
             le_variance =       0.274693857504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370597536
  error estimate for blocks of size 2^( 2) =       0.000384915685
  error estimate for blocks of size 2^( 3) =       0.000398131089
  error estimate for blocks of size 2^( 4) =       0.000407362135
  error estimate for blocks of size 2^( 5) =       0.000412989820
  error estimate for blocks of size 2^( 6) =       0.000415071683
  error estimate for blocks of size 2^( 7) =       0.000418613716

      target function =      -0.938678626204
              le_mean =     -17.209302369222
             les_mean =     296.443786616810
             stat err =       0.000413509339
             autocorr =       1.244989213417
   target nu stat err =       0.000413509339
   target dn stat err =       0.002163317353
      target stat err =       0.003685824079
              std dev =       0.524112447385
             le_variance =       0.274693857504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274705538394
                                         uncertainty =       0.001709588714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370597536
  error estimate for blocks of size 2^( 2) =       0.000384915685
  error estimate for blocks of size 2^( 3) =       0.000398131089
  error estimate for blocks of size 2^( 4) =       0.000407362135
  error estimate for blocks of size 2^( 5) =       0.000412989820
  error estimate for blocks of size 2^( 6) =       0.000415071683
  error estimate for blocks of size 2^( 7) =       0.000418613716

      target function =      -0.938678626204
              le_mean =     -17.209302369222
             les_mean =     296.443786616810
             stat err =       0.000413509339
             autocorr =       1.244989213417
   target nu stat err =       0.000413509339
   target dn stat err =       0.002163317353
      target stat err =       0.003685824079
              std dev =       0.524112447385
             le_variance =       0.274693857504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938678626204        initial  <--
     2.4414e+35     2.4414e+36             0.0000e+00        -0.938678626204
     9.7656e+35     9.7656e+36             0.0000e+00        -0.938678626204
     3.9062e+36     3.9062e+37             0.0000e+00        -0.938678626204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.3174
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2772
    reference variance = 0.270313
====================================================
  Execution time = 2.7521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8786e-01
  Total weights = 1.966559146e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3723e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278561013218
                                         uncertainty =       0.002784742779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278561013218
                                         uncertainty =       0.002784742779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373183720
  error estimate for blocks of size 2^( 2) =       0.000387444206
  error estimate for blocks of size 2^( 3) =       0.000400713782
  error estimate for blocks of size 2^( 4) =       0.000410989908
  error estimate for blocks of size 2^( 5) =       0.000416357853
  error estimate for blocks of size 2^( 6) =       0.000418620794
  error estimate for blocks of size 2^( 7) =       0.000419903366

      target function =      -0.931767938310
              le_mean =     -17.209324659532
             les_mean =     296.448713313809
             stat err =       0.000416467980
             autocorr =       1.245425788934
   target nu stat err =       0.000416467980
   target dn stat err =       0.003258801608
      target stat err =       0.005411335074
              std dev =       0.527769922014
             le_variance =       0.278541090583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720932465953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+36, overlap shift 2.4414e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+36, overlap shift 9.7656e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+37, overlap shift 3.9062e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931798013545       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.646113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5903e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1507
    reference variance = 0.274141
====================================================
  Execution time = 2.7967e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8946e-01
  Total weights = 1.9662e+06
  Execution time = 2.2985e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371595836
  error estimate for blocks of size 2^( 2) =       0.000386094684
  error estimate for blocks of size 2^( 3) =       0.000399659030
  error estimate for blocks of size 2^( 4) =       0.000409878685
  error estimate for blocks of size 2^( 5) =       0.000416405864
  error estimate for blocks of size 2^( 6) =       0.000419836232
  error estimate for blocks of size 2^( 7) =       0.000422701998

      target function =      -0.928990747046
              le_mean =     -17.209872273175
             les_mean =     296.469167607936
             stat err =       0.000417205695
             autocorr =       1.260546230567
   target nu stat err =       0.000417205695
   target dn stat err =       0.007334744141
      target stat err =       0.012031311478
              std dev =       0.525524279191
             le_variance =       0.276175768019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371595836
  error estimate for blocks of size 2^( 2) =       0.000386094684
  error estimate for blocks of size 2^( 3) =       0.000399659030
  error estimate for blocks of size 2^( 4) =       0.000409878685
  error estimate for blocks of size 2^( 5) =       0.000416405864
  error estimate for blocks of size 2^( 6) =       0.000419836232
  error estimate for blocks of size 2^( 7) =       0.000422701998

      target function =      -0.928990747046
              le_mean =     -17.209872273175
             les_mean =     296.469167607936
             stat err =       0.000417205695
             autocorr =       1.260546230567
   target nu stat err =       0.000417205695
   target dn stat err =       0.007334744141
      target stat err =       0.012031311478
              std dev =       0.525524279191
             le_variance =       0.276175768019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371595836
  error estimate for blocks of size 2^( 2) =       0.000386094684
  error estimate for blocks of size 2^( 3) =       0.000399659030
  error estimate for blocks of size 2^( 4) =       0.000409878685
  error estimate for blocks of size 2^( 5) =       0.000416405864
  error estimate for blocks of size 2^( 6) =       0.000419836232
  error estimate for blocks of size 2^( 7) =       0.000422701998

      target function =      -0.928990747046
              le_mean =     -17.209872273175
             les_mean =     296.469167607936
             stat err =       0.000417205695
             autocorr =       1.260546230567
   target nu stat err =       0.000417205695
   target dn stat err =       0.007334744141
      target stat err =       0.012031311478
              std dev =       0.525524279191
             le_variance =       0.276175768019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118582217
                                         uncertainty =       0.002670488648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371595836
  error estimate for blocks of size 2^( 2) =       0.000386094684
  error estimate for blocks of size 2^( 3) =       0.000399659030
  error estimate for blocks of size 2^( 4) =       0.000409878685
  error estimate for blocks of size 2^( 5) =       0.000416405864
  error estimate for blocks of size 2^( 6) =       0.000419836232
  error estimate for blocks of size 2^( 7) =       0.000422701998

      target function =      -0.928990747046
              le_mean =     -17.209872273175
             les_mean =     296.469167607936
             stat err =       0.000417205695
             autocorr =       1.260546230567
   target nu stat err =       0.000417205695
   target dn stat err =       0.007334744141
      target stat err =       0.012031311478
              std dev =       0.525524279191
             le_variance =       0.276175768019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928990747046        initial  <--
     2.4414e+36     2.4414e+37             0.0000e+00        -0.928990747046
     9.7656e+36     9.7656e+37             0.0000e+00        -0.928990747046
     3.9062e+37     3.9062e+38             0.0000e+00        -0.928990747046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5691
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1112
    reference variance = 0.411711
====================================================
  Execution time = 2.7642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8721e-01
  Total weights = 1.966107168e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4287e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276817331348
                                         uncertainty =       0.002051697608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276817331348
                                         uncertainty =       0.002051697608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372001996
  error estimate for blocks of size 2^( 2) =       0.000386404747
  error estimate for blocks of size 2^( 3) =       0.000399665296
  error estimate for blocks of size 2^( 4) =       0.000409362686
  error estimate for blocks of size 2^( 5) =       0.000415486429
  error estimate for blocks of size 2^( 6) =       0.000416693440
  error estimate for blocks of size 2^( 7) =       0.000418743016

      target function =      -0.932820651423
              le_mean =     -17.210168329484
             les_mean =     296.477105128047
             stat err =       0.000415071393
             autocorr =       1.244959041887
   target nu stat err =       0.000415071393
   target dn stat err =       0.002558291292
      target stat err =       0.004288362154
              std dev =       0.526098685454
             le_variance =       0.276779826837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721016832948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+37, overlap shift 2.4414e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+37, overlap shift 9.7656e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+38, overlap shift 3.9062e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932839344246       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.647403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6080e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1557
    reference variance = 0.166651
====================================================
  Execution time = 2.7391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8225e-01
  Total weights = 1.9664e+06
  Execution time = 2.2917e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369746881
  error estimate for blocks of size 2^( 2) =       0.000383883757
  error estimate for blocks of size 2^( 3) =       0.000397315246
  error estimate for blocks of size 2^( 4) =       0.000405960734
  error estimate for blocks of size 2^( 5) =       0.000410538002
  error estimate for blocks of size 2^( 6) =       0.000412223729
  error estimate for blocks of size 2^( 7) =       0.000414905473

      target function =      -0.941080495921
              le_mean =     -17.210429231288
             les_mean =     296.481129310078
             stat err =       0.000410906985
             autocorr =       1.235031427600
   target nu stat err =       0.000410906985
   target dn stat err =       0.002078370260
      target stat err =       0.003571417072
              std dev =       0.522909419789
             le_variance =       0.273434261305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369746881
  error estimate for blocks of size 2^( 2) =       0.000383883757
  error estimate for blocks of size 2^( 3) =       0.000397315246
  error estimate for blocks of size 2^( 4) =       0.000405960734
  error estimate for blocks of size 2^( 5) =       0.000410538002
  error estimate for blocks of size 2^( 6) =       0.000412223729
  error estimate for blocks of size 2^( 7) =       0.000414905473

      target function =      -0.941080495921
              le_mean =     -17.210429231288
             les_mean =     296.481129310078
             stat err =       0.000410906985
             autocorr =       1.235031427600
   target nu stat err =       0.000410906985
   target dn stat err =       0.002078370260
      target stat err =       0.003571417072
              std dev =       0.522909419789
             le_variance =       0.273434261305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369746881
  error estimate for blocks of size 2^( 2) =       0.000383883757
  error estimate for blocks of size 2^( 3) =       0.000397315246
  error estimate for blocks of size 2^( 4) =       0.000405960734
  error estimate for blocks of size 2^( 5) =       0.000410538002
  error estimate for blocks of size 2^( 6) =       0.000412223729
  error estimate for blocks of size 2^( 7) =       0.000414905473

      target function =      -0.941080495921
              le_mean =     -17.210429231288
             les_mean =     296.481129310078
             stat err =       0.000410906985
             autocorr =       1.235031427600
   target nu stat err =       0.000410906985
   target dn stat err =       0.002078370260
      target stat err =       0.003571417072
              std dev =       0.522909419789
             le_variance =       0.273434261305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273464094238
                                         uncertainty =       0.001534469528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369746881
  error estimate for blocks of size 2^( 2) =       0.000383883757
  error estimate for blocks of size 2^( 3) =       0.000397315246
  error estimate for blocks of size 2^( 4) =       0.000405960734
  error estimate for blocks of size 2^( 5) =       0.000410538002
  error estimate for blocks of size 2^( 6) =       0.000412223729
  error estimate for blocks of size 2^( 7) =       0.000414905473

      target function =      -0.941080495921
              le_mean =     -17.210429231288
             les_mean =     296.481129310078
             stat err =       0.000410906985
             autocorr =       1.235031427600
   target nu stat err =       0.000410906985
   target dn stat err =       0.002078370260
      target stat err =       0.003571417072
              std dev =       0.522909419789
             le_variance =       0.273434261305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941080495921        initial  <--
     2.4414e+37     2.4414e+38             0.0000e+00        -0.941080495921
     9.7656e+37     9.7656e+38             0.0000e+00        -0.941080495921
     3.9062e+38     3.9062e+39             0.0000e+00        -0.941080495921

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9722
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2492
    reference variance = 0.274757
====================================================
  Execution time = 2.7669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8615e-01
  Total weights = 1.966414638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4097e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278500295664
                                         uncertainty =       0.002314490101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278500295664
                                         uncertainty =       0.002314490101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373147242
  error estimate for blocks of size 2^( 2) =       0.000387578214
  error estimate for blocks of size 2^( 3) =       0.000400590594
  error estimate for blocks of size 2^( 4) =       0.000410714472
  error estimate for blocks of size 2^( 5) =       0.000416074152
  error estimate for blocks of size 2^( 6) =       0.000418229040
  error estimate for blocks of size 2^( 7) =       0.000419658142

      target function =      -0.934609931240
              le_mean =     -17.208582345545
             les_mean =     296.421458501755
             stat err =       0.000416168951
             autocorr =       1.243881130435
   target nu stat err =       0.000416168951
   target dn stat err =       0.002638370374
      target stat err =       0.004422462887
              std dev =       0.527718334097
             le_variance =       0.278486640142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720858234555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+38, overlap shift 2.4414e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+38, overlap shift 9.7656e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+39, overlap shift 3.9062e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934629866555       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.648684 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6087e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.288879
====================================================
  Execution time = 2.7491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8426e-01
  Total weights = 1.9662e+06
  Execution time = 2.2995e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371097852
  error estimate for blocks of size 2^( 2) =       0.000385637486
  error estimate for blocks of size 2^( 3) =       0.000398277411
  error estimate for blocks of size 2^( 4) =       0.000408079420
  error estimate for blocks of size 2^( 5) =       0.000413961048
  error estimate for blocks of size 2^( 6) =       0.000417148734
  error estimate for blocks of size 2^( 7) =       0.000419843360

      target function =      -0.937742548695
              le_mean =     -17.209637018095
             les_mean =     296.455863742212
             stat err =       0.000414758141
             autocorr =       1.249145295285
   target nu stat err =       0.000414758141
   target dn stat err =       0.001992321940
      target stat err =       0.003402557952
              std dev =       0.524820012044
             le_variance =       0.275436045042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371097852
  error estimate for blocks of size 2^( 2) =       0.000385637486
  error estimate for blocks of size 2^( 3) =       0.000398277411
  error estimate for blocks of size 2^( 4) =       0.000408079420
  error estimate for blocks of size 2^( 5) =       0.000413961048
  error estimate for blocks of size 2^( 6) =       0.000417148734
  error estimate for blocks of size 2^( 7) =       0.000419843360

      target function =      -0.937742548695
              le_mean =     -17.209637018095
             les_mean =     296.455863742212
             stat err =       0.000414758141
             autocorr =       1.249145295285
   target nu stat err =       0.000414758141
   target dn stat err =       0.001992321940
      target stat err =       0.003402557952
              std dev =       0.524820012044
             le_variance =       0.275436045042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371097852
  error estimate for blocks of size 2^( 2) =       0.000385637486
  error estimate for blocks of size 2^( 3) =       0.000398277411
  error estimate for blocks of size 2^( 4) =       0.000408079420
  error estimate for blocks of size 2^( 5) =       0.000413961048
  error estimate for blocks of size 2^( 6) =       0.000417148734
  error estimate for blocks of size 2^( 7) =       0.000419843360

      target function =      -0.937742548695
              le_mean =     -17.209637018095
             les_mean =     296.455863742212
             stat err =       0.000414758141
             autocorr =       1.249145295285
   target nu stat err =       0.000414758141
   target dn stat err =       0.001992321940
      target stat err =       0.003402557952
              std dev =       0.524820012044
             le_variance =       0.275436045042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275498965968
                                         uncertainty =       0.001325789008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371097852
  error estimate for blocks of size 2^( 2) =       0.000385637486
  error estimate for blocks of size 2^( 3) =       0.000398277411
  error estimate for blocks of size 2^( 4) =       0.000408079420
  error estimate for blocks of size 2^( 5) =       0.000413961048
  error estimate for blocks of size 2^( 6) =       0.000417148734
  error estimate for blocks of size 2^( 7) =       0.000419843360

      target function =      -0.937742548695
              le_mean =     -17.209637018095
             les_mean =     296.455863742212
             stat err =       0.000414758141
             autocorr =       1.249145295285
   target nu stat err =       0.000414758141
   target dn stat err =       0.001992321940
      target stat err =       0.003402557952
              std dev =       0.524820012044
             le_variance =       0.275436045042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937742548695        initial  <--
     2.4414e+38     2.4414e+39             0.0000e+00        -0.937742548695
     9.7656e+38     9.7656e+39             0.0000e+00        -0.937742548695
     3.9062e+39     3.9062e+40             0.0000e+00        -0.937742548695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0809
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2325
    reference variance = 0.162298
====================================================
  Execution time = 2.7628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8530e-01
  Total weights = 1.966449619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7559e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275870540790
                                         uncertainty =       0.001749547543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275870540790
                                         uncertainty =       0.001749547543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371429187
  error estimate for blocks of size 2^( 2) =       0.000386018439
  error estimate for blocks of size 2^( 3) =       0.000399229066
  error estimate for blocks of size 2^( 4) =       0.000409038411
  error estimate for blocks of size 2^( 5) =       0.000414591642
  error estimate for blocks of size 2^( 6) =       0.000418111060
  error estimate for blocks of size 2^( 7) =       0.000420253562

      target function =      -0.936004182909
              le_mean =     -17.209266832229
             les_mean =     296.444168632297
             stat err =       0.000415498669
             autocorr =       1.251374262029
   target nu stat err =       0.000415498669
   target dn stat err =       0.002401232998
      target stat err =       0.004053377314
              std dev =       0.525288597685
             le_variance =       0.275928110858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720926683223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+39, overlap shift 2.4414e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+39, overlap shift 9.7656e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+40, overlap shift 3.9062e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936020644170       residual = 6.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.650053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6392e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2738
    reference variance = 0.169116
====================================================
  Execution time = 2.9623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9117e-01
  Total weights = 1.9665e+06
  Execution time = 2.3008e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372484735
  error estimate for blocks of size 2^( 2) =       0.000386738410
  error estimate for blocks of size 2^( 3) =       0.000400101601
  error estimate for blocks of size 2^( 4) =       0.000410197236
  error estimate for blocks of size 2^( 5) =       0.000415546921
  error estimate for blocks of size 2^( 6) =       0.000418959082
  error estimate for blocks of size 2^( 7) =       0.000420274344

      target function =      -0.926316692408
              le_mean =     -17.209424864623
             les_mean =     296.455471853613
             stat err =       0.000416244395
             autocorr =       1.248762470563
   target nu stat err =       0.000416244395
   target dn stat err =       0.004770873158
      target stat err =       0.007793224810
              std dev =       0.526781392774
             le_variance =       0.277498635773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372484735
  error estimate for blocks of size 2^( 2) =       0.000386738410
  error estimate for blocks of size 2^( 3) =       0.000400101601
  error estimate for blocks of size 2^( 4) =       0.000410197236
  error estimate for blocks of size 2^( 5) =       0.000415546921
  error estimate for blocks of size 2^( 6) =       0.000418959082
  error estimate for blocks of size 2^( 7) =       0.000420274344

      target function =      -0.926316692408
              le_mean =     -17.209424864623
             les_mean =     296.455471853613
             stat err =       0.000416244395
             autocorr =       1.248762470566
   target nu stat err =       0.000416244395
   target dn stat err =       0.004770873158
      target stat err =       0.007793224810
              std dev =       0.526781392774
             le_variance =       0.277498635773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372484735
  error estimate for blocks of size 2^( 2) =       0.000386738410
  error estimate for blocks of size 2^( 3) =       0.000400101601
  error estimate for blocks of size 2^( 4) =       0.000410197236
  error estimate for blocks of size 2^( 5) =       0.000415546921
  error estimate for blocks of size 2^( 6) =       0.000418959082
  error estimate for blocks of size 2^( 7) =       0.000420274344

      target function =      -0.926316692408
              le_mean =     -17.209424864623
             les_mean =     296.455471853613
             stat err =       0.000416244395
             autocorr =       1.248762470566
   target nu stat err =       0.000416244395
   target dn stat err =       0.004770873158
      target stat err =       0.007793224810
              std dev =       0.526781392774
             le_variance =       0.277498635773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277487303321
                                         uncertainty =       0.002205131123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372484735
  error estimate for blocks of size 2^( 2) =       0.000386738410
  error estimate for blocks of size 2^( 3) =       0.000400101601
  error estimate for blocks of size 2^( 4) =       0.000410197236
  error estimate for blocks of size 2^( 5) =       0.000415546921
  error estimate for blocks of size 2^( 6) =       0.000418959082
  error estimate for blocks of size 2^( 7) =       0.000420274344

      target function =      -0.926316692408
              le_mean =     -17.209424864623
             les_mean =     296.455471853613
             stat err =       0.000416244395
             autocorr =       1.248762470566
   target nu stat err =       0.000416244395
   target dn stat err =       0.004770873158
      target stat err =       0.007793224810
              std dev =       0.526781392774
             le_variance =       0.277498635773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926316692408        initial  <--
     2.4414e+39     2.4414e+40             0.0000e+00        -0.926316692408
     9.7656e+39     9.7656e+40             0.0000e+00        -0.926316692408
     3.9062e+40     3.9062e+41             0.0000e+00        -0.926316692408

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2367
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2
    reference variance = 0.267779
====================================================
  Execution time = 2.7618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0503e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8815e-01
  Total weights = 1.966258059e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5011e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278044868204
                                         uncertainty =       0.002323663184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278044868204
                                         uncertainty =       0.002323663184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372823812
  error estimate for blocks of size 2^( 2) =       0.000387016394
  error estimate for blocks of size 2^( 3) =       0.000400190946
  error estimate for blocks of size 2^( 4) =       0.000410006780
  error estimate for blocks of size 2^( 5) =       0.000416164088
  error estimate for blocks of size 2^( 6) =       0.000419350098
  error estimate for blocks of size 2^( 7) =       0.000421250695

      target function =      -0.931280829903
              le_mean =     -17.209675214709
             les_mean =     296.461067268028
             stat err =       0.000416692915
             autocorr =       1.249179788698
   target nu stat err =       0.000416692915
   target dn stat err =       0.003366273683
      target stat err =       0.005584539896
              std dev =       0.527260926586
             le_variance =       0.278004084705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720967521471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+40, overlap shift 2.4414e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931313404311       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931313404311       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931313404311       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+40 is 5.210137e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+40, overlap shift 9.7656e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931313404311       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931313404311       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+40 is 1.302534e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+41, overlap shift 3.9062e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931313404311       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931313404311       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931313404311       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+41 is 3.256335e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.651575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6128e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.194922
====================================================
  Execution time = 2.7374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8697e-01
  Total weights = 1.9666e+06
  Execution time = 2.2906e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372340261
  error estimate for blocks of size 2^( 2) =       0.000386668929
  error estimate for blocks of size 2^( 3) =       0.000399873540
  error estimate for blocks of size 2^( 4) =       0.000409992632
  error estimate for blocks of size 2^( 5) =       0.000416668942
  error estimate for blocks of size 2^( 6) =       0.000419008393
  error estimate for blocks of size 2^( 7) =       0.000421759611

      target function =      -0.933228692123
              le_mean =     -17.210041070100
             les_mean =     296.472481152941
             stat err =       0.000416857395
             autocorr =       1.253415386942
   target nu stat err =       0.000416857395
   target dn stat err =       0.002434251544
      target stat err =       0.004089787901
              std dev =       0.526577071961
             le_variance =       0.277283412715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372340261
  error estimate for blocks of size 2^( 2) =       0.000386668929
  error estimate for blocks of size 2^( 3) =       0.000399873540
  error estimate for blocks of size 2^( 4) =       0.000409992632
  error estimate for blocks of size 2^( 5) =       0.000416668942
  error estimate for blocks of size 2^( 6) =       0.000419008393
  error estimate for blocks of size 2^( 7) =       0.000421759611

      target function =      -0.933228692123
              le_mean =     -17.210041070100
             les_mean =     296.472481152941
             stat err =       0.000416857395
             autocorr =       1.253415386942
   target nu stat err =       0.000416857395
   target dn stat err =       0.002434251544
      target stat err =       0.004089787901
              std dev =       0.526577071961
             le_variance =       0.277283412715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372340261
  error estimate for blocks of size 2^( 2) =       0.000386668929
  error estimate for blocks of size 2^( 3) =       0.000399873540
  error estimate for blocks of size 2^( 4) =       0.000409992632
  error estimate for blocks of size 2^( 5) =       0.000416668942
  error estimate for blocks of size 2^( 6) =       0.000419008393
  error estimate for blocks of size 2^( 7) =       0.000421759611

      target function =      -0.933228692123
              le_mean =     -17.210041070100
             les_mean =     296.472481152941
             stat err =       0.000416857395
             autocorr =       1.253415386942
   target nu stat err =       0.000416857395
   target dn stat err =       0.002434251544
      target stat err =       0.004089787901
              std dev =       0.526577071961
             le_variance =       0.277283412715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277232048293
                                         uncertainty =       0.001746975968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372340261
  error estimate for blocks of size 2^( 2) =       0.000386668929
  error estimate for blocks of size 2^( 3) =       0.000399873540
  error estimate for blocks of size 2^( 4) =       0.000409992632
  error estimate for blocks of size 2^( 5) =       0.000416668942
  error estimate for blocks of size 2^( 6) =       0.000419008393
  error estimate for blocks of size 2^( 7) =       0.000421759611

      target function =      -0.933228692123
              le_mean =     -17.210041070100
             les_mean =     296.472481152941
             stat err =       0.000416857395
             autocorr =       1.253415386942
   target nu stat err =       0.000416857395
   target dn stat err =       0.002434251544
      target stat err =       0.004089787901
              std dev =       0.526577071961
             le_variance =       0.277283412715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933228692123        initial  <--
     2.4414e+40     2.4414e+41             5.2101e-45        -0.933228692123
     9.7656e+40     9.7656e+41             1.3025e-45        -0.933228692123
     3.9062e+41     3.9062e+42             3.2563e-46        -0.933228692123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9378
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2947
    reference variance = 0.173608
====================================================
  Execution time = 2.7655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9211e-01
  Total weights = 1.966237732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4003e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281478906016
                                         uncertainty =       0.002127336178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281478906016
                                         uncertainty =       0.002127336178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375120145
  error estimate for blocks of size 2^( 2) =       0.000389503084
  error estimate for blocks of size 2^( 3) =       0.000402941037
  error estimate for blocks of size 2^( 4) =       0.000411871688
  error estimate for blocks of size 2^( 5) =       0.000416892921
  error estimate for blocks of size 2^( 6) =       0.000419629702
  error estimate for blocks of size 2^( 7) =       0.000418836031

      target function =      -0.924796855386
              le_mean =     -17.209822048609
             les_mean =     296.470087475919
             stat err =       0.000416807585
             autocorr =       1.234611883974
   target nu stat err =       0.000416807585
   target dn stat err =       0.003428155683
      target stat err =       0.005608791770
              std dev =       0.530508484486
             le_variance =       0.281439252112


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720982204861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+41, overlap shift 2.4414e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+41, overlap shift 9.7656e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+42, overlap shift 3.9062e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924829668016       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.652871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6064e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.215076
====================================================
  Execution time = 2.7408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8525e-01
  Total weights = 1.9663e+06
  Execution time = 2.2954e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371977365
  error estimate for blocks of size 2^( 2) =       0.000386411168
  error estimate for blocks of size 2^( 3) =       0.000399378193
  error estimate for blocks of size 2^( 4) =       0.000409518427
  error estimate for blocks of size 2^( 5) =       0.000416936584
  error estimate for blocks of size 2^( 6) =       0.000419732716
  error estimate for blocks of size 2^( 7) =       0.000423641858

      target function =      -0.936083743211
              le_mean =     -17.209376837900
             les_mean =     296.447905745494
             stat err =       0.000417457396
             autocorr =       1.259480053294
   target nu stat err =       0.000417457396
   target dn stat err =       0.002369467622
      target stat err =       0.004003682409
              std dev =       0.526063850608
             le_variance =       0.276743174916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371977365
  error estimate for blocks of size 2^( 2) =       0.000386411168
  error estimate for blocks of size 2^( 3) =       0.000399378193
  error estimate for blocks of size 2^( 4) =       0.000409518427
  error estimate for blocks of size 2^( 5) =       0.000416936584
  error estimate for blocks of size 2^( 6) =       0.000419732716
  error estimate for blocks of size 2^( 7) =       0.000423641858

      target function =      -0.936083743211
              le_mean =     -17.209376837900
             les_mean =     296.447905745494
             stat err =       0.000417457396
             autocorr =       1.259480053287
   target nu stat err =       0.000417457396
   target dn stat err =       0.002369467622
      target stat err =       0.004003682409
              std dev =       0.526063850608
             le_variance =       0.276743174916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371977365
  error estimate for blocks of size 2^( 2) =       0.000386411168
  error estimate for blocks of size 2^( 3) =       0.000399378193
  error estimate for blocks of size 2^( 4) =       0.000409518427
  error estimate for blocks of size 2^( 5) =       0.000416936584
  error estimate for blocks of size 2^( 6) =       0.000419732716
  error estimate for blocks of size 2^( 7) =       0.000423641858

      target function =      -0.936083743211
              le_mean =     -17.209376837900
             les_mean =     296.447905745494
             stat err =       0.000417457396
             autocorr =       1.259480053287
   target nu stat err =       0.000417457396
   target dn stat err =       0.002369467622
      target stat err =       0.004003682409
              std dev =       0.526063850608
             le_variance =       0.276743174916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276721601371
                                         uncertainty =       0.001876711163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371977365
  error estimate for blocks of size 2^( 2) =       0.000386411168
  error estimate for blocks of size 2^( 3) =       0.000399378193
  error estimate for blocks of size 2^( 4) =       0.000409518427
  error estimate for blocks of size 2^( 5) =       0.000416936584
  error estimate for blocks of size 2^( 6) =       0.000419732716
  error estimate for blocks of size 2^( 7) =       0.000423641858

      target function =      -0.936083743211
              le_mean =     -17.209376837900
             les_mean =     296.447905745494
             stat err =       0.000417457396
             autocorr =       1.259480053287
   target nu stat err =       0.000417457396
   target dn stat err =       0.002369467622
      target stat err =       0.004003682409
              std dev =       0.526063850608
             le_variance =       0.276743174916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936083743211        initial  <--
     2.4414e+41     2.4414e+42             0.0000e+00        -0.936083743211
     9.7656e+41     9.7656e+42             0.0000e+00        -0.936083743211
     3.9062e+42     3.9062e+43             0.0000e+00        -0.936083743211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0006
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1778
    reference variance = 0.157234
====================================================
  Execution time = 2.7473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8952e-01
  Total weights = 1.966285619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3397e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278641544854
                                         uncertainty =       0.001792201725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278641544854
                                         uncertainty =       0.001792201725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373219675
  error estimate for blocks of size 2^( 2) =       0.000387540817
  error estimate for blocks of size 2^( 3) =       0.000400450938
  error estimate for blocks of size 2^( 4) =       0.000409703967
  error estimate for blocks of size 2^( 5) =       0.000414750505
  error estimate for blocks of size 2^( 6) =       0.000416704561
  error estimate for blocks of size 2^( 7) =       0.000418387292

      target function =      -0.929056448946
              le_mean =     -17.209354572669
             les_mean =     296.451403693998
             stat err =       0.000414886581
             autocorr =       1.235747431742
   target nu stat err =       0.000414886581
   target dn stat err =       0.002419433491
      target stat err =       0.004024154204
              std dev =       0.527820771118
             le_variance =       0.278594766424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720935457267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+42, overlap shift 2.4414e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+42, overlap shift 9.7656e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+43, overlap shift 3.9063e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929072647025       residual = 7.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.654160 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5822e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.538315
====================================================
  Execution time = 2.7215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8589e-01
  Total weights = 1.9664e+06
  Execution time = 2.2990e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372188281
  error estimate for blocks of size 2^( 2) =       0.000386536783
  error estimate for blocks of size 2^( 3) =       0.000400073672
  error estimate for blocks of size 2^( 4) =       0.000409336523
  error estimate for blocks of size 2^( 5) =       0.000415149005
  error estimate for blocks of size 2^( 6) =       0.000418829590
  error estimate for blocks of size 2^( 7) =       0.000418578706

      target function =      -0.935021044977
              le_mean =     -17.209757283535
             les_mean =     296.461635506238
             stat err =       0.000415473456
             autocorr =       1.246123759073
   target nu stat err =       0.000415473456
   target dn stat err =       0.002377048261
      target stat err =       0.004009338876
              std dev =       0.526362136323
             le_variance =       0.277057098554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372188281
  error estimate for blocks of size 2^( 2) =       0.000386536783
  error estimate for blocks of size 2^( 3) =       0.000400073672
  error estimate for blocks of size 2^( 4) =       0.000409336523
  error estimate for blocks of size 2^( 5) =       0.000415149005
  error estimate for blocks of size 2^( 6) =       0.000418829590
  error estimate for blocks of size 2^( 7) =       0.000418578706

      target function =      -0.935021044977
              le_mean =     -17.209757283535
             les_mean =     296.461635506238
             stat err =       0.000415473456
             autocorr =       1.246123759073
   target nu stat err =       0.000415473456
   target dn stat err =       0.002377048261
      target stat err =       0.004009338876
              std dev =       0.526362136323
             le_variance =       0.277057098554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372188281
  error estimate for blocks of size 2^( 2) =       0.000386536783
  error estimate for blocks of size 2^( 3) =       0.000400073672
  error estimate for blocks of size 2^( 4) =       0.000409336523
  error estimate for blocks of size 2^( 5) =       0.000415149005
  error estimate for blocks of size 2^( 6) =       0.000418829590
  error estimate for blocks of size 2^( 7) =       0.000418578706

      target function =      -0.935021044977
              le_mean =     -17.209757283535
             les_mean =     296.461635506238
             stat err =       0.000415473456
             autocorr =       1.246123759073
   target nu stat err =       0.000415473456
   target dn stat err =       0.002377048261
      target stat err =       0.004009338876
              std dev =       0.526362136323
             le_variance =       0.277057098554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713621829
                                         uncertainty =       0.001600794812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372188281
  error estimate for blocks of size 2^( 2) =       0.000386536783
  error estimate for blocks of size 2^( 3) =       0.000400073672
  error estimate for blocks of size 2^( 4) =       0.000409336523
  error estimate for blocks of size 2^( 5) =       0.000415149005
  error estimate for blocks of size 2^( 6) =       0.000418829590
  error estimate for blocks of size 2^( 7) =       0.000418578706

      target function =      -0.935021044977
              le_mean =     -17.209757283535
             les_mean =     296.461635506238
             stat err =       0.000415473456
             autocorr =       1.246123759073
   target nu stat err =       0.000415473456
   target dn stat err =       0.002377048261
      target stat err =       0.004009338876
              std dev =       0.526362136323
             le_variance =       0.277057098554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935021044977        initial  <--
     2.4414e+42     2.4414e+43             0.0000e+00        -0.935021044977
     9.7656e+42     9.7656e+43             0.0000e+00        -0.935021044977
     3.9062e+43     3.9063e+44             0.0000e+00        -0.935021044977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8089
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2589
    reference variance = 0.217228
====================================================
  Execution time = 2.7611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9098e-01
  Total weights = 1.966267114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5254e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279400512715
                                         uncertainty =       0.002225647893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279400512715
                                         uncertainty =       0.002225647893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373766583
  error estimate for blocks of size 2^( 2) =       0.000388263624
  error estimate for blocks of size 2^( 3) =       0.000401091185
  error estimate for blocks of size 2^( 4) =       0.000410590947
  error estimate for blocks of size 2^( 5) =       0.000415847690
  error estimate for blocks of size 2^( 6) =       0.000419679887
  error estimate for blocks of size 2^( 7) =       0.000422741400

      target function =      -0.926649356605
              le_mean =     -17.209322081600
             les_mean =     296.451745683302
             stat err =       0.000417214981
             autocorr =       1.246002312761
   target nu stat err =       0.000417214981
   target dn stat err =       0.003878325608
      target stat err =       0.006352866110
              std dev =       0.528594228057
             le_variance =       0.279411857935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720932208160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+43, overlap shift 2.4414e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+43, overlap shift 9.7656e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+44, overlap shift 3.9063e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926691478384       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.655451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6145e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2278
    reference variance = 0.124894
====================================================
  Execution time = 2.9735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8649e-01
  Total weights = 1.9662e+06
  Execution time = 2.3017e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371714823
  error estimate for blocks of size 2^( 2) =       0.000386330632
  error estimate for blocks of size 2^( 3) =       0.000399851640
  error estimate for blocks of size 2^( 4) =       0.000409656463
  error estimate for blocks of size 2^( 5) =       0.000414901360
  error estimate for blocks of size 2^( 6) =       0.000417736858
  error estimate for blocks of size 2^( 7) =       0.000418800169

      target function =      -0.934042311561
              le_mean =     -17.209152285316
             les_mean =     296.441410330945
             stat err =       0.000415273712
             autocorr =       1.248099244834
   target nu stat err =       0.000415273712
   target dn stat err =       0.002614014003
      target stat err =       0.004381983561
              std dev =       0.525692555078
             le_variance =       0.276352662465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371714823
  error estimate for blocks of size 2^( 2) =       0.000386330632
  error estimate for blocks of size 2^( 3) =       0.000399851640
  error estimate for blocks of size 2^( 4) =       0.000409656463
  error estimate for blocks of size 2^( 5) =       0.000414901360
  error estimate for blocks of size 2^( 6) =       0.000417736858
  error estimate for blocks of size 2^( 7) =       0.000418800169

      target function =      -0.934042311561
              le_mean =     -17.209152285316
             les_mean =     296.441410330945
             stat err =       0.000415273712
             autocorr =       1.248099244834
   target nu stat err =       0.000415273712
   target dn stat err =       0.002614014003
      target stat err =       0.004381983561
              std dev =       0.525692555078
             le_variance =       0.276352662465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371714823
  error estimate for blocks of size 2^( 2) =       0.000386330632
  error estimate for blocks of size 2^( 3) =       0.000399851640
  error estimate for blocks of size 2^( 4) =       0.000409656463
  error estimate for blocks of size 2^( 5) =       0.000414901360
  error estimate for blocks of size 2^( 6) =       0.000417736858
  error estimate for blocks of size 2^( 7) =       0.000418800169

      target function =      -0.934042311561
              le_mean =     -17.209152285316
             les_mean =     296.441410330945
             stat err =       0.000415273712
             autocorr =       1.248099244834
   target nu stat err =       0.000415273712
   target dn stat err =       0.002614014003
      target stat err =       0.004381983561
              std dev =       0.525692555078
             le_variance =       0.276352662465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372974445
                                         uncertainty =       0.002001871422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371714823
  error estimate for blocks of size 2^( 2) =       0.000386330632
  error estimate for blocks of size 2^( 3) =       0.000399851640
  error estimate for blocks of size 2^( 4) =       0.000409656463
  error estimate for blocks of size 2^( 5) =       0.000414901360
  error estimate for blocks of size 2^( 6) =       0.000417736858
  error estimate for blocks of size 2^( 7) =       0.000418800169

      target function =      -0.934042311561
              le_mean =     -17.209152285316
             les_mean =     296.441410330945
             stat err =       0.000415273712
             autocorr =       1.248099244834
   target nu stat err =       0.000415273712
   target dn stat err =       0.002614014003
      target stat err =       0.004381983561
              std dev =       0.525692555078
             le_variance =       0.276352662465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934042311561        initial  <--
     2.4414e+43     2.4414e+44             0.0000e+00        -0.934042311561
     9.7656e+43     9.7656e+44             0.0000e+00        -0.934042311561
     3.9063e+44     3.9063e+45             0.0000e+00        -0.934042311561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.3444
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2532
    reference variance = 0.194102
====================================================
  Execution time = 2.7582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8822e-01
  Total weights = 1.966513557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5002e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278637183384
                                         uncertainty =       0.002579396244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278637183384
                                         uncertainty =       0.002579396244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373268210
  error estimate for blocks of size 2^( 2) =       0.000387636870
  error estimate for blocks of size 2^( 3) =       0.000400536650
  error estimate for blocks of size 2^( 4) =       0.000409777500
  error estimate for blocks of size 2^( 5) =       0.000414824224
  error estimate for blocks of size 2^( 6) =       0.000416043675
  error estimate for blocks of size 2^( 7) =       0.000417560638

      target function =      -0.931169248062
              le_mean =     -17.209702355070
             les_mean =     296.462070963922
             stat err =       0.000414551509
             autocorr =       1.233431379345
   target nu stat err =       0.000414551509
   target dn stat err =       0.003102865884
      target stat err =       0.005153941112
              std dev =       0.527889410540
             le_variance =       0.278667229760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720970235507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+44, overlap shift 2.4414e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+44, overlap shift 9.7656e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+45, overlap shift 3.9063e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198200613       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.656738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6091e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.290648
====================================================
  Execution time = 2.7265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8674e-01
  Total weights = 1.9662e+06
  Execution time = 2.2930e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371468639
  error estimate for blocks of size 2^( 2) =       0.000385645637
  error estimate for blocks of size 2^( 3) =       0.000398427724
  error estimate for blocks of size 2^( 4) =       0.000408640632
  error estimate for blocks of size 2^( 5) =       0.000414609660
  error estimate for blocks of size 2^( 6) =       0.000416145789
  error estimate for blocks of size 2^( 7) =       0.000419635991

      target function =      -0.933619810890
              le_mean =     -17.209801759254
             les_mean =     296.464012177997
             stat err =       0.000414758018
             autocorr =       1.246652093559
   target nu stat err =       0.000414758018
   target dn stat err =       0.002372458330
      target stat err =       0.003990178505
              std dev =       0.525344392852
             le_variance =       0.275986731101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371468639
  error estimate for blocks of size 2^( 2) =       0.000385645637
  error estimate for blocks of size 2^( 3) =       0.000398427724
  error estimate for blocks of size 2^( 4) =       0.000408640632
  error estimate for blocks of size 2^( 5) =       0.000414609660
  error estimate for blocks of size 2^( 6) =       0.000416145789
  error estimate for blocks of size 2^( 7) =       0.000419635991

      target function =      -0.933619810890
              le_mean =     -17.209801759254
             les_mean =     296.464012177997
             stat err =       0.000414758018
             autocorr =       1.246652093558
   target nu stat err =       0.000414758018
   target dn stat err =       0.002372458330
      target stat err =       0.003990178505
              std dev =       0.525344392852
             le_variance =       0.275986731101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371468639
  error estimate for blocks of size 2^( 2) =       0.000385645637
  error estimate for blocks of size 2^( 3) =       0.000398427724
  error estimate for blocks of size 2^( 4) =       0.000408640632
  error estimate for blocks of size 2^( 5) =       0.000414609660
  error estimate for blocks of size 2^( 6) =       0.000416145789
  error estimate for blocks of size 2^( 7) =       0.000419635991

      target function =      -0.933619810890
              le_mean =     -17.209801759254
             les_mean =     296.464012177997
             stat err =       0.000414758018
             autocorr =       1.246652093558
   target nu stat err =       0.000414758018
   target dn stat err =       0.002372458330
      target stat err =       0.003990178505
              std dev =       0.525344392852
             le_variance =       0.275986731101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975566517
                                         uncertainty =       0.001770714937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371468639
  error estimate for blocks of size 2^( 2) =       0.000385645637
  error estimate for blocks of size 2^( 3) =       0.000398427724
  error estimate for blocks of size 2^( 4) =       0.000408640632
  error estimate for blocks of size 2^( 5) =       0.000414609660
  error estimate for blocks of size 2^( 6) =       0.000416145789
  error estimate for blocks of size 2^( 7) =       0.000419635991

      target function =      -0.933619810890
              le_mean =     -17.209801759254
             les_mean =     296.464012177997
             stat err =       0.000414758018
             autocorr =       1.246652093558
   target nu stat err =       0.000414758018
   target dn stat err =       0.002372458330
      target stat err =       0.003990178505
              std dev =       0.525344392852
             le_variance =       0.275986731101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933619810890        initial  <--
     2.4414e+44     2.4414e+45             0.0000e+00        -0.933619810890
     9.7656e+44     9.7656e+45             0.0000e+00        -0.933619810890
     3.9063e+45     3.9063e+46             0.0000e+00        -0.933619810890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8341
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1559
    reference variance = 0.346095
====================================================
  Execution time = 2.7585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8482e-01
  Total weights = 1.966676409e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3926e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274534017683
                                         uncertainty =       0.001596070719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274534017683
                                         uncertainty =       0.001596070719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370460806
  error estimate for blocks of size 2^( 2) =       0.000384657551
  error estimate for blocks of size 2^( 3) =       0.000397557690
  error estimate for blocks of size 2^( 4) =       0.000407113956
  error estimate for blocks of size 2^( 5) =       0.000412577863
  error estimate for blocks of size 2^( 6) =       0.000415251025
  error estimate for blocks of size 2^( 7) =       0.000415429282

      target function =      -0.936809237746
              le_mean =     -17.209726498015
             les_mean =     296.459502134539
             stat err =       0.000412593031
             autocorr =       1.240392818699
   target nu stat err =       0.000412593031
   target dn stat err =       0.002081809265
      target stat err =       0.003541256459
              std dev =       0.523919078145
             le_variance =       0.274491200445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720972649801e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+45, overlap shift 2.4414e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936821565593       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936821565593       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936821565593       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937500000000       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+45 is 4.675434e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+45, overlap shift 9.7656e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936821565593       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936821565593       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936821565593       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+45 is 9.387484e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+46, overlap shift 3.9063e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936821565593       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936821565593       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936821565593       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936821565593       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.26e+05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+46 is 3.476666e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.659045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5988e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1544
    reference variance = 0.182358
====================================================
  Execution time = 2.7576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8679e-01
  Total weights = 1.9663e+06
  Execution time = 2.3092e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371919771
  error estimate for blocks of size 2^( 2) =       0.000385796267
  error estimate for blocks of size 2^( 3) =       0.000398857789
  error estimate for blocks of size 2^( 4) =       0.000408479809
  error estimate for blocks of size 2^( 5) =       0.000413473726
  error estimate for blocks of size 2^( 6) =       0.000417381568
  error estimate for blocks of size 2^( 7) =       0.000419833661

      target function =      -0.933532452926
              le_mean =     -17.210033673753
             les_mean =     296.472045803736
             stat err =       0.000414792191
             autocorr =       1.243834539416
   target nu stat err =       0.000414792191
   target dn stat err =       0.002085068098
      target stat err =       0.003525186919
              std dev =       0.525982399403
             le_variance =       0.276657484482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371919771
  error estimate for blocks of size 2^( 2) =       0.000385796267
  error estimate for blocks of size 2^( 3) =       0.000398857789
  error estimate for blocks of size 2^( 4) =       0.000408479809
  error estimate for blocks of size 2^( 5) =       0.000413473726
  error estimate for blocks of size 2^( 6) =       0.000417381568
  error estimate for blocks of size 2^( 7) =       0.000419833661

      target function =      -0.933532452926
              le_mean =     -17.210033673753
             les_mean =     296.472045803736
             stat err =       0.000414792191
             autocorr =       1.243834539416
   target nu stat err =       0.000414792191
   target dn stat err =       0.002085068098
      target stat err =       0.003525186919
              std dev =       0.525982399403
             le_variance =       0.276657484482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371919771
  error estimate for blocks of size 2^( 2) =       0.000385796267
  error estimate for blocks of size 2^( 3) =       0.000398857789
  error estimate for blocks of size 2^( 4) =       0.000408479809
  error estimate for blocks of size 2^( 5) =       0.000413473726
  error estimate for blocks of size 2^( 6) =       0.000417381568
  error estimate for blocks of size 2^( 7) =       0.000419833661

      target function =      -0.933532452926
              le_mean =     -17.210033673753
             les_mean =     296.472045803736
             stat err =       0.000414792191
             autocorr =       1.243834539416
   target nu stat err =       0.000414792191
   target dn stat err =       0.002085068098
      target stat err =       0.003525186919
              std dev =       0.525982399403
             le_variance =       0.276657484482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276743089936
                                         uncertainty =       0.001606105155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371919771
  error estimate for blocks of size 2^( 2) =       0.000385796267
  error estimate for blocks of size 2^( 3) =       0.000398857789
  error estimate for blocks of size 2^( 4) =       0.000408479809
  error estimate for blocks of size 2^( 5) =       0.000413473726
  error estimate for blocks of size 2^( 6) =       0.000417381568
  error estimate for blocks of size 2^( 7) =       0.000419833661

      target function =      -0.933532452926
              le_mean =     -17.210033673753
             les_mean =     296.472045803736
             stat err =       0.000414792191
             autocorr =       1.243834539416
   target nu stat err =       0.000414792191
   target dn stat err =       0.002085068098
      target stat err =       0.003525186919
              std dev =       0.525982399403
             le_variance =       0.276657484482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933532452926        initial  <--
     2.4414e+45     2.4414e+46             4.6754e-50        -0.933532452926
     9.7656e+45     9.7656e+46             9.3875e-51        -0.933532452926
     3.9063e+46     3.9063e+47             3.4767e-51        -0.933532452926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2265
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.516179
====================================================
  Execution time = 2.7607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8863e-01
  Total weights = 1.966177653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3444e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277695898192
                                         uncertainty =       0.001787451169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277695898192
                                         uncertainty =       0.001787451169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372567301
  error estimate for blocks of size 2^( 2) =       0.000386753083
  error estimate for blocks of size 2^( 3) =       0.000399878296
  error estimate for blocks of size 2^( 4) =       0.000410029897
  error estimate for blocks of size 2^( 5) =       0.000416615663
  error estimate for blocks of size 2^( 6) =       0.000419272214
  error estimate for blocks of size 2^( 7) =       0.000420340928

      target function =      -0.930462525519
              le_mean =     -17.210755174535
             les_mean =     296.498724691894
             stat err =       0.000416564675
             autocorr =       1.250130663909
   target nu stat err =       0.000416564675
   target dn stat err =       0.002470448223
      target stat err =       0.004129971141
              std dev =       0.526898159507
             le_variance =       0.277621670492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721075517453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+46, overlap shift 2.4414e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+46, overlap shift 9.7656e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+47, overlap shift 3.9062e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930479679306       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.660331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5961e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.190853
====================================================
  Execution time = 2.7356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9210e-01
  Total weights = 1.9665e+06
  Execution time = 2.2986e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372643385
  error estimate for blocks of size 2^( 2) =       0.000386979128
  error estimate for blocks of size 2^( 3) =       0.000400547625
  error estimate for blocks of size 2^( 4) =       0.000409702057
  error estimate for blocks of size 2^( 5) =       0.000415681287
  error estimate for blocks of size 2^( 6) =       0.000419897347
  error estimate for blocks of size 2^( 7) =       0.000424137044

      target function =      -0.924758915478
              le_mean =     -17.210046418588
             les_mean =     296.477794146691
             stat err =       0.000417354434
             autocorr =       1.254362987408
   target nu stat err =       0.000417354434
   target dn stat err =       0.005537404351
      target stat err =       0.009015839043
              std dev =       0.527005761013
             le_variance =       0.277735072141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372643385
  error estimate for blocks of size 2^( 2) =       0.000386979128
  error estimate for blocks of size 2^( 3) =       0.000400547625
  error estimate for blocks of size 2^( 4) =       0.000409702057
  error estimate for blocks of size 2^( 5) =       0.000415681287
  error estimate for blocks of size 2^( 6) =       0.000419897347
  error estimate for blocks of size 2^( 7) =       0.000424137044

      target function =      -0.924758915478
              le_mean =     -17.210046418588
             les_mean =     296.477794146691
             stat err =       0.000417354434
             autocorr =       1.254362987408
   target nu stat err =       0.000417354434
   target dn stat err =       0.005537404351
      target stat err =       0.009015839043
              std dev =       0.527005761013
             le_variance =       0.277735072141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372643385
  error estimate for blocks of size 2^( 2) =       0.000386979128
  error estimate for blocks of size 2^( 3) =       0.000400547625
  error estimate for blocks of size 2^( 4) =       0.000409702057
  error estimate for blocks of size 2^( 5) =       0.000415681287
  error estimate for blocks of size 2^( 6) =       0.000419897347
  error estimate for blocks of size 2^( 7) =       0.000424137044

      target function =      -0.924758915478
              le_mean =     -17.210046418588
             les_mean =     296.477794146691
             stat err =       0.000417354434
             autocorr =       1.254362987408
   target nu stat err =       0.000417354434
   target dn stat err =       0.005537404351
      target stat err =       0.009015839043
              std dev =       0.527005761013
             le_variance =       0.277735072141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711414719
                                         uncertainty =       0.001621181395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372643385
  error estimate for blocks of size 2^( 2) =       0.000386979128
  error estimate for blocks of size 2^( 3) =       0.000400547625
  error estimate for blocks of size 2^( 4) =       0.000409702057
  error estimate for blocks of size 2^( 5) =       0.000415681287
  error estimate for blocks of size 2^( 6) =       0.000419897347
  error estimate for blocks of size 2^( 7) =       0.000424137044

      target function =      -0.924758915478
              le_mean =     -17.210046418588
             les_mean =     296.477794146691
             stat err =       0.000417354434
             autocorr =       1.254362987408
   target nu stat err =       0.000417354434
   target dn stat err =       0.005537404351
      target stat err =       0.009015839043
              std dev =       0.527005761013
             le_variance =       0.277735072141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924758915478        initial  <--
     2.4414e+46     2.4414e+47             0.0000e+00        -0.924758915478
     9.7656e+46     9.7656e+47             0.0000e+00        -0.924758915478
     3.9063e+47     3.9062e+48             0.0000e+00        -0.924758915478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9599
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1409
    reference variance = 0.343626
====================================================
  Execution time = 2.7496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0472e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8589e-01
  Total weights = 1.966158666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4157e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277417651737
                                         uncertainty =       0.001666573527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277417651737
                                         uncertainty =       0.001666573527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372445188
  error estimate for blocks of size 2^( 2) =       0.000386823151
  error estimate for blocks of size 2^( 3) =       0.000400374314
  error estimate for blocks of size 2^( 4) =       0.000409488225
  error estimate for blocks of size 2^( 5) =       0.000414250190
  error estimate for blocks of size 2^( 6) =       0.000417378094
  error estimate for blocks of size 2^( 7) =       0.000421226851

      target function =      -0.935018924004
              le_mean =     -17.210251869508
             les_mean =     296.478656790729
             stat err =       0.000415585840
             autocorr =       1.245078540040
   target nu stat err =       0.000415585840
   target dn stat err =       0.001856652627
      target stat err =       0.003168184627
              std dev =       0.526725463667
             le_variance =       0.277439714076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721025186951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+47, overlap shift 2.4414e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+47, overlap shift 9.7656e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+48, overlap shift 3.9062e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935028587974       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.661647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5920e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.144673
====================================================
  Execution time = 2.9390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8641e-01
  Total weights = 1.9663e+06
  Execution time = 2.2981e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372164104
  error estimate for blocks of size 2^( 2) =       0.000386480676
  error estimate for blocks of size 2^( 3) =       0.000400098787
  error estimate for blocks of size 2^( 4) =       0.000409849825
  error estimate for blocks of size 2^( 5) =       0.000415357619
  error estimate for blocks of size 2^( 6) =       0.000418721845
  error estimate for blocks of size 2^( 7) =       0.000419869551

      target function =      -0.934170887665
              le_mean =     -17.209411050054
             les_mean =     296.450235093945
             stat err =       0.000415949710
             autocorr =       1.249144520014
   target nu stat err =       0.000415949710
   target dn stat err =       0.002603068307
      target stat err =       0.004367677978
              std dev =       0.526327944369
             le_variance =       0.277021105024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372164104
  error estimate for blocks of size 2^( 2) =       0.000386480676
  error estimate for blocks of size 2^( 3) =       0.000400098787
  error estimate for blocks of size 2^( 4) =       0.000409849825
  error estimate for blocks of size 2^( 5) =       0.000415357619
  error estimate for blocks of size 2^( 6) =       0.000418721845
  error estimate for blocks of size 2^( 7) =       0.000419869551

      target function =      -0.934170887665
              le_mean =     -17.209411050054
             les_mean =     296.450235093945
             stat err =       0.000415949710
             autocorr =       1.249144520014
   target nu stat err =       0.000415949710
   target dn stat err =       0.002603068307
      target stat err =       0.004367677978
              std dev =       0.526327944369
             le_variance =       0.277021105024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372164104
  error estimate for blocks of size 2^( 2) =       0.000386480676
  error estimate for blocks of size 2^( 3) =       0.000400098787
  error estimate for blocks of size 2^( 4) =       0.000409849825
  error estimate for blocks of size 2^( 5) =       0.000415357619
  error estimate for blocks of size 2^( 6) =       0.000418721845
  error estimate for blocks of size 2^( 7) =       0.000419869551

      target function =      -0.934170887665
              le_mean =     -17.209411050054
             les_mean =     296.450235093945
             stat err =       0.000415949710
             autocorr =       1.249144520014
   target nu stat err =       0.000415949710
   target dn stat err =       0.002603068307
      target stat err =       0.004367677978
              std dev =       0.526327944369
             le_variance =       0.277021105024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276954120730
                                         uncertainty =       0.001928071679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372164104
  error estimate for blocks of size 2^( 2) =       0.000386480676
  error estimate for blocks of size 2^( 3) =       0.000400098787
  error estimate for blocks of size 2^( 4) =       0.000409849825
  error estimate for blocks of size 2^( 5) =       0.000415357619
  error estimate for blocks of size 2^( 6) =       0.000418721845
  error estimate for blocks of size 2^( 7) =       0.000419869551

      target function =      -0.934170887665
              le_mean =     -17.209411050054
             les_mean =     296.450235093945
             stat err =       0.000415949710
             autocorr =       1.249144520014
   target nu stat err =       0.000415949710
   target dn stat err =       0.002603068307
      target stat err =       0.004367677978
              std dev =       0.526327944369
             le_variance =       0.277021105024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934170887665        initial  <--
     2.4414e+47     2.4414e+48             0.0000e+00        -0.934170887665
     9.7656e+47     9.7656e+48             0.0000e+00        -0.934170887665
     3.9062e+48     3.9062e+49             0.0000e+00        -0.934170887665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9983
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1658
    reference variance = 0.123207
====================================================
  Execution time = 2.7427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8923e-01
  Total weights = 1.966467509e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4692e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278660348190
                                         uncertainty =       0.001743080335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278660348190
                                         uncertainty =       0.001743080335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373213618
  error estimate for blocks of size 2^( 2) =       0.000387758107
  error estimate for blocks of size 2^( 3) =       0.000400952086
  error estimate for blocks of size 2^( 4) =       0.000410746442
  error estimate for blocks of size 2^( 5) =       0.000416963526
  error estimate for blocks of size 2^( 6) =       0.000420197809
  error estimate for blocks of size 2^( 7) =       0.000422882757

      target function =      -0.929498672147
              le_mean =     -17.209952296057
             les_mean =     296.471689142747
             stat err =       0.000417697633
             autocorr =       1.252590359181
   target nu stat err =       0.000417697633
   target dn stat err =       0.002947884386
      target stat err =       0.004887587688
              std dev =       0.527812205015
             le_variance =       0.278585723763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720995229606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+48, overlap shift 2.4414e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929523064312       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929523064312       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929523064312       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929523064312       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+48 is 5.702452e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+48, overlap shift 9.7656e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929523064312       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929523064312       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.000000000000       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+48 is 1.039214e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+49, overlap shift 3.9062e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929523064312       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929523064312       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929523064312       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929523064312       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929523064311       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+49 is 3.529568e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.663647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5906e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.236613
====================================================
  Execution time = 2.7246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8574e-01
  Total weights = 1.9663e+06
  Execution time = 2.2927e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372504790
  error estimate for blocks of size 2^( 2) =       0.000386696547
  error estimate for blocks of size 2^( 3) =       0.000400107197
  error estimate for blocks of size 2^( 4) =       0.000410700326
  error estimate for blocks of size 2^( 5) =       0.000415560174
  error estimate for blocks of size 2^( 6) =       0.000418680351
  error estimate for blocks of size 2^( 7) =       0.000421737591

      target function =      -0.935292430535
              le_mean =     -17.209130856152
             les_mean =     296.439921016875
             stat err =       0.000416669610
             autocorr =       1.251180390052
   target nu stat err =       0.000416669610
   target dn stat err =       0.002218752643
      target stat err =       0.003749757866
              std dev =       0.526809755317
             le_variance =       0.277528518297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372504790
  error estimate for blocks of size 2^( 2) =       0.000386696547
  error estimate for blocks of size 2^( 3) =       0.000400107197
  error estimate for blocks of size 2^( 4) =       0.000410700326
  error estimate for blocks of size 2^( 5) =       0.000415560174
  error estimate for blocks of size 2^( 6) =       0.000418680351
  error estimate for blocks of size 2^( 7) =       0.000421737591

      target function =      -0.935292430535
              le_mean =     -17.209130856152
             les_mean =     296.439921016875
             stat err =       0.000416669610
             autocorr =       1.251180390054
   target nu stat err =       0.000416669610
   target dn stat err =       0.002218752643
      target stat err =       0.003749757866
              std dev =       0.526809755317
             le_variance =       0.277528518297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372504790
  error estimate for blocks of size 2^( 2) =       0.000386696547
  error estimate for blocks of size 2^( 3) =       0.000400107197
  error estimate for blocks of size 2^( 4) =       0.000410700326
  error estimate for blocks of size 2^( 5) =       0.000415560174
  error estimate for blocks of size 2^( 6) =       0.000418680351
  error estimate for blocks of size 2^( 7) =       0.000421737591

      target function =      -0.935292430535
              le_mean =     -17.209130856152
             les_mean =     296.439921016875
             stat err =       0.000416669610
             autocorr =       1.251180390054
   target nu stat err =       0.000416669610
   target dn stat err =       0.002218752643
      target stat err =       0.003749757866
              std dev =       0.526809755317
             le_variance =       0.277528518297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277575647265
                                         uncertainty =       0.001630442990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372504790
  error estimate for blocks of size 2^( 2) =       0.000386696547
  error estimate for blocks of size 2^( 3) =       0.000400107197
  error estimate for blocks of size 2^( 4) =       0.000410700326
  error estimate for blocks of size 2^( 5) =       0.000415560174
  error estimate for blocks of size 2^( 6) =       0.000418680351
  error estimate for blocks of size 2^( 7) =       0.000421737591

      target function =      -0.935292430535
              le_mean =     -17.209130856152
             les_mean =     296.439921016875
             stat err =       0.000416669610
             autocorr =       1.251180390054
   target nu stat err =       0.000416669610
   target dn stat err =       0.002218752643
      target stat err =       0.003749757866
              std dev =       0.526809755317
             le_variance =       0.277528518297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935292430535        initial  <--
     2.4414e+48     2.4414e+49             5.7025e-53        -0.935292430535
     9.7656e+48     9.7656e+49             1.0392e-53        -0.935292430535
     3.9062e+49     3.9062e+50             3.5296e-54        -0.935292430535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8156
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.245636
====================================================
  Execution time = 2.7528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0501e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9162e-01
  Total weights = 1.966532599e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4668e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280168588641
                                         uncertainty =       0.002308447491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280168588641
                                         uncertainty =       0.002308447491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374330889
  error estimate for blocks of size 2^( 2) =       0.000388795295
  error estimate for blocks of size 2^( 3) =       0.000401777014
  error estimate for blocks of size 2^( 4) =       0.000411531147
  error estimate for blocks of size 2^( 5) =       0.000417691229
  error estimate for blocks of size 2^( 6) =       0.000419811860
  error estimate for blocks of size 2^( 7) =       0.000423135875

      target function =      -0.925604520684
              le_mean =     -17.209521601959
             les_mean =     296.459251660815
             stat err =       0.000418042527
             autocorr =       1.247181321627
   target nu stat err =       0.000418042527
   target dn stat err =       0.003805676503
      target stat err =       0.006224019195
              std dev =       0.529392290197
             le_variance =       0.280256196920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720952160196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+49, overlap shift 2.4414e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925645223734       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925645223734       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+49 is 9.897457e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+49, overlap shift 9.7656e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925645223734       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925645223734       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.54e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+49 is 2.474364e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+50, overlap shift 3.9063e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925645223734       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925645223734       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925645223734       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925645223734       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.68e+05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.32e+15           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+50 is 4.988450e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.665683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6004e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.0548
    reference variance = 0.330222
====================================================
  Execution time = 2.7405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8400e-01
  Total weights = 1.9664e+06
  Execution time = 2.2993e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212155
  error estimate for blocks of size 2^( 2) =       0.000385830293
  error estimate for blocks of size 2^( 3) =       0.000399451039
  error estimate for blocks of size 2^( 4) =       0.000409858416
  error estimate for blocks of size 2^( 5) =       0.000415682154
  error estimate for blocks of size 2^( 6) =       0.000419087224
  error estimate for blocks of size 2^( 7) =       0.000424795266

      target function =      -0.938170748943
              le_mean =     -17.209878061449
             les_mean =     296.463899650399
             stat err =       0.000417355765
             autocorr =       1.264062233368
   target nu stat err =       0.000417355765
   target dn stat err =       0.002145624527
      target stat err =       0.003658380103
              std dev =       0.524981664098
             le_variance =       0.275605747639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212155
  error estimate for blocks of size 2^( 2) =       0.000385830293
  error estimate for blocks of size 2^( 3) =       0.000399451039
  error estimate for blocks of size 2^( 4) =       0.000409858416
  error estimate for blocks of size 2^( 5) =       0.000415682154
  error estimate for blocks of size 2^( 6) =       0.000419087224
  error estimate for blocks of size 2^( 7) =       0.000424795266

      target function =      -0.938170748943
              le_mean =     -17.209878061449
             les_mean =     296.463899650399
             stat err =       0.000417355765
             autocorr =       1.264062233368
   target nu stat err =       0.000417355765
   target dn stat err =       0.002145624527
      target stat err =       0.003658380103
              std dev =       0.524981664098
             le_variance =       0.275605747639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212155
  error estimate for blocks of size 2^( 2) =       0.000385830293
  error estimate for blocks of size 2^( 3) =       0.000399451039
  error estimate for blocks of size 2^( 4) =       0.000409858416
  error estimate for blocks of size 2^( 5) =       0.000415682154
  error estimate for blocks of size 2^( 6) =       0.000419087224
  error estimate for blocks of size 2^( 7) =       0.000424795266

      target function =      -0.938170748943
              le_mean =     -17.209878061449
             les_mean =     296.463899650399
             stat err =       0.000417355765
             autocorr =       1.264062233368
   target nu stat err =       0.000417355765
   target dn stat err =       0.002145624527
      target stat err =       0.003658380103
              std dev =       0.524981664098
             le_variance =       0.275605747639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275568655283
                                         uncertainty =       0.001736370982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371212155
  error estimate for blocks of size 2^( 2) =       0.000385830293
  error estimate for blocks of size 2^( 3) =       0.000399451039
  error estimate for blocks of size 2^( 4) =       0.000409858416
  error estimate for blocks of size 2^( 5) =       0.000415682154
  error estimate for blocks of size 2^( 6) =       0.000419087224
  error estimate for blocks of size 2^( 7) =       0.000424795266

      target function =      -0.938170748943
              le_mean =     -17.209878061449
             les_mean =     296.463899650399
             stat err =       0.000417355765
             autocorr =       1.264062233368
   target nu stat err =       0.000417355765
   target dn stat err =       0.002145624527
      target stat err =       0.003658380103
              std dev =       0.524981664098
             le_variance =       0.275605747639


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938170748943        initial  <--
     2.4414e+49     2.4414e+50             9.8975e-54        -0.938170748943
     9.7656e+49     9.7656e+50             2.4744e-54        -0.938170748943
     3.9062e+50     3.9063e+51             4.9885e-55        -0.938170748943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0102
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1455
    reference variance = 0.223552
====================================================
  Execution time = 2.7468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8772e-01
  Total weights = 1.966714899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5024e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277733781230
                                         uncertainty =       0.001512853156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277733781230
                                         uncertainty =       0.001512853156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372628197
  error estimate for blocks of size 2^( 2) =       0.000386601927
  error estimate for blocks of size 2^( 3) =       0.000400115972
  error estimate for blocks of size 2^( 4) =       0.000409465196
  error estimate for blocks of size 2^( 5) =       0.000416008953
  error estimate for blocks of size 2^( 6) =       0.000419470726
  error estimate for blocks of size 2^( 7) =       0.000420856056

      target function =      -0.931983722612
              le_mean =     -17.209925015729
             les_mean =     296.469243054507
             stat err =       0.000416450233
             autocorr =       1.249035520401
   target nu stat err =       0.000416450233
   target dn stat err =       0.002446680340
      target stat err =       0.004098177912
              std dev =       0.526984280791
             le_variance =       0.277712432201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720992501573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+50, overlap shift 2.4414e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932000790292       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932000790292       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932000790292       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+50 is 4.628100e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+50, overlap shift 9.7656e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932000790292       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932000790292       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932000790292       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+50 is 1.157025e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+51, overlap shift 3.9063e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932000790292       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932000790292       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932000790292       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+51 is 2.892562e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.667335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5980e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.133459
====================================================
  Execution time = 2.7333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8163e-01
  Total weights = 1.9665e+06
  Execution time = 2.3013e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369704777
  error estimate for blocks of size 2^( 2) =       0.000383936386
  error estimate for blocks of size 2^( 3) =       0.000397181686
  error estimate for blocks of size 2^( 4) =       0.000407576355
  error estimate for blocks of size 2^( 5) =       0.000413486246
  error estimate for blocks of size 2^( 6) =       0.000416935510
  error estimate for blocks of size 2^( 7) =       0.000419609370

      target function =      -0.942152340430
              le_mean =     -17.208804723480
             les_mean =     296.424587416389
             stat err =       0.000414401870
             autocorr =       1.256415508657
   target nu stat err =       0.000414401870
   target dn stat err =       0.002280220873
      target stat err =       0.003902128139
              std dev =       0.522849875558
             le_variance =       0.273371992371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369704777
  error estimate for blocks of size 2^( 2) =       0.000383936386
  error estimate for blocks of size 2^( 3) =       0.000397181686
  error estimate for blocks of size 2^( 4) =       0.000407576355
  error estimate for blocks of size 2^( 5) =       0.000413486246
  error estimate for blocks of size 2^( 6) =       0.000416935510
  error estimate for blocks of size 2^( 7) =       0.000419609370

      target function =      -0.942152340430
              le_mean =     -17.208804723480
             les_mean =     296.424587416389
             stat err =       0.000414401870
             autocorr =       1.256415508658
   target nu stat err =       0.000414401870
   target dn stat err =       0.002280220873
      target stat err =       0.003902128139
              std dev =       0.522849875558
             le_variance =       0.273371992371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369704777
  error estimate for blocks of size 2^( 2) =       0.000383936386
  error estimate for blocks of size 2^( 3) =       0.000397181686
  error estimate for blocks of size 2^( 4) =       0.000407576355
  error estimate for blocks of size 2^( 5) =       0.000413486246
  error estimate for blocks of size 2^( 6) =       0.000416935510
  error estimate for blocks of size 2^( 7) =       0.000419609370

      target function =      -0.942152340430
              le_mean =     -17.208804723480
             les_mean =     296.424587416389
             stat err =       0.000414401870
             autocorr =       1.256415508658
   target nu stat err =       0.000414401870
   target dn stat err =       0.002280220873
      target stat err =       0.003902128139
              std dev =       0.522849875558
             le_variance =       0.273371992371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379573356
                                         uncertainty =       0.001832602383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369704777
  error estimate for blocks of size 2^( 2) =       0.000383936386
  error estimate for blocks of size 2^( 3) =       0.000397181686
  error estimate for blocks of size 2^( 4) =       0.000407576355
  error estimate for blocks of size 2^( 5) =       0.000413486246
  error estimate for blocks of size 2^( 6) =       0.000416935510
  error estimate for blocks of size 2^( 7) =       0.000419609370

      target function =      -0.942152340430
              le_mean =     -17.208804723480
             les_mean =     296.424587416389
             stat err =       0.000414401870
             autocorr =       1.256415508658
   target nu stat err =       0.000414401870
   target dn stat err =       0.002280220873
      target stat err =       0.003902128139
              std dev =       0.522849875558
             le_variance =       0.273371992371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942152340430        initial  <--
     2.4414e+50     2.4414e+51             4.6281e-55        -0.942152340430
     9.7656e+50     9.7656e+51             1.1570e-55        -0.942152340430
     3.9063e+51     3.9063e+52             2.8926e-56        -0.942152340430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9398
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2632
    reference variance = 0.224905
====================================================
  Execution time = 2.7856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9110e-01
  Total weights = 1.966212377e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4083e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806387823
                                         uncertainty =       0.002999173816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806387823
                                         uncertainty =       0.002999173816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375388019
  error estimate for blocks of size 2^( 2) =       0.000389537359
  error estimate for blocks of size 2^( 3) =       0.000402336434
  error estimate for blocks of size 2^( 4) =       0.000411906141
  error estimate for blocks of size 2^( 5) =       0.000417226002
  error estimate for blocks of size 2^( 6) =       0.000419876588
  error estimate for blocks of size 2^( 7) =       0.000421081195

      target function =      -0.926484369276
              le_mean =     -17.208659533316
             les_mean =     296.429064372204
             stat err =       0.000417522481
             autocorr =       1.237083217563
   target nu stat err =       0.000417522481
   target dn stat err =       0.003418044503
      target stat err =       0.005600601473
              std dev =       0.530887321585
             le_variance =       0.281841348219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720865953332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+51, overlap shift 2.4414e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+51, overlap shift 9.7656e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+52, overlap shift 3.9063e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926517512771       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.668650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6273e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.125526
====================================================
  Execution time = 2.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8450e-01
  Total weights = 1.9665e+06
  Execution time = 2.2991e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264024
  error estimate for blocks of size 2^( 2) =       0.000385710202
  error estimate for blocks of size 2^( 3) =       0.000399048500
  error estimate for blocks of size 2^( 4) =       0.000408543643
  error estimate for blocks of size 2^( 5) =       0.000414639930
  error estimate for blocks of size 2^( 6) =       0.000418183094
  error estimate for blocks of size 2^( 7) =       0.000420857122

      target function =      -0.937332933216
              le_mean =     -17.210085279758
             les_mean =     296.471533426403
             stat err =       0.000415555947
             autocorr =       1.252833246804
   target nu stat err =       0.000415555947
   target dn stat err =       0.001931040164
      target stat err =       0.003303197639
              std dev =       0.525055018077
             le_variance =       0.275682772008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264024
  error estimate for blocks of size 2^( 2) =       0.000385710202
  error estimate for blocks of size 2^( 3) =       0.000399048500
  error estimate for blocks of size 2^( 4) =       0.000408543643
  error estimate for blocks of size 2^( 5) =       0.000414639930
  error estimate for blocks of size 2^( 6) =       0.000418183094
  error estimate for blocks of size 2^( 7) =       0.000420857122

      target function =      -0.937332933216
              le_mean =     -17.210085279758
             les_mean =     296.471533426403
             stat err =       0.000415555947
             autocorr =       1.252833246800
   target nu stat err =       0.000415555947
   target dn stat err =       0.001931040164
      target stat err =       0.003303197639
              std dev =       0.525055018077
             le_variance =       0.275682772008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264024
  error estimate for blocks of size 2^( 2) =       0.000385710202
  error estimate for blocks of size 2^( 3) =       0.000399048500
  error estimate for blocks of size 2^( 4) =       0.000408543643
  error estimate for blocks of size 2^( 5) =       0.000414639930
  error estimate for blocks of size 2^( 6) =       0.000418183094
  error estimate for blocks of size 2^( 7) =       0.000420857122

      target function =      -0.937332933216
              le_mean =     -17.210085279758
             les_mean =     296.471533426403
             stat err =       0.000415555947
             autocorr =       1.252833246800
   target nu stat err =       0.000415555947
   target dn stat err =       0.001931040164
      target stat err =       0.003303197639
              std dev =       0.525055018077
             le_variance =       0.275682772008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275643147776
                                         uncertainty =       0.001384580086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264024
  error estimate for blocks of size 2^( 2) =       0.000385710202
  error estimate for blocks of size 2^( 3) =       0.000399048500
  error estimate for blocks of size 2^( 4) =       0.000408543643
  error estimate for blocks of size 2^( 5) =       0.000414639930
  error estimate for blocks of size 2^( 6) =       0.000418183094
  error estimate for blocks of size 2^( 7) =       0.000420857122

      target function =      -0.937332933216
              le_mean =     -17.210085279758
             les_mean =     296.471533426403
             stat err =       0.000415555947
             autocorr =       1.252833246800
   target nu stat err =       0.000415555947
   target dn stat err =       0.001931040164
      target stat err =       0.003303197639
              std dev =       0.525055018077
             le_variance =       0.275682772008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937332933216        initial  <--
     2.4414e+51     2.4414e+52             0.0000e+00        -0.937332933216
     9.7656e+51     9.7656e+52             0.0000e+00        -0.937332933216
     3.9063e+52     3.9063e+53             0.0000e+00        -0.937332933216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.4134
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1738
    reference variance = 0.399231
====================================================
  Execution time = 2.7477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8682e-01
  Total weights = 1.966454465e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2630e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276594725792
                                         uncertainty =       0.001718903065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276594725792
                                         uncertainty =       0.001718903065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371877408
  error estimate for blocks of size 2^( 2) =       0.000386419676
  error estimate for blocks of size 2^( 3) =       0.000399659066
  error estimate for blocks of size 2^( 4) =       0.000408952900
  error estimate for blocks of size 2^( 5) =       0.000414620771
  error estimate for blocks of size 2^( 6) =       0.000417985848
  error estimate for blocks of size 2^( 7) =       0.000421212383

      target function =      -0.933489064646
              le_mean =     -17.209506598135
             les_mean =     296.453933205033
             stat err =       0.000415692975
             autocorr =       1.249527389241
   target nu stat err =       0.000415692975
   target dn stat err =       0.002770750494
      target stat err =       0.004635361610
              std dev =       0.525922488695
             le_variance =       0.276594464115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720950659814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+52, overlap shift 2.4414e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+52, overlap shift 9.7656e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+53, overlap shift 3.9063e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933511041856       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.669937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5749e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2338
    reference variance = 0.301359
====================================================
  Execution time = 2.7419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8808e-01
  Total weights = 1.9663e+06
  Execution time = 2.2970e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848278
  error estimate for blocks of size 2^( 2) =       0.000386173922
  error estimate for blocks of size 2^( 3) =       0.000399508299
  error estimate for blocks of size 2^( 4) =       0.000409303775
  error estimate for blocks of size 2^( 5) =       0.000415346978
  error estimate for blocks of size 2^( 6) =       0.000418901831
  error estimate for blocks of size 2^( 7) =       0.000421682027

      target function =      -0.931383879399
              le_mean =     -17.209613051871
             les_mean =     296.458863772422
             stat err =       0.000416308653
             autocorr =       1.253427805587
   target nu stat err =       0.000416308653
   target dn stat err =       0.003582610835
      target stat err =       0.005937935944
              std dev =       0.525881292473
             le_variance =       0.276551133773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848278
  error estimate for blocks of size 2^( 2) =       0.000386173922
  error estimate for blocks of size 2^( 3) =       0.000399508299
  error estimate for blocks of size 2^( 4) =       0.000409303775
  error estimate for blocks of size 2^( 5) =       0.000415346978
  error estimate for blocks of size 2^( 6) =       0.000418901831
  error estimate for blocks of size 2^( 7) =       0.000421682027

      target function =      -0.931383879399
              le_mean =     -17.209613051871
             les_mean =     296.458863772422
             stat err =       0.000416308653
             autocorr =       1.253427805587
   target nu stat err =       0.000416308653
   target dn stat err =       0.003582610835
      target stat err =       0.005937935944
              std dev =       0.525881292473
             le_variance =       0.276551133773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848278
  error estimate for blocks of size 2^( 2) =       0.000386173922
  error estimate for blocks of size 2^( 3) =       0.000399508299
  error estimate for blocks of size 2^( 4) =       0.000409303775
  error estimate for blocks of size 2^( 5) =       0.000415346978
  error estimate for blocks of size 2^( 6) =       0.000418901831
  error estimate for blocks of size 2^( 7) =       0.000421682027

      target function =      -0.931383879399
              le_mean =     -17.209613051871
             les_mean =     296.458863772422
             stat err =       0.000416308653
             autocorr =       1.253427805587
   target nu stat err =       0.000416308653
   target dn stat err =       0.003582610835
      target stat err =       0.005937935944
              std dev =       0.525881292473
             le_variance =       0.276551133773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584102185
                                         uncertainty =       0.001564890170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848278
  error estimate for blocks of size 2^( 2) =       0.000386173922
  error estimate for blocks of size 2^( 3) =       0.000399508299
  error estimate for blocks of size 2^( 4) =       0.000409303775
  error estimate for blocks of size 2^( 5) =       0.000415346978
  error estimate for blocks of size 2^( 6) =       0.000418901831
  error estimate for blocks of size 2^( 7) =       0.000421682027

      target function =      -0.931383879399
              le_mean =     -17.209613051871
             les_mean =     296.458863772422
             stat err =       0.000416308653
             autocorr =       1.253427805587
   target nu stat err =       0.000416308653
   target dn stat err =       0.003582610835
      target stat err =       0.005937935944
              std dev =       0.525881292473
             le_variance =       0.276551133773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931383879399        initial  <--
     2.4414e+52     2.4414e+53             0.0000e+00        -0.931383879399
     9.7656e+52     9.7656e+53             0.0000e+00        -0.931383879399
     3.9063e+53     3.9063e+54             0.0000e+00        -0.931383879399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0147
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.32251
====================================================
  Execution time = 2.7277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0472e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8752e-01
  Total weights = 1.966542149e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4599e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276243486318
                                         uncertainty =       0.001787144171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276243486318
                                         uncertainty =       0.001787144171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371646534
  error estimate for blocks of size 2^( 2) =       0.000386211216
  error estimate for blocks of size 2^( 3) =       0.000399795010
  error estimate for blocks of size 2^( 4) =       0.000408999466
  error estimate for blocks of size 2^( 5) =       0.000414258610
  error estimate for blocks of size 2^( 6) =       0.000416843272
  error estimate for blocks of size 2^( 7) =       0.000417548375

      target function =      -0.932307950561
              le_mean =     -17.209862785143
             les_mean =     296.466896262856
             stat err =       0.000414412431
             autocorr =       1.243384285564
   target nu stat err =       0.000414412431
   target dn stat err =       0.003355464708
      target stat err =       0.005580551344
              std dev =       0.525595978049
             le_variance =       0.276251132141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720986278514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+53, overlap shift 2.4414e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+53, overlap shift 9.7656e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+54, overlap shift 3.9063e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932340289545       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.671217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5746e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2007
    reference variance = 0.284617
====================================================
  Execution time = 2.7421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8680e-01
  Total weights = 1.9663e+06
  Execution time = 2.3006e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372907738
  error estimate for blocks of size 2^( 2) =       0.000387170081
  error estimate for blocks of size 2^( 3) =       0.000400808365
  error estimate for blocks of size 2^( 4) =       0.000410350267
  error estimate for blocks of size 2^( 5) =       0.000415491951
  error estimate for blocks of size 2^( 6) =       0.000418501042
  error estimate for blocks of size 2^( 7) =       0.000419757990

      target function =      -0.933526707760
              le_mean =     -17.208988401223
             les_mean =     296.436081295078
             stat err =       0.000416025312
             autocorr =       1.244619844475
   target nu stat err =       0.000416025312
   target dn stat err =       0.002930362430
      target stat err =       0.004891529500
              std dev =       0.527379618030
             le_variance =       0.278129261514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372907738
  error estimate for blocks of size 2^( 2) =       0.000387170081
  error estimate for blocks of size 2^( 3) =       0.000400808365
  error estimate for blocks of size 2^( 4) =       0.000410350267
  error estimate for blocks of size 2^( 5) =       0.000415491951
  error estimate for blocks of size 2^( 6) =       0.000418501042
  error estimate for blocks of size 2^( 7) =       0.000419757990

      target function =      -0.933526707760
              le_mean =     -17.208988401223
             les_mean =     296.436081295078
             stat err =       0.000416025312
             autocorr =       1.244619844473
   target nu stat err =       0.000416025312
   target dn stat err =       0.002930362430
      target stat err =       0.004891529500
              std dev =       0.527379618030
             le_variance =       0.278129261514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372907738
  error estimate for blocks of size 2^( 2) =       0.000387170081
  error estimate for blocks of size 2^( 3) =       0.000400808365
  error estimate for blocks of size 2^( 4) =       0.000410350267
  error estimate for blocks of size 2^( 5) =       0.000415491951
  error estimate for blocks of size 2^( 6) =       0.000418501042
  error estimate for blocks of size 2^( 7) =       0.000419757990

      target function =      -0.933526707760
              le_mean =     -17.208988401223
             les_mean =     296.436081295078
             stat err =       0.000416025312
             autocorr =       1.244619844473
   target nu stat err =       0.000416025312
   target dn stat err =       0.002930362430
      target stat err =       0.004891529500
              std dev =       0.527379618030
             le_variance =       0.278129261514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200977514
                                         uncertainty =       0.002634004700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372907738
  error estimate for blocks of size 2^( 2) =       0.000387170081
  error estimate for blocks of size 2^( 3) =       0.000400808365
  error estimate for blocks of size 2^( 4) =       0.000410350267
  error estimate for blocks of size 2^( 5) =       0.000415491951
  error estimate for blocks of size 2^( 6) =       0.000418501042
  error estimate for blocks of size 2^( 7) =       0.000419757990

      target function =      -0.933526707760
              le_mean =     -17.208988401223
             les_mean =     296.436081295078
             stat err =       0.000416025312
             autocorr =       1.244619844473
   target nu stat err =       0.000416025312
   target dn stat err =       0.002930362430
      target stat err =       0.004891529500
              std dev =       0.527379618030
             le_variance =       0.278129261514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933526707760        initial  <--
     2.4414e+53     2.4414e+54             0.0000e+00        -0.933526707760
     9.7656e+53     9.7656e+54             0.0000e+00        -0.933526707760
     3.9063e+54     3.9063e+55             0.0000e+00        -0.933526707760

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0254
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.167299
====================================================
  Execution time = 2.7330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0519e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8514e-01
  Total weights = 1.966543794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2968e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277283195673
                                         uncertainty =       0.001517222175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277283195673
                                         uncertainty =       0.001517222175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372511872
  error estimate for blocks of size 2^( 2) =       0.000386850392
  error estimate for blocks of size 2^( 3) =       0.000400192018
  error estimate for blocks of size 2^( 4) =       0.000409398432
  error estimate for blocks of size 2^( 5) =       0.000415355773
  error estimate for blocks of size 2^( 6) =       0.000418548355
  error estimate for blocks of size 2^( 7) =       0.000418533909

      target function =      -0.936252465193
              le_mean =     -17.210186336677
             les_mean =     296.475658369564
             stat err =       0.000415459117
             autocorr =       1.243873892799
   target nu stat err =       0.000415459117
   target dn stat err =       0.002031378721
      target stat err =       0.003459269293
              std dev =       0.526819769881
             le_variance =       0.277539069937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721018633668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+54, overlap shift 2.4414e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+54, overlap shift 9.7656e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+55, overlap shift 3.9063e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936264397459       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.672509 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5636e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2423
    reference variance = 0.156749
====================================================
  Execution time = 2.7405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8554e-01
  Total weights = 1.9664e+06
  Execution time = 2.3005e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954309
  error estimate for blocks of size 2^( 2) =       0.000386039523
  error estimate for blocks of size 2^( 3) =       0.000399428794
  error estimate for blocks of size 2^( 4) =       0.000408947397
  error estimate for blocks of size 2^( 5) =       0.000414692513
  error estimate for blocks of size 2^( 6) =       0.000417635994
  error estimate for blocks of size 2^( 7) =       0.000420336039

      target function =      -0.935616609329
              le_mean =     -17.209075047996
             les_mean =     296.437805314447
             stat err =       0.000415402986
             autocorr =       1.247268742798
   target nu stat err =       0.000415402986
   target dn stat err =       0.002222644578
      target stat err =       0.003757797185
              std dev =       0.526031244662
             le_variance =       0.276708870361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954309
  error estimate for blocks of size 2^( 2) =       0.000386039523
  error estimate for blocks of size 2^( 3) =       0.000399428794
  error estimate for blocks of size 2^( 4) =       0.000408947397
  error estimate for blocks of size 2^( 5) =       0.000414692513
  error estimate for blocks of size 2^( 6) =       0.000417635994
  error estimate for blocks of size 2^( 7) =       0.000420336039

      target function =      -0.935616609329
              le_mean =     -17.209075047996
             les_mean =     296.437805314447
             stat err =       0.000415402986
             autocorr =       1.247268742796
   target nu stat err =       0.000415402986
   target dn stat err =       0.002222644578
      target stat err =       0.003757797185
              std dev =       0.526031244662
             le_variance =       0.276708870361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954309
  error estimate for blocks of size 2^( 2) =       0.000386039523
  error estimate for blocks of size 2^( 3) =       0.000399428794
  error estimate for blocks of size 2^( 4) =       0.000408947397
  error estimate for blocks of size 2^( 5) =       0.000414692513
  error estimate for blocks of size 2^( 6) =       0.000417635994
  error estimate for blocks of size 2^( 7) =       0.000420336039

      target function =      -0.935616609329
              le_mean =     -17.209075047996
             les_mean =     296.437805314447
             stat err =       0.000415402986
             autocorr =       1.247268742796
   target nu stat err =       0.000415402986
   target dn stat err =       0.002222644578
      target stat err =       0.003757797185
              std dev =       0.526031244662
             le_variance =       0.276708870361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276490680611
                                         uncertainty =       0.001681746626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371954309
  error estimate for blocks of size 2^( 2) =       0.000386039523
  error estimate for blocks of size 2^( 3) =       0.000399428794
  error estimate for blocks of size 2^( 4) =       0.000408947397
  error estimate for blocks of size 2^( 5) =       0.000414692513
  error estimate for blocks of size 2^( 6) =       0.000417635994
  error estimate for blocks of size 2^( 7) =       0.000420336039

      target function =      -0.935616609329
              le_mean =     -17.209075047996
             les_mean =     296.437805314447
             stat err =       0.000415402986
             autocorr =       1.247268742796
   target nu stat err =       0.000415402986
   target dn stat err =       0.002222644578
      target stat err =       0.003757797185
              std dev =       0.526031244662
             le_variance =       0.276708870361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935616609329        initial  <--
     2.4414e+54     2.4414e+55             0.0000e+00        -0.935616609329
     9.7656e+54     9.7656e+55             0.0000e+00        -0.935616609329
     3.9063e+55     3.9063e+56             0.0000e+00        -0.935616609329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9919
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1822
    reference variance = 0.174701
====================================================
  Execution time = 2.7491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8140e-01
  Total weights = 1.966435627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8458e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273859080483
                                         uncertainty =       0.001741750136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273859080483
                                         uncertainty =       0.001741750136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370105036
  error estimate for blocks of size 2^( 2) =       0.000384664221
  error estimate for blocks of size 2^( 3) =       0.000397819732
  error estimate for blocks of size 2^( 4) =       0.000407533987
  error estimate for blocks of size 2^( 5) =       0.000413258720
  error estimate for blocks of size 2^( 6) =       0.000416406360
  error estimate for blocks of size 2^( 7) =       0.000417644465

      target function =      -0.942528941693
              le_mean =     -17.209155607475
             les_mean =     296.436440130990
             stat err =       0.000413710883
             autocorr =       1.249521983624
   target nu stat err =       0.000413710883
   target dn stat err =       0.002036972602
      target stat err =       0.003506444009
              std dev =       0.523415935809
             le_variance =       0.273964241859


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720915560747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+55, overlap shift 2.4414e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+55, overlap shift 9.7656e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+56, overlap shift 3.9063e+57 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541033702       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.673866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8888e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2427
    reference variance = 0.286755
====================================================
  Execution time = 2.7961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9126e-01
  Total weights = 1.9665e+06
  Execution time = 2.3176e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374736612
  error estimate for blocks of size 2^( 2) =       0.000389049405
  error estimate for blocks of size 2^( 3) =       0.000401722269
  error estimate for blocks of size 2^( 4) =       0.000412340558
  error estimate for blocks of size 2^( 5) =       0.000419099879
  error estimate for blocks of size 2^( 6) =       0.000421655550
  error estimate for blocks of size 2^( 7) =       0.000423326812

      target function =      -0.926175980228
              le_mean =     -17.210132772797
             les_mean =     296.479930188397
             stat err =       0.000419105700
             autocorr =       1.250820185856
   target nu stat err =       0.000419105700
   target dn stat err =       0.003012838459
      target stat err =       0.004959688863
              std dev =       0.529966078886
             le_variance =       0.280864044770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374736612
  error estimate for blocks of size 2^( 2) =       0.000389049405
  error estimate for blocks of size 2^( 3) =       0.000401722269
  error estimate for blocks of size 2^( 4) =       0.000412340558
  error estimate for blocks of size 2^( 5) =       0.000419099879
  error estimate for blocks of size 2^( 6) =       0.000421655550
  error estimate for blocks of size 2^( 7) =       0.000423326812

      target function =      -0.926175980228
              le_mean =     -17.210132772797
             les_mean =     296.479930188397
             stat err =       0.000419105700
             autocorr =       1.250820185856
   target nu stat err =       0.000419105700
   target dn stat err =       0.003012838459
      target stat err =       0.004959688863
              std dev =       0.529966078886
             le_variance =       0.280864044770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374736612
  error estimate for blocks of size 2^( 2) =       0.000389049405
  error estimate for blocks of size 2^( 3) =       0.000401722269
  error estimate for blocks of size 2^( 4) =       0.000412340558
  error estimate for blocks of size 2^( 5) =       0.000419099879
  error estimate for blocks of size 2^( 6) =       0.000421655550
  error estimate for blocks of size 2^( 7) =       0.000423326812

      target function =      -0.926175980228
              le_mean =     -17.210132772797
             les_mean =     296.479930188397
             stat err =       0.000419105700
             autocorr =       1.250820185856
   target nu stat err =       0.000419105700
   target dn stat err =       0.003012838459
      target stat err =       0.004959688863
              std dev =       0.529966078886
             le_variance =       0.280864044770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280823014699
                                         uncertainty =       0.002187869288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374736612
  error estimate for blocks of size 2^( 2) =       0.000389049405
  error estimate for blocks of size 2^( 3) =       0.000401722269
  error estimate for blocks of size 2^( 4) =       0.000412340558
  error estimate for blocks of size 2^( 5) =       0.000419099879
  error estimate for blocks of size 2^( 6) =       0.000421655550
  error estimate for blocks of size 2^( 7) =       0.000423326812

      target function =      -0.926175980228
              le_mean =     -17.210132772797
             les_mean =     296.479930188397
             stat err =       0.000419105700
             autocorr =       1.250820185856
   target nu stat err =       0.000419105700
   target dn stat err =       0.003012838459
      target stat err =       0.004959688863
              std dev =       0.529966078886
             le_variance =       0.280864044770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926175980228        initial  <--
     2.4414e+55     2.4414e+56             0.0000e+00        -0.926175980228
     9.7656e+55     9.7656e+56             0.0000e+00        -0.926175980228
     3.9063e+56     3.9063e+57             0.0000e+00        -0.926175980228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.6558
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.3298
    reference variance = 0.32185
====================================================
  Execution time = 2.7466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0503e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8881e-01
  Total weights = 1.966207134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4902e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276519073851
                                         uncertainty =       0.001787656175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276519073851
                                         uncertainty =       0.001787656175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371824171
  error estimate for blocks of size 2^( 2) =       0.000386181781
  error estimate for blocks of size 2^( 3) =       0.000399271945
  error estimate for blocks of size 2^( 4) =       0.000409567682
  error estimate for blocks of size 2^( 5) =       0.000416075975
  error estimate for blocks of size 2^( 6) =       0.000419807140
  error estimate for blocks of size 2^( 7) =       0.000422045934

      target function =      -0.930183357314
              le_mean =     -17.210024349498
             les_mean =     296.473748301229
             stat err =       0.000416874183
             autocorr =       1.256998507003
   target nu stat err =       0.000416874183
   target dn stat err =       0.003120157619
      target stat err =       0.005174961123
              std dev =       0.525847199423
             le_variance =       0.276515277141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721002434950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+56, overlap shift 2.4414e+57 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+56, overlap shift 9.7656e+57 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+57, overlap shift 3.9063e+58 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930211041288       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.675166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5965e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.154347
====================================================
  Execution time = 2.7188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8731e-01
  Total weights = 1.9663e+06
  Execution time = 2.3122e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848542
  error estimate for blocks of size 2^( 2) =       0.000386543261
  error estimate for blocks of size 2^( 3) =       0.000398886159
  error estimate for blocks of size 2^( 4) =       0.000408255192
  error estimate for blocks of size 2^( 5) =       0.000414572713
  error estimate for blocks of size 2^( 6) =       0.000417719434
  error estimate for blocks of size 2^( 7) =       0.000418435149

      target function =      -0.932663855286
              le_mean =     -17.209660115958
             les_mean =     296.459712464164
             stat err =       0.000414745622
             autocorr =       1.244031724909
   target nu stat err =       0.000414745622
   target dn stat err =       0.002972206506
      target stat err =       0.004956720430
              std dev =       0.525881664605
             le_variance =       0.276551525168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848542
  error estimate for blocks of size 2^( 2) =       0.000386543261
  error estimate for blocks of size 2^( 3) =       0.000398886159
  error estimate for blocks of size 2^( 4) =       0.000408255192
  error estimate for blocks of size 2^( 5) =       0.000414572713
  error estimate for blocks of size 2^( 6) =       0.000417719434
  error estimate for blocks of size 2^( 7) =       0.000418435149

      target function =      -0.932663855286
              le_mean =     -17.209660115958
             les_mean =     296.459712464164
             stat err =       0.000414745622
             autocorr =       1.244031724909
   target nu stat err =       0.000414745622
   target dn stat err =       0.002972206506
      target stat err =       0.004956720430
              std dev =       0.525881664605
             le_variance =       0.276551525168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848542
  error estimate for blocks of size 2^( 2) =       0.000386543261
  error estimate for blocks of size 2^( 3) =       0.000398886159
  error estimate for blocks of size 2^( 4) =       0.000408255192
  error estimate for blocks of size 2^( 5) =       0.000414572713
  error estimate for blocks of size 2^( 6) =       0.000417719434
  error estimate for blocks of size 2^( 7) =       0.000418435149

      target function =      -0.932663855286
              le_mean =     -17.209660115958
             les_mean =     296.459712464164
             stat err =       0.000414745622
             autocorr =       1.244031724909
   target nu stat err =       0.000414745622
   target dn stat err =       0.002972206506
      target stat err =       0.004956720430
              std dev =       0.525881664605
             le_variance =       0.276551525168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276572174115
                                         uncertainty =       0.001645783580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848542
  error estimate for blocks of size 2^( 2) =       0.000386543261
  error estimate for blocks of size 2^( 3) =       0.000398886159
  error estimate for blocks of size 2^( 4) =       0.000408255192
  error estimate for blocks of size 2^( 5) =       0.000414572713
  error estimate for blocks of size 2^( 6) =       0.000417719434
  error estimate for blocks of size 2^( 7) =       0.000418435149

      target function =      -0.932663855286
              le_mean =     -17.209660115958
             les_mean =     296.459712464164
             stat err =       0.000414745622
             autocorr =       1.244031724909
   target nu stat err =       0.000414745622
   target dn stat err =       0.002972206506
      target stat err =       0.004956720430
              std dev =       0.525881664605
             le_variance =       0.276551525168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932663855286        initial  <--
     2.4414e+56     2.4414e+57             0.0000e+00        -0.932663855286
     9.7656e+56     9.7656e+57             0.0000e+00        -0.932663855286
     3.9063e+57     3.9063e+58             0.0000e+00        -0.932663855286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8600
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2045
    reference variance = 0.225416
====================================================
  Execution time = 2.7442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0488e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8707e-01
  Total weights = 1.966242986e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4722e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277102252036
                                         uncertainty =       0.001679559032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277102252036
                                         uncertainty =       0.001679559032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372199861
  error estimate for blocks of size 2^( 2) =       0.000386349505
  error estimate for blocks of size 2^( 3) =       0.000399692068
  error estimate for blocks of size 2^( 4) =       0.000410061854
  error estimate for blocks of size 2^( 5) =       0.000415829516
  error estimate for blocks of size 2^( 6) =       0.000418193036
  error estimate for blocks of size 2^( 7) =       0.000420999685

      target function =      -0.933085856122
              le_mean =     -17.208642319504
             les_mean =     296.424444795451
             stat err =       0.000416271023
             autocorr =       1.250834777396
   target nu stat err =       0.000416271023
   target dn stat err =       0.002710547030
      target stat err =       0.004526085411
              std dev =       0.526378512830
             le_variance =       0.277074338769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720864231950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+57, overlap shift 2.4414e+58 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933106681643       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933106681643       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+57 is 4.692939e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+57, overlap shift 9.7656e+58 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933106681643       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933106681643       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933106681643       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933106681643       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.83e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+57 is 1.341062e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+58, overlap shift 3.9063e+59 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933106681643       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933106681643       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+58 is 2.933087e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.677345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5924e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.168154
====================================================
  Execution time = 2.7963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8866e-01
  Total weights = 1.9664e+06
  Execution time = 2.3186e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775950
  error estimate for blocks of size 2^( 2) =       0.000388024847
  error estimate for blocks of size 2^( 3) =       0.000401324093
  error estimate for blocks of size 2^( 4) =       0.000410945057
  error estimate for blocks of size 2^( 5) =       0.000417152974
  error estimate for blocks of size 2^( 6) =       0.000418630527
  error estimate for blocks of size 2^( 7) =       0.000420257362

      target function =      -0.930415421556
              le_mean =     -17.210441894448
             les_mean =     296.487974517356
             stat err =       0.000416746480
             autocorr =       1.243143240252
   target nu stat err =       0.000416746480
   target dn stat err =       0.002690953934
      target stat err =       0.004484298946
              std dev =       0.528607475354
             le_variance =       0.279425863000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775950
  error estimate for blocks of size 2^( 2) =       0.000388024847
  error estimate for blocks of size 2^( 3) =       0.000401324093
  error estimate for blocks of size 2^( 4) =       0.000410945057
  error estimate for blocks of size 2^( 5) =       0.000417152974
  error estimate for blocks of size 2^( 6) =       0.000418630527
  error estimate for blocks of size 2^( 7) =       0.000420257362

      target function =      -0.930415421556
              le_mean =     -17.210441894448
             les_mean =     296.487974517356
             stat err =       0.000416746480
             autocorr =       1.243143240252
   target nu stat err =       0.000416746480
   target dn stat err =       0.002690953934
      target stat err =       0.004484298946
              std dev =       0.528607475354
             le_variance =       0.279425863000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775950
  error estimate for blocks of size 2^( 2) =       0.000388024847
  error estimate for blocks of size 2^( 3) =       0.000401324093
  error estimate for blocks of size 2^( 4) =       0.000410945057
  error estimate for blocks of size 2^( 5) =       0.000417152974
  error estimate for blocks of size 2^( 6) =       0.000418630527
  error estimate for blocks of size 2^( 7) =       0.000420257362

      target function =      -0.930415421556
              le_mean =     -17.210441894448
             les_mean =     296.487974517356
             stat err =       0.000416746480
             autocorr =       1.243143240252
   target nu stat err =       0.000416746480
   target dn stat err =       0.002690953934
      target stat err =       0.004484298946
              std dev =       0.528607475354
             le_variance =       0.279425863000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279430687506
                                         uncertainty =       0.002360713286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775950
  error estimate for blocks of size 2^( 2) =       0.000388024847
  error estimate for blocks of size 2^( 3) =       0.000401324093
  error estimate for blocks of size 2^( 4) =       0.000410945057
  error estimate for blocks of size 2^( 5) =       0.000417152974
  error estimate for blocks of size 2^( 6) =       0.000418630527
  error estimate for blocks of size 2^( 7) =       0.000420257362

      target function =      -0.930415421556
              le_mean =     -17.210441894448
             les_mean =     296.487974517356
             stat err =       0.000416746480
             autocorr =       1.243143240252
   target nu stat err =       0.000416746480
   target dn stat err =       0.002690953934
      target stat err =       0.004484298946
              std dev =       0.528607475354
             le_variance =       0.279425863000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930415421556        initial  <--
     2.4414e+57     2.4414e+58             4.6929e-62        -0.930415421556
     9.7656e+57     9.7656e+58             1.3411e-62        -0.930415421556
     3.9063e+58     3.9063e+59             2.9331e-63        -0.930415421556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.6761
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2343
    reference variance = 0.15579
====================================================
  Execution time = 2.7817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8702e-01
  Total weights = 1.965884390e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4047e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278270266407
                                         uncertainty =       0.002222247496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278270266407
                                         uncertainty =       0.002222247496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373028488
  error estimate for blocks of size 2^( 2) =       0.000387198769
  error estimate for blocks of size 2^( 3) =       0.000400283903
  error estimate for blocks of size 2^( 4) =       0.000409949879
  error estimate for blocks of size 2^( 5) =       0.000417454063
  error estimate for blocks of size 2^( 6) =       0.000419356740
  error estimate for blocks of size 2^( 7) =       0.000419138894

      target function =      -0.933161025852
              le_mean =     -17.209156085976
             les_mean =     296.442076313594
             stat err =       0.000416474894
             autocorr =       1.246503934731
   target nu stat err =       0.000416474894
   target dn stat err =       0.002451703330
      target stat err =       0.004110546192
              std dev =       0.527550386918
             le_variance =       0.278309410738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720915608598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+58, overlap shift 2.4414e+59 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933178125859       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933178125859       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+58 is 4.794781e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+58, overlap shift 9.7656e+59 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933178125859       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933178125859       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+58 is 1.198695e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+59, overlap shift 3.9063e+60 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933178125859       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933178125859       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+59 is 2.996738e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.679092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6230e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1472
    reference variance = 0.227659
====================================================
  Execution time = 2.7709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8934e-01
  Total weights = 1.9661e+06
  Execution time = 2.3269e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372136653
  error estimate for blocks of size 2^( 2) =       0.000386201664
  error estimate for blocks of size 2^( 3) =       0.000399180717
  error estimate for blocks of size 2^( 4) =       0.000409254614
  error estimate for blocks of size 2^( 5) =       0.000414046910
  error estimate for blocks of size 2^( 6) =       0.000416814655
  error estimate for blocks of size 2^( 7) =       0.000419118799

      target function =      -0.929283732526
              le_mean =     -17.209456058308
             les_mean =     296.454717338031
             stat err =       0.000414808745
             autocorr =       1.242484307944
   target nu stat err =       0.000414808745
   target dn stat err =       0.005261523960
      target stat err =       0.008643318717
              std dev =       0.526289121748
             le_variance =       0.276980239670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372136653
  error estimate for blocks of size 2^( 2) =       0.000386201664
  error estimate for blocks of size 2^( 3) =       0.000399180717
  error estimate for blocks of size 2^( 4) =       0.000409254614
  error estimate for blocks of size 2^( 5) =       0.000414046910
  error estimate for blocks of size 2^( 6) =       0.000416814655
  error estimate for blocks of size 2^( 7) =       0.000419118799

      target function =      -0.929283732526
              le_mean =     -17.209456058308
             les_mean =     296.454717338031
             stat err =       0.000414808745
             autocorr =       1.242484307944
   target nu stat err =       0.000414808745
   target dn stat err =       0.005261523960
      target stat err =       0.008643318717
              std dev =       0.526289121748
             le_variance =       0.276980239670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372136653
  error estimate for blocks of size 2^( 2) =       0.000386201664
  error estimate for blocks of size 2^( 3) =       0.000399180717
  error estimate for blocks of size 2^( 4) =       0.000409254614
  error estimate for blocks of size 2^( 5) =       0.000414046910
  error estimate for blocks of size 2^( 6) =       0.000416814655
  error estimate for blocks of size 2^( 7) =       0.000419118799

      target function =      -0.929283732526
              le_mean =     -17.209456058308
             les_mean =     296.454717338031
             stat err =       0.000414808745
             autocorr =       1.242484307944
   target nu stat err =       0.000414808745
   target dn stat err =       0.005261523960
      target stat err =       0.008643318717
              std dev =       0.526289121748
             le_variance =       0.276980239670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062790906
                                         uncertainty =       0.001948121414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372136653
  error estimate for blocks of size 2^( 2) =       0.000386201664
  error estimate for blocks of size 2^( 3) =       0.000399180717
  error estimate for blocks of size 2^( 4) =       0.000409254614
  error estimate for blocks of size 2^( 5) =       0.000414046910
  error estimate for blocks of size 2^( 6) =       0.000416814655
  error estimate for blocks of size 2^( 7) =       0.000419118799

      target function =      -0.929283732526
              le_mean =     -17.209456058308
             les_mean =     296.454717338031
             stat err =       0.000414808745
             autocorr =       1.242484307944
   target nu stat err =       0.000414808745
   target dn stat err =       0.005261523960
      target stat err =       0.008643318717
              std dev =       0.526289121748
             le_variance =       0.276980239670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929283732526        initial  <--
     2.4414e+58     2.4414e+59             4.7948e-63        -0.929283732526
     9.7656e+58     9.7656e+59             1.1987e-63        -0.929283732526
     3.9063e+59     3.9063e+60             2.9967e-64        -0.929283732526

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4328
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2596
    reference variance = 0.205826
====================================================
  Execution time = 2.7418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8788e-01
  Total weights = 1.966136993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0952e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278102296814
                                         uncertainty =       0.002124283558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278102296814
                                         uncertainty =       0.002124283558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372874593
  error estimate for blocks of size 2^( 2) =       0.000386867934
  error estimate for blocks of size 2^( 3) =       0.000399795714
  error estimate for blocks of size 2^( 4) =       0.000409801232
  error estimate for blocks of size 2^( 5) =       0.000415045825
  error estimate for blocks of size 2^( 6) =       0.000418589830
  error estimate for blocks of size 2^( 7) =       0.000420854994

      target function =      -0.931706409671
              le_mean =     -17.209870551404
             les_mean =     296.467529217088
             stat err =       0.000416072970
             autocorr =       1.245126344364
   target nu stat err =       0.000416072970
   target dn stat err =       0.003279072259
      target stat err =       0.005449211690
              std dev =       0.527332743668
             le_variance =       0.278079822545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720987055140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+59, overlap shift 2.4414e+60 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+59, overlap shift 9.7656e+60 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+60, overlap shift 3.9063e+61 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931737577464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.680379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6522e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1622
    reference variance = 0.199124
====================================================
  Execution time = 2.7406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8501e-01
  Total weights = 1.9663e+06
  Execution time = 2.3162e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371376429
  error estimate for blocks of size 2^( 2) =       0.000385963312
  error estimate for blocks of size 2^( 3) =       0.000399318517
  error estimate for blocks of size 2^( 4) =       0.000408741727
  error estimate for blocks of size 2^( 5) =       0.000414286795
  error estimate for blocks of size 2^( 6) =       0.000417141676
  error estimate for blocks of size 2^( 7) =       0.000419719584

      target function =      -0.936485892785
              le_mean =     -17.209780269990
             les_mean =     296.461546264636
             stat err =       0.000414972445
             autocorr =       1.248561236475
   target nu stat err =       0.000414972445
   target dn stat err =       0.002131923845
      target stat err =       0.003621672490
              std dev =       0.525213986084
             le_variance =       0.275849731179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371376429
  error estimate for blocks of size 2^( 2) =       0.000385963312
  error estimate for blocks of size 2^( 3) =       0.000399318517
  error estimate for blocks of size 2^( 4) =       0.000408741727
  error estimate for blocks of size 2^( 5) =       0.000414286795
  error estimate for blocks of size 2^( 6) =       0.000417141676
  error estimate for blocks of size 2^( 7) =       0.000419719584

      target function =      -0.936485892785
              le_mean =     -17.209780269990
             les_mean =     296.461546264636
             stat err =       0.000414972445
             autocorr =       1.248561236475
   target nu stat err =       0.000414972445
   target dn stat err =       0.002131923845
      target stat err =       0.003621672490
              std dev =       0.525213986084
             le_variance =       0.275849731179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371376429
  error estimate for blocks of size 2^( 2) =       0.000385963312
  error estimate for blocks of size 2^( 3) =       0.000399318517
  error estimate for blocks of size 2^( 4) =       0.000408741727
  error estimate for blocks of size 2^( 5) =       0.000414286795
  error estimate for blocks of size 2^( 6) =       0.000417141676
  error estimate for blocks of size 2^( 7) =       0.000419719584

      target function =      -0.936485892785
              le_mean =     -17.209780269990
             les_mean =     296.461546264636
             stat err =       0.000414972445
             autocorr =       1.248561236475
   target nu stat err =       0.000414972445
   target dn stat err =       0.002131923845
      target stat err =       0.003621672490
              std dev =       0.525213986084
             le_variance =       0.275849731179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275904443621
                                         uncertainty =       0.001874786300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371376429
  error estimate for blocks of size 2^( 2) =       0.000385963312
  error estimate for blocks of size 2^( 3) =       0.000399318517
  error estimate for blocks of size 2^( 4) =       0.000408741727
  error estimate for blocks of size 2^( 5) =       0.000414286795
  error estimate for blocks of size 2^( 6) =       0.000417141676
  error estimate for blocks of size 2^( 7) =       0.000419719584

      target function =      -0.936485892785
              le_mean =     -17.209780269990
             les_mean =     296.461546264636
             stat err =       0.000414972445
             autocorr =       1.248561236475
   target nu stat err =       0.000414972445
   target dn stat err =       0.002131923845
      target stat err =       0.003621672490
              std dev =       0.525213986084
             le_variance =       0.275849731179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936485892785        initial  <--
     2.4414e+59     2.4414e+60             0.0000e+00        -0.936485892785
     9.7656e+59     9.7656e+60             0.0000e+00        -0.936485892785
     3.9063e+60     3.9063e+61             0.0000e+00        -0.936485892785

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0957
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1851
    reference variance = 0.245014
====================================================
  Execution time = 2.7505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0460e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8839e-01
  Total weights = 1.966253223e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3991e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279087009069
                                         uncertainty =       0.001648633431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279087009069
                                         uncertainty =       0.001648633431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373555860
  error estimate for blocks of size 2^( 2) =       0.000387954586
  error estimate for blocks of size 2^( 3) =       0.000401315567
  error estimate for blocks of size 2^( 4) =       0.000410809406
  error estimate for blocks of size 2^( 5) =       0.000416814053
  error estimate for blocks of size 2^( 6) =       0.000419894177
  error estimate for blocks of size 2^( 7) =       0.000419819443

      target function =      -0.930903979705
              le_mean =     -17.209690316908
             les_mean =     296.461826393965
             stat err =       0.000416834270
             autocorr =       1.245132948125
   target nu stat err =       0.000416834270
   target dn stat err =       0.002352784834
      target stat err =       0.003935466968
              std dev =       0.528296216713
             le_variance =       0.279096892593


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720969031691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+60, overlap shift 2.4414e+61 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930919516127       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930919516127       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930919516127       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930919516127       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930919516127       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.86e+06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 3.97e+17           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+60 is 4.186875e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+60, overlap shift 9.7656e+61 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930919516127       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930919516127       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930919516127       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930919516127       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930919516127       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930919511528       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929290880125       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+60 is 1.011812e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+61, overlap shift 3.9063e+62 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930919516127       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930919516127       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930919516127       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930919516127       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930919516127       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930919441220       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+61 is 2.529530e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.683592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5915e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.18902
====================================================
  Execution time = 2.7555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8493e-01
  Total weights = 1.9665e+06
  Execution time = 2.3166e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371792418
  error estimate for blocks of size 2^( 2) =       0.000386240556
  error estimate for blocks of size 2^( 3) =       0.000399476871
  error estimate for blocks of size 2^( 4) =       0.000409365598
  error estimate for blocks of size 2^( 5) =       0.000414981679
  error estimate for blocks of size 2^( 6) =       0.000420278228
  error estimate for blocks of size 2^( 7) =       0.000421865526

      target function =      -0.936625817052
              le_mean =     -17.209635151560
             les_mean =     296.456468811503
             stat err =       0.000416622758
             autocorr =       1.255697182212
   target nu stat err =       0.000416622758
   target dn stat err =       0.002168210875
      target stat err =       0.003681438771
              std dev =       0.525802293060
             le_variance =       0.276468051387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371792418
  error estimate for blocks of size 2^( 2) =       0.000386240556
  error estimate for blocks of size 2^( 3) =       0.000399476871
  error estimate for blocks of size 2^( 4) =       0.000409365598
  error estimate for blocks of size 2^( 5) =       0.000414981679
  error estimate for blocks of size 2^( 6) =       0.000420278228
  error estimate for blocks of size 2^( 7) =       0.000421865526

      target function =      -0.936625817052
              le_mean =     -17.209635151560
             les_mean =     296.456468811503
             stat err =       0.000416622758
             autocorr =       1.255697182207
   target nu stat err =       0.000416622758
   target dn stat err =       0.002168210875
      target stat err =       0.003681438771
              std dev =       0.525802293060
             le_variance =       0.276468051387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371792418
  error estimate for blocks of size 2^( 2) =       0.000386240556
  error estimate for blocks of size 2^( 3) =       0.000399476871
  error estimate for blocks of size 2^( 4) =       0.000409365598
  error estimate for blocks of size 2^( 5) =       0.000414981679
  error estimate for blocks of size 2^( 6) =       0.000420278228
  error estimate for blocks of size 2^( 7) =       0.000421865526

      target function =      -0.936625817052
              le_mean =     -17.209635151560
             les_mean =     296.456468811503
             stat err =       0.000416622758
             autocorr =       1.255697182207
   target nu stat err =       0.000416622758
   target dn stat err =       0.002168210875
      target stat err =       0.003681438771
              std dev =       0.525802293060
             le_variance =       0.276468051387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468980216
                                         uncertainty =       0.001501822894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371792418
  error estimate for blocks of size 2^( 2) =       0.000386240556
  error estimate for blocks of size 2^( 3) =       0.000399476871
  error estimate for blocks of size 2^( 4) =       0.000409365598
  error estimate for blocks of size 2^( 5) =       0.000414981679
  error estimate for blocks of size 2^( 6) =       0.000420278228
  error estimate for blocks of size 2^( 7) =       0.000421865526

      target function =      -0.936625817052
              le_mean =     -17.209635151560
             les_mean =     296.456468811503
             stat err =       0.000416622758
             autocorr =       1.255697182207
   target nu stat err =       0.000416622758
   target dn stat err =       0.002168210875
      target stat err =       0.003681438771
              std dev =       0.525802293060
             le_variance =       0.276468051387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936625817052        initial  <--
     2.4414e+60     2.4414e+61             4.1869e-65        -0.936625817052
     9.7656e+60     9.7656e+61             1.0118e-65        -0.936625817052
     3.9063e+61     3.9063e+62             2.5295e-66        -0.936625817052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2526
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.0764
    reference variance = 0.49232
====================================================
  Execution time = 2.7610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8648e-01
  Total weights = 1.966517373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277221505076
                                         uncertainty =       0.001962569015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277221505076
                                         uncertainty =       0.001962569015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372259617
  error estimate for blocks of size 2^( 2) =       0.000386574840
  error estimate for blocks of size 2^( 3) =       0.000399934117
  error estimate for blocks of size 2^( 4) =       0.000409898834
  error estimate for blocks of size 2^( 5) =       0.000415938967
  error estimate for blocks of size 2^( 6) =       0.000417572431
  error estimate for blocks of size 2^( 7) =       0.000420803607

      target function =      -0.934067846357
              le_mean =     -17.208999323035
             les_mean =     296.436134615991
             stat err =       0.000416053460
             autocorr =       1.249126502183
   target nu stat err =       0.000416053460
   target dn stat err =       0.002361631859
      target stat err =       0.003970718220
              std dev =       0.526463022526
             le_variance =       0.277163314087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720899932304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+61, overlap shift 2.4414e+62 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+61, overlap shift 9.7656e+62 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+62, overlap shift 3.9063e+63 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934083755711       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.684903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6113e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2474
    reference variance = 0.410672
====================================================
  Execution time = 2.7837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8930e-01
  Total weights = 1.9661e+06
  Execution time = 2.3191e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371736412
  error estimate for blocks of size 2^( 2) =       0.000386123268
  error estimate for blocks of size 2^( 3) =       0.000399175245
  error estimate for blocks of size 2^( 4) =       0.000409020788
  error estimate for blocks of size 2^( 5) =       0.000414375236
  error estimate for blocks of size 2^( 6) =       0.000416558971
  error estimate for blocks of size 2^( 7) =       0.000418549144

      target function =      -0.929390815391
              le_mean =     -17.209369692579
             les_mean =     296.451707562732
             stat err =       0.000414626035
             autocorr =       1.244064597084
   target nu stat err =       0.000414626035
   target dn stat err =       0.003530053601
      target stat err =       0.005824284179
              std dev =       0.525723086791
             le_variance =       0.276384763985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371736412
  error estimate for blocks of size 2^( 2) =       0.000386123268
  error estimate for blocks of size 2^( 3) =       0.000399175245
  error estimate for blocks of size 2^( 4) =       0.000409020788
  error estimate for blocks of size 2^( 5) =       0.000414375236
  error estimate for blocks of size 2^( 6) =       0.000416558971
  error estimate for blocks of size 2^( 7) =       0.000418549144

      target function =      -0.929390815391
              le_mean =     -17.209369692579
             les_mean =     296.451707562732
             stat err =       0.000414626035
             autocorr =       1.244064597085
   target nu stat err =       0.000414626035
   target dn stat err =       0.003530053601
      target stat err =       0.005824284179
              std dev =       0.525723086791
             le_variance =       0.276384763985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371736412
  error estimate for blocks of size 2^( 2) =       0.000386123268
  error estimate for blocks of size 2^( 3) =       0.000399175245
  error estimate for blocks of size 2^( 4) =       0.000409020788
  error estimate for blocks of size 2^( 5) =       0.000414375236
  error estimate for blocks of size 2^( 6) =       0.000416558971
  error estimate for blocks of size 2^( 7) =       0.000418549144

      target function =      -0.929390815391
              le_mean =     -17.209369692579
             les_mean =     296.451707562732
             stat err =       0.000414626035
             autocorr =       1.244064597085
   target nu stat err =       0.000414626035
   target dn stat err =       0.003530053601
      target stat err =       0.005824284179
              std dev =       0.525723086791
             le_variance =       0.276384763985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276320241791
                                         uncertainty =       0.001708217089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371736412
  error estimate for blocks of size 2^( 2) =       0.000386123268
  error estimate for blocks of size 2^( 3) =       0.000399175245
  error estimate for blocks of size 2^( 4) =       0.000409020788
  error estimate for blocks of size 2^( 5) =       0.000414375236
  error estimate for blocks of size 2^( 6) =       0.000416558971
  error estimate for blocks of size 2^( 7) =       0.000418549144

      target function =      -0.929390815391
              le_mean =     -17.209369692579
             les_mean =     296.451707562732
             stat err =       0.000414626035
             autocorr =       1.244064597085
   target nu stat err =       0.000414626035
   target dn stat err =       0.003530053601
      target stat err =       0.005824284179
              std dev =       0.525723086791
             le_variance =       0.276384763985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929390815391        initial  <--
     2.4414e+61     2.4414e+62             0.0000e+00        -0.929390815391
     9.7656e+61     9.7656e+62             0.0000e+00        -0.929390815391
     3.9063e+62     3.9063e+63             0.0000e+00        -0.929390815391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5707
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2003
    reference variance = 0.282625
====================================================
  Execution time = 2.7493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8458e-01
  Total weights = 1.966312519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4672e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275567263070
                                         uncertainty =       0.001709309786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275567263070
                                         uncertainty =       0.001709309786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371137984
  error estimate for blocks of size 2^( 2) =       0.000385436265
  error estimate for blocks of size 2^( 3) =       0.000398878663
  error estimate for blocks of size 2^( 4) =       0.000408022479
  error estimate for blocks of size 2^( 5) =       0.000413316165
  error estimate for blocks of size 2^( 6) =       0.000415737678
  error estimate for blocks of size 2^( 7) =       0.000417579483

      target function =      -0.937185173618
              le_mean =     -17.209954161259
             les_mean =     296.467102182128
             stat err =       0.000413663951
             autocorr =       1.242294442533
   target nu stat err =       0.000413663951
   target dn stat err =       0.002919028505
      target stat err =       0.004919239892
              std dev =       0.524876768921
             le_variance =       0.275495622553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720995416126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+62, overlap shift 2.4414e+63 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+62, overlap shift 9.7656e+63 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+63, overlap shift 3.9063e+64 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937209822494       residual = 4.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.686188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5971e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.220466
====================================================
  Execution time = 2.7290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8877e-01
  Total weights = 1.9665e+06
  Execution time = 2.3215e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371582803
  error estimate for blocks of size 2^( 2) =       0.000385986492
  error estimate for blocks of size 2^( 3) =       0.000398850088
  error estimate for blocks of size 2^( 4) =       0.000408351598
  error estimate for blocks of size 2^( 5) =       0.000413379471
  error estimate for blocks of size 2^( 6) =       0.000415263043
  error estimate for blocks of size 2^( 7) =       0.000415928072

      target function =      -0.930251628780
              le_mean =     -17.209338398726
             les_mean =     296.450102239635
             stat err =       0.000413230546
             autocorr =       1.236726367797
   target nu stat err =       0.000413230546
   target dn stat err =       0.003799752221
      target stat err =       0.006273420145
              std dev =       0.525505848028
             le_variance =       0.276156396311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371582803
  error estimate for blocks of size 2^( 2) =       0.000385986492
  error estimate for blocks of size 2^( 3) =       0.000398850088
  error estimate for blocks of size 2^( 4) =       0.000408351598
  error estimate for blocks of size 2^( 5) =       0.000413379471
  error estimate for blocks of size 2^( 6) =       0.000415263043
  error estimate for blocks of size 2^( 7) =       0.000415928072

      target function =      -0.930251628780
              le_mean =     -17.209338398726
             les_mean =     296.450102239635
             stat err =       0.000413230546
             autocorr =       1.236726367797
   target nu stat err =       0.000413230546
   target dn stat err =       0.003799752221
      target stat err =       0.006273420145
              std dev =       0.525505848028
             le_variance =       0.276156396311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371582803
  error estimate for blocks of size 2^( 2) =       0.000385986492
  error estimate for blocks of size 2^( 3) =       0.000398850088
  error estimate for blocks of size 2^( 4) =       0.000408351598
  error estimate for blocks of size 2^( 5) =       0.000413379471
  error estimate for blocks of size 2^( 6) =       0.000415263043
  error estimate for blocks of size 2^( 7) =       0.000415928072

      target function =      -0.930251628780
              le_mean =     -17.209338398726
             les_mean =     296.450102239635
             stat err =       0.000413230546
             autocorr =       1.236726367797
   target nu stat err =       0.000413230546
   target dn stat err =       0.003799752221
      target stat err =       0.006273420145
              std dev =       0.525505848028
             le_variance =       0.276156396311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276118160059
                                         uncertainty =       0.001996200923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371582803
  error estimate for blocks of size 2^( 2) =       0.000385986492
  error estimate for blocks of size 2^( 3) =       0.000398850088
  error estimate for blocks of size 2^( 4) =       0.000408351598
  error estimate for blocks of size 2^( 5) =       0.000413379471
  error estimate for blocks of size 2^( 6) =       0.000415263043
  error estimate for blocks of size 2^( 7) =       0.000415928072

      target function =      -0.930251628780
              le_mean =     -17.209338398726
             les_mean =     296.450102239635
             stat err =       0.000413230546
             autocorr =       1.236726367797
   target nu stat err =       0.000413230546
   target dn stat err =       0.003799752221
      target stat err =       0.006273420145
              std dev =       0.525505848028
             le_variance =       0.276156396311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930251628780        initial  <--
     2.4414e+62     2.4414e+63             0.0000e+00        -0.930251628780
     9.7656e+62     9.7656e+63             0.0000e+00        -0.930251628780
     3.9063e+63     3.9063e+64             0.0000e+00        -0.930251628780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9919
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4968e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.367642
====================================================
  Execution time = 2.7839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8959e-01
  Total weights = 1.966323428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3942e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279113942398
                                         uncertainty =       0.001832723443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279113942398
                                         uncertainty =       0.001832723443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373526236
  error estimate for blocks of size 2^( 2) =       0.000387882673
  error estimate for blocks of size 2^( 3) =       0.000400917000
  error estimate for blocks of size 2^( 4) =       0.000410570017
  error estimate for blocks of size 2^( 5) =       0.000416638845
  error estimate for blocks of size 2^( 6) =       0.000419152960
  error estimate for blocks of size 2^( 7) =       0.000421503511

      target function =      -0.928920321986
              le_mean =     -17.209671405369
             les_mean =     296.462383184648
             stat err =       0.000416966333
             autocorr =       1.246119686593
   target nu stat err =       0.000416966333
   target dn stat err =       0.002626297907
      target stat err =       0.004359310624
              std dev =       0.528254321290
             le_variance =       0.279052627962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720967140537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+63, overlap shift 2.4414e+64 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+63, overlap shift 9.7656e+64 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+64, overlap shift 3.9063e+65 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928939869903       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.687486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7242e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.193807
====================================================
  Execution time = 2.7586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8854e-01
  Total weights = 1.9664e+06
  Execution time = 2.3202e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199552
  error estimate for blocks of size 2^( 2) =       0.000387771766
  error estimate for blocks of size 2^( 3) =       0.000401061869
  error estimate for blocks of size 2^( 4) =       0.000410629098
  error estimate for blocks of size 2^( 5) =       0.000416642926
  error estimate for blocks of size 2^( 6) =       0.000419656201
  error estimate for blocks of size 2^( 7) =       0.000422451937

      target function =      -0.930656884694
              le_mean =     -17.209201446302
             les_mean =     296.445156417386
             stat err =       0.000417345041
             autocorr =       1.250570806152
   target nu stat err =       0.000417345041
   target dn stat err =       0.002737240994
      target stat err =       0.004551159865
              std dev =       0.527792312754
             le_variance =       0.278564725402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199552
  error estimate for blocks of size 2^( 2) =       0.000387771766
  error estimate for blocks of size 2^( 3) =       0.000401061869
  error estimate for blocks of size 2^( 4) =       0.000410629098
  error estimate for blocks of size 2^( 5) =       0.000416642926
  error estimate for blocks of size 2^( 6) =       0.000419656201
  error estimate for blocks of size 2^( 7) =       0.000422451937

      target function =      -0.930656884694
              le_mean =     -17.209201446302
             les_mean =     296.445156417386
             stat err =       0.000417345041
             autocorr =       1.250570806152
   target nu stat err =       0.000417345041
   target dn stat err =       0.002737240994
      target stat err =       0.004551159865
              std dev =       0.527792312754
             le_variance =       0.278564725402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199552
  error estimate for blocks of size 2^( 2) =       0.000387771766
  error estimate for blocks of size 2^( 3) =       0.000401061869
  error estimate for blocks of size 2^( 4) =       0.000410629098
  error estimate for blocks of size 2^( 5) =       0.000416642926
  error estimate for blocks of size 2^( 6) =       0.000419656201
  error estimate for blocks of size 2^( 7) =       0.000422451937

      target function =      -0.930656884694
              le_mean =     -17.209201446302
             les_mean =     296.445156417386
             stat err =       0.000417345041
             autocorr =       1.250570806152
   target nu stat err =       0.000417345041
   target dn stat err =       0.002737240994
      target stat err =       0.004551159865
              std dev =       0.527792312754
             le_variance =       0.278564725402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278486136871
                                         uncertainty =       0.001670110308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199552
  error estimate for blocks of size 2^( 2) =       0.000387771766
  error estimate for blocks of size 2^( 3) =       0.000401061869
  error estimate for blocks of size 2^( 4) =       0.000410629098
  error estimate for blocks of size 2^( 5) =       0.000416642926
  error estimate for blocks of size 2^( 6) =       0.000419656201
  error estimate for blocks of size 2^( 7) =       0.000422451937

      target function =      -0.930656884694
              le_mean =     -17.209201446302
             les_mean =     296.445156417386
             stat err =       0.000417345041
             autocorr =       1.250570806152
   target nu stat err =       0.000417345041
   target dn stat err =       0.002737240994
      target stat err =       0.004551159865
              std dev =       0.527792312754
             le_variance =       0.278564725402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930656884694        initial  <--
     2.4414e+63     2.4414e+64             0.0000e+00        -0.930656884694
     9.7656e+63     9.7656e+64             0.0000e+00        -0.930656884694
     3.9063e+64     3.9063e+65             0.0000e+00        -0.930656884694

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2734
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.226491
====================================================
  Execution time = 2.7767e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9088e-01
  Total weights = 1.966430969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3879e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280095149873
                                         uncertainty =       0.002208375667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280095149873
                                         uncertainty =       0.002208375667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374187132
  error estimate for blocks of size 2^( 2) =       0.000388216698
  error estimate for blocks of size 2^( 3) =       0.000401593018
  error estimate for blocks of size 2^( 4) =       0.000411213434
  error estimate for blocks of size 2^( 5) =       0.000417190139
  error estimate for blocks of size 2^( 6) =       0.000419301071
  error estimate for blocks of size 2^( 7) =       0.000423597717

      target function =      -0.926790888730
              le_mean =     -17.210176515319
             les_mean =     296.481052010905
             stat err =       0.000417825590
             autocorr =       1.246844728621
   target nu stat err =       0.000417825590
   target dn stat err =       0.003481787070
      target stat err =       0.005723526758
              std dev =       0.529188984138
             le_variance =       0.280040980933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721017651532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+64, overlap shift 2.4414e+65 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+64, overlap shift 9.7656e+65 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+65, overlap shift 3.9063e+66 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926825077172       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.688776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6164e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1771
    reference variance = 0.246684
====================================================
  Execution time = 2.7321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8225e-01
  Total weights = 1.9666e+06
  Execution time = 2.3108e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370508360
  error estimate for blocks of size 2^( 2) =       0.000384634349
  error estimate for blocks of size 2^( 3) =       0.000398535251
  error estimate for blocks of size 2^( 4) =       0.000407866925
  error estimate for blocks of size 2^( 5) =       0.000413426543
  error estimate for blocks of size 2^( 6) =       0.000417043929
  error estimate for blocks of size 2^( 7) =       0.000418180527

      target function =      -0.941101613170
              le_mean =     -17.209645306359
             les_mean =     296.454143386496
             stat err =       0.000414129481
             autocorr =       1.249327425240
   target nu stat err =       0.000414129481
   target dn stat err =       0.001680412362
      target stat err =       0.002916950528
              std dev =       0.523986330817
             le_variance =       0.274561674883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370508360
  error estimate for blocks of size 2^( 2) =       0.000384634349
  error estimate for blocks of size 2^( 3) =       0.000398535251
  error estimate for blocks of size 2^( 4) =       0.000407866925
  error estimate for blocks of size 2^( 5) =       0.000413426543
  error estimate for blocks of size 2^( 6) =       0.000417043929
  error estimate for blocks of size 2^( 7) =       0.000418180527

      target function =      -0.941101613170
              le_mean =     -17.209645306359
             les_mean =     296.454143386496
             stat err =       0.000414129481
             autocorr =       1.249327425240
   target nu stat err =       0.000414129481
   target dn stat err =       0.001680412362
      target stat err =       0.002916950528
              std dev =       0.523986330817
             le_variance =       0.274561674883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370508360
  error estimate for blocks of size 2^( 2) =       0.000384634349
  error estimate for blocks of size 2^( 3) =       0.000398535251
  error estimate for blocks of size 2^( 4) =       0.000407866925
  error estimate for blocks of size 2^( 5) =       0.000413426543
  error estimate for blocks of size 2^( 6) =       0.000417043929
  error estimate for blocks of size 2^( 7) =       0.000418180527

      target function =      -0.941101613170
              le_mean =     -17.209645306359
             les_mean =     296.454143386496
             stat err =       0.000414129481
             autocorr =       1.249327425240
   target nu stat err =       0.000414129481
   target dn stat err =       0.001680412362
      target stat err =       0.002916950528
              std dev =       0.523986330817
             le_variance =       0.274561674883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274553778462
                                         uncertainty =       0.001215228645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370508360
  error estimate for blocks of size 2^( 2) =       0.000384634349
  error estimate for blocks of size 2^( 3) =       0.000398535251
  error estimate for blocks of size 2^( 4) =       0.000407866925
  error estimate for blocks of size 2^( 5) =       0.000413426543
  error estimate for blocks of size 2^( 6) =       0.000417043929
  error estimate for blocks of size 2^( 7) =       0.000418180527

      target function =      -0.941101613170
              le_mean =     -17.209645306359
             les_mean =     296.454143386496
             stat err =       0.000414129481
             autocorr =       1.249327425240
   target nu stat err =       0.000414129481
   target dn stat err =       0.001680412362
      target stat err =       0.002916950528
              std dev =       0.523986330817
             le_variance =       0.274561674883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941101613170        initial  <--
     2.4414e+64     2.4414e+65             0.0000e+00        -0.941101613170
     9.7656e+64     9.7656e+65             0.0000e+00        -0.941101613170
     3.9063e+65     3.9063e+66             0.0000e+00        -0.941101613170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9870
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2867
    reference variance = 0.210343
====================================================
  Execution time = 2.7577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9572e-01
  Total weights = 1.966161162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7276e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282960948359
                                         uncertainty =       0.003875479988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282960948359
                                         uncertainty =       0.003875479988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376122964
  error estimate for blocks of size 2^( 2) =       0.000390099783
  error estimate for blocks of size 2^( 3) =       0.000403615488
  error estimate for blocks of size 2^( 4) =       0.000413454022
  error estimate for blocks of size 2^( 5) =       0.000418104082
  error estimate for blocks of size 2^( 6) =       0.000419688579
  error estimate for blocks of size 2^( 7) =       0.000421048554

      target function =      -0.918949415144
              le_mean =     -17.209584430787
             les_mean =     296.465518493434
             stat err =       0.000418073809
             autocorr =       1.235509878636
   target nu stat err =       0.000418073809
   target dn stat err =       0.005187165250
      target stat err =       0.008336737477
              std dev =       0.531926708058
             le_variance =       0.282946022745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720958443079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+65, overlap shift 2.4414e+66 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+65, overlap shift 9.7656e+66 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+66, overlap shift 3.9063e+67 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919023597653       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.690085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6313e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2759
    reference variance = 0.298078
====================================================
  Execution time = 2.7634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8634e-01
  Total weights = 1.9666e+06
  Execution time = 2.3136e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712037
  error estimate for blocks of size 2^( 2) =       0.000386191992
  error estimate for blocks of size 2^( 3) =       0.000399345070
  error estimate for blocks of size 2^( 4) =       0.000409328492
  error estimate for blocks of size 2^( 5) =       0.000415926746
  error estimate for blocks of size 2^( 6) =       0.000420308543
  error estimate for blocks of size 2^( 7) =       0.000422861835

      target function =      -0.934256064962
              le_mean =     -17.209931477567
             les_mean =     296.468084863942
             stat err =       0.000417106404
             autocorr =       1.259158682267
   target nu stat err =       0.000417106404
   target dn stat err =       0.002930630672
      target stat err =       0.004908583421
              std dev =       0.525688615541
             le_variance =       0.276348520510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712037
  error estimate for blocks of size 2^( 2) =       0.000386191992
  error estimate for blocks of size 2^( 3) =       0.000399345070
  error estimate for blocks of size 2^( 4) =       0.000409328492
  error estimate for blocks of size 2^( 5) =       0.000415926746
  error estimate for blocks of size 2^( 6) =       0.000420308543
  error estimate for blocks of size 2^( 7) =       0.000422861835

      target function =      -0.934256064962
              le_mean =     -17.209931477567
             les_mean =     296.468084863942
             stat err =       0.000417106404
             autocorr =       1.259158682259
   target nu stat err =       0.000417106404
   target dn stat err =       0.002930630672
      target stat err =       0.004908583421
              std dev =       0.525688615541
             le_variance =       0.276348520510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712037
  error estimate for blocks of size 2^( 2) =       0.000386191992
  error estimate for blocks of size 2^( 3) =       0.000399345070
  error estimate for blocks of size 2^( 4) =       0.000409328492
  error estimate for blocks of size 2^( 5) =       0.000415926746
  error estimate for blocks of size 2^( 6) =       0.000420308543
  error estimate for blocks of size 2^( 7) =       0.000422861835

      target function =      -0.934256064962
              le_mean =     -17.209931477567
             les_mean =     296.468084863942
             stat err =       0.000417106404
             autocorr =       1.259158682259
   target nu stat err =       0.000417106404
   target dn stat err =       0.002930630672
      target stat err =       0.004908583421
              std dev =       0.525688615541
             le_variance =       0.276348520510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276383063057
                                         uncertainty =       0.001944281859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712037
  error estimate for blocks of size 2^( 2) =       0.000386191992
  error estimate for blocks of size 2^( 3) =       0.000399345070
  error estimate for blocks of size 2^( 4) =       0.000409328492
  error estimate for blocks of size 2^( 5) =       0.000415926746
  error estimate for blocks of size 2^( 6) =       0.000420308543
  error estimate for blocks of size 2^( 7) =       0.000422861835

      target function =      -0.934256064962
              le_mean =     -17.209931477567
             les_mean =     296.468084863942
             stat err =       0.000417106404
             autocorr =       1.259158682259
   target nu stat err =       0.000417106404
   target dn stat err =       0.002930630672
      target stat err =       0.004908583421
              std dev =       0.525688615541
             le_variance =       0.276348520510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934256064962        initial  <--
     2.4414e+65     2.4414e+66             0.0000e+00        -0.934256064962
     9.7656e+65     9.7656e+66             0.0000e+00        -0.934256064962
     3.9063e+66     3.9063e+67             0.0000e+00        -0.934256064962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.3398
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2066
    reference variance = 0.155506
====================================================
  Execution time = 2.7631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8789e-01
  Total weights = 1.966100526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4707e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275722755018
                                         uncertainty =       0.001580819998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275722755018
                                         uncertainty =       0.001580819998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371233046
  error estimate for blocks of size 2^( 2) =       0.000385366349
  error estimate for blocks of size 2^( 3) =       0.000398575428
  error estimate for blocks of size 2^( 4) =       0.000408438183
  error estimate for blocks of size 2^( 5) =       0.000414640844
  error estimate for blocks of size 2^( 6) =       0.000418221211
  error estimate for blocks of size 2^( 7) =       0.000417208606

      target function =      -0.931691113711
              le_mean =     -17.209981596084
             les_mean =     296.471360377535
             stat err =       0.000414627211
             autocorr =       1.247447690624
   target nu stat err =       0.000414627211
   target dn stat err =       0.003129061532
      target stat err =       0.005205117719
              std dev =       0.525011208485
             le_variance =       0.275636769034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720998159608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+66, overlap shift 2.4414e+67 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+66, overlap shift 9.7656e+67 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+67, overlap shift 3.9063e+68 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931719253282       residual = 7.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.693525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6114e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2659
    reference variance = 0.526422
====================================================
  Execution time = 2.7414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8621e-01
  Total weights = 1.9664e+06
  Execution time = 2.3264e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372122709
  error estimate for blocks of size 2^( 2) =       0.000386256123
  error estimate for blocks of size 2^( 3) =       0.000399761250
  error estimate for blocks of size 2^( 4) =       0.000408961572
  error estimate for blocks of size 2^( 5) =       0.000415391721
  error estimate for blocks of size 2^( 6) =       0.000417541695
  error estimate for blocks of size 2^( 7) =       0.000421787824

      target function =      -0.934501038790
              le_mean =     -17.209665148392
             les_mean =     296.458781213544
             stat err =       0.000415920703
             autocorr =       1.249248190976
   target nu stat err =       0.000415920703
   target dn stat err =       0.002173395760
      target stat err =       0.003673459948
              std dev =       0.526269402039
             le_variance =       0.276959483522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372122709
  error estimate for blocks of size 2^( 2) =       0.000386256123
  error estimate for blocks of size 2^( 3) =       0.000399761250
  error estimate for blocks of size 2^( 4) =       0.000408961572
  error estimate for blocks of size 2^( 5) =       0.000415391721
  error estimate for blocks of size 2^( 6) =       0.000417541695
  error estimate for blocks of size 2^( 7) =       0.000421787824

      target function =      -0.934501038790
              le_mean =     -17.209665148392
             les_mean =     296.458781213544
             stat err =       0.000415920703
             autocorr =       1.249248190976
   target nu stat err =       0.000415920703
   target dn stat err =       0.002173395760
      target stat err =       0.003673459948
              std dev =       0.526269402039
             le_variance =       0.276959483522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372122709
  error estimate for blocks of size 2^( 2) =       0.000386256123
  error estimate for blocks of size 2^( 3) =       0.000399761250
  error estimate for blocks of size 2^( 4) =       0.000408961572
  error estimate for blocks of size 2^( 5) =       0.000415391721
  error estimate for blocks of size 2^( 6) =       0.000417541695
  error estimate for blocks of size 2^( 7) =       0.000421787824

      target function =      -0.934501038790
              le_mean =     -17.209665148392
             les_mean =     296.458781213544
             stat err =       0.000415920703
             autocorr =       1.249248190976
   target nu stat err =       0.000415920703
   target dn stat err =       0.002173395760
      target stat err =       0.003673459948
              std dev =       0.526269402039
             le_variance =       0.276959483522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277013050232
                                         uncertainty =       0.001585158056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372122709
  error estimate for blocks of size 2^( 2) =       0.000386256123
  error estimate for blocks of size 2^( 3) =       0.000399761250
  error estimate for blocks of size 2^( 4) =       0.000408961572
  error estimate for blocks of size 2^( 5) =       0.000415391721
  error estimate for blocks of size 2^( 6) =       0.000417541695
  error estimate for blocks of size 2^( 7) =       0.000421787824

      target function =      -0.934501038790
              le_mean =     -17.209665148392
             les_mean =     296.458781213544
             stat err =       0.000415920703
             autocorr =       1.249248190976
   target nu stat err =       0.000415920703
   target dn stat err =       0.002173395760
      target stat err =       0.003673459948
              std dev =       0.526269402039
             le_variance =       0.276959483522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934501038790        initial  <--
     2.4414e+66     2.4414e+67             0.0000e+00        -0.934501038790
     9.7656e+66     9.7656e+67             0.0000e+00        -0.934501038790
     3.9063e+67     3.9063e+68             0.0000e+00        -0.934501038790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1320
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.430163
====================================================
  Execution time = 2.8781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0464e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8296e-01
  Total weights = 1.966343858e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4736e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275512109298
                                         uncertainty =       0.001610083446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275512109298
                                         uncertainty =       0.001610083446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371117586
  error estimate for blocks of size 2^( 2) =       0.000385575492
  error estimate for blocks of size 2^( 3) =       0.000398768377
  error estimate for blocks of size 2^( 4) =       0.000408596525
  error estimate for blocks of size 2^( 5) =       0.000414187226
  error estimate for blocks of size 2^( 6) =       0.000417374448
  error estimate for blocks of size 2^( 7) =       0.000420117006

      target function =      -0.939916080974
              le_mean =     -17.209864871995
             les_mean =     296.462403987147
             stat err =       0.000415068801
             autocorr =       1.250884211651
   target nu stat err =       0.000415068801
   target dn stat err =       0.001918641476
      target stat err =       0.003299140089
              std dev =       0.524847921387
             le_variance =       0.275465340584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720986487199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+67, overlap shift 2.4414e+68 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+67, overlap shift 9.7656e+68 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+68, overlap shift 3.9063e+69 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939926687011       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.694806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7263e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.735998
====================================================
  Execution time = 2.7382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9702e-01
  Total weights = 1.9664e+06
  Execution time = 2.3173e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808886
  error estimate for blocks of size 2^( 2) =       0.000388877437
  error estimate for blocks of size 2^( 3) =       0.000402210387
  error estimate for blocks of size 2^( 4) =       0.000411655789
  error estimate for blocks of size 2^( 5) =       0.000418085367
  error estimate for blocks of size 2^( 6) =       0.000421351008
  error estimate for blocks of size 2^( 7) =       0.000423893477

      target function =      -0.916896650997
              le_mean =     -17.209273611597
             les_mean =     296.456121600294
             stat err =       0.000418746410
             autocorr =       1.248194996700
   target nu stat err =       0.000418746410
   target dn stat err =       0.004898622609
      target stat err =       0.007837059034
              std dev =       0.530068290136
             le_variance =       0.280972392207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808886
  error estimate for blocks of size 2^( 2) =       0.000388877437
  error estimate for blocks of size 2^( 3) =       0.000402210387
  error estimate for blocks of size 2^( 4) =       0.000411655789
  error estimate for blocks of size 2^( 5) =       0.000418085367
  error estimate for blocks of size 2^( 6) =       0.000421351008
  error estimate for blocks of size 2^( 7) =       0.000423893477

      target function =      -0.916896650997
              le_mean =     -17.209273611597
             les_mean =     296.456121600294
             stat err =       0.000418746410
             autocorr =       1.248194996700
   target nu stat err =       0.000418746410
   target dn stat err =       0.004898622609
      target stat err =       0.007837059034
              std dev =       0.530068290136
             le_variance =       0.280972392207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808886
  error estimate for blocks of size 2^( 2) =       0.000388877437
  error estimate for blocks of size 2^( 3) =       0.000402210387
  error estimate for blocks of size 2^( 4) =       0.000411655789
  error estimate for blocks of size 2^( 5) =       0.000418085367
  error estimate for blocks of size 2^( 6) =       0.000421351008
  error estimate for blocks of size 2^( 7) =       0.000423893477

      target function =      -0.916896650997
              le_mean =     -17.209273611597
             les_mean =     296.456121600294
             stat err =       0.000418746410
             autocorr =       1.248194996700
   target nu stat err =       0.000418746410
   target dn stat err =       0.004898622609
      target stat err =       0.007837059034
              std dev =       0.530068290136
             le_variance =       0.280972392207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280989138922
                                         uncertainty =       0.002413374557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374808886
  error estimate for blocks of size 2^( 2) =       0.000388877437
  error estimate for blocks of size 2^( 3) =       0.000402210387
  error estimate for blocks of size 2^( 4) =       0.000411655789
  error estimate for blocks of size 2^( 5) =       0.000418085367
  error estimate for blocks of size 2^( 6) =       0.000421351008
  error estimate for blocks of size 2^( 7) =       0.000423893477

      target function =      -0.916896650997
              le_mean =     -17.209273611597
             les_mean =     296.456121600294
             stat err =       0.000418746410
             autocorr =       1.248194996700
   target nu stat err =       0.000418746410
   target dn stat err =       0.004898622609
      target stat err =       0.007837059034
              std dev =       0.530068290136
             le_variance =       0.280972392207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916896650997        initial  <--
     2.4414e+67     2.4414e+68             0.0000e+00        -0.916896650997
     9.7656e+67     9.7656e+68             0.0000e+00        -0.916896650997
     3.9063e+68     3.9063e+69             0.0000e+00        -0.916896650997

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0832
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.237385
====================================================
  Execution time = 2.7403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8421e-01
  Total weights = 1.966464532e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3874e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431366901
                                         uncertainty =       0.001583752431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276431366901
                                         uncertainty =       0.001583752431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371767892
  error estimate for blocks of size 2^( 2) =       0.000385950854
  error estimate for blocks of size 2^( 3) =       0.000399186653
  error estimate for blocks of size 2^( 4) =       0.000408221054
  error estimate for blocks of size 2^( 5) =       0.000414096945
  error estimate for blocks of size 2^( 6) =       0.000417520323
  error estimate for blocks of size 2^( 7) =       0.000417758034

      target function =      -0.937807916731
              le_mean =     -17.209963804252
             les_mean =     296.467067632594
             stat err =       0.000414399089
             autocorr =       1.242492646553
   target nu stat err =       0.000414399089
   target dn stat err =       0.002109004362
      target stat err =       0.003595312746
              std dev =       0.525767606363
             le_variance =       0.276431575900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720996380425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+68, overlap shift 2.4414e+69 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+68, overlap shift 9.7656e+69 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+69, overlap shift 3.9063e+70 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937820673488       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.696080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5799e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.193529
====================================================
  Execution time = 2.7464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8809e-01
  Total weights = 1.9667e+06
  Execution time = 2.3145e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373061128
  error estimate for blocks of size 2^( 2) =       0.000387277821
  error estimate for blocks of size 2^( 3) =       0.000400713526
  error estimate for blocks of size 2^( 4) =       0.000410631073
  error estimate for blocks of size 2^( 5) =       0.000416981394
  error estimate for blocks of size 2^( 6) =       0.000419343208
  error estimate for blocks of size 2^( 7) =       0.000422368050

      target function =      -0.931389419635
              le_mean =     -17.209565563025
             les_mean =     296.457239022685
             stat err =       0.000417330931
             autocorr =       1.251414404802
   target nu stat err =       0.000417330931
   target dn stat err =       0.002414810602
      target stat err =       0.004038983163
              std dev =       0.527596548391
             le_variance =       0.278358117874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373061128
  error estimate for blocks of size 2^( 2) =       0.000387277821
  error estimate for blocks of size 2^( 3) =       0.000400713526
  error estimate for blocks of size 2^( 4) =       0.000410631073
  error estimate for blocks of size 2^( 5) =       0.000416981394
  error estimate for blocks of size 2^( 6) =       0.000419343208
  error estimate for blocks of size 2^( 7) =       0.000422368050

      target function =      -0.931389419635
              le_mean =     -17.209565563025
             les_mean =     296.457239022685
             stat err =       0.000417330931
             autocorr =       1.251414404799
   target nu stat err =       0.000417330931
   target dn stat err =       0.002414810602
      target stat err =       0.004038983163
              std dev =       0.527596548391
             le_variance =       0.278358117874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373061128
  error estimate for blocks of size 2^( 2) =       0.000387277821
  error estimate for blocks of size 2^( 3) =       0.000400713526
  error estimate for blocks of size 2^( 4) =       0.000410631073
  error estimate for blocks of size 2^( 5) =       0.000416981394
  error estimate for blocks of size 2^( 6) =       0.000419343208
  error estimate for blocks of size 2^( 7) =       0.000422368050

      target function =      -0.931389419635
              le_mean =     -17.209565563025
             les_mean =     296.457239022685
             stat err =       0.000417330931
             autocorr =       1.251414404799
   target nu stat err =       0.000417330931
   target dn stat err =       0.002414810602
      target stat err =       0.004038983163
              std dev =       0.527596548391
             le_variance =       0.278358117874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278419411189
                                         uncertainty =       0.001725018313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373061128
  error estimate for blocks of size 2^( 2) =       0.000387277821
  error estimate for blocks of size 2^( 3) =       0.000400713526
  error estimate for blocks of size 2^( 4) =       0.000410631073
  error estimate for blocks of size 2^( 5) =       0.000416981394
  error estimate for blocks of size 2^( 6) =       0.000419343208
  error estimate for blocks of size 2^( 7) =       0.000422368050

      target function =      -0.931389419635
              le_mean =     -17.209565563025
             les_mean =     296.457239022685
             stat err =       0.000417330931
             autocorr =       1.251414404799
   target nu stat err =       0.000417330931
   target dn stat err =       0.002414810602
      target stat err =       0.004038983163
              std dev =       0.527596548391
             le_variance =       0.278358117874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931389419635        initial  <--
     2.4414e+68     2.4414e+69             0.0000e+00        -0.931389419635
     9.7656e+68     9.7656e+69             0.0000e+00        -0.931389419635
     3.9063e+69     3.9063e+70             0.0000e+00        -0.931389419635

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1505
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4956e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2915
    reference variance = 0.207061
====================================================
  Execution time = 2.7238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0491e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8611e-01
  Total weights = 1.966488129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276263032508
                                         uncertainty =       0.001792132091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276263032508
                                         uncertainty =       0.001792132091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371616439
  error estimate for blocks of size 2^( 2) =       0.000385874038
  error estimate for blocks of size 2^( 3) =       0.000399121688
  error estimate for blocks of size 2^( 4) =       0.000408639997
  error estimate for blocks of size 2^( 5) =       0.000415614882
  error estimate for blocks of size 2^( 6) =       0.000418208489
  error estimate for blocks of size 2^( 7) =       0.000420806219

      target function =      -0.934656667612
              le_mean =     -17.210110917968
             les_mean =     296.474023322626
             stat err =       0.000415817397
             autocorr =       1.252032138195
   target nu stat err =       0.000415817397
   target dn stat err =       0.002197611634
      target stat err =       0.003717070439
              std dev =       0.525553416046
             le_variance =       0.276206393117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721011091797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+69, overlap shift 2.4414e+70 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934670490837       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934670490837       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934670490837       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934670490837       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+69 is 6.369541e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+69, overlap shift 9.7656e+70 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934670490837       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934670490837       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934670490837       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934670490837       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934670490837       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.35e+13           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+69 is 1.684436e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+70, overlap shift 3.9063e+71 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934670490837       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934670490837       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934670490837       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934670490836       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934670489328       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9063e+70 is 4.211838e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.698762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5804e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.198113
====================================================
  Execution time = 2.7286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8716e-01
  Total weights = 1.9665e+06
  Execution time = 2.3193e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372042350
  error estimate for blocks of size 2^( 2) =       0.000385965803
  error estimate for blocks of size 2^( 3) =       0.000399048440
  error estimate for blocks of size 2^( 4) =       0.000408952210
  error estimate for blocks of size 2^( 5) =       0.000414902317
  error estimate for blocks of size 2^( 6) =       0.000419277421
  error estimate for blocks of size 2^( 7) =       0.000422097368

      target function =      -0.932912864216
              le_mean =     -17.209879272109
             les_mean =     296.467104167800
             stat err =       0.000416307329
             autocorr =       1.252112514904
   target nu stat err =       0.000416307329
   target dn stat err =       0.002654283181
      target stat err =       0.004443426272
              std dev =       0.526155754898
             le_variance =       0.276839878413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372042350
  error estimate for blocks of size 2^( 2) =       0.000385965803
  error estimate for blocks of size 2^( 3) =       0.000399048440
  error estimate for blocks of size 2^( 4) =       0.000408952210
  error estimate for blocks of size 2^( 5) =       0.000414902317
  error estimate for blocks of size 2^( 6) =       0.000419277421
  error estimate for blocks of size 2^( 7) =       0.000422097368

      target function =      -0.932912864216
              le_mean =     -17.209879272109
             les_mean =     296.467104167800
             stat err =       0.000416307329
             autocorr =       1.252112514904
   target nu stat err =       0.000416307329
   target dn stat err =       0.002654283181
      target stat err =       0.004443426272
              std dev =       0.526155754898
             le_variance =       0.276839878413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372042350
  error estimate for blocks of size 2^( 2) =       0.000385965803
  error estimate for blocks of size 2^( 3) =       0.000399048440
  error estimate for blocks of size 2^( 4) =       0.000408952210
  error estimate for blocks of size 2^( 5) =       0.000414902317
  error estimate for blocks of size 2^( 6) =       0.000419277421
  error estimate for blocks of size 2^( 7) =       0.000422097368

      target function =      -0.932912864216
              le_mean =     -17.209879272109
             les_mean =     296.467104167800
             stat err =       0.000416307329
             autocorr =       1.252112514904
   target nu stat err =       0.000416307329
   target dn stat err =       0.002654283181
      target stat err =       0.004443426272
              std dev =       0.526155754898
             le_variance =       0.276839878413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276800298828
                                         uncertainty =       0.001919839788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372042350
  error estimate for blocks of size 2^( 2) =       0.000385965803
  error estimate for blocks of size 2^( 3) =       0.000399048440
  error estimate for blocks of size 2^( 4) =       0.000408952210
  error estimate for blocks of size 2^( 5) =       0.000414902317
  error estimate for blocks of size 2^( 6) =       0.000419277421
  error estimate for blocks of size 2^( 7) =       0.000422097368

      target function =      -0.932912864216
              le_mean =     -17.209879272109
             les_mean =     296.467104167800
             stat err =       0.000416307329
             autocorr =       1.252112514904
   target nu stat err =       0.000416307329
   target dn stat err =       0.002654283181
      target stat err =       0.004443426272
              std dev =       0.526155754898
             le_variance =       0.276839878413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932912864216        initial  <--
     2.4414e+69     2.4414e+70             6.3695e-74        -0.932912864216
     9.7656e+69     9.7656e+70             1.6844e-74        -0.932912864216
     3.9063e+70     3.9063e+71             4.2118e-75        -0.932912864216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9986
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.086448e-01 1 1  ON 0
  uu_1                 5.287242e-02 1 1  ON 1
  uu_2                -3.637591e-02 1 1  ON 2
  uu_3                -8.945762e-02 1 1  ON 3
  uu_4                -1.214412e-01 1 1  ON 4
  uu_5                -1.310844e-01 1 1  ON 5
  uu_6                -1.141410e-01 1 1  ON 6
  uu_7                -5.690127e-02 1 1  ON 7
  uu_8                 5.799801e-02 1 1  ON 8
  uu_9                 1.222537e-01 1 1  ON 9
  ud_0                 2.998766e-01 1 1  ON 10
  ud_1                 7.275132e-02 1 1  ON 11
  ud_2                -2.634392e-02 1 1  ON 12
  ud_3                -7.732469e-02 1 1  ON 13
  ud_4                -1.123524e-01 1 1  ON 14
  ud_5                -1.314879e-01 1 1  ON 15
  ud_6                -1.262661e-01 1 1  ON 16
  ud_7                -8.673910e-02 1 1  ON 17
  ud_8                -4.314234e-03 1 1  ON 18
  ud_9                 8.463599e-02 1 1  ON 19
  eO_0                -6.926986e-01 1 1  ON 20
  eO_1                -4.130620e-01 1 1  ON 21
  eO_2                -4.192789e-02 1 1  ON 22
  eO_3                 1.780416e-01 1 1  ON 23
  eO_4                 2.494739e-01 1 1  ON 24
  eO_5                 2.740681e-01 1 1  ON 25
  eO_6                 2.477318e-01 1 1  ON 26
  eO_7                 1.383047e-01 1 1  ON 27
  eO_8                 2.919758e-02 1 1  ON 28
  eO_9                 1.941595e-02 1 1  ON 29
 eH1_0                -2.052597e-01 1 1  ON 30
 eH1_1                -1.001318e-01 1 1  ON 31
 eH1_2                -4.902841e-02 1 1  ON 32
 eH1_3                -1.779315e-02 1 1  ON 33
 eH1_4                 1.687414e-02 1 1  ON 34
 eH1_5                 2.439017e-02 1 1  ON 35
 eH1_6                 7.872400e-02 1 1  ON 36
 eH1_7                 1.067670e-01 1 1  ON 37
 eH1_8                 1.032769e-01 1 1  ON 38
 eH1_9                 2.602796e-02 1 1  ON 39
 eH2_0                -2.020306e-01 1 1  ON 40
 eH2_1                -9.698427e-02 1 1  ON 41
 eH2_2                -4.656569e-02 1 1  ON 42
 eH2_3                -1.596065e-02 1 1  ON 43
 eH2_4                 1.719801e-02 1 1  ON 44
 eH2_5                 2.130531e-02 1 1  ON 45
 eH2_6                 7.068841e-02 1 1  ON 46
 eH2_7                 1.057191e-01 1 1  ON 47
 eH2_8                 1.051737e-01 1 1  ON 48
 eH2_9                 2.839091e-02 1 1  ON 49
ci_001                -4.215091e-02 3 1  ON 50
ci_002                -3.109042e-02 3 1  ON 51
ci_003                -2.582624e-02 3 1  ON 52
ci_004                 2.456283e-02 3 1  ON 53
ci_005                 2.465439e-02 3 1  ON 54
ci_006                -2.043642e-02 3 1  ON 55
ci_007                -2.042689e-02 3 1  ON 56
ci_008                -8.845482e-03 3 1  ON 57
ci_009                -1.497493e-02 3 1  ON 58
ci_010                -9.392016e-03 3 1  ON 59
ci_011                -1.018204e-02 3 1  ON 60
ci_012                -1.016577e-02 3 1  ON 61
ci_013                -1.946905e-02 3 1  ON 62
ci_014                 1.330971e-02 3 1  ON 63
ci_015                 1.319864e-02 3 1  ON 64
ci_016                 1.639980e-02 3 1  ON 65
ci_017                 1.622902e-02 3 1  ON 66
ci_018                 1.018106e-02 3 1  ON 67
ci_019                 1.025307e-02 3 1  ON 68
ci_020                 1.660986e-02 3 1  ON 69
ci_021                 1.650686e-02 3 1  ON 70
ci_022                 1.055237e-02 3 1  ON 71
ci_023                 9.564437e-03 3 1  ON 72
ci_024                 7.556962e-03 3 1  ON 73
ci_025                 6.349901e-03 3 1  ON 74
ci_026                 1.163655e-02 3 1  ON 75
ci_027                 1.175312e-02 3 1  ON 76
ci_028                -1.524555e-02 3 1  ON 77
ci_029                -1.528669e-02 3 1  ON 78
ci_030                -4.398381e-03 3 1  ON 79
ci_031                -4.793398e-03 3 1  ON 80
ci_032                -1.530625e-02 3 1  ON 81
ci_033                 6.830001e-03 3 1  ON 82
ci_034                 7.268799e-03 3 1  ON 83
ci_035                -4.582369e-03 3 1  ON 84
ci_036                -1.277551e-02 3 1  ON 85
ci_037                -1.273764e-02 3 1  ON 86
ci_038                 1.224625e-03 3 1  ON 87
ci_039                 1.418117e-03 3 1  ON 88
ci_040                -2.651130e-03 3 1  ON 89
ci_041                 8.416127e-03 3 1  ON 90
ci_042                 8.444750e-03 3 1  ON 91
ci_043                -3.610956e-03 3 1  ON 92
ci_044                -4.081330e-03 3 1  ON 93
ci_045                -2.796278e-03 3 1  ON 94
ci_046                 5.776765e-03 3 1  ON 95
ci_047                 5.635140e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4808e+01 secs
  Total Execution time = 7.6066e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
