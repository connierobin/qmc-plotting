Rank =    0  Free Memory = 54187 MB
Rank =    1  Free Memory = 54179 MB
Rank =    2  Free Memory = 54179 MB
Rank =    3  Free Memory = 54179 MB
Rank =    4  Free Memory = 54179 MB
Rank =    5  Free Memory = 54179 MB
Rank =    6  Free Memory = 54179 MB
Rank =    7  Free Memory = 54179 MB
Rank =    8  Free Memory = 54179 MB
Rank =    9  Free Memory = 54179 MB
Rank =   10  Free Memory = 54179 MB
Rank =   11  Free Memory = 54179 MB
Rank =   12  Free Memory = 54178 MB
Rank =   13  Free Memory = 54177 MB
Rank =   14  Free Memory = 54177 MB
Rank =   15  Free Memory = 54167 MB
Rank =   16  Free Memory = 54162 MB
Rank =   17  Free Memory = 54162 MB
Rank =   18  Free Memory = 54162 MB
Rank =   19  Free Memory = 54162 MB
Rank =   20  Free Memory = 54162 MB
Rank =   21  Free Memory = 54162 MB
Rank =   22  Free Memory = 54162 MB
Rank =   23  Free Memory = 54162 MB
Rank =   24  Free Memory = 56194 MB
Rank =   25  Free Memory = 56194 MB
Rank =   26  Free Memory = 56194 MB
Rank =   27  Free Memory = 56194 MB
Rank =   28  Free Memory = 56194 MB
Rank =   29  Free Memory = 56194 MB
Rank =   30  Free Memory = 56194 MB
Rank =   31  Free Memory = 56194 MB
Rank =   32  Free Memory = 56194 MB
Rank =   33  Free Memory = 56194 MB
Rank =   34  Free Memory = 56194 MB
Rank =   35  Free Memory = 56194 MB
Rank =   36  Free Memory = 56194 MB
Rank =   37  Free Memory = 56194 MB
Rank =   38  Free Memory = 56194 MB
Rank =   39  Free Memory = 56194 MB
Rank =   40  Free Memory = 56194 MB
Rank =   41  Free Memory = 56194 MB
Rank =   42  Free Memory = 56194 MB
Rank =   43  Free Memory = 56194 MB
Rank =   44  Free Memory = 56194 MB
Rank =   45  Free Memory = 56194 MB
Rank =   46  Free Memory = 56194 MB
Rank =   47  Free Memory = 56194 MB
Rank =   48  Free Memory = 60713 MB
Rank =   49  Free Memory = 60713 MB
Rank =   50  Free Memory = 60713 MB
Rank =   51  Free Memory = 60713 MB
Rank =   52  Free Memory = 60713 MB
Rank =   53  Free Memory = 60713 MB
Rank =   54  Free Memory = 60713 MB
Rank =   55  Free Memory = 60713 MB
Rank =   56  Free Memory = 60713 MB
Rank =   57  Free Memory = 60713 MB
Rank =   58  Free Memory = 60713 MB
Rank =   59  Free Memory = 60713 MB
Rank =   60  Free Memory = 60713 MB
Rank =   61  Free Memory = 60713 MB
Rank =   62  Free Memory = 60713 MB
Rank =   63  Free Memory = 60713 MB
Rank =   64  Free Memory = 60713 MB
Rank =   65  Free Memory = 60713 MB
Rank =   66  Free Memory = 60713 MB
Rank =   67  Free Memory = 60713 MB
Rank =   68  Free Memory = 60713 MB
Rank =   69  Free Memory = 60713 MB
Rank =   70  Free Memory = 60713 MB
Rank =   71  Free Memory = 60713 MB
Rank =   72  Free Memory = 54921 MB
Rank =   73  Free Memory = 54921 MB
Rank =   74  Free Memory = 54921 MB
Rank =   75  Free Memory = 54921 MB
Rank =   76  Free Memory = 54921 MB
Rank =   77  Free Memory = 54921 MB
Rank =   78  Free Memory = 54921 MB
Rank =   79  Free Memory = 54921 MB
Rank =   80  Free Memory = 54921 MB
Rank =   81  Free Memory = 54921 MB
Rank =   82  Free Memory = 54921 MB
Rank =   83  Free Memory = 54921 MB
Rank =   84  Free Memory = 54921 MB
Rank =   85  Free Memory = 54921 MB
Rank =   86  Free Memory = 54921 MB
Rank =   87  Free Memory = 54921 MB
Rank =   88  Free Memory = 54921 MB
Rank =   89  Free Memory = 54921 MB
Rank =   90  Free Memory = 54921 MB
Rank =   91  Free Memory = 54917 MB
Rank =   92  Free Memory = 54915 MB
Rank =   93  Free Memory = 54915 MB
Rank =   94  Free Memory = 54915 MB
Rank =   95  Free Memory = 54915 MB
  Input file(s): opt_h2o_gs_tec_48dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_48dets_run001b.xml

  Project = H2O
  date    = 2023-05-03 09:42:29 PDT
  host    = n0037.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 757

  Range of prime numbers to use as seeds over processors and threads = 5783-6619


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.085226e-01    1         1  ON     0
     uu_1                 5.234236e-02    1         1  ON     1
     uu_2                -3.707546e-02    1         1  ON     2
     uu_3                -9.031758e-02    1         1  ON     3
     uu_4                -1.222790e-01    1         1  ON     4
     uu_5                -1.315724e-01    1         1  ON     5
     uu_6                -1.137333e-01    1         1  ON     6
     uu_7                -5.557761e-02    1         1  ON     7
     uu_8                 6.127295e-02    1         1  ON     8
     uu_9                 1.219792e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.013137e-01    1         1  ON     0
     ud_1                 7.401120e-02    1         1  ON     1
     ud_2                -2.540207e-02    1         1  ON     2
     ud_3                -7.665085e-02    1         1  ON     3
     ud_4                -1.122475e-01    1         1  ON     4
     ud_5                -1.322663e-01    1         1  ON     5
     ud_6                -1.279198e-01    1         1  ON     6
     ud_7                -8.886151e-02    1         1  ON     7
     ud_8                -3.543190e-03    1         1  ON     8
     ud_9                 8.507211e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.939931e-01    1         1  ON     0
     eO_1                -4.135577e-01    1         1  ON     1
     eO_2                -4.114945e-02    1         1  ON     2
     eO_3                 1.790346e-01    1         1  ON     3
     eO_4                 2.510250e-01    1         1  ON     4
     eO_5                 2.753322e-01    1         1  ON     5
     eO_6                 2.475324e-01    1         1  ON     6
     eO_7                 1.360299e-01    1         1  ON     7
     eO_8                 2.899396e-02    1         1  ON     8
     eO_9                 1.933890e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.044522e-01    1         1  ON     0
     eH1_1                -9.984160e-02    1         1  ON     1
     eH1_2                -4.893474e-02    1         1  ON     2
     eH1_3                -1.761908e-02    1         1  ON     3
     eH1_4                 1.758573e-02    1         1  ON     4
     eH1_5                 2.530478e-02    1         1  ON     5
     eH1_6                 7.729273e-02    1         1  ON     6
     eH1_7                 1.064271e-01    1         1  ON     7
     eH1_8                 1.024307e-01    1         1  ON     8
     eH1_9                 2.574338e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.011051e-01    1         1  ON     0
     eH2_1                -9.666840e-02    1         1  ON     1
     eH2_2                -4.626212e-02    1         1  ON     2
     eH2_3                -1.568804e-02    1         1  ON     3
     eH2_4                 1.794291e-02    1         1  ON     4
     eH2_5                 2.168908e-02    1         1  ON     5
     eH2_6                 6.870834e-02    1         1  ON     6
     eH2_7                 1.058400e-01    1         1  ON     7
     eH2_8                 1.043343e-01    1         1  ON     8
     eH2_9                 2.822488e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.692155e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.6548e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 97
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.28333
====================================================
  Execution time = 2.7660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0472e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8706e-01
  Total weights = 1.966194380e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1044e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275911272956
                                         uncertainty =       0.001708890655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275911272956
                                         uncertainty =       0.001708890655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371427619
  error estimate for blocks of size 2^( 2) =       0.000385418337
  error estimate for blocks of size 2^( 3) =       0.000398161729
  error estimate for blocks of size 2^( 4) =       0.000407504219
  error estimate for blocks of size 2^( 5) =       0.000412240928
  error estimate for blocks of size 2^( 6) =       0.000416314705
  error estimate for blocks of size 2^( 7) =       0.000419588303

      target function =      -0.933033677811
              le_mean =     -17.210664941236
             les_mean =     296.494050065671
             stat err =       0.000413912039
             autocorr =       1.241845959743
   target nu stat err =       0.000413912039
   target dn stat err =       0.003329415118
      target stat err =       0.005556366385
              std dev =       0.525286380024
             le_variance =       0.275925781038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721066494124e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933065632086       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933315052105       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933347304045       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933356788792       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933359442602       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933361393999       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933364826316       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933367159298       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933368692728       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933370714408       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933371977380       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933372575234       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933373783966       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933374649311       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933375159096       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933376159703       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933376854540       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933377327470       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933377076928       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933377301250       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933377804828       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933378061766       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933378815702       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933379291141       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933379628381       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933379936860       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933380123269       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933380129556       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933380259623       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933380077543       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933380073129       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933379999966       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933379963459       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933379991921       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933380002118       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933379962605       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933379942353       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933379993859       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933379970534       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933379888673       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933379939853       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933379969410       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933379941735       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933379980668       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933380002572       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.933379973663       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933379981764       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.933379992841       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933379966121       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.826893e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933065632086       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933141751725       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933151224665       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933153930229       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933154662253       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933155212838       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933156215770       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933156833084       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933157223626       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933157793556       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933158123975       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933158272144       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933158606385       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933158857628       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933158998457       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933159255266       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933159401831       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933159512052       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933159442122       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933159499583       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933159605237       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933159678564       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933159898907       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933160008918       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933160057807       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933160124697       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933160162628       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933160142351       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933160158338       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933160125369       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933160116764       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933160097497       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933160092360       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933160105691       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933160095290       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933160092515       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933160093661       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933160098918       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933160090385       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933160088253       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933160093156       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933160092126       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933160093984       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933160101693       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933160097896       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 4.806415e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933065632086       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933085773220       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933088248887       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933088949478       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933089137167       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933089279499       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933089541528       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933089697727       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933089795172       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933089942347       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933090025599       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933090062633       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933090148758       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933090213760       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933090249903       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933090314026       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933090348096       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933090375292       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933090357325       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933090371528       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933090396290       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933090416054       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933090472622       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933090499057       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933090508784       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933090524393       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933090533249       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933090526916       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933090530156       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933090522560       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933090519872       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933090515540       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933090514274       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933090517840       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933090514807       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933090514575       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933090514879       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933090515847       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933090513846       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933090514162       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933090514794       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933090514241       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933090515217       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933090516879       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933090515588       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 4.0000e+00 is 1.216707e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5914e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.084795e-01                 1 1 ON  0
uu_1   5.241986e-02                 1 1 ON  1
uu_2   -3.698857e-02                1 1 ON  2
uu_3   -9.019573e-02                1 1 ON  3
uu_4   -1.221387e-01                1 1 ON  4
uu_5   -1.314973e-01                1 1 ON  5
uu_6   -1.137319e-01                1 1 ON  6
uu_7   -5.580358e-02                1 1 ON  7
uu_8   6.087069e-02                 1 1 ON  8
uu_9   1.220081e-01                 1 1 ON  9
ud_0   3.011665e-01                 1 1 ON  10
ud_1   7.387033e-02                 1 1 ON  11
ud_2   -2.553274e-02                1 1 ON  12
ud_3   -7.676261e-02                1 1 ON  13
ud_4   -1.122570e-01                1 1 ON  14
ud_5   -1.321388e-01                1 1 ON  15
ud_6   -1.276659e-01                1 1 ON  16
ud_7   -8.861848e-02                1 1 ON  17
ud_8   -3.714245e-03                1 1 ON  18
ud_9   8.504475e-02                 1 1 ON  19
eO_0   -6.937731e-01                1 1 ON  20
eO_1   -4.134669e-01                1 1 ON  21
eO_2   -4.121310e-02                1 1 ON  22
eO_3   1.788749e-01                 1 1 ON  23
eO_4   2.507702e-01                 1 1 ON  24
eO_5   2.751861e-01                 1 1 ON  25
eO_6   2.475825e-01                 1 1 ON  26
eO_7   1.362567e-01                 1 1 ON  27
eO_8   2.900996e-02                 1 1 ON  28
eO_9   1.935580e-02                 1 1 ON  29
eH1_0  -2.047159e-01                1 1 ON  30
eH1_1  -1.000221e-01                1 1 ON  31
eH1_2  -4.908429e-02                1 1 ON  32
eH1_3  -1.768721e-02                1 1 ON  33
eH1_4  1.750484e-02                 1 1 ON  34
eH1_5  2.533028e-02                 1 1 ON  35
eH1_6  7.776056e-02                 1 1 ON  36
eH1_7  1.065734e-01                 1 1 ON  37
eH1_8  1.024906e-01                 1 1 ON  38
eH1_9  2.577385e-02                 1 1 ON  39
eH2_0  -2.012328e-01                1 1 ON  40
eH2_1  -9.672479e-02                1 1 ON  41
eH2_2  -4.633384e-02                1 1 ON  42
eH2_3  -1.575409e-02                1 1 ON  43
eH2_4  1.778024e-02                 1 1 ON  44
eH2_5  2.154133e-02                 1 1 ON  45
eH2_6  6.918898e-02                 1 1 ON  46
eH2_7  1.058825e-01                 1 1 ON  47
eH2_8  1.044086e-01                 1 1 ON  48
eH2_9  2.824036e-02                 1 1 ON  49
ci_001 -4.261226e-02                3 1 ON  50
ci_002 -3.123360e-02                3 1 ON  51
ci_003 -2.587227e-02                3 1 ON  52
ci_004 2.447357e-02                 3 1 ON  53
ci_005 2.455880e-02                 3 1 ON  54
ci_006 -2.036533e-02                3 1 ON  55
ci_007 -2.051752e-02                3 1 ON  56
ci_008 -8.979325e-03                3 1 ON  57
ci_009 -1.503225e-02                3 1 ON  58
ci_010 -9.382537e-03                3 1 ON  59
ci_011 -1.045924e-02                3 1 ON  60
ci_012 -1.031072e-02                3 1 ON  61
ci_013 -1.949913e-02                3 1 ON  62
ci_014 1.303098e-02                 3 1 ON  63
ci_015 1.341910e-02                 3 1 ON  64
ci_016 1.649472e-02                 3 1 ON  65
ci_017 1.622440e-02                 3 1 ON  66
ci_018 1.032059e-02                 3 1 ON  67
ci_019 1.027671e-02                 3 1 ON  68
ci_020 1.661010e-02                 3 1 ON  69
ci_021 1.648728e-02                 3 1 ON  70
ci_022 1.072069e-02                 3 1 ON  71
ci_023 9.850584e-03                 3 1 ON  72
ci_024 7.612608e-03                 3 1 ON  73
ci_025 6.720630e-03                 3 1 ON  74
ci_026 1.179292e-02                 3 1 ON  75
ci_027 1.162889e-02                 3 1 ON  76
ci_028 -1.512531e-02                3 1 ON  77
ci_029 -1.540708e-02                3 1 ON  78
ci_030 -4.723414e-03                3 1 ON  79
ci_031 -4.857199e-03                3 1 ON  80
ci_032 -1.521659e-02                3 1 ON  81
ci_033 6.875137e-03                 3 1 ON  82
ci_034 7.359935e-03                 3 1 ON  83
ci_035 -4.655772e-03                3 1 ON  84
ci_036 -1.280291e-02                3 1 ON  85
ci_037 -1.273315e-02                3 1 ON  86
ci_038 1.220888e-03                 3 1 ON  87
ci_039 1.461015e-03                 3 1 ON  88
ci_040 -2.749753e-03                3 1 ON  89
ci_041 8.519184e-03                 3 1 ON  90
ci_042 8.332973e-03                 3 1 ON  91
ci_043 -3.615836e-03                3 1 ON  92
ci_044 -4.714941e-03                3 1 ON  93
ci_045 -2.829366e-03                3 1 ON  94
ci_046 5.890957e-03                 3 1 ON  95
ci_047 5.790310e-03                 3 1 ON  96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1621
    reference variance = 0.173029
====================================================
  Execution time = 2.7252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8124e-01
  Total weights = 1.9662e+06
  Execution time = 2.3882e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273389806358
                                         uncertainty =       0.001376949614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273389806358
                                         uncertainty =       0.001376949614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369684223
  error estimate for blocks of size 2^( 2) =       0.000383895381
  error estimate for blocks of size 2^( 3) =       0.000396961163
  error estimate for blocks of size 2^( 4) =       0.000406708235
  error estimate for blocks of size 2^( 5) =       0.000412491924
  error estimate for blocks of size 2^( 6) =       0.000415449192
  error estimate for blocks of size 2^( 7) =       0.000417510568

      target function =      -0.942537894906
              le_mean =     -17.209444257697
             les_mean =     296.446367899867
             stat err =       0.000413039980
             autocorr =       1.248309709075
   target nu stat err =       0.000413039980
   target dn stat err =       0.001970472343
      target stat err =       0.003399709558
              std dev =       0.522820806770
             le_variance =       0.273341595992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273293823382
                                         uncertainty =       0.001373650247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273293823382
                                         uncertainty =       0.001373650247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369619572
  error estimate for blocks of size 2^( 2) =       0.000383899704
  error estimate for blocks of size 2^( 3) =       0.000397049882
  error estimate for blocks of size 2^( 4) =       0.000406863236
  error estimate for blocks of size 2^( 5) =       0.000412692135
  error estimate for blocks of size 2^( 6) =       0.000415649820
  error estimate for blocks of size 2^( 7) =       0.000417706811

      target function =      -0.942665718095
              le_mean =     -17.209443652147
             les_mean =     296.446271032968
             stat err =       0.000413228001
             autocorr =       1.249883585965
   target nu stat err =       0.000413228001
   target dn stat err =       0.001990659211
      target stat err =       0.003433883849
              std dev =       0.522729374677
             le_variance =       0.273245999151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273322676408
                                         uncertainty =       0.001374889041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273322676408
                                         uncertainty =       0.001374889041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369638990
  error estimate for blocks of size 2^( 2) =       0.000383890282
  error estimate for blocks of size 2^( 3) =       0.000397005429
  error estimate for blocks of size 2^( 4) =       0.000406791113
  error estimate for blocks of size 2^( 5) =       0.000412601504
  error estimate for blocks of size 2^( 6) =       0.000415559010
  error estimate for blocks of size 2^( 7) =       0.000417617696

      target function =      -0.942410209103
              le_mean =     -17.209442052080
             les_mean =     296.446367725434
             stat err =       0.000413142331
             autocorr =       1.249234130665
   target nu stat err =       0.000413142331
   target dn stat err =       0.001984658116
      target stat err =       0.003422155025
              std dev =       0.522756836795
             le_variance =       0.273274710416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379168434
                                         uncertainty =       0.001376662546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273379168434
                                         uncertainty =       0.001376662546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369677052
  error estimate for blocks of size 2^( 2) =       0.000383893390
  error estimate for blocks of size 2^( 3) =       0.000396965604
  error estimate for blocks of size 2^( 4) =       0.000406717612
  error estimate for blocks of size 2^( 5) =       0.000412504730
  error estimate for blocks of size 2^( 6) =       0.000415461998
  error estimate for blocks of size 2^( 7) =       0.000417523008

      target function =      -0.942523055700
              le_mean =     -17.209443666989
             les_mean =     296.446356367707
             stat err =       0.000413051837
             autocorr =       1.248429815277
   target nu stat err =       0.000413051837
   target dn stat err =       0.001972785373
      target stat err =       0.003403408547
              std dev =       0.522810664810
             le_variance =       0.273330991239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942537894906        initial
     2.5000e-01     2.5000e+00             1.8269e-03        -0.942665718095  <--
     1.0000e+00     1.0000e+01             4.8064e-04        -0.942410209103
     4.0000e+00     4.0000e+01             1.2167e-04        -0.942523055700

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.9275e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.084206e-01 1 1  ON 0
  uu_1                 5.262902e-02 1 1  ON 1
  uu_2                -3.675212e-02 1 1  ON 2
  uu_3                -8.987331e-02 1 1  ON 3
  uu_4                -1.217688e-01 1 1  ON 4
  uu_5                -1.312810e-01 1 1  ON 5
  uu_6                -1.137263e-01 1 1  ON 6
  uu_7                -5.642064e-02 1 1  ON 7
  uu_8                 5.968480e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.007753e-01 1 1  ON 10
  ud_1                 7.349590e-02 1 1  ON 11
  ud_2                -2.587755e-02 1 1  ON 12
  ud_3                -7.705174e-02 1 1  ON 13
  ud_4                -1.122916e-01 1 1  ON 14
  ud_5                -1.318273e-01 1 1  ON 15
  ud_6                -1.270178e-01 1 1  ON 16
  ud_7                -8.795138e-02 1 1  ON 17
  ud_8                -4.167907e-03 1 1  ON 18
  ud_9                 8.496067e-02 1 1  ON 19
  eO_0                -6.932240e-01 1 1  ON 20
  eO_1                -4.132284e-01 1 1  ON 21
  eO_2                -4.137893e-02 1 1  ON 22
  eO_3                 1.784362e-01 1 1  ON 23
  eO_4                 2.500638e-01 1 1  ON 24
  eO_5                 2.747453e-01 1 1  ON 25
  eO_6                 2.477445e-01 1 1  ON 26
  eO_7                 1.369461e-01 1 1  ON 27
  eO_8                 2.906033e-02 1 1  ON 28
  eO_9                 1.940696e-02 1 1  ON 29
 eH1_0                -2.054395e-01 1 1  ON 30
 eH1_1                -1.005426e-01 1 1  ON 31
 eH1_2                -4.953047e-02 1 1  ON 32
 eH1_3                -1.794027e-02 1 1  ON 33
 eH1_4                 1.725548e-02 1 1  ON 34
 eH1_5                 2.540486e-02 1 1  ON 35
 eH1_6                 7.909626e-02 1 1  ON 36
 eH1_7                 1.070402e-01 1 1  ON 37
 eH1_8                 1.026746e-01 1 1  ON 38
 eH1_9                 2.586652e-02 1 1  ON 39
 eH2_0                -2.015952e-01 1 1  ON 40
 eH2_1                -9.692229e-02 1 1  ON 41
 eH2_2                -4.656753e-02 1 1  ON 42
 eH2_3                -1.597628e-02 1 1  ON 43
 eH2_4                 1.733510e-02 1 1  ON 44
 eH2_5                 2.116358e-02 1 1  ON 45
 eH2_6                 7.053523e-02 1 1  ON 46
 eH2_7                 1.060420e-01 1 1  ON 47
 eH2_8                 1.046354e-01 1 1  ON 48
 eH2_9                 2.828769e-02 1 1  ON 49
ci_001                -4.236649e-02 3 1  ON 50
ci_002                -3.117140e-02 3 1  ON 51
ci_003                -2.574370e-02 3 1  ON 52
ci_004                 2.448648e-02 3 1  ON 53
ci_005                 2.459180e-02 3 1  ON 54
ci_006                -2.027533e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.994499e-03 3 1  ON 57
ci_009                -1.502888e-02 3 1  ON 58
ci_010                -9.433131e-03 3 1  ON 59
ci_011                -1.021318e-02 3 1  ON 60
ci_012                -1.012529e-02 3 1  ON 61
ci_013                -1.952641e-02 3 1  ON 62
ci_014                 1.297548e-02 3 1  ON 63
ci_015                 1.320461e-02 3 1  ON 64
ci_016                 1.641374e-02 3 1  ON 65
ci_017                 1.619530e-02 3 1  ON 66
ci_018                 1.022025e-02 3 1  ON 67
ci_019                 1.040528e-02 3 1  ON 68
ci_020                 1.646850e-02 3 1  ON 69
ci_021                 1.642462e-02 3 1  ON 70
ci_022                 1.056324e-02 3 1  ON 71
ci_023                 9.268823e-03 3 1  ON 72
ci_024                 7.503254e-03 3 1  ON 73
ci_025                 6.046093e-03 3 1  ON 74
ci_026                 1.168706e-02 3 1  ON 75
ci_027                 1.168128e-02 3 1  ON 76
ci_028                -1.521032e-02 3 1  ON 77
ci_029                -1.537762e-02 3 1  ON 78
ci_030                -4.433392e-03 3 1  ON 79
ci_031                -4.885354e-03 3 1  ON 80
ci_032                -1.533952e-02 3 1  ON 81
ci_033                 6.957682e-03 3 1  ON 82
ci_034                 7.342814e-03 3 1  ON 83
ci_035                -4.578607e-03 3 1  ON 84
ci_036                -1.271879e-02 3 1  ON 85
ci_037                -1.279737e-02 3 1  ON 86
ci_038                 1.171098e-03 3 1  ON 87
ci_039                 1.342997e-03 3 1  ON 88
ci_040                -2.715001e-03 3 1  ON 89
ci_041                 8.465760e-03 3 1  ON 90
ci_042                 8.397322e-03 3 1  ON 91
ci_043                -3.612943e-03 3 1  ON 92
ci_044                -4.758497e-03 3 1  ON 93
ci_045                -2.793878e-03 3 1  ON 94
ci_046                 5.850911e-03 3 1  ON 95
ci_047                 5.648118e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1752
    reference variance = 0.217681
====================================================
  Execution time = 2.7370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0506e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8954e-01
  Total weights = 1.966477891e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3267e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276967987278
                                         uncertainty =       0.001882799381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276967987278
                                         uncertainty =       0.001882799381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372122717
  error estimate for blocks of size 2^( 2) =       0.000386322161
  error estimate for blocks of size 2^( 3) =       0.000399132422
  error estimate for blocks of size 2^( 4) =       0.000409256493
  error estimate for blocks of size 2^( 5) =       0.000415376768
  error estimate for blocks of size 2^( 6) =       0.000419369886
  error estimate for blocks of size 2^( 7) =       0.000421402929

      target function =      -0.928991275881
              le_mean =     -17.209582530150
             les_mean =     296.459272486846
             stat err =       0.000416351519
             autocorr =       1.251837455097
   target nu stat err =       0.000416351519
   target dn stat err =       0.003326983287
      target stat err =       0.005494060464
              std dev =       0.526269412809
             le_variance =       0.276959494858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720958253015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929022523557       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929272680703       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929350266230       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929385690265       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929390239893       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929397503562       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929399037918       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929402389403       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929405091382       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929405190334       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929404958483       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929406320514       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929407608590       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929407861542       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929410008481       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929411040733       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929412924140       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929413721779       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929415057081       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929415415929       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929416101189       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929416679736       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929417574655       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929416853053       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929417017339       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929417197102       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929417789198       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929418204947       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929419036782       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929419095253       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929418964212       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929419398671       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929419462798       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929419727152       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929419940479       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929420144630       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929419584211       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929419768118       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929420103968       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929420201777       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929420591486       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929420332654       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929420110616       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929420124280       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929420292872       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929420564907       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929420521316       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.929420519668       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929420373905       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.929420383554       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.929420354444       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         50 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-02 is 4.984412e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929022523557       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929130171485       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929160922668       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929173903408       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929175388124       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929178151622       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929178588141       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929180062262       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929180736754       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929181001296       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929180824631       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929181200389       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929181867263       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929182129528       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929182774757       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929183051073       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929183563855       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929183817810       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929184375314       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929184549687       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929184652219       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929184738209       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929184811505       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929184684542       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929184696990       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929184904516       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929185023835       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929185125501       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929185125064       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929185127328       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929185048989       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929185197812       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929185183516       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929185271350       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929185264325       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929185238638       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929185157243       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929185236401       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929185317517       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929185282527       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929185316842       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929185243790       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929185248780       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929185268627       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929185305067       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929185305770       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929185306164       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.929185279746       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929185278289       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e-01 is 1.356484e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929022523557       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929055354409       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929064325511       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929067963130       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929068381521       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929069170939       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929069265901       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929069716191       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929069873735       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929069970977       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929069937234       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929070052814       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929070259924       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929070312833       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929070481621       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929070544410       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929070678294       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929070754352       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929070914999       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929070958617       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929070962151       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929070973152       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929070976345       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929070967596       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929070957270       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929071031957       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929071046445       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929071064569       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929071054766       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929071051146       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929071037543       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929071071097       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929071068756       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929071086800       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929071079716       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929071072205       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929071065273       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929071082136       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929071091600       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929071081679       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929071088309       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929071076873       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929071078627       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929071084727       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+00 is 3.459790e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5837e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.086502e-01 1 1  ON 0
  uu_1                 5.288050e-02 1 1  ON 1
  uu_2                -3.652391e-02 1 1  ON 2
  uu_3                -8.957837e-02 1 1  ON 3
  uu_4                -1.213965e-01 1 1  ON 4
  uu_5                -1.310286e-01 1 1  ON 5
  uu_6                -1.141200e-01 1 1  ON 6
  uu_7                -5.672672e-02 1 1  ON 7
  uu_8                 5.832831e-02 1 1  ON 8
  uu_9                 1.222351e-01 1 1  ON 9
  ud_0                 3.001446e-01 1 1  ON 10
  ud_1                 7.305061e-02 1 1  ON 11
  ud_2                -2.609385e-02 1 1  ON 12
  ud_3                -7.701259e-02 1 1  ON 13
  ud_4                -1.121072e-01 1 1  ON 14
  ud_5                -1.315381e-01 1 1  ON 15
  ud_6                -1.265323e-01 1 1  ON 16
  ud_7                -8.704117e-02 1 1  ON 17
  ud_8                -4.602997e-03 1 1  ON 18
  ud_9                 8.429434e-02 1 1  ON 19
  eO_0                -6.928978e-01 1 1  ON 20
  eO_1                -4.133194e-01 1 1  ON 21
  eO_2                -4.206395e-02 1 1  ON 22
  eO_3                 1.777802e-01 1 1  ON 23
  eO_4                 2.501984e-01 1 1  ON 24
  eO_5                 2.747288e-01 1 1  ON 25
  eO_6                 2.479381e-01 1 1  ON 26
  eO_7                 1.376550e-01 1 1  ON 27
  eO_8                 2.914254e-02 1 1  ON 28
  eO_9                 1.940875e-02 1 1  ON 29
 eH1_0                -2.056249e-01 1 1  ON 30
 eH1_1                -1.001415e-01 1 1  ON 31
 eH1_2                -4.904088e-02 1 1  ON 32
 eH1_3                -1.766552e-02 1 1  ON 33
 eH1_4                 1.711494e-02 1 1  ON 34
 eH1_5                 2.488164e-02 1 1  ON 35
 eH1_6                 7.866230e-02 1 1  ON 36
 eH1_7                 1.068502e-01 1 1  ON 37
 eH1_8                 1.029127e-01 1 1  ON 38
 eH1_9                 2.594844e-02 1 1  ON 39
 eH2_0                -2.013014e-01 1 1  ON 40
 eH2_1                -9.659215e-02 1 1  ON 41
 eH2_2                -4.611610e-02 1 1  ON 42
 eH2_3                -1.566428e-02 1 1  ON 43
 eH2_4                 1.698258e-02 1 1  ON 44
 eH2_5                 2.057371e-02 1 1  ON 45
 eH2_6                 7.029909e-02 1 1  ON 46
 eH2_7                 1.054178e-01 1 1  ON 47
 eH2_8                 1.050264e-01 1 1  ON 48
 eH2_9                 2.829403e-02 1 1  ON 49
ci_001                -4.194917e-02 3 1  ON 50
ci_002                -3.114952e-02 3 1  ON 51
ci_003                -2.549070e-02 3 1  ON 52
ci_004                 2.447550e-02 3 1  ON 53
ci_005                 2.449836e-02 3 1  ON 54
ci_006                -2.040501e-02 3 1  ON 55
ci_007                -2.042786e-02 3 1  ON 56
ci_008                -8.806352e-03 3 1  ON 57
ci_009                -1.499849e-02 3 1  ON 58
ci_010                -9.825430e-03 3 1  ON 59
ci_011                -1.019370e-02 3 1  ON 60
ci_012                -9.850069e-03 3 1  ON 61
ci_013                -1.936187e-02 3 1  ON 62
ci_014                 1.303918e-02 3 1  ON 63
ci_015                 1.347055e-02 3 1  ON 64
ci_016                 1.612204e-02 3 1  ON 65
ci_017                 1.588984e-02 3 1  ON 66
ci_018                 1.010563e-02 3 1  ON 67
ci_019                 1.056036e-02 3 1  ON 68
ci_020                 1.666008e-02 3 1  ON 69
ci_021                 1.658925e-02 3 1  ON 70
ci_022                 1.071881e-02 3 1  ON 71
ci_023                 9.638138e-03 3 1  ON 72
ci_024                 7.626396e-03 3 1  ON 73
ci_025                 6.216655e-03 3 1  ON 74
ci_026                 1.210157e-02 3 1  ON 75
ci_027                 1.152417e-02 3 1  ON 76
ci_028                -1.526571e-02 3 1  ON 77
ci_029                -1.518414e-02 3 1  ON 78
ci_030                -4.359778e-03 3 1  ON 79
ci_031                -4.988182e-03 3 1  ON 80
ci_032                -1.525179e-02 3 1  ON 81
ci_033                 6.573581e-03 3 1  ON 82
ci_034                 7.497558e-03 3 1  ON 83
ci_035                -4.635802e-03 3 1  ON 84
ci_036                -1.269409e-02 3 1  ON 85
ci_037                -1.256744e-02 3 1  ON 86
ci_038                 1.146483e-03 3 1  ON 87
ci_039                 1.311541e-03 3 1  ON 88
ci_040                -2.705329e-03 3 1  ON 89
ci_041                 8.647288e-03 3 1  ON 90
ci_042                 8.451792e-03 3 1  ON 91
ci_043                -3.623949e-03 3 1  ON 92
ci_044                -4.586530e-03 3 1  ON 93
ci_045                -2.917942e-03 3 1  ON 94
ci_046                 5.913478e-03 3 1  ON 95
ci_047                 5.600336e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.228807
====================================================
  Execution time = 2.9426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8636e-01
  Total weights = 1.9662e+06
  Execution time = 2.4019e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274835727860
                                         uncertainty =       0.001587825001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274835727860
                                         uncertainty =       0.001587825001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370695106
  error estimate for blocks of size 2^( 2) =       0.000384735966
  error estimate for blocks of size 2^( 3) =       0.000398335357
  error estimate for blocks of size 2^( 4) =       0.000408263436
  error estimate for blocks of size 2^( 5) =       0.000414187448
  error estimate for blocks of size 2^( 6) =       0.000417835070
  error estimate for blocks of size 2^( 7) =       0.000418704455

      target function =      -0.928740451796
              le_mean =     -17.208986612613
             les_mean =     296.438914513892
             stat err =       0.000414747602
             autocorr =       1.251797448911
   target nu stat err =       0.000414747602
   target dn stat err =       0.004327092347
      target stat err =       0.007107544756
              std dev =       0.524250434893
             le_variance =       0.274838518486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276645947683
                                         uncertainty =       0.002271082037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276645947683
                                         uncertainty =       0.002271082037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371912001
  error estimate for blocks of size 2^( 2) =       0.000386059469
  error estimate for blocks of size 2^( 3) =       0.000399750949
  error estimate for blocks of size 2^( 4) =       0.000409744726
  error estimate for blocks of size 2^( 5) =       0.000415725647
  error estimate for blocks of size 2^( 6) =       0.000419358810
  error estimate for blocks of size 2^( 7) =       0.000420218743

      target function =      -0.123737644557
              le_mean =     -17.209016750004
             les_mean =     298.513173395044
             stat err =       0.000416261982
             autocorr =       1.252717398686
   target nu stat err =       0.000416261982
   target dn stat err =       2.072671191878
      target stat err =       0.097087518610
              std dev =       0.525971411234
             le_variance =       0.276645925436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274936839850
                                         uncertainty =       0.001591599746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274936839850
                                         uncertainty =       0.001591599746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370762656
  error estimate for blocks of size 2^( 2) =       0.000384915526
  error estimate for blocks of size 2^( 3) =       0.000398630174
  error estimate for blocks of size 2^( 4) =       0.000408633197
  error estimate for blocks of size 2^( 5) =       0.000414584766
  error estimate for blocks of size 2^( 6) =       0.000418290388
  error estimate for blocks of size 2^( 7) =       0.000419160405

      target function =      -0.920854595462
              le_mean =     -17.208983183556
             les_mean =     296.443589870161
             stat err =       0.000415167189
             autocorr =       1.253874524050
   target nu stat err =       0.000415167189
   target dn stat err =       0.007857150019
      target stat err =       0.012642957956
              std dev =       0.524345965564
             le_variance =       0.274938691603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274920318082
                                         uncertainty =       0.001571727764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274920318082
                                         uncertainty =       0.001571727764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370752048
  error estimate for blocks of size 2^( 2) =       0.000384807471
  error estimate for blocks of size 2^( 3) =       0.000398423566
  error estimate for blocks of size 2^( 4) =       0.000408359950
  error estimate for blocks of size 2^( 5) =       0.000414283044
  error estimate for blocks of size 2^( 6) =       0.000417923723
  error estimate for blocks of size 2^( 7) =       0.000418791064

      target function =      -0.794306940632
              le_mean =     -17.208977367353
             les_mean =     296.523376758773
             stat err =       0.000414839445
             autocorr =       1.251967261438
   target nu stat err =       0.000414839445
   target dn stat err =       0.086578279170
      target stat err =       0.105281078182
              std dev =       0.524330963724
             le_variance =       0.274922959520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928740451796        initial  <--
     6.2500e-02     6.2500e-01             4.9844e-03        -0.123737644557
     2.5000e-01     2.5000e+00             1.3565e-03        -0.920854595462
     1.0000e+00     1.0000e+01             3.4598e-04        -0.794306940632

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.4904
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.084206e-01 1 1  ON 0
  uu_1                 5.262902e-02 1 1  ON 1
  uu_2                -3.675212e-02 1 1  ON 2
  uu_3                -8.987331e-02 1 1  ON 3
  uu_4                -1.217688e-01 1 1  ON 4
  uu_5                -1.312810e-01 1 1  ON 5
  uu_6                -1.137263e-01 1 1  ON 6
  uu_7                -5.642064e-02 1 1  ON 7
  uu_8                 5.968480e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.007753e-01 1 1  ON 10
  ud_1                 7.349590e-02 1 1  ON 11
  ud_2                -2.587755e-02 1 1  ON 12
  ud_3                -7.705174e-02 1 1  ON 13
  ud_4                -1.122916e-01 1 1  ON 14
  ud_5                -1.318273e-01 1 1  ON 15
  ud_6                -1.270178e-01 1 1  ON 16
  ud_7                -8.795138e-02 1 1  ON 17
  ud_8                -4.167907e-03 1 1  ON 18
  ud_9                 8.496067e-02 1 1  ON 19
  eO_0                -6.932240e-01 1 1  ON 20
  eO_1                -4.132284e-01 1 1  ON 21
  eO_2                -4.137893e-02 1 1  ON 22
  eO_3                 1.784362e-01 1 1  ON 23
  eO_4                 2.500638e-01 1 1  ON 24
  eO_5                 2.747453e-01 1 1  ON 25
  eO_6                 2.477445e-01 1 1  ON 26
  eO_7                 1.369461e-01 1 1  ON 27
  eO_8                 2.906033e-02 1 1  ON 28
  eO_9                 1.940696e-02 1 1  ON 29
 eH1_0                -2.054395e-01 1 1  ON 30
 eH1_1                -1.005426e-01 1 1  ON 31
 eH1_2                -4.953047e-02 1 1  ON 32
 eH1_3                -1.794027e-02 1 1  ON 33
 eH1_4                 1.725548e-02 1 1  ON 34
 eH1_5                 2.540486e-02 1 1  ON 35
 eH1_6                 7.909626e-02 1 1  ON 36
 eH1_7                 1.070402e-01 1 1  ON 37
 eH1_8                 1.026746e-01 1 1  ON 38
 eH1_9                 2.586652e-02 1 1  ON 39
 eH2_0                -2.015952e-01 1 1  ON 40
 eH2_1                -9.692229e-02 1 1  ON 41
 eH2_2                -4.656753e-02 1 1  ON 42
 eH2_3                -1.597628e-02 1 1  ON 43
 eH2_4                 1.733510e-02 1 1  ON 44
 eH2_5                 2.116358e-02 1 1  ON 45
 eH2_6                 7.053523e-02 1 1  ON 46
 eH2_7                 1.060420e-01 1 1  ON 47
 eH2_8                 1.046354e-01 1 1  ON 48
 eH2_9                 2.828769e-02 1 1  ON 49
ci_001                -4.236649e-02 3 1  ON 50
ci_002                -3.117140e-02 3 1  ON 51
ci_003                -2.574370e-02 3 1  ON 52
ci_004                 2.448648e-02 3 1  ON 53
ci_005                 2.459180e-02 3 1  ON 54
ci_006                -2.027533e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.994499e-03 3 1  ON 57
ci_009                -1.502888e-02 3 1  ON 58
ci_010                -9.433131e-03 3 1  ON 59
ci_011                -1.021318e-02 3 1  ON 60
ci_012                -1.012529e-02 3 1  ON 61
ci_013                -1.952641e-02 3 1  ON 62
ci_014                 1.297548e-02 3 1  ON 63
ci_015                 1.320461e-02 3 1  ON 64
ci_016                 1.641374e-02 3 1  ON 65
ci_017                 1.619530e-02 3 1  ON 66
ci_018                 1.022025e-02 3 1  ON 67
ci_019                 1.040528e-02 3 1  ON 68
ci_020                 1.646850e-02 3 1  ON 69
ci_021                 1.642462e-02 3 1  ON 70
ci_022                 1.056324e-02 3 1  ON 71
ci_023                 9.268823e-03 3 1  ON 72
ci_024                 7.503254e-03 3 1  ON 73
ci_025                 6.046093e-03 3 1  ON 74
ci_026                 1.168706e-02 3 1  ON 75
ci_027                 1.168128e-02 3 1  ON 76
ci_028                -1.521032e-02 3 1  ON 77
ci_029                -1.537762e-02 3 1  ON 78
ci_030                -4.433392e-03 3 1  ON 79
ci_031                -4.885354e-03 3 1  ON 80
ci_032                -1.533952e-02 3 1  ON 81
ci_033                 6.957682e-03 3 1  ON 82
ci_034                 7.342814e-03 3 1  ON 83
ci_035                -4.578607e-03 3 1  ON 84
ci_036                -1.271879e-02 3 1  ON 85
ci_037                -1.279737e-02 3 1  ON 86
ci_038                 1.171098e-03 3 1  ON 87
ci_039                 1.342997e-03 3 1  ON 88
ci_040                -2.715001e-03 3 1  ON 89
ci_041                 8.465760e-03 3 1  ON 90
ci_042                 8.397322e-03 3 1  ON 91
ci_043                -3.612943e-03 3 1  ON 92
ci_044                -4.758497e-03 3 1  ON 93
ci_045                -2.793878e-03 3 1  ON 94
ci_046                 5.850911e-03 3 1  ON 95
ci_047                 5.648118e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.186729
====================================================
  Execution time = 2.7188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0502e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8926e-01
  Total weights = 1.966453137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3852e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277475532556
                                         uncertainty =       0.001680224876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277475532556
                                         uncertainty =       0.001680224876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372484716
  error estimate for blocks of size 2^( 2) =       0.000386657673
  error estimate for blocks of size 2^( 3) =       0.000399674551
  error estimate for blocks of size 2^( 4) =       0.000409596692
  error estimate for blocks of size 2^( 5) =       0.000416022059
  error estimate for blocks of size 2^( 6) =       0.000419029462
  error estimate for blocks of size 2^( 7) =       0.000420941592

      target function =      -0.929429637725
              le_mean =     -17.210404443428
             les_mean =     296.487281196688
             stat err =       0.000416397451
             autocorr =       1.249681126917
   target nu stat err =       0.000416397451
   target dn stat err =       0.002914103457
      target stat err =       0.004837258202
              std dev =       0.526781365321
             le_variance =       0.277498606849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721040444343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929453873518       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929514873153       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929526006278       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929530367819       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929531295481       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929532264169       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929532513723       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929534047921       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929534742443       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929535239618       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929535399494       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929535792778       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929536301073       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929536484214       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929537187725       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929537470190       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929537837586       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929538035371       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929538169034       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929538384477       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929538399303       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929538359801       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929538233181       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929538162999       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929538177585       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929538162945       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929538146703       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929538151862       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929538269711       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929538341023       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929538377167       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929538363038       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929538389052       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929538355721       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929538385183       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929538406528       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929538411868       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929538412106       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929538388745       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929538375214       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929538374314       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929538379841       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929538377213       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929538384474       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929538379411       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929538376670       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929538375537       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         46 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e-01 is 7.171713e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929453873518       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929470507354       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929473451533       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929474622374       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929474871982       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929475124155       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929475184619       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929475597728       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929475776625       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929475910067       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929475951292       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929476064720       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929476179589       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929476270841       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929476424620       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929476474835       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929476571170       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929476620666       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929476655845       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929476707658       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929476705795       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929476690832       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929476656808       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929476640884       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929476643427       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929476640228       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929476637595       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929476642415       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929476668279       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929476683930       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929476690870       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929476686163       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929476694012       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929476687260       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929476693801       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929476697945       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929476698672       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929476699084       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929476692932       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929476690267       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929476689838       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929476690992       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929476690492       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929476692178       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+00 is 1.834255e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929453873518       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929458128505       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929458875224       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929459173436       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929459237077       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929459300755       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929459315712       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929459421025       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929459466053       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929459500076       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929459510445       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929459539899       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929459567411       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929459595265       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929459631744       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929459641356       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929459666111       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929459678352       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929459687294       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929459700057       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929459699196       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929459695109       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929459686489       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929459682632       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929459683202       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929459682442       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929459681887       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929459683305       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929459689523       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929459693294       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929459694864       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929459693654       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929459695724       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929459694126       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929459695685       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929459696621       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929459696793       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929459696924       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929459695368       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929459694753       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929459694624       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929459694881       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929459694761       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929459695198       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+01 is 4.608794e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5682e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.084299e-01 1 1  ON 0
  uu_1                 5.266678e-02 1 1  ON 1
  uu_2                -3.671072e-02 1 1  ON 2
  uu_3                -8.984096e-02 1 1  ON 3
  uu_4                -1.217411e-01 1 1  ON 4
  uu_5                -1.312773e-01 1 1  ON 5
  uu_6                -1.137534e-01 1 1  ON 6
  uu_7                -5.648180e-02 1 1  ON 7
  uu_8                 5.957508e-02 1 1  ON 8
  uu_9                 1.220925e-01 1 1  ON 9
  ud_0                 3.006741e-01 1 1  ON 10
  ud_1                 7.343165e-02 1 1  ON 11
  ud_2                -2.591736e-02 1 1  ON 12
  ud_3                -7.706804e-02 1 1  ON 13
  ud_4                -1.122719e-01 1 1  ON 14
  ud_5                -1.317691e-01 1 1  ON 15
  ud_6                -1.269250e-01 1 1  ON 16
  ud_7                -8.787527e-02 1 1  ON 17
  ud_8                -4.197285e-03 1 1  ON 18
  ud_9                 8.492057e-02 1 1  ON 19
  eO_0                -6.931797e-01 1 1  ON 20
  eO_1                -4.132254e-01 1 1  ON 21
  eO_2                -4.140763e-02 1 1  ON 22
  eO_3                 1.783994e-01 1 1  ON 23
  eO_4                 2.500481e-01 1 1  ON 24
  eO_5                 2.746725e-01 1 1  ON 25
  eO_6                 2.477610e-01 1 1  ON 26
  eO_7                 1.370256e-01 1 1  ON 27
  eO_8                 2.906815e-02 1 1  ON 28
  eO_9                 1.940856e-02 1 1  ON 29
 eH1_0                -2.053639e-01 1 1  ON 30
 eH1_1                -1.004505e-01 1 1  ON 31
 eH1_2                -4.946577e-02 1 1  ON 32
 eH1_3                -1.793801e-02 1 1  ON 33
 eH1_4                 1.719976e-02 1 1  ON 34
 eH1_5                 2.530619e-02 1 1  ON 35
 eH1_6                 7.899547e-02 1 1  ON 36
 eH1_7                 1.070184e-01 1 1  ON 37
 eH1_8                 1.027037e-01 1 1  ON 38
 eH1_9                 2.587674e-02 1 1  ON 39
 eH2_0                -2.016982e-01 1 1  ON 40
 eH2_1                -9.698481e-02 1 1  ON 41
 eH2_2                -4.659759e-02 1 1  ON 42
 eH2_3                -1.603306e-02 1 1  ON 43
 eH2_4                 1.727615e-02 1 1  ON 44
 eH2_5                 2.113581e-02 1 1  ON 45
 eH2_6                 7.071866e-02 1 1  ON 46
 eH2_7                 1.061352e-01 1 1  ON 47
 eH2_8                 1.046890e-01 1 1  ON 48
 eH2_9                 2.829827e-02 1 1  ON 49
ci_001                -4.236478e-02 3 1  ON 50
ci_002                -3.114958e-02 3 1  ON 51
ci_003                -2.575122e-02 3 1  ON 52
ci_004                 2.445986e-02 3 1  ON 53
ci_005                 2.459166e-02 3 1  ON 54
ci_006                -2.031730e-02 3 1  ON 55
ci_007                -2.043619e-02 3 1  ON 56
ci_008                -8.998319e-03 3 1  ON 57
ci_009                -1.503855e-02 3 1  ON 58
ci_010                -9.406224e-03 3 1  ON 59
ci_011                -1.024801e-02 3 1  ON 60
ci_012                -1.009121e-02 3 1  ON 61
ci_013                -1.952140e-02 3 1  ON 62
ci_014                 1.303017e-02 3 1  ON 63
ci_015                 1.322381e-02 3 1  ON 64
ci_016                 1.640905e-02 3 1  ON 65
ci_017                 1.614942e-02 3 1  ON 66
ci_018                 1.020617e-02 3 1  ON 67
ci_019                 1.038194e-02 3 1  ON 68
ci_020                 1.650682e-02 3 1  ON 69
ci_021                 1.642733e-02 3 1  ON 70
ci_022                 1.053507e-02 3 1  ON 71
ci_023                 9.282436e-03 3 1  ON 72
ci_024                 7.483295e-03 3 1  ON 73
ci_025                 6.084244e-03 3 1  ON 74
ci_026                 1.168951e-02 3 1  ON 75
ci_027                 1.167038e-02 3 1  ON 76
ci_028                -1.515861e-02 3 1  ON 77
ci_029                -1.536028e-02 3 1  ON 78
ci_030                -4.408257e-03 3 1  ON 79
ci_031                -4.879253e-03 3 1  ON 80
ci_032                -1.535350e-02 3 1  ON 81
ci_033                 6.946501e-03 3 1  ON 82
ci_034                 7.293788e-03 3 1  ON 83
ci_035                -4.592889e-03 3 1  ON 84
ci_036                -1.273964e-02 3 1  ON 85
ci_037                -1.277940e-02 3 1  ON 86
ci_038                 1.187829e-03 3 1  ON 87
ci_039                 1.334594e-03 3 1  ON 88
ci_040                -2.719471e-03 3 1  ON 89
ci_041                 8.502886e-03 3 1  ON 90
ci_042                 8.422456e-03 3 1  ON 91
ci_043                -3.624905e-03 3 1  ON 92
ci_044                -4.759146e-03 3 1  ON 93
ci_045                -2.801834e-03 3 1  ON 94
ci_046                 5.834520e-03 3 1  ON 95
ci_047                 5.645976e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1352
    reference variance = 0.229264
====================================================
  Execution time = 2.7464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8363e-01
  Total weights = 1.9665e+06
  Execution time = 2.4009e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274505090585
                                         uncertainty =       0.001621169012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274505090585
                                         uncertainty =       0.001621169012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370424479
  error estimate for blocks of size 2^( 2) =       0.000384764221
  error estimate for blocks of size 2^( 3) =       0.000397770273
  error estimate for blocks of size 2^( 4) =       0.000407769705
  error estimate for blocks of size 2^( 5) =       0.000412680336
  error estimate for blocks of size 2^( 6) =       0.000415013435
  error estimate for blocks of size 2^( 7) =       0.000417062504

      target function =      -0.938826323037
              le_mean =     -17.208982306236
             les_mean =     296.432683796181
             stat err =       0.000413131495
             autocorr =       1.243876471253
   target nu stat err =       0.000413131495
   target dn stat err =       0.002175140228
      target stat err =       0.003704933022
              std dev =       0.523867703234
             le_variance =       0.274437370492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274490129420
                                         uncertainty =       0.001623423108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274490129420
                                         uncertainty =       0.001623423108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370414096
  error estimate for blocks of size 2^( 2) =       0.000384781655
  error estimate for blocks of size 2^( 3) =       0.000397812364
  error estimate for blocks of size 2^( 4) =       0.000407832183
  error estimate for blocks of size 2^( 5) =       0.000412751538
  error estimate for blocks of size 2^( 6) =       0.000415081595
  error estimate for blocks of size 2^( 7) =       0.000417128177

      target function =      -0.938536303267
              le_mean =     -17.208981830969
             les_mean =     296.432841082864
             stat err =       0.000413198373
             autocorr =       1.244348979475
   target nu stat err =       0.000413198373
   target dn stat err =       0.002192754716
      target stat err =       0.003731519833
              std dev =       0.523853019414
             le_variance =       0.274421985949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274495078104
                                         uncertainty =       0.001622323688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274495078104
                                         uncertainty =       0.001622323688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370417566
  error estimate for blocks of size 2^( 2) =       0.000384772241
  error estimate for blocks of size 2^( 3) =       0.000397791441
  error estimate for blocks of size 2^( 4) =       0.000407801731
  error estimate for blocks of size 2^( 5) =       0.000412717015
  error estimate for blocks of size 2^( 6) =       0.000415048447
  error estimate for blocks of size 2^( 7) =       0.000417096325

      target function =      -0.938721309692
              le_mean =     -17.208981743368
             les_mean =     296.432727296275
             stat err =       0.000413165880
             autocorr =       1.244129968116
   target nu stat err =       0.000413165880
   target dn stat err =       0.002180695386
      target stat err =       0.003713217408
              std dev =       0.523857926687
             le_variance =       0.274427127353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274503554059
                                         uncertainty =       0.001621306138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274503554059
                                         uncertainty =       0.001621306138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370423422
  error estimate for blocks of size 2^( 2) =       0.000384765064
  error estimate for blocks of size 2^( 3) =       0.000397772785
  error estimate for blocks of size 2^( 4) =       0.000407773597
  error estimate for blocks of size 2^( 5) =       0.000412684821
  error estimate for blocks of size 2^( 6) =       0.000415017704
  error estimate for blocks of size 2^( 7) =       0.000417066631

      target function =      -0.938826069532
              le_mean =     -17.208982196604
             les_mean =     296.432680172791
             stat err =       0.000413135688
             autocorr =       1.243908818378
   target nu stat err =       0.000413135688
   target dn stat err =       0.002175521784
      target stat err =       0.003705556143
              std dev =       0.523866208415
             le_variance =       0.274435804319


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938826323037        initial  <--
     6.2500e-01     6.2500e+00             7.1717e-04        -0.938536303267
     2.5000e+00     2.5000e+01             1.8343e-04        -0.938721309692
     1.0000e+01     1.0000e+02             4.6088e-05        -0.938826069532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5432
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.084206e-01 1 1  ON 0
  uu_1                 5.262902e-02 1 1  ON 1
  uu_2                -3.675212e-02 1 1  ON 2
  uu_3                -8.987331e-02 1 1  ON 3
  uu_4                -1.217688e-01 1 1  ON 4
  uu_5                -1.312810e-01 1 1  ON 5
  uu_6                -1.137263e-01 1 1  ON 6
  uu_7                -5.642064e-02 1 1  ON 7
  uu_8                 5.968480e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.007753e-01 1 1  ON 10
  ud_1                 7.349590e-02 1 1  ON 11
  ud_2                -2.587755e-02 1 1  ON 12
  ud_3                -7.705174e-02 1 1  ON 13
  ud_4                -1.122916e-01 1 1  ON 14
  ud_5                -1.318273e-01 1 1  ON 15
  ud_6                -1.270178e-01 1 1  ON 16
  ud_7                -8.795138e-02 1 1  ON 17
  ud_8                -4.167907e-03 1 1  ON 18
  ud_9                 8.496067e-02 1 1  ON 19
  eO_0                -6.932240e-01 1 1  ON 20
  eO_1                -4.132284e-01 1 1  ON 21
  eO_2                -4.137893e-02 1 1  ON 22
  eO_3                 1.784362e-01 1 1  ON 23
  eO_4                 2.500638e-01 1 1  ON 24
  eO_5                 2.747453e-01 1 1  ON 25
  eO_6                 2.477445e-01 1 1  ON 26
  eO_7                 1.369461e-01 1 1  ON 27
  eO_8                 2.906033e-02 1 1  ON 28
  eO_9                 1.940696e-02 1 1  ON 29
 eH1_0                -2.054395e-01 1 1  ON 30
 eH1_1                -1.005426e-01 1 1  ON 31
 eH1_2                -4.953047e-02 1 1  ON 32
 eH1_3                -1.794027e-02 1 1  ON 33
 eH1_4                 1.725548e-02 1 1  ON 34
 eH1_5                 2.540486e-02 1 1  ON 35
 eH1_6                 7.909626e-02 1 1  ON 36
 eH1_7                 1.070402e-01 1 1  ON 37
 eH1_8                 1.026746e-01 1 1  ON 38
 eH1_9                 2.586652e-02 1 1  ON 39
 eH2_0                -2.015952e-01 1 1  ON 40
 eH2_1                -9.692229e-02 1 1  ON 41
 eH2_2                -4.656753e-02 1 1  ON 42
 eH2_3                -1.597628e-02 1 1  ON 43
 eH2_4                 1.733510e-02 1 1  ON 44
 eH2_5                 2.116358e-02 1 1  ON 45
 eH2_6                 7.053523e-02 1 1  ON 46
 eH2_7                 1.060420e-01 1 1  ON 47
 eH2_8                 1.046354e-01 1 1  ON 48
 eH2_9                 2.828769e-02 1 1  ON 49
ci_001                -4.236649e-02 3 1  ON 50
ci_002                -3.117140e-02 3 1  ON 51
ci_003                -2.574370e-02 3 1  ON 52
ci_004                 2.448648e-02 3 1  ON 53
ci_005                 2.459180e-02 3 1  ON 54
ci_006                -2.027533e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.994499e-03 3 1  ON 57
ci_009                -1.502888e-02 3 1  ON 58
ci_010                -9.433131e-03 3 1  ON 59
ci_011                -1.021318e-02 3 1  ON 60
ci_012                -1.012529e-02 3 1  ON 61
ci_013                -1.952641e-02 3 1  ON 62
ci_014                 1.297548e-02 3 1  ON 63
ci_015                 1.320461e-02 3 1  ON 64
ci_016                 1.641374e-02 3 1  ON 65
ci_017                 1.619530e-02 3 1  ON 66
ci_018                 1.022025e-02 3 1  ON 67
ci_019                 1.040528e-02 3 1  ON 68
ci_020                 1.646850e-02 3 1  ON 69
ci_021                 1.642462e-02 3 1  ON 70
ci_022                 1.056324e-02 3 1  ON 71
ci_023                 9.268823e-03 3 1  ON 72
ci_024                 7.503254e-03 3 1  ON 73
ci_025                 6.046093e-03 3 1  ON 74
ci_026                 1.168706e-02 3 1  ON 75
ci_027                 1.168128e-02 3 1  ON 76
ci_028                -1.521032e-02 3 1  ON 77
ci_029                -1.537762e-02 3 1  ON 78
ci_030                -4.433392e-03 3 1  ON 79
ci_031                -4.885354e-03 3 1  ON 80
ci_032                -1.533952e-02 3 1  ON 81
ci_033                 6.957682e-03 3 1  ON 82
ci_034                 7.342814e-03 3 1  ON 83
ci_035                -4.578607e-03 3 1  ON 84
ci_036                -1.271879e-02 3 1  ON 85
ci_037                -1.279737e-02 3 1  ON 86
ci_038                 1.171098e-03 3 1  ON 87
ci_039                 1.342997e-03 3 1  ON 88
ci_040                -2.715001e-03 3 1  ON 89
ci_041                 8.465760e-03 3 1  ON 90
ci_042                 8.397322e-03 3 1  ON 91
ci_043                -3.612943e-03 3 1  ON 92
ci_044                -4.758497e-03 3 1  ON 93
ci_045                -2.793878e-03 3 1  ON 94
ci_046                 5.850911e-03 3 1  ON 95
ci_047                 5.648118e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7178e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.198569
====================================================
  Execution time = 2.7192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8637e-01
  Total weights = 1.966161698e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3831e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276689243520
                                         uncertainty =       0.001447000481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276689243520
                                         uncertainty =       0.001447000481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371945667
  error estimate for blocks of size 2^( 2) =       0.000386284228
  error estimate for blocks of size 2^( 3) =       0.000399566885
  error estimate for blocks of size 2^( 4) =       0.000409360240
  error estimate for blocks of size 2^( 5) =       0.000416003109
  error estimate for blocks of size 2^( 6) =       0.000418731495
  error estimate for blocks of size 2^( 7) =       0.000417947215

      target function =      -0.934239445948
              le_mean =     -17.209285841943
             les_mean =     296.445888128893
             stat err =       0.000415510515
             autocorr =       1.247972540367
   target nu stat err =       0.000415510515
   target dn stat err =       0.002098727089
      target stat err =       0.003548729661
              std dev =       0.526019022695
             le_variance =       0.276696012237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720928584194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934251798321       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934259057539       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934260003417       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934260236468       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934260368996       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934260431395       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934260513612       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934260573198       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934260601987       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934260626328       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934260658989       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934260658441       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934260680549       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934260696573       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934260782164       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934260823813       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934260819254       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934260831433       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934260830317       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934260845730       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934260855468       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934260852992       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934260868026       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934260873623       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934260880271       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934260878236       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934260869336       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934260872719       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934260872403       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934260876937       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934260877549       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934260877004       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934260877510       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934260875624       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934260874832       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934260874768       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934260877683       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934260877508       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934260877763       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934260878439       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934260879430       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934260878828       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934260879019       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934260878337       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934260879541       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+00 is 6.217925e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934251798321       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934253630607       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934253868966       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934253927563       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934253960955       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934253976688       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934253997389       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934254012405       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934254019663       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934254025765       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934254034002       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934254033832       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934254039380       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934254043461       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934254064929       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934254075348       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934254074183       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934254077240       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934254076958       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934254080783       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934254083242       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934254082565       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934254086385       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934254087691       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934254089432       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934254088721       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934254086644       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934254087486       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934254087400       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934254088535       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934254088660       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934254088523       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934254088662       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934254088186       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934254087999       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934254087986       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934254088699       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934254088654       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934254088717       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934254088892       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934254089134       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934254088980       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934254089021       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934254088859       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934254089157       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+01 is 1.560385e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934251798321       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934252257498       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934252317207       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934252331878       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934252340242       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934252344184       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934252349368       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934252353130       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934252354948       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934252356475       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934252358539       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934252358494       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934252359883       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934252360907       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934252366279       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934252368884       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934252368591       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934252369356       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934252369285       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934252370240       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934252370856       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934252370683       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934252371642       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934252371962       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934252372403       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934252372212       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934252371703       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934252371913       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934252371891       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934252372174       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934252372204       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934252372170       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934252372205       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934252372086       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934252372040       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934252372037       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934252372214       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934252372203       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934252372219       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934252372262       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934252372323       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934252372284       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934252372294       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934252372254       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934252372329       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.0000e+02 is 3.904670e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5682e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.084295e-01 1 1  ON 0
  uu_1                 5.263460e-02 1 1  ON 1
  uu_2                -3.674842e-02 1 1  ON 2
  uu_3                -8.987036e-02 1 1  ON 3
  uu_4                -1.217685e-01 1 1  ON 4
  uu_5                -1.312822e-01 1 1  ON 5
  uu_6                -1.137323e-01 1 1  ON 6
  uu_7                -5.643146e-02 1 1  ON 7
  uu_8                 5.967524e-02 1 1  ON 8
  uu_9                 1.220879e-01 1 1  ON 9
  ud_0                 3.007650e-01 1 1  ON 10
  ud_1                 7.348791e-02 1 1  ON 11
  ud_2                -2.588231e-02 1 1  ON 12
  ud_3                -7.705585e-02 1 1  ON 13
  ud_4                -1.122925e-01 1 1  ON 14
  ud_5                -1.318231e-01 1 1  ON 15
  ud_6                -1.270110e-01 1 1  ON 16
  ud_7                -8.793578e-02 1 1  ON 17
  ud_8                -4.169217e-03 1 1  ON 18
  ud_9                 8.495704e-02 1 1  ON 19
  eO_0                -6.932226e-01 1 1  ON 20
  eO_1                -4.132288e-01 1 1  ON 21
  eO_2                -4.138172e-02 1 1  ON 22
  eO_3                 1.784335e-01 1 1  ON 23
  eO_4                 2.500550e-01 1 1  ON 24
  eO_5                 2.747474e-01 1 1  ON 25
  eO_6                 2.477434e-01 1 1  ON 26
  eO_7                 1.369565e-01 1 1  ON 27
  eO_8                 2.906145e-02 1 1  ON 28
  eO_9                 1.940705e-02 1 1  ON 29
 eH1_0                -2.054424e-01 1 1  ON 30
 eH1_1                -1.005449e-01 1 1  ON 31
 eH1_2                -4.952959e-02 1 1  ON 32
 eH1_3                -1.794010e-02 1 1  ON 33
 eH1_4                 1.725370e-02 1 1  ON 34
 eH1_5                 2.540217e-02 1 1  ON 35
 eH1_6                 7.909662e-02 1 1  ON 36
 eH1_7                 1.070424e-01 1 1  ON 37
 eH1_8                 1.026793e-01 1 1  ON 38
 eH1_9                 2.586774e-02 1 1  ON 39
 eH2_0                -2.016000e-01 1 1  ON 40
 eH2_1                -9.692102e-02 1 1  ON 41
 eH2_2                -4.656416e-02 1 1  ON 42
 eH2_3                -1.597313e-02 1 1  ON 43
 eH2_4                 1.733944e-02 1 1  ON 44
 eH2_5                 2.116286e-02 1 1  ON 45
 eH2_6                 7.052441e-02 1 1  ON 46
 eH2_7                 1.060378e-01 1 1  ON 47
 eH2_8                 1.046414e-01 1 1  ON 48
 eH2_9                 2.828958e-02 1 1  ON 49
ci_001                -4.236693e-02 3 1  ON 50
ci_002                -3.117026e-02 3 1  ON 51
ci_003                -2.574179e-02 3 1  ON 52
ci_004                 2.449043e-02 3 1  ON 53
ci_005                 2.459366e-02 3 1  ON 54
ci_006                -2.027503e-02 3 1  ON 55
ci_007                -2.043090e-02 3 1  ON 56
ci_008                -8.994920e-03 3 1  ON 57
ci_009                -1.502908e-02 3 1  ON 58
ci_010                -9.434930e-03 3 1  ON 59
ci_011                -1.021332e-02 3 1  ON 60
ci_012                -1.011671e-02 3 1  ON 61
ci_013                -1.952907e-02 3 1  ON 62
ci_014                 1.297430e-02 3 1  ON 63
ci_015                 1.320671e-02 3 1  ON 64
ci_016                 1.641305e-02 3 1  ON 65
ci_017                 1.619329e-02 3 1  ON 66
ci_018                 1.021698e-02 3 1  ON 67
ci_019                 1.040676e-02 3 1  ON 68
ci_020                 1.646772e-02 3 1  ON 69
ci_021                 1.643037e-02 3 1  ON 70
ci_022                 1.056231e-02 3 1  ON 71
ci_023                 9.271435e-03 3 1  ON 72
ci_024                 7.504005e-03 3 1  ON 73
ci_025                 6.048013e-03 3 1  ON 74
ci_026                 1.168515e-02 3 1  ON 75
ci_027                 1.167931e-02 3 1  ON 76
ci_028                -1.520955e-02 3 1  ON 77
ci_029                -1.537697e-02 3 1  ON 78
ci_030                -4.433844e-03 3 1  ON 79
ci_031                -4.882146e-03 3 1  ON 80
ci_032                -1.534116e-02 3 1  ON 81
ci_033                 6.954240e-03 3 1  ON 82
ci_034                 7.344458e-03 3 1  ON 83
ci_035                -4.578322e-03 3 1  ON 84
ci_036                -1.272018e-02 3 1  ON 85
ci_037                -1.279665e-02 3 1  ON 86
ci_038                 1.171518e-03 3 1  ON 87
ci_039                 1.342733e-03 3 1  ON 88
ci_040                -2.712680e-03 3 1  ON 89
ci_041                 8.464470e-03 3 1  ON 90
ci_042                 8.394914e-03 3 1  ON 91
ci_043                -3.613255e-03 3 1  ON 92
ci_044                -4.754542e-03 3 1  ON 93
ci_045                -2.794163e-03 3 1  ON 94
ci_046                 5.849349e-03 3 1  ON 95
ci_047                 5.647838e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1457
    reference variance = 0.250056
====================================================
  Execution time = 2.7990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8815e-01
  Total weights = 1.9664e+06
  Execution time = 2.3932e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151508969
                                         uncertainty =       0.001429531167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151508969
                                         uncertainty =       0.001429531167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372308888
  error estimate for blocks of size 2^( 2) =       0.000386454792
  error estimate for blocks of size 2^( 3) =       0.000399545585
  error estimate for blocks of size 2^( 4) =       0.000409306576
  error estimate for blocks of size 2^( 5) =       0.000415443722
  error estimate for blocks of size 2^( 6) =       0.000417584561
  error estimate for blocks of size 2^( 7) =       0.000419750946

      target function =      -0.931259087790
              le_mean =     -17.210197920825
             les_mean =     296.479067184642
             stat err =       0.000415521451
             autocorr =       1.245604271821
   target nu stat err =       0.000415521451
   target dn stat err =       0.002590373595
      target stat err =       0.004327810471
              std dev =       0.526532703585
             le_variance =       0.277236687945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151066433
                                         uncertainty =       0.001429209559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151066433
                                         uncertainty =       0.001429209559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372308608
  error estimate for blocks of size 2^( 2) =       0.000386457321
  error estimate for blocks of size 2^( 3) =       0.000399550613
  error estimate for blocks of size 2^( 4) =       0.000409313218
  error estimate for blocks of size 2^( 5) =       0.000415450822
  error estimate for blocks of size 2^( 6) =       0.000417591464
  error estimate for blocks of size 2^( 7) =       0.000419758924

      target function =      -0.931285738620
              le_mean =     -17.210197670162
             les_mean =     296.479042427050
             stat err =       0.000415528607
             autocorr =       1.245649048808
   target nu stat err =       0.000415528607
   target dn stat err =       0.002584619050
      target stat err =       0.004318716832
              std dev =       0.526532307485
             le_variance =       0.277236270825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151260400
                                         uncertainty =       0.001429367897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151260400
                                         uncertainty =       0.001429367897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372308730
  error estimate for blocks of size 2^( 2) =       0.000386456051
  error estimate for blocks of size 2^( 3) =       0.000399548104
  error estimate for blocks of size 2^( 4) =       0.000409309908
  error estimate for blocks of size 2^( 5) =       0.000415447284
  error estimate for blocks of size 2^( 6) =       0.000417588021
  error estimate for blocks of size 2^( 7) =       0.000419754948

      target function =      -0.931273964737
              le_mean =     -17.210197791046
             les_mean =     296.479053711049
             stat err =       0.000415525040
             autocorr =       1.245626849215
   target nu stat err =       0.000415525040
   target dn stat err =       0.002587427760
      target stat err =       0.004323166620
              std dev =       0.526532479714
             le_variance =       0.277236452194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151474942
                                         uncertainty =       0.001429510591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277151474942
                                         uncertainty =       0.001429510591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372308867
  error estimate for blocks of size 2^( 2) =       0.000386454948
  error estimate for blocks of size 2^( 3) =       0.000399545899
  error estimate for blocks of size 2^( 4) =       0.000409306991
  error estimate for blocks of size 2^( 5) =       0.000415444166
  error estimate for blocks of size 2^( 6) =       0.000417584992
  error estimate for blocks of size 2^( 7) =       0.000419751445

      target function =      -0.931261128806
              le_mean =     -17.210197904209
             les_mean =     296.479065376746
             stat err =       0.000415521899
             autocorr =       1.245607100334
   target nu stat err =       0.000415521899
   target dn stat err =       0.002589999598
      target stat err =       0.004327222297
              std dev =       0.526532672798
             le_variance =       0.277236655524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931259087790        initial
     6.2500e+00     6.2500e+01             6.2179e-05        -0.931285738620  <--
     2.5000e+01     2.5000e+02             1.5604e-05        -0.931273964737
     1.0000e+02     1.0000e+03             3.9047e-06        -0.931261128806

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 4.0036e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.084561e-01 1 1  ON 0
  uu_1                 5.265123e-02 1 1  ON 1
  uu_2                -3.673732e-02 1 1  ON 2
  uu_3                -8.986154e-02 1 1  ON 3
  uu_4                -1.217676e-01 1 1  ON 4
  uu_5                -1.312856e-01 1 1  ON 5
  uu_6                -1.137501e-01 1 1  ON 6
  uu_7                -5.646383e-02 1 1  ON 7
  uu_8                 5.964658e-02 1 1  ON 8
  uu_9                 1.220901e-01 1 1  ON 9
  ud_0                 3.007342e-01 1 1  ON 10
  ud_1                 7.346411e-02 1 1  ON 11
  ud_2                -2.589655e-02 1 1  ON 12
  ud_3                -7.706816e-02 1 1  ON 13
  ud_4                -1.122955e-01 1 1  ON 14
  ud_5                -1.318104e-01 1 1  ON 15
  ud_6                -1.269907e-01 1 1  ON 16
  ud_7                -8.788920e-02 1 1  ON 17
  ud_8                -4.173068e-03 1 1  ON 18
  ud_9                 8.494616e-02 1 1  ON 19
  eO_0                -6.932188e-01 1 1  ON 20
  eO_1                -4.132299e-01 1 1  ON 21
  eO_2                -4.139008e-02 1 1  ON 22
  eO_3                 1.784256e-01 1 1  ON 23
  eO_4                 2.500289e-01 1 1  ON 24
  eO_5                 2.747538e-01 1 1  ON 25
  eO_6                 2.477402e-01 1 1  ON 26
  eO_7                 1.369877e-01 1 1  ON 27
  eO_8                 2.906483e-02 1 1  ON 28
  eO_9                 1.940732e-02 1 1  ON 29
 eH1_0                -2.054509e-01 1 1  ON 30
 eH1_1                -1.005515e-01 1 1  ON 31
 eH1_2                -4.952700e-02 1 1  ON 32
 eH1_3                -1.793961e-02 1 1  ON 33
 eH1_4                 1.724837e-02 1 1  ON 34
 eH1_5                 2.539412e-02 1 1  ON 35
 eH1_6                 7.909770e-02 1 1  ON 36
 eH1_7                 1.070493e-01 1 1  ON 37
 eH1_8                 1.026931e-01 1 1  ON 38
 eH1_9                 2.587141e-02 1 1  ON 39
 eH2_0                -2.016141e-01 1 1  ON 40
 eH2_1                -9.691725e-02 1 1  ON 41
 eH2_2                -4.655415e-02 1 1  ON 42
 eH2_3                -1.596372e-02 1 1  ON 43
 eH2_4                 1.735235e-02 1 1  ON 44
 eH2_5                 2.116073e-02 1 1  ON 45
 eH2_6                 7.049203e-02 1 1  ON 46
 eH2_7                 1.060251e-01 1 1  ON 47
 eH2_8                 1.046594e-01 1 1  ON 48
 eH2_9                 2.829525e-02 1 1  ON 49
ci_001                -4.236823e-02 3 1  ON 50
ci_002                -3.116686e-02 3 1  ON 51
ci_003                -2.573612e-02 3 1  ON 52
ci_004                 2.450212e-02 3 1  ON 53
ci_005                 2.459919e-02 3 1  ON 54
ci_006                -2.027413e-02 3 1  ON 55
ci_007                -2.044093e-02 3 1  ON 56
ci_008                -8.996163e-03 3 1  ON 57
ci_009                -1.502968e-02 3 1  ON 58
ci_010                -9.440260e-03 3 1  ON 59
ci_011                -1.021374e-02 3 1  ON 60
ci_012                -1.009126e-02 3 1  ON 61
ci_013                -1.953697e-02 3 1  ON 62
ci_014                 1.297079e-02 3 1  ON 63
ci_015                 1.321294e-02 3 1  ON 64
ci_016                 1.641102e-02 3 1  ON 65
ci_017                 1.618730e-02 3 1  ON 66
ci_018                 1.020733e-02 3 1  ON 67
ci_019                 1.041115e-02 3 1  ON 68
ci_020                 1.646539e-02 3 1  ON 69
ci_021                 1.644743e-02 3 1  ON 70
ci_022                 1.055958e-02 3 1  ON 71
ci_023                 9.279184e-03 3 1  ON 72
ci_024                 7.506230e-03 3 1  ON 73
ci_025                 6.053712e-03 3 1  ON 74
ci_026                 1.167951e-02 3 1  ON 75
ci_027                 1.167350e-02 3 1  ON 76
ci_028                -1.520729e-02 3 1  ON 77
ci_029                -1.537504e-02 3 1  ON 78
ci_030                -4.435183e-03 3 1  ON 79
ci_031                -4.872644e-03 3 1  ON 80
ci_032                -1.534601e-02 3 1  ON 81
ci_033                 6.944031e-03 3 1  ON 82
ci_034                 7.349336e-03 3 1  ON 83
ci_035                -4.577478e-03 3 1  ON 84
ci_036                -1.272427e-02 3 1  ON 85
ci_037                -1.279451e-02 3 1  ON 86
ci_038                 1.172765e-03 3 1  ON 87
ci_039                 1.341953e-03 3 1  ON 88
ci_040                -2.705805e-03 3 1  ON 89
ci_041                 8.460644e-03 3 1  ON 90
ci_042                 8.387776e-03 3 1  ON 91
ci_043                -3.614182e-03 3 1  ON 92
ci_044                -4.742819e-03 3 1  ON 93
ci_045                -2.795010e-03 3 1  ON 94
ci_046                 5.844716e-03 3 1  ON 95
ci_047                 5.647011e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7176e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1888
    reference variance = 0.246015
====================================================
  Execution time = 2.7399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8476e-01
  Total weights = 1.966415945e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3343e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275680348771
                                         uncertainty =       0.001724171176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275680348771
                                         uncertainty =       0.001724171176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371256635
  error estimate for blocks of size 2^( 2) =       0.000385854848
  error estimate for blocks of size 2^( 3) =       0.000398960169
  error estimate for blocks of size 2^( 4) =       0.000408890682
  error estimate for blocks of size 2^( 5) =       0.000415276940
  error estimate for blocks of size 2^( 6) =       0.000419151737
  error estimate for blocks of size 2^( 7) =       0.000421382916

      target function =      -0.936890106558
              le_mean =     -17.209876744627
             les_mean =     296.464620483048
             stat err =       0.000416175569
             autocorr =       1.256622163741
   target nu stat err =       0.000416175569
   target dn stat err =       0.002168007504
      target stat err =       0.003685669758
              std dev =       0.525044568647
             le_variance =       0.275671799065


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720987674463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936903602578       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936928780542       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936932421272       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936933542430       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936933964428       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936934285515       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936934369703       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936934828413       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936935022518       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936935440091       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936935590207       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936935762019       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936935837296       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936936049982       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936936139977       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936936243057       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936936321690       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936936421345       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936936565724       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936936566862       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936936515794       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936936516872       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936936683096       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936936657428       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936936641725       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936936600475       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936936612976       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936936618781       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936936617729       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936936616857       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936936609837       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936936619422       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936936608873       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936936600661       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936936606863       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936936626182       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936936619845       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936936611686       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936936609489       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936936605417       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936936604279       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+00 is 1.910248e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936903602578       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936910128481       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936911060527       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936911348454       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936911458728       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936911539801       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936911561320       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936911679471       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936911728195       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936911835250       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936911872455       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936911915329       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936911934103       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936911987743       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936912010440       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936912036480       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936912056716       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936912081758       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936912117068       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936912116081       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936912103423       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936912104597       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936912146250       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936912139187       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936912134319       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936912124454       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936912127436       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936912129043       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936912128439       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936912128211       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936912126493       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936912128596       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936912125838       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936912124206       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936912125768       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936912130361       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936912128633       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936912126730       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936912126233       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936912125296       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+00 is 4.853390e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936903602578       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936905249187       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936905483599       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936905556074       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936905583960       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936905604270       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936905609696       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936905639454       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936905651643       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936905678578       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936905687854       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936905698565       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936905703255       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936905716694       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936905722381       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936905728908       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936905734005       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936905740272       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936905749044       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936905748718       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936905745562       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936905745919       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936905756330       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936905754524       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936905753245       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936905750814       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936905751546       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936905751957       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936905751785       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936905751728       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936905751301       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936905751808       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936905751112       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936905750732       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936905751121       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936905752254       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936905751813       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936905751347       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936905751226       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936905750997       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+01 is 1.218114e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.544964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5813e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.084646e-01 1 1  ON 0
  uu_1                 5.265049e-02 1 1  ON 1
  uu_2                -3.674272e-02 1 1  ON 2
  uu_3                -8.987128e-02 1 1  ON 3
  uu_4                -1.217774e-01 1 1  ON 4
  uu_5                -1.312888e-01 1 1  ON 5
  uu_6                -1.137579e-01 1 1  ON 6
  uu_7                -5.643657e-02 1 1  ON 7
  uu_8                 5.959956e-02 1 1  ON 8
  uu_9                 1.221015e-01 1 1  ON 9
  ud_0                 3.007026e-01 1 1  ON 10
  ud_1                 7.343982e-02 1 1  ON 11
  ud_2                -2.591542e-02 1 1  ON 12
  ud_3                -7.708005e-02 1 1  ON 13
  ud_4                -1.123043e-01 1 1  ON 14
  ud_5                -1.318036e-01 1 1  ON 15
  ud_6                -1.269637e-01 1 1  ON 16
  ud_7                -8.784067e-02 1 1  ON 17
  ud_8                -4.195290e-03 1 1  ON 18
  ud_9                 8.494979e-02 1 1  ON 19
  eO_0                -6.932168e-01 1 1  ON 20
  eO_1                -4.132251e-01 1 1  ON 21
  eO_2                -4.139378e-02 1 1  ON 22
  eO_3                 1.784152e-01 1 1  ON 23
  eO_4                 2.500108e-01 1 1  ON 24
  eO_5                 2.747264e-01 1 1  ON 25
  eO_6                 2.477412e-01 1 1  ON 26
  eO_7                 1.370300e-01 1 1  ON 27
  eO_8                 2.906873e-02 1 1  ON 28
  eO_9                 1.941034e-02 1 1  ON 29
 eH1_0                -2.054667e-01 1 1  ON 30
 eH1_1                -1.005385e-01 1 1  ON 31
 eH1_2                -4.951885e-02 1 1  ON 32
 eH1_3                -1.794366e-02 1 1  ON 33
 eH1_4                 1.723131e-02 1 1  ON 34
 eH1_5                 2.538424e-02 1 1  ON 35
 eH1_6                 7.910224e-02 1 1  ON 36
 eH1_7                 1.070394e-01 1 1  ON 37
 eH1_8                 1.027127e-01 1 1  ON 38
 eH1_9                 2.587925e-02 1 1  ON 39
 eH2_0                -2.016569e-01 1 1  ON 40
 eH2_1                -9.694922e-02 1 1  ON 41
 eH2_2                -4.657471e-02 1 1  ON 42
 eH2_3                -1.597419e-02 1 1  ON 43
 eH2_4                 1.734931e-02 1 1  ON 44
 eH2_5                 2.120654e-02 1 1  ON 45
 eH2_6                 7.053422e-02 1 1  ON 46
 eH2_7                 1.060147e-01 1 1  ON 47
 eH2_8                 1.046896e-01 1 1  ON 48
 eH2_9                 2.829404e-02 1 1  ON 49
ci_001                -4.235739e-02 3 1  ON 50
ci_002                -3.115807e-02 3 1  ON 51
ci_003                -2.574082e-02 3 1  ON 52
ci_004                 2.450675e-02 3 1  ON 53
ci_005                 2.460263e-02 3 1  ON 54
ci_006                -2.028534e-02 3 1  ON 55
ci_007                -2.043810e-02 3 1  ON 56
ci_008                -8.992958e-03 3 1  ON 57
ci_009                -1.503587e-02 3 1  ON 58
ci_010                -9.457123e-03 3 1  ON 59
ci_011                -1.021626e-02 3 1  ON 60
ci_012                -1.007466e-02 3 1  ON 61
ci_013                -1.953310e-02 3 1  ON 62
ci_014                 1.298557e-02 3 1  ON 63
ci_015                 1.322736e-02 3 1  ON 64
ci_016                 1.641530e-02 3 1  ON 65
ci_017                 1.619096e-02 3 1  ON 66
ci_018                 1.020370e-02 3 1  ON 67
ci_019                 1.039920e-02 3 1  ON 68
ci_020                 1.646679e-02 3 1  ON 69
ci_021                 1.644572e-02 3 1  ON 70
ci_022                 1.056193e-02 3 1  ON 71
ci_023                 9.300539e-03 3 1  ON 72
ci_024                 7.504175e-03 3 1  ON 73
ci_025                 6.062647e-03 3 1  ON 74
ci_026                 1.168123e-02 3 1  ON 75
ci_027                 1.165622e-02 3 1  ON 76
ci_028                -1.520219e-02 3 1  ON 77
ci_029                -1.537709e-02 3 1  ON 78
ci_030                -4.432990e-03 3 1  ON 79
ci_031                -4.866006e-03 3 1  ON 80
ci_032                -1.534846e-02 3 1  ON 81
ci_033                 6.961853e-03 3 1  ON 82
ci_034                 7.366363e-03 3 1  ON 83
ci_035                -4.574969e-03 3 1  ON 84
ci_036                -1.272615e-02 3 1  ON 85
ci_037                -1.278556e-02 3 1  ON 86
ci_038                 1.174600e-03 3 1  ON 87
ci_039                 1.339220e-03 3 1  ON 88
ci_040                -2.711639e-03 3 1  ON 89
ci_041                 8.447225e-03 3 1  ON 90
ci_042                 8.384032e-03 3 1  ON 91
ci_043                -3.608784e-03 3 1  ON 92
ci_044                -4.728779e-03 3 1  ON 93
ci_045                -2.798347e-03 3 1  ON 94
ci_046                 5.842738e-03 3 1  ON 95
ci_047                 5.652384e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2736
    reference variance = 0.168207
====================================================
  Execution time = 2.7013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8744e-01
  Total weights = 1.9666e+06
  Execution time = 2.4040e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443154378
                                         uncertainty =       0.001904188676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443154378
                                         uncertainty =       0.001904188676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421494
  error estimate for blocks of size 2^( 2) =       0.000386756430
  error estimate for blocks of size 2^( 3) =       0.000399827059
  error estimate for blocks of size 2^( 4) =       0.000409863984
  error estimate for blocks of size 2^( 5) =       0.000416328503
  error estimate for blocks of size 2^( 6) =       0.000419697528
  error estimate for blocks of size 2^( 7) =       0.000421059935

      target function =      -0.932448716909
              le_mean =     -17.210220921447
             les_mean =     296.479137740395
             stat err =       0.000416737488
             autocorr =       1.252147998189
   target nu stat err =       0.000416737488
   target dn stat err =       0.002478828718
      target stat err =       0.004157928169
              std dev =       0.526691954103
             le_variance =       0.277404414517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277444536377
                                         uncertainty =       0.001902539542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277444536377
                                         uncertainty =       0.001902539542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372422393
  error estimate for blocks of size 2^( 2) =       0.000386760315
  error estimate for blocks of size 2^( 3) =       0.000399833900
  error estimate for blocks of size 2^( 4) =       0.000409872747
  error estimate for blocks of size 2^( 5) =       0.000416338166
  error estimate for blocks of size 2^( 6) =       0.000419706816
  error estimate for blocks of size 2^( 7) =       0.000421070467

      target function =      -0.932383761685
              le_mean =     -17.210220616696
             les_mean =     296.479166589831
             stat err =       0.000416747049
             autocorr =       1.252199405364
   target nu stat err =       0.000416747049
   target dn stat err =       0.002481167773
      target stat err =       0.004161158211
              std dev =       0.526693226324
             le_variance =       0.277405754656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443623103
                                         uncertainty =       0.001903326439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443623103
                                         uncertainty =       0.001903326439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421794
  error estimate for blocks of size 2^( 2) =       0.000386758262
  error estimate for blocks of size 2^( 3) =       0.000399830405
  error estimate for blocks of size 2^( 4) =       0.000409868311
  error estimate for blocks of size 2^( 5) =       0.000416333275
  error estimate for blocks of size 2^( 6) =       0.000419702103
  error estimate for blocks of size 2^( 7) =       0.000421065170

      target function =      -0.932433372749
              le_mean =     -17.210220722930
             les_mean =     296.479140198730
             stat err =       0.000416742215
             autocorr =       1.252174385045
   target nu stat err =       0.000416742215
   target dn stat err =       0.002479812971
      target stat err =       0.004159392395
              std dev =       0.526692378581
             le_variance =       0.277404861655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443180398
                                         uncertainty =       0.001904079176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277443180398
                                         uncertainty =       0.001904079176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421509
  error estimate for blocks of size 2^( 2) =       0.000386756638
  error estimate for blocks of size 2^( 3) =       0.000399827458
  error estimate for blocks of size 2^( 4) =       0.000409864506
  error estimate for blocks of size 2^( 5) =       0.000416329081
  error estimate for blocks of size 2^( 6) =       0.000419698082
  error estimate for blocks of size 2^( 7) =       0.000421060573

      target function =      -0.932448114352
              le_mean =     -17.210220891437
             les_mean =     296.479137072236
             stat err =       0.000416738060
             autocorr =       1.252151333342
   target nu stat err =       0.000416738060
   target dn stat err =       0.002478926488
      target stat err =       0.004158081662
              std dev =       0.526691976235
             le_variance =       0.277404437831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932448716909        initial  <--
     1.5625e+00     1.5625e+01             1.9102e-04        -0.932383761685
     6.2500e+00     6.2500e+01             4.8534e-05        -0.932433372749
     2.5000e+01     2.5000e+02             1.2181e-05        -0.932448114352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.1066
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.084561e-01 1 1  ON 0
  uu_1                 5.265123e-02 1 1  ON 1
  uu_2                -3.673732e-02 1 1  ON 2
  uu_3                -8.986154e-02 1 1  ON 3
  uu_4                -1.217676e-01 1 1  ON 4
  uu_5                -1.312856e-01 1 1  ON 5
  uu_6                -1.137501e-01 1 1  ON 6
  uu_7                -5.646383e-02 1 1  ON 7
  uu_8                 5.964658e-02 1 1  ON 8
  uu_9                 1.220901e-01 1 1  ON 9
  ud_0                 3.007342e-01 1 1  ON 10
  ud_1                 7.346411e-02 1 1  ON 11
  ud_2                -2.589655e-02 1 1  ON 12
  ud_3                -7.706816e-02 1 1  ON 13
  ud_4                -1.122955e-01 1 1  ON 14
  ud_5                -1.318104e-01 1 1  ON 15
  ud_6                -1.269907e-01 1 1  ON 16
  ud_7                -8.788920e-02 1 1  ON 17
  ud_8                -4.173068e-03 1 1  ON 18
  ud_9                 8.494616e-02 1 1  ON 19
  eO_0                -6.932188e-01 1 1  ON 20
  eO_1                -4.132299e-01 1 1  ON 21
  eO_2                -4.139008e-02 1 1  ON 22
  eO_3                 1.784256e-01 1 1  ON 23
  eO_4                 2.500289e-01 1 1  ON 24
  eO_5                 2.747538e-01 1 1  ON 25
  eO_6                 2.477402e-01 1 1  ON 26
  eO_7                 1.369877e-01 1 1  ON 27
  eO_8                 2.906483e-02 1 1  ON 28
  eO_9                 1.940732e-02 1 1  ON 29
 eH1_0                -2.054509e-01 1 1  ON 30
 eH1_1                -1.005515e-01 1 1  ON 31
 eH1_2                -4.952700e-02 1 1  ON 32
 eH1_3                -1.793961e-02 1 1  ON 33
 eH1_4                 1.724837e-02 1 1  ON 34
 eH1_5                 2.539412e-02 1 1  ON 35
 eH1_6                 7.909770e-02 1 1  ON 36
 eH1_7                 1.070493e-01 1 1  ON 37
 eH1_8                 1.026931e-01 1 1  ON 38
 eH1_9                 2.587141e-02 1 1  ON 39
 eH2_0                -2.016141e-01 1 1  ON 40
 eH2_1                -9.691725e-02 1 1  ON 41
 eH2_2                -4.655415e-02 1 1  ON 42
 eH2_3                -1.596372e-02 1 1  ON 43
 eH2_4                 1.735235e-02 1 1  ON 44
 eH2_5                 2.116073e-02 1 1  ON 45
 eH2_6                 7.049203e-02 1 1  ON 46
 eH2_7                 1.060251e-01 1 1  ON 47
 eH2_8                 1.046594e-01 1 1  ON 48
 eH2_9                 2.829525e-02 1 1  ON 49
ci_001                -4.236823e-02 3 1  ON 50
ci_002                -3.116686e-02 3 1  ON 51
ci_003                -2.573612e-02 3 1  ON 52
ci_004                 2.450212e-02 3 1  ON 53
ci_005                 2.459919e-02 3 1  ON 54
ci_006                -2.027413e-02 3 1  ON 55
ci_007                -2.044093e-02 3 1  ON 56
ci_008                -8.996163e-03 3 1  ON 57
ci_009                -1.502968e-02 3 1  ON 58
ci_010                -9.440260e-03 3 1  ON 59
ci_011                -1.021374e-02 3 1  ON 60
ci_012                -1.009126e-02 3 1  ON 61
ci_013                -1.953697e-02 3 1  ON 62
ci_014                 1.297079e-02 3 1  ON 63
ci_015                 1.321294e-02 3 1  ON 64
ci_016                 1.641102e-02 3 1  ON 65
ci_017                 1.618730e-02 3 1  ON 66
ci_018                 1.020733e-02 3 1  ON 67
ci_019                 1.041115e-02 3 1  ON 68
ci_020                 1.646539e-02 3 1  ON 69
ci_021                 1.644743e-02 3 1  ON 70
ci_022                 1.055958e-02 3 1  ON 71
ci_023                 9.279184e-03 3 1  ON 72
ci_024                 7.506230e-03 3 1  ON 73
ci_025                 6.053712e-03 3 1  ON 74
ci_026                 1.167951e-02 3 1  ON 75
ci_027                 1.167350e-02 3 1  ON 76
ci_028                -1.520729e-02 3 1  ON 77
ci_029                -1.537504e-02 3 1  ON 78
ci_030                -4.435183e-03 3 1  ON 79
ci_031                -4.872644e-03 3 1  ON 80
ci_032                -1.534601e-02 3 1  ON 81
ci_033                 6.944031e-03 3 1  ON 82
ci_034                 7.349336e-03 3 1  ON 83
ci_035                -4.577478e-03 3 1  ON 84
ci_036                -1.272427e-02 3 1  ON 85
ci_037                -1.279451e-02 3 1  ON 86
ci_038                 1.172765e-03 3 1  ON 87
ci_039                 1.341953e-03 3 1  ON 88
ci_040                -2.705805e-03 3 1  ON 89
ci_041                 8.460644e-03 3 1  ON 90
ci_042                 8.387776e-03 3 1  ON 91
ci_043                -3.614182e-03 3 1  ON 92
ci_044                -4.742819e-03 3 1  ON 93
ci_045                -2.795010e-03 3 1  ON 94
ci_046                 5.844716e-03 3 1  ON 95
ci_047                 5.647011e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7187e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.559803
====================================================
  Execution time = 2.7879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8426e-01
  Total weights = 1.966536467e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2868e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275475103354
                                         uncertainty =       0.001578053619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275475103354
                                         uncertainty =       0.001578053619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371139406
  error estimate for blocks of size 2^( 2) =       0.000385440318
  error estimate for blocks of size 2^( 3) =       0.000398629854
  error estimate for blocks of size 2^( 4) =       0.000408491701
  error estimate for blocks of size 2^( 5) =       0.000415490137
  error estimate for blocks of size 2^( 6) =       0.000418881443
  error estimate for blocks of size 2^( 7) =       0.000420615516

      target function =      -0.937730033142
              le_mean =     -17.209621976589
             les_mean =     296.455352137263
             stat err =       0.000415869699
             autocorr =       1.255568527189
   target nu stat err =       0.000415869699
   target dn stat err =       0.001975239383
      target stat err =       0.003375921039
              std dev =       0.524878778762
             le_variance =       0.275497732394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720962197659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937741108846       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937743253122       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937743602488       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937743666808       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937743661267       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937743672316       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937743688073       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937743696297       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937743730461       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937743747934       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937743768610       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937743784495       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937743817931       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937743838154       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937743839331       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937743851921       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937743856182       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937743864975       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937743861103       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937743864591       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937743866370       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937743864536       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937743859852       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937743857592       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937743860766       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937743865745       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937743874015       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937743874919       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937743877032       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937743876675       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937743876103       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937743878084       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937743879900       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937743877497       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937743876406       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937743876215       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937743875971       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937743875697       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937743875830       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937743875762       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937743876218       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937743876478       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937743876543       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937743876601       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+01 is 3.045428e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937741108846       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937741646959       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937741734524       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937741750647       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937741749250       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937741752000       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937741755957       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937741758007       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937741766566       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937741770960       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937741776149       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937741780130       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937741788488       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937741793551       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937741793809       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937741796958       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937741798041       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937741800237       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937741799271       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937741800143       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937741800583       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937741800116       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937741798946       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937741798383       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937741799180       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937741800428       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937741802494       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937741802711       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937741803231       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937741803143       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937741803004       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937741803504       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937741803950       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937741803348       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937741803073       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937741803031       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937741802969       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937741802903       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937741802933       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937741802922       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937741803029       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937741803099       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937741803109       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937741803129       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+01 is 7.625144e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937741108846       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937741243503       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937741265408       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937741269441       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937741269091       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937741269778       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937741270768       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937741271281       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937741273422       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937741274521       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937741275820       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937741276816       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937741278905       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937741280171       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937741280234       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937741281021       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937741281293       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937741281842       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937741281601       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937741281819       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937741281929       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937741281810       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937741281518       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937741281377       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937741281577       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937741281889       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937741282406       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937741282459       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937741282588       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937741282568       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937741282533       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937741282658       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937741282768       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937741282618       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937741282549       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937741282539       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937741282523       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937741282508       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937741282515       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937741282512       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937741282539       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937741282557       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937741282559       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937741282564       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.5000e+02 is 1.907011e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.635529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6264e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.084571e-01 1 1  ON 0
  uu_1                 5.265130e-02 1 1  ON 1
  uu_2                -3.673682e-02 1 1  ON 2
  uu_3                -8.986041e-02 1 1  ON 3
  uu_4                -1.217669e-01 1 1  ON 4
  uu_5                -1.312854e-01 1 1  ON 5
  uu_6                -1.137506e-01 1 1  ON 6
  uu_7                -5.646307e-02 1 1  ON 7
  uu_8                 5.964078e-02 1 1  ON 8
  uu_9                 1.220904e-01 1 1  ON 9
  ud_0                 3.007314e-01 1 1  ON 10
  ud_1                 7.346127e-02 1 1  ON 11
  ud_2                -2.589915e-02 1 1  ON 12
  ud_3                -7.707024e-02 1 1  ON 13
  ud_4                -1.122954e-01 1 1  ON 14
  ud_5                -1.318087e-01 1 1  ON 15
  ud_6                -1.269864e-01 1 1  ON 16
  ud_7                -8.788446e-02 1 1  ON 17
  ud_8                -4.173559e-03 1 1  ON 18
  ud_9                 8.494433e-02 1 1  ON 19
  eO_0                -6.932169e-01 1 1  ON 20
  eO_1                -4.132279e-01 1 1  ON 21
  eO_2                -4.139044e-02 1 1  ON 22
  eO_3                 1.784224e-01 1 1  ON 23
  eO_4                 2.500213e-01 1 1  ON 24
  eO_5                 2.747506e-01 1 1  ON 25
  eO_6                 2.477440e-01 1 1  ON 26
  eO_7                 1.369941e-01 1 1  ON 27
  eO_8                 2.906512e-02 1 1  ON 28
  eO_9                 1.940734e-02 1 1  ON 29
 eH1_0                -2.054520e-01 1 1  ON 30
 eH1_1                -1.005513e-01 1 1  ON 31
 eH1_2                -4.952529e-02 1 1  ON 32
 eH1_3                -1.793972e-02 1 1  ON 33
 eH1_4                 1.724592e-02 1 1  ON 34
 eH1_5                 2.539199e-02 1 1  ON 35
 eH1_6                 7.909838e-02 1 1  ON 36
 eH1_7                 1.070503e-01 1 1  ON 37
 eH1_8                 1.026950e-01 1 1  ON 38
 eH1_9                 2.587175e-02 1 1  ON 39
 eH2_0                -2.016160e-01 1 1  ON 40
 eH2_1                -9.691763e-02 1 1  ON 41
 eH2_2                -4.655353e-02 1 1  ON 42
 eH2_3                -1.596304e-02 1 1  ON 43
 eH2_4                 1.735065e-02 1 1  ON 44
 eH2_5                 2.116230e-02 1 1  ON 45
 eH2_6                 7.049046e-02 1 1  ON 46
 eH2_7                 1.060244e-01 1 1  ON 47
 eH2_8                 1.046622e-01 1 1  ON 48
 eH2_9                 2.829579e-02 1 1  ON 49
ci_001                -4.236809e-02 3 1  ON 50
ci_002                -3.116707e-02 3 1  ON 51
ci_003                -2.573475e-02 3 1  ON 52
ci_004                 2.450242e-02 3 1  ON 53
ci_005                 2.459968e-02 3 1  ON 54
ci_006                -2.027393e-02 3 1  ON 55
ci_007                -2.044145e-02 3 1  ON 56
ci_008                -8.995819e-03 3 1  ON 57
ci_009                -1.503057e-02 3 1  ON 58
ci_010                -9.440471e-03 3 1  ON 59
ci_011                -1.021238e-02 3 1  ON 60
ci_012                -1.009033e-02 3 1  ON 61
ci_013                -1.953547e-02 3 1  ON 62
ci_014                 1.297102e-02 3 1  ON 63
ci_015                 1.321472e-02 3 1  ON 64
ci_016                 1.641116e-02 3 1  ON 65
ci_017                 1.618632e-02 3 1  ON 66
ci_018                 1.020637e-02 3 1  ON 67
ci_019                 1.041004e-02 3 1  ON 68
ci_020                 1.646600e-02 3 1  ON 69
ci_021                 1.644828e-02 3 1  ON 70
ci_022                 1.055954e-02 3 1  ON 71
ci_023                 9.280210e-03 3 1  ON 72
ci_024                 7.505425e-03 3 1  ON 73
ci_025                 6.055024e-03 3 1  ON 74
ci_026                 1.167832e-02 3 1  ON 75
ci_027                 1.167176e-02 3 1  ON 76
ci_028                -1.520732e-02 3 1  ON 77
ci_029                -1.537540e-02 3 1  ON 78
ci_030                -4.435682e-03 3 1  ON 79
ci_031                -4.873234e-03 3 1  ON 80
ci_032                -1.534583e-02 3 1  ON 81
ci_033                 6.944370e-03 3 1  ON 82
ci_034                 7.349311e-03 3 1  ON 83
ci_035                -4.577875e-03 3 1  ON 84
ci_036                -1.272373e-02 3 1  ON 85
ci_037                -1.279369e-02 3 1  ON 86
ci_038                 1.172497e-03 3 1  ON 87
ci_039                 1.341896e-03 3 1  ON 88
ci_040                -2.705530e-03 3 1  ON 89
ci_041                 8.458868e-03 3 1  ON 90
ci_042                 8.387770e-03 3 1  ON 91
ci_043                -3.614305e-03 3 1  ON 92
ci_044                -4.743551e-03 3 1  ON 93
ci_045                -2.794344e-03 3 1  ON 94
ci_046                 5.844141e-03 3 1  ON 95
ci_047                 5.646200e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.307299
====================================================
  Execution time = 2.9342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9208e-01
  Total weights = 1.9664e+06
  Execution time = 2.3533e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818587396
                                         uncertainty =       0.002064450341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818587396
                                         uncertainty =       0.002064450341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374653717
  error estimate for blocks of size 2^( 2) =       0.000388820176
  error estimate for blocks of size 2^( 3) =       0.000401878367
  error estimate for blocks of size 2^( 4) =       0.000410668130
  error estimate for blocks of size 2^( 5) =       0.000416618905
  error estimate for blocks of size 2^( 6) =       0.000417813716
  error estimate for blocks of size 2^( 7) =       0.000420160595

      target function =      -0.924846796512
              le_mean =     -17.209747138949
             les_mean =     296.467482492464
             stat err =       0.000416315337
             autocorr =       1.234766188530
   target nu stat err =       0.000416315337
   target dn stat err =       0.002885186089
      target stat err =       0.004737859109
              std dev =       0.529848845197
             le_variance =       0.280739798757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818757389
                                         uncertainty =       0.002064655518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818757389
                                         uncertainty =       0.002064655518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374653834
  error estimate for blocks of size 2^( 2) =       0.000388821116
  error estimate for blocks of size 2^( 3) =       0.000401880435
  error estimate for blocks of size 2^( 4) =       0.000410670874
  error estimate for blocks of size 2^( 5) =       0.000416621995
  error estimate for blocks of size 2^( 6) =       0.000417817164
  error estimate for blocks of size 2^( 7) =       0.000420164006

      target function =      -0.924853698801
              le_mean =     -17.209747052951
             les_mean =     296.467475280335
             stat err =       0.000416318510
             autocorr =       1.234784239268
   target nu stat err =       0.000416318510
   target dn stat err =       0.002885202653
      target stat err =       0.004737955630
              std dev =       0.529849010946
             le_variance =       0.280739974401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818670378
                                         uncertainty =       0.002064553232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818670378
                                         uncertainty =       0.002064553232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374653774
  error estimate for blocks of size 2^( 2) =       0.000388820645
  error estimate for blocks of size 2^( 3) =       0.000401879402
  error estimate for blocks of size 2^( 4) =       0.000410669504
  error estimate for blocks of size 2^( 5) =       0.000416620452
  error estimate for blocks of size 2^( 6) =       0.000417815443
  error estimate for blocks of size 2^( 7) =       0.000420162304

      target function =      -0.924850670392
              le_mean =     -17.209747095491
             les_mean =     296.467478610093
             stat err =       0.000416316926
             autocorr =       1.234775238849
   target nu stat err =       0.000416316926
   target dn stat err =       0.002885190782
      target stat err =       0.004737905892
              std dev =       0.529848926182
             le_variance =       0.280739884576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818597491
                                         uncertainty =       0.002064463207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280818597491
                                         uncertainty =       0.002064463207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374653724
  error estimate for blocks of size 2^( 2) =       0.000388820234
  error estimate for blocks of size 2^( 3) =       0.000401878496
  error estimate for blocks of size 2^( 4) =       0.000410668302
  error estimate for blocks of size 2^( 5) =       0.000416619098
  error estimate for blocks of size 2^( 6) =       0.000417813932
  error estimate for blocks of size 2^( 7) =       0.000420160809

      target function =      -0.924847311202
              le_mean =     -17.209747133476
             les_mean =     296.467481986996
             stat err =       0.000416315535
             autocorr =       1.234767320657
   target nu stat err =       0.000416315535
   target dn stat err =       0.002885186264
      target stat err =       0.004737864605
              std dev =       0.529848855059
             le_variance =       0.280739809207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924846796512        initial
     1.5625e+01     1.5625e+02             3.0454e-05        -0.924853698801  <--
     6.2500e+01     6.2500e+02             7.6251e-06        -0.924850670392
     2.5000e+02     2.5000e+03             1.9070e-06        -0.924847311202

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.1196e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.084600e-01 1 1  ON 0
  uu_1                 5.265153e-02 1 1  ON 1
  uu_2                -3.673533e-02 1 1  ON 2
  uu_3                -8.985702e-02 1 1  ON 3
  uu_4                -1.217645e-01 1 1  ON 4
  uu_5                -1.312847e-01 1 1  ON 5
  uu_6                -1.137519e-01 1 1  ON 6
  uu_7                -5.646080e-02 1 1  ON 7
  uu_8                 5.962338e-02 1 1  ON 8
  uu_9                 1.220913e-01 1 1  ON 9
  ud_0                 3.007232e-01 1 1  ON 10
  ud_1                 7.345277e-02 1 1  ON 11
  ud_2                -2.590694e-02 1 1  ON 12
  ud_3                -7.707647e-02 1 1  ON 13
  ud_4                -1.122951e-01 1 1  ON 14
  ud_5                -1.318034e-01 1 1  ON 15
  ud_6                -1.269735e-01 1 1  ON 16
  ud_7                -8.787023e-02 1 1  ON 17
  ud_8                -4.175019e-03 1 1  ON 18
  ud_9                 8.493885e-02 1 1  ON 19
  eO_0                -6.932111e-01 1 1  ON 20
  eO_1                -4.132221e-01 1 1  ON 21
  eO_2                -4.139154e-02 1 1  ON 22
  eO_3                 1.784127e-01 1 1  ON 23
  eO_4                 2.499984e-01 1 1  ON 24
  eO_5                 2.747412e-01 1 1  ON 25
  eO_6                 2.477553e-01 1 1  ON 26
  eO_7                 1.370135e-01 1 1  ON 27
  eO_8                 2.906598e-02 1 1  ON 28
  eO_9                 1.940740e-02 1 1  ON 29
 eH1_0                -2.054553e-01 1 1  ON 30
 eH1_1                -1.005509e-01 1 1  ON 31
 eH1_2                -4.952018e-02 1 1  ON 32
 eH1_3                -1.794005e-02 1 1  ON 33
 eH1_4                 1.723858e-02 1 1  ON 34
 eH1_5                 2.538561e-02 1 1  ON 35
 eH1_6                 7.910042e-02 1 1  ON 36
 eH1_7                 1.070535e-01 1 1  ON 37
 eH1_8                 1.027007e-01 1 1  ON 38
 eH1_9                 2.587276e-02 1 1  ON 39
 eH2_0                -2.016215e-01 1 1  ON 40
 eH2_1                -9.691878e-02 1 1  ON 41
 eH2_2                -4.655170e-02 1 1  ON 42
 eH2_3                -1.596099e-02 1 1  ON 43
 eH2_4                 1.734559e-02 1 1  ON 44
 eH2_5                 2.116700e-02 1 1  ON 45
 eH2_6                 7.048577e-02 1 1  ON 46
 eH2_7                 1.060223e-01 1 1  ON 47
 eH2_8                 1.046704e-01 1 1  ON 48
 eH2_9                 2.829741e-02 1 1  ON 49
ci_001                -4.236768e-02 3 1  ON 50
ci_002                -3.116772e-02 3 1  ON 51
ci_003                -2.573068e-02 3 1  ON 52
ci_004                 2.450331e-02 3 1  ON 53
ci_005                 2.460116e-02 3 1  ON 54
ci_006                -2.027334e-02 3 1  ON 55
ci_007                -2.044299e-02 3 1  ON 56
ci_008                -8.994793e-03 3 1  ON 57
ci_009                -1.503324e-02 3 1  ON 58
ci_010                -9.441103e-03 3 1  ON 59
ci_011                -1.020831e-02 3 1  ON 60
ci_012                -1.008755e-02 3 1  ON 61
ci_013                -1.953099e-02 3 1  ON 62
ci_014                 1.297169e-02 3 1  ON 63
ci_015                 1.322005e-02 3 1  ON 64
ci_016                 1.641157e-02 3 1  ON 65
ci_017                 1.618342e-02 3 1  ON 66
ci_018                 1.020351e-02 3 1  ON 67
ci_019                 1.040675e-02 3 1  ON 68
ci_020                 1.646782e-02 3 1  ON 69
ci_021                 1.645084e-02 3 1  ON 70
ci_022                 1.055941e-02 3 1  ON 71
ci_023                 9.283275e-03 3 1  ON 72
ci_024                 7.503019e-03 3 1  ON 73
ci_025                 6.058943e-03 3 1  ON 74
ci_026                 1.167475e-02 3 1  ON 75
ci_027                 1.166655e-02 3 1  ON 76
ci_028                -1.520742e-02 3 1  ON 77
ci_029                -1.537647e-02 3 1  ON 78
ci_030                -4.437172e-03 3 1  ON 79
ci_031                -4.874994e-03 3 1  ON 80
ci_032                -1.534529e-02 3 1  ON 81
ci_033                 6.945382e-03 3 1  ON 82
ci_034                 7.349237e-03 3 1  ON 83
ci_035                -4.579060e-03 3 1  ON 84
ci_036                -1.272211e-02 3 1  ON 85
ci_037                -1.279126e-02 3 1  ON 86
ci_038                 1.171696e-03 3 1  ON 87
ci_039                 1.341727e-03 3 1  ON 88
ci_040                -2.704709e-03 3 1  ON 89
ci_041                 8.453563e-03 3 1  ON 90
ci_042                 8.387752e-03 3 1  ON 91
ci_043                -3.614672e-03 3 1  ON 92
ci_044                -4.745734e-03 3 1  ON 93
ci_045                -2.792357e-03 3 1  ON 94
ci_046                 5.842424e-03 3 1  ON 95
ci_047                 5.643781e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.142891
====================================================
  Execution time = 2.7375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8411e-01
  Total weights = 1.966407121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3790e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274640533751
                                         uncertainty =       0.001841778853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274640533751
                                         uncertainty =       0.001841778853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370532451
  error estimate for blocks of size 2^( 2) =       0.000385047826
  error estimate for blocks of size 2^( 3) =       0.000398241220
  error estimate for blocks of size 2^( 4) =       0.000408226520
  error estimate for blocks of size 2^( 5) =       0.000414116234
  error estimate for blocks of size 2^( 6) =       0.000416488314
  error estimate for blocks of size 2^( 7) =       0.000418487755

      target function =      -0.937987469815
              le_mean =     -17.209578007758
             les_mean =     296.453682175715
             stat err =       0.000414329706
             autocorr =       1.250373163785
   target nu stat err =       0.000414329706
   target dn stat err =       0.002329544400
      target stat err =       0.003955840510
              std dev =       0.524020401972
             le_variance =       0.274597381683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720957800776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938003151939       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938008049965       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938009161863       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938009647926       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938009840739       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938009945952       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938010056566       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938010219047       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938010266624       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938010361829       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938010384664       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938010390759       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938010474698       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938010481746       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938010479447       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938010491479       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938010507327       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938010526827       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938010545888       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938010561680       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938010586385       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938010605163       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938010617011       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938010642793       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938010638743       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938010639589       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938010640939       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938010650053       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938010662793       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938010665035       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938010665507       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938010665669       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938010667958       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938010668474       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938010671994       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938010674607       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938010673663       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938010671164       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938010670101       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938010667907       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938010668518       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938010665554       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938010666840       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+00 is 1.102768e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938003151939       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938004394859       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938004676036       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938004798536       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938004847263       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938004873940       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938004901161       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938004942806       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938004954640       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938004978524       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938004984491       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938004985865       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938005006957       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938005008482       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938005007955       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938005010961       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938005015048       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938005019954       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938005024716       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938005028638       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938005034755       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938005039530       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938005042393       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938005048828       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938005047807       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938005047944       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938005048306       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938005050582       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938005053699       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938005054214       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938005054306       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938005054349       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938005054933       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938005055039       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938005055915       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938005056547       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938005056299       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938005055660       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938005055427       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938005054895       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938005055009       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938005054296       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938005054603       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+01 is 2.763191e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938003151939       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938003463842       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938003534339       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938003565025       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938003577240       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938003583933       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938003590711       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938003601187       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938003604142       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938003610119       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938003611626       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938003611960       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938003617240       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938003617606       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938003617477       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938003618229       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938003619258       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938003620487       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938003621677       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938003622656       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938003624182       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938003625380       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938003626090       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938003627698       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938003627442       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938003627472       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938003627564       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938003628133       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938003628907       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938003629033       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938003629055       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938003629066       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938003629212       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938003629237       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938003629456       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938003629612       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938003629550       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938003629389       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938003629333       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938003629201       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938003629227       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938003629051       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938003629126       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.2500e+01 is 6.911893e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.721495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5848e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.084676e-01 1 1  ON 0
  uu_1                 5.265760e-02 1 1  ON 1
  uu_2                -3.673286e-02 1 1  ON 2
  uu_3                -8.985564e-02 1 1  ON 3
  uu_4                -1.217645e-01 1 1  ON 4
  uu_5                -1.312827e-01 1 1  ON 5
  uu_6                -1.137541e-01 1 1  ON 6
  uu_7                -5.646279e-02 1 1  ON 7
  uu_8                 5.959574e-02 1 1  ON 8
  uu_9                 1.220898e-01 1 1  ON 9
  ud_0                 3.007136e-01 1 1  ON 10
  ud_1                 7.344312e-02 1 1  ON 11
  ud_2                -2.591425e-02 1 1  ON 12
  ud_3                -7.707918e-02 1 1  ON 13
  ud_4                -1.122932e-01 1 1  ON 14
  ud_5                -1.317945e-01 1 1  ON 15
  ud_6                -1.269607e-01 1 1  ON 16
  ud_7                -8.785767e-02 1 1  ON 17
  ud_8                -4.188746e-03 1 1  ON 18
  ud_9                 8.493459e-02 1 1  ON 19
  eO_0                -6.932112e-01 1 1  ON 20
  eO_1                -4.132225e-01 1 1  ON 21
  eO_2                -4.139819e-02 1 1  ON 22
  eO_3                 1.784000e-01 1 1  ON 23
  eO_4                 2.499880e-01 1 1  ON 24
  eO_5                 2.747540e-01 1 1  ON 25
  eO_6                 2.477549e-01 1 1  ON 26
  eO_7                 1.370269e-01 1 1  ON 27
  eO_8                 2.906874e-02 1 1  ON 28
  eO_9                 1.940825e-02 1 1  ON 29
 eH1_0                -2.054536e-01 1 1  ON 30
 eH1_1                -1.005433e-01 1 1  ON 31
 eH1_2                -4.951440e-02 1 1  ON 32
 eH1_3                -1.793389e-02 1 1  ON 33
 eH1_4                 1.723678e-02 1 1  ON 34
 eH1_5                 2.537582e-02 1 1  ON 35
 eH1_6                 7.908448e-02 1 1  ON 36
 eH1_7                 1.070513e-01 1 1  ON 37
 eH1_8                 1.027078e-01 1 1  ON 38
 eH1_9                 2.587372e-02 1 1  ON 39
 eH2_0                -2.016385e-01 1 1  ON 40
 eH2_1                -9.692536e-02 1 1  ON 41
 eH2_2                -4.655790e-02 1 1  ON 42
 eH2_3                -1.596832e-02 1 1  ON 43
 eH2_4                 1.734431e-02 1 1  ON 44
 eH2_5                 2.118024e-02 1 1  ON 45
 eH2_6                 7.050982e-02 1 1  ON 46
 eH2_7                 1.060164e-01 1 1  ON 47
 eH2_8                 1.046752e-01 1 1  ON 48
 eH2_9                 2.829853e-02 1 1  ON 49
ci_001                -4.236382e-02 3 1  ON 50
ci_002                -3.116578e-02 3 1  ON 51
ci_003                -2.573174e-02 3 1  ON 52
ci_004                 2.450015e-02 3 1  ON 53
ci_005                 2.460031e-02 3 1  ON 54
ci_006                -2.027726e-02 3 1  ON 55
ci_007                -2.043908e-02 3 1  ON 56
ci_008                -8.992574e-03 3 1  ON 57
ci_009                -1.503446e-02 3 1  ON 58
ci_010                -9.443906e-03 3 1  ON 59
ci_011                -1.021009e-02 3 1  ON 60
ci_012                -1.008614e-02 3 1  ON 61
ci_013                -1.953079e-02 3 1  ON 62
ci_014                 1.297827e-02 3 1  ON 63
ci_015                 1.321769e-02 3 1  ON 64
ci_016                 1.641195e-02 3 1  ON 65
ci_017                 1.618165e-02 3 1  ON 66
ci_018                 1.020085e-02 3 1  ON 67
ci_019                 1.040088e-02 3 1  ON 68
ci_020                 1.646691e-02 3 1  ON 69
ci_021                 1.644919e-02 3 1  ON 70
ci_022                 1.056262e-02 3 1  ON 71
ci_023                 9.286176e-03 3 1  ON 72
ci_024                 7.506556e-03 3 1  ON 73
ci_025                 6.064025e-03 3 1  ON 74
ci_026                 1.167790e-02 3 1  ON 75
ci_027                 1.166743e-02 3 1  ON 76
ci_028                -1.520425e-02 3 1  ON 77
ci_029                -1.537489e-02 3 1  ON 78
ci_030                -4.439636e-03 3 1  ON 79
ci_031                -4.872766e-03 3 1  ON 80
ci_032                -1.534812e-02 3 1  ON 81
ci_033                 6.944517e-03 3 1  ON 82
ci_034                 7.347206e-03 3 1  ON 83
ci_035                -4.580348e-03 3 1  ON 84
ci_036                -1.272494e-02 3 1  ON 85
ci_037                -1.278897e-02 3 1  ON 86
ci_038                 1.169618e-03 3 1  ON 87
ci_039                 1.340282e-03 3 1  ON 88
ci_040                -2.704787e-03 3 1  ON 89
ci_041                 8.453769e-03 3 1  ON 90
ci_042                 8.387331e-03 3 1  ON 91
ci_043                -3.615351e-03 3 1  ON 92
ci_044                -4.738068e-03 3 1  ON 93
ci_045                -2.792184e-03 3 1  ON 94
ci_046                 5.840623e-03 3 1  ON 95
ci_047                 5.643963e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.3025
    reference variance = 0.541785
====================================================
  Execution time = 2.7218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8622e-01
  Total weights = 1.9664e+06
  Execution time = 2.3313e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276750395538
                                         uncertainty =       0.001727430834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276750395538
                                         uncertainty =       0.001727430834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371951996
  error estimate for blocks of size 2^( 2) =       0.000386310917
  error estimate for blocks of size 2^( 3) =       0.000399540770
  error estimate for blocks of size 2^( 4) =       0.000409753342
  error estimate for blocks of size 2^( 5) =       0.000415798193
  error estimate for blocks of size 2^( 6) =       0.000418462522
  error estimate for blocks of size 2^( 7) =       0.000420661243

      target function =      -0.934435226577
              le_mean =     -17.210323649276
             les_mean =     296.481471014964
             stat err =       0.000416168825
             autocorr =       1.251887491121
   target nu stat err =       0.000416168825
   target dn stat err =       0.002495413335
      target stat err =       0.004203089726
              std dev =       0.526027974223
             le_variance =       0.276705429665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276752958494
                                         uncertainty =       0.001727209574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276752958494
                                         uncertainty =       0.001727209574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371953753
  error estimate for blocks of size 2^( 2) =       0.000386315121
  error estimate for blocks of size 2^( 3) =       0.000399547407
  error estimate for blocks of size 2^( 4) =       0.000409761714
  error estimate for blocks of size 2^( 5) =       0.000415807801
  error estimate for blocks of size 2^( 6) =       0.000418472688
  error estimate for blocks of size 2^( 7) =       0.000420671593

      target function =      -0.934491547712
              le_mean =     -17.210323664685
             les_mean =     296.481437746356
             stat err =       0.000416178449
             autocorr =       1.251933568530
   target nu stat err =       0.000416178449
   target dn stat err =       0.002476174335
      target stat err =       0.004172186012
              std dev =       0.526030458535
             le_variance =       0.276708043306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276751669225
                                         uncertainty =       0.001727318358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276751669225
                                         uncertainty =       0.001727318358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371952870
  error estimate for blocks of size 2^( 2) =       0.000386313029
  error estimate for blocks of size 2^( 3) =       0.000399544112
  error estimate for blocks of size 2^( 4) =       0.000409757560
  error estimate for blocks of size 2^( 5) =       0.000415803035
  error estimate for blocks of size 2^( 6) =       0.000418467647
  error estimate for blocks of size 2^( 7) =       0.000420666450

      target function =      -0.934463009674
              le_mean =     -17.210323650937
             les_mean =     296.481454402350
             stat err =       0.000416173673
             autocorr =       1.251910779627
   target nu stat err =       0.000416173673
   target dn stat err =       0.002485526179
      target stat err =       0.004187197612
              std dev =       0.526029209273
             le_variance =       0.276706729008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276750552073
                                         uncertainty =       0.001727416662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276750552073
                                         uncertainty =       0.001727416662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371952104
  error estimate for blocks of size 2^( 2) =       0.000386311179
  error estimate for blocks of size 2^( 3) =       0.000399541187
  error estimate for blocks of size 2^( 4) =       0.000409753868
  error estimate for blocks of size 2^( 5) =       0.000415798798
  error estimate for blocks of size 2^( 6) =       0.000418463161
  error estimate for blocks of size 2^( 7) =       0.000420661893

      target function =      -0.934439993774
              le_mean =     -17.210323648989
             les_mean =     296.481468140927
             stat err =       0.000416169430
             autocorr =       1.251890410083
   target nu stat err =       0.000416169430
   target dn stat err =       0.002494154603
      target stat err =       0.004201077382
              std dev =       0.526028126070
             le_variance =       0.276705589417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934435226577        initial
     3.9062e+00     3.9062e+01             1.1028e-04        -0.934491547712  <--
     1.5625e+01     1.5625e+02             2.7632e-05        -0.934463009674
     6.2500e+01     6.2500e+02             6.9119e-06        -0.934439993774

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.9003e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.084902e-01 1 1  ON 0
  uu_1                 5.267560e-02 1 1  ON 1
  uu_2                -3.672542e-02 1 1  ON 2
  uu_3                -8.985145e-02 1 1  ON 3
  uu_4                -1.217643e-01 1 1  ON 4
  uu_5                -1.312768e-01 1 1  ON 5
  uu_6                -1.137604e-01 1 1  ON 6
  uu_7                -5.646880e-02 1 1  ON 7
  uu_8                 5.951310e-02 1 1  ON 8
  uu_9                 1.220853e-01 1 1  ON 9
  ud_0                 3.006852e-01 1 1  ON 10
  ud_1                 7.341451e-02 1 1  ON 11
  ud_2                -2.593594e-02 1 1  ON 12
  ud_3                -7.708726e-02 1 1  ON 13
  ud_4                -1.122877e-01 1 1  ON 14
  ud_5                -1.317682e-01 1 1  ON 15
  ud_6                -1.269229e-01 1 1  ON 16
  ud_7                -8.782024e-02 1 1  ON 17
  ud_8                -4.229664e-03 1 1  ON 18
  ud_9                 8.492182e-02 1 1  ON 19
  eO_0                -6.932116e-01 1 1  ON 20
  eO_1                -4.132240e-01 1 1  ON 21
  eO_2                -4.141817e-02 1 1  ON 22
  eO_3                 1.783622e-01 1 1  ON 23
  eO_4                 2.499569e-01 1 1  ON 24
  eO_5                 2.747924e-01 1 1  ON 25
  eO_6                 2.477541e-01 1 1  ON 26
  eO_7                 1.370672e-01 1 1  ON 27
  eO_8                 2.907702e-02 1 1  ON 28
  eO_9                 1.941077e-02 1 1  ON 29
 eH1_0                -2.054486e-01 1 1  ON 30
 eH1_1                -1.005209e-01 1 1  ON 31
 eH1_2                -4.949720e-02 1 1  ON 32
 eH1_3                -1.791558e-02 1 1  ON 33
 eH1_4                 1.723151e-02 1 1  ON 34
 eH1_5                 2.534669e-02 1 1  ON 35
 eH1_6                 7.903676e-02 1 1  ON 36
 eH1_7                 1.070447e-01 1 1  ON 37
 eH1_8                 1.027292e-01 1 1  ON 38
 eH1_9                 2.587658e-02 1 1  ON 39
 eH2_0                -2.016890e-01 1 1  ON 40
 eH2_1                -9.694513e-02 1 1  ON 41
 eH2_2                -4.657654e-02 1 1  ON 42
 eH2_3                -1.599026e-02 1 1  ON 43
 eH2_4                 1.734040e-02 1 1  ON 44
 eH2_5                 2.121964e-02 1 1  ON 45
 eH2_6                 7.058183e-02 1 1  ON 46
 eH2_7                 1.059990e-01 1 1  ON 47
 eH2_8                 1.046896e-01 1 1  ON 48
 eH2_9                 2.830190e-02 1 1  ON 49
ci_001                -4.235240e-02 3 1  ON 50
ci_002                -3.116004e-02 3 1  ON 51
ci_003                -2.573486e-02 3 1  ON 52
ci_004                 2.449084e-02 3 1  ON 53
ci_005                 2.459781e-02 3 1  ON 54
ci_006                -2.028886e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.986055e-03 3 1  ON 57
ci_009                -1.503805e-02 3 1  ON 58
ci_010                -9.452164e-03 3 1  ON 59
ci_011                -1.021536e-02 3 1  ON 60
ci_012                -1.008202e-02 3 1  ON 61
ci_013                -1.953019e-02 3 1  ON 62
ci_014                 1.299765e-02 3 1  ON 63
ci_015                 1.321075e-02 3 1  ON 64
ci_016                 1.641308e-02 3 1  ON 65
ci_017                 1.617642e-02 3 1  ON 66
ci_018                 1.019301e-02 3 1  ON 67
ci_019                 1.038360e-02 3 1  ON 68
ci_020                 1.646418e-02 3 1  ON 69
ci_021                 1.644431e-02 3 1  ON 70
ci_022                 1.057208e-02 3 1  ON 71
ci_023                 9.294725e-03 3 1  ON 72
ci_024                 7.516982e-03 3 1  ON 73
ci_025                 6.079025e-03 3 1  ON 74
ci_026                 1.168713e-02 3 1  ON 75
ci_027                 1.167002e-02 3 1  ON 76
ci_028                -1.519491e-02 3 1  ON 77
ci_029                -1.537025e-02 3 1  ON 78
ci_030                -4.446885e-03 3 1  ON 79
ci_031                -4.866216e-03 3 1  ON 80
ci_032                -1.535650e-02 3 1  ON 81
ci_033                 6.941970e-03 3 1  ON 82
ci_034                 7.341217e-03 3 1  ON 83
ci_035                -4.584149e-03 3 1  ON 84
ci_036                -1.273325e-02 3 1  ON 85
ci_037                -1.278224e-02 3 1  ON 86
ci_038                 1.163504e-03 3 1  ON 87
ci_039                 1.336029e-03 3 1  ON 88
ci_040                -2.705020e-03 3 1  ON 89
ci_041                 8.454365e-03 3 1  ON 90
ci_042                 8.386091e-03 3 1  ON 91
ci_043                -3.617347e-03 3 1  ON 92
ci_044                -4.715486e-03 3 1  ON 93
ci_045                -2.791673e-03 3 1  ON 94
ci_046                 5.835316e-03 3 1  ON 95
ci_047                 5.644502e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.3272
    reference variance = 1.30847
====================================================
  Execution time = 2.7590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8403e-01
  Total weights = 1.966294333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2966e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276360207327
                                         uncertainty =       0.001348701603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276360207327
                                         uncertainty =       0.001348701603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371689883
  error estimate for blocks of size 2^( 2) =       0.000385771348
  error estimate for blocks of size 2^( 3) =       0.000399209048
  error estimate for blocks of size 2^( 4) =       0.000408813127
  error estimate for blocks of size 2^( 5) =       0.000414259258
  error estimate for blocks of size 2^( 6) =       0.000417474956
  error estimate for blocks of size 2^( 7) =       0.000417649221

      target function =      -0.938119353786
              le_mean =     -17.209689210776
             les_mean =     296.457432765492
             stat err =       0.000414549141
             autocorr =       1.243914581697
   target nu stat err =       0.000414549141
   target dn stat err =       0.001886768097
      target stat err =       0.003234617737
              std dev =       0.525657283278
             le_variance =       0.276315579463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720968921078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938129426964       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938154292306       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938157550150       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938159134850       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938159183829       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938159407241       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938159279506       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938160079977       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938160581072       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938161048273       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938161175354       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938161318224       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938161297999       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938161675738       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938161481256       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938161680426       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938161811831       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938161872143       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938161929382       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938161838879       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938161884709       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938161919739       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938161831438       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938161843607       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938161985275       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938162036315       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938162002791       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938162059608       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938162043449       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938162039757       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938162036211       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938162021390       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938161980736       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938161946355       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938161959019       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938161970948       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938161984117       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938161990392       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938161989649       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938161993304       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938161974400       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938161977667       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e-01 is 4.263051e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938129426964       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938136010617       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938136855132       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938137272943       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938137281614       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938137349279       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938137297986       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938137498092       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938137651487       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938137768392       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938137802860       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938137836690       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938137828737       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938137924861       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938137874858       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938137926806       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938137961883       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938137975664       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938137990009       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938137968264       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938137977216       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938137983120       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938137959616       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938137964705       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938137999882       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938138010268       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938138002074       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938138018025       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938138014382       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938138012971       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938138011845       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938138007196       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938137997129       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938137989292       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938137993257       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938137995919       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938137999375       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938138000362       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938138000233       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938138000445       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938137996653       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+00 is 1.074136e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938129426964       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938131097555       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938131310625       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938131416520       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938131418468       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938131436131       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938131422336       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938131472484       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938131512210       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938131541545       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938131550293       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938131558630       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938131556437       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938131580571       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938131567990       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938131581124       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938131590043       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938131593397       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938131596979       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938131591601       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938131593673       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938131594947       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938131588993       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938131590416       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938131599172       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938131601614       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938131599593       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938131603692       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938131602784       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938131602417       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938131602107       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938131600895       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938131598398       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938131596494       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938131597527       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938131598168       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938131599042       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938131599247       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938131599222       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938131599219       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938131598343       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+01 is 2.690081e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.799063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5971e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.085242e-01 1 1  ON 0
  uu_1                 5.269330e-02 1 1  ON 1
  uu_2                -3.670716e-02 1 1  ON 2
  uu_3                -8.983720e-02 1 1  ON 3
  uu_4                -1.217506e-01 1 1  ON 4
  uu_5                -1.312813e-01 1 1  ON 5
  uu_6                -1.138065e-01 1 1  ON 6
  uu_7                -5.652766e-02 1 1  ON 7
  uu_8                 5.943371e-02 1 1  ON 8
  uu_9                 1.221187e-01 1 1  ON 9
  ud_0                 3.006313e-01 1 1  ON 10
  ud_1                 7.335675e-02 1 1  ON 11
  ud_2                -2.598491e-02 1 1  ON 12
  ud_3                -7.713001e-02 1 1  ON 13
  ud_4                -1.123101e-01 1 1  ON 14
  ud_5                -1.317571e-01 1 1  ON 15
  ud_6                -1.268595e-01 1 1  ON 16
  ud_7                -8.775194e-02 1 1  ON 17
  ud_8                -4.213059e-03 1 1  ON 18
  ud_9                 8.493921e-02 1 1  ON 19
  eO_0                -6.932025e-01 1 1  ON 20
  eO_1                -4.132007e-01 1 1  ON 21
  eO_2                -4.142049e-02 1 1  ON 22
  eO_3                 1.783694e-01 1 1  ON 23
  eO_4                 2.498713e-01 1 1  ON 24
  eO_5                 2.747071e-01 1 1  ON 25
  eO_6                 2.477991e-01 1 1  ON 26
  eO_7                 1.371231e-01 1 1  ON 27
  eO_8                 2.909519e-02 1 1  ON 28
  eO_9                 1.941990e-02 1 1  ON 29
 eH1_0                -2.054570e-01 1 1  ON 30
 eH1_1                -1.005101e-01 1 1  ON 31
 eH1_2                -4.948214e-02 1 1  ON 32
 eH1_3                -1.793039e-02 1 1  ON 33
 eH1_4                 1.719515e-02 1 1  ON 34
 eH1_5                 2.531116e-02 1 1  ON 35
 eH1_6                 7.904209e-02 1 1  ON 36
 eH1_7                 1.070514e-01 1 1  ON 37
 eH1_8                 1.027584e-01 1 1  ON 38
 eH1_9                 2.589176e-02 1 1  ON 39
 eH2_0                -2.017480e-01 1 1  ON 40
 eH2_1                -9.696700e-02 1 1  ON 41
 eH2_2                -4.659046e-02 1 1  ON 42
 eH2_3                -1.602497e-02 1 1  ON 43
 eH2_4                 1.729488e-02 1 1  ON 44
 eH2_5                 2.123227e-02 1 1  ON 45
 eH2_6                 7.068925e-02 1 1  ON 46
 eH2_7                 1.060112e-01 1 1  ON 47
 eH2_8                 1.047292e-01 1 1  ON 48
 eH2_9                 2.830457e-02 1 1  ON 49
ci_001                -4.235098e-02 3 1  ON 50
ci_002                -3.115532e-02 3 1  ON 51
ci_003                -2.574794e-02 3 1  ON 52
ci_004                 2.449446e-02 3 1  ON 53
ci_005                 2.459404e-02 3 1  ON 54
ci_006                -2.028409e-02 3 1  ON 55
ci_007                -2.042677e-02 3 1  ON 56
ci_008                -8.966000e-03 3 1  ON 57
ci_009                -1.505272e-02 3 1  ON 58
ci_010                -9.434187e-03 3 1  ON 59
ci_011                -1.022424e-02 3 1  ON 60
ci_012                -1.008339e-02 3 1  ON 61
ci_013                -1.952605e-02 3 1  ON 62
ci_014                 1.299769e-02 3 1  ON 63
ci_015                 1.320046e-02 3 1  ON 64
ci_016                 1.641927e-02 3 1  ON 65
ci_017                 1.616850e-02 3 1  ON 66
ci_018                 1.020085e-02 3 1  ON 67
ci_019                 1.037679e-02 3 1  ON 68
ci_020                 1.646656e-02 3 1  ON 69
ci_021                 1.643252e-02 3 1  ON 70
ci_022                 1.056180e-02 3 1  ON 71
ci_023                 9.326542e-03 3 1  ON 72
ci_024                 7.530310e-03 3 1  ON 73
ci_025                 6.095030e-03 3 1  ON 74
ci_026                 1.169445e-02 3 1  ON 75
ci_027                 1.166135e-02 3 1  ON 76
ci_028                -1.518659e-02 3 1  ON 77
ci_029                -1.536398e-02 3 1  ON 78
ci_030                -4.438466e-03 3 1  ON 79
ci_031                -4.844484e-03 3 1  ON 80
ci_032                -1.533079e-02 3 1  ON 81
ci_033                 6.931565e-03 3 1  ON 82
ci_034                 7.350761e-03 3 1  ON 83
ci_035                -4.576554e-03 3 1  ON 84
ci_036                -1.271263e-02 3 1  ON 85
ci_037                -1.277489e-02 3 1  ON 86
ci_038                 1.158262e-03 3 1  ON 87
ci_039                 1.336145e-03 3 1  ON 88
ci_040                -2.706978e-03 3 1  ON 89
ci_041                 8.451968e-03 3 1  ON 90
ci_042                 8.401075e-03 3 1  ON 91
ci_043                -3.613465e-03 3 1  ON 92
ci_044                -4.706851e-03 3 1  ON 93
ci_045                -2.789370e-03 3 1  ON 94
ci_046                 5.834876e-03 3 1  ON 95
ci_047                 5.649719e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2177
    reference variance = 0.204367
====================================================
  Execution time = 2.7186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8266e-01
  Total weights = 1.9663e+06
  Execution time = 2.3295e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273132709329
                                         uncertainty =       0.001364498647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273132709329
                                         uncertainty =       0.001364498647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369556292
  error estimate for blocks of size 2^( 2) =       0.000383808447
  error estimate for blocks of size 2^( 3) =       0.000397196476
  error estimate for blocks of size 2^( 4) =       0.000406752463
  error estimate for blocks of size 2^( 5) =       0.000412177256
  error estimate for blocks of size 2^( 6) =       0.000414046191
  error estimate for blocks of size 2^( 7) =       0.000415252785

      target function =      -0.940472611532
              le_mean =     -17.209225985782
             les_mean =     296.440086934683
             stat err =       0.000412057174
             autocorr =       1.243236512213
   target nu stat err =       0.000412057174
   target dn stat err =       0.001834243708
      target stat err =       0.003160888935
              std dev =       0.522639882643
             le_variance =       0.273152446929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273141764710
                                         uncertainty =       0.001364846450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273141764710
                                         uncertainty =       0.001364846450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369562332
  error estimate for blocks of size 2^( 2) =       0.000383827371
  error estimate for blocks of size 2^( 3) =       0.000397227818
  error estimate for blocks of size 2^( 4) =       0.000406794226
  error estimate for blocks of size 2^( 5) =       0.000412223878
  error estimate for blocks of size 2^( 6) =       0.000414096537
  error estimate for blocks of size 2^( 7) =       0.000415299333

      target function =      -0.940244285041
              le_mean =     -17.209225072188
             les_mean =     296.440191687686
             stat err =       0.000412103494
             autocorr =       1.243475393514
   target nu stat err =       0.000412103494
   target dn stat err =       0.001843831937
      target stat err =       0.003175035306
              std dev =       0.522648423723
             le_variance =       0.273161374820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273137016979
                                         uncertainty =       0.001364675725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273137016979
                                         uncertainty =       0.001364675725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369559161
  error estimate for blocks of size 2^( 2) =       0.000383818046
  error estimate for blocks of size 2^( 3) =       0.000397212552
  error estimate for blocks of size 2^( 4) =       0.000406774005
  error estimate for blocks of size 2^( 5) =       0.000412201304
  error estimate for blocks of size 2^( 6) =       0.000414072209
  error estimate for blocks of size 2^( 7) =       0.000415276849

      target function =      -0.940306109913
              le_mean =     -17.209225437007
             les_mean =     296.440167380316
             stat err =       0.000412081092
             autocorr =       1.243361541536
   target nu stat err =       0.000412081092
   target dn stat err =       0.001838020353
      target stat err =       0.003165961739
              std dev =       0.522643939865
             le_variance =       0.273156687877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273133195696
                                         uncertainty =       0.001364520070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273133195696
                                         uncertainty =       0.001364520070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369556616
  error estimate for blocks of size 2^( 2) =       0.000383809620
  error estimate for blocks of size 2^( 3) =       0.000397198466
  error estimate for blocks of size 2^( 4) =       0.000406755145
  error estimate for blocks of size 2^( 5) =       0.000412180254
  error estimate for blocks of size 2^( 6) =       0.000414049444
  error estimate for blocks of size 2^( 7) =       0.000415255792

      target function =      -0.940470754855
              le_mean =     -17.209225906685
             les_mean =     296.440085319335
             stat err =       0.000412060159
             autocorr =       1.243252351202
   target nu stat err =       0.000412060159
   target dn stat err =       0.001834376399
      target stat err =       0.003161093879
              std dev =       0.522640339902
             le_variance =       0.273152924893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940472611532        initial  <--
     9.7656e-01     9.7656e+00             4.2631e-04        -0.940244285041
     3.9062e+00     3.9062e+01             1.0741e-04        -0.940306109913
     1.5625e+01     1.5625e+02             2.6901e-05        -0.940470754855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9546
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.084902e-01 1 1  ON 0
  uu_1                 5.267560e-02 1 1  ON 1
  uu_2                -3.672542e-02 1 1  ON 2
  uu_3                -8.985145e-02 1 1  ON 3
  uu_4                -1.217643e-01 1 1  ON 4
  uu_5                -1.312768e-01 1 1  ON 5
  uu_6                -1.137604e-01 1 1  ON 6
  uu_7                -5.646880e-02 1 1  ON 7
  uu_8                 5.951310e-02 1 1  ON 8
  uu_9                 1.220853e-01 1 1  ON 9
  ud_0                 3.006852e-01 1 1  ON 10
  ud_1                 7.341451e-02 1 1  ON 11
  ud_2                -2.593594e-02 1 1  ON 12
  ud_3                -7.708726e-02 1 1  ON 13
  ud_4                -1.122877e-01 1 1  ON 14
  ud_5                -1.317682e-01 1 1  ON 15
  ud_6                -1.269229e-01 1 1  ON 16
  ud_7                -8.782024e-02 1 1  ON 17
  ud_8                -4.229664e-03 1 1  ON 18
  ud_9                 8.492182e-02 1 1  ON 19
  eO_0                -6.932116e-01 1 1  ON 20
  eO_1                -4.132240e-01 1 1  ON 21
  eO_2                -4.141817e-02 1 1  ON 22
  eO_3                 1.783622e-01 1 1  ON 23
  eO_4                 2.499569e-01 1 1  ON 24
  eO_5                 2.747924e-01 1 1  ON 25
  eO_6                 2.477541e-01 1 1  ON 26
  eO_7                 1.370672e-01 1 1  ON 27
  eO_8                 2.907702e-02 1 1  ON 28
  eO_9                 1.941077e-02 1 1  ON 29
 eH1_0                -2.054486e-01 1 1  ON 30
 eH1_1                -1.005209e-01 1 1  ON 31
 eH1_2                -4.949720e-02 1 1  ON 32
 eH1_3                -1.791558e-02 1 1  ON 33
 eH1_4                 1.723151e-02 1 1  ON 34
 eH1_5                 2.534669e-02 1 1  ON 35
 eH1_6                 7.903676e-02 1 1  ON 36
 eH1_7                 1.070447e-01 1 1  ON 37
 eH1_8                 1.027292e-01 1 1  ON 38
 eH1_9                 2.587658e-02 1 1  ON 39
 eH2_0                -2.016890e-01 1 1  ON 40
 eH2_1                -9.694513e-02 1 1  ON 41
 eH2_2                -4.657654e-02 1 1  ON 42
 eH2_3                -1.599026e-02 1 1  ON 43
 eH2_4                 1.734040e-02 1 1  ON 44
 eH2_5                 2.121964e-02 1 1  ON 45
 eH2_6                 7.058183e-02 1 1  ON 46
 eH2_7                 1.059990e-01 1 1  ON 47
 eH2_8                 1.046896e-01 1 1  ON 48
 eH2_9                 2.830190e-02 1 1  ON 49
ci_001                -4.235240e-02 3 1  ON 50
ci_002                -3.116004e-02 3 1  ON 51
ci_003                -2.573486e-02 3 1  ON 52
ci_004                 2.449084e-02 3 1  ON 53
ci_005                 2.459781e-02 3 1  ON 54
ci_006                -2.028886e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.986055e-03 3 1  ON 57
ci_009                -1.503805e-02 3 1  ON 58
ci_010                -9.452164e-03 3 1  ON 59
ci_011                -1.021536e-02 3 1  ON 60
ci_012                -1.008202e-02 3 1  ON 61
ci_013                -1.953019e-02 3 1  ON 62
ci_014                 1.299765e-02 3 1  ON 63
ci_015                 1.321075e-02 3 1  ON 64
ci_016                 1.641308e-02 3 1  ON 65
ci_017                 1.617642e-02 3 1  ON 66
ci_018                 1.019301e-02 3 1  ON 67
ci_019                 1.038360e-02 3 1  ON 68
ci_020                 1.646418e-02 3 1  ON 69
ci_021                 1.644431e-02 3 1  ON 70
ci_022                 1.057208e-02 3 1  ON 71
ci_023                 9.294725e-03 3 1  ON 72
ci_024                 7.516982e-03 3 1  ON 73
ci_025                 6.079025e-03 3 1  ON 74
ci_026                 1.168713e-02 3 1  ON 75
ci_027                 1.167002e-02 3 1  ON 76
ci_028                -1.519491e-02 3 1  ON 77
ci_029                -1.537025e-02 3 1  ON 78
ci_030                -4.446885e-03 3 1  ON 79
ci_031                -4.866216e-03 3 1  ON 80
ci_032                -1.535650e-02 3 1  ON 81
ci_033                 6.941970e-03 3 1  ON 82
ci_034                 7.341217e-03 3 1  ON 83
ci_035                -4.584149e-03 3 1  ON 84
ci_036                -1.273325e-02 3 1  ON 85
ci_037                -1.278224e-02 3 1  ON 86
ci_038                 1.163504e-03 3 1  ON 87
ci_039                 1.336029e-03 3 1  ON 88
ci_040                -2.705020e-03 3 1  ON 89
ci_041                 8.454365e-03 3 1  ON 90
ci_042                 8.386091e-03 3 1  ON 91
ci_043                -3.617347e-03 3 1  ON 92
ci_044                -4.715486e-03 3 1  ON 93
ci_045                -2.791673e-03 3 1  ON 94
ci_046                 5.835316e-03 3 1  ON 95
ci_047                 5.644502e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.198369
====================================================
  Execution time = 2.7323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8529e-01
  Total weights = 1.966627423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3258e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276339260910
                                         uncertainty =       0.001645438934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276339260910
                                         uncertainty =       0.001645438934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371685819
  error estimate for blocks of size 2^( 2) =       0.000386040090
  error estimate for blocks of size 2^( 3) =       0.000399679164
  error estimate for blocks of size 2^( 4) =       0.000409428868
  error estimate for blocks of size 2^( 5) =       0.000414602742
  error estimate for blocks of size 2^( 6) =       0.000418517127
  error estimate for blocks of size 2^( 7) =       0.000422521850

      target function =      -0.936010956580
              le_mean =     -17.209851732417
             les_mean =     296.464288470190
             stat err =       0.000416267647
             autocorr =       1.254276639978
   target nu stat err =       0.000416267647
   target dn stat err =       0.002156859837
      target stat err =       0.003660602379
              std dev =       0.525651535701
             le_variance =       0.276309536985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720985173242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936024162092       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936026735041       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936027230508       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936027430878       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936027489746       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936027541263       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936027545472       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936027646410       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936027685545       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936027720729       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936027742825       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936027742751       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936027727933       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936027767346       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936027779532       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936027808390       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936027814371       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936027837244       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936027853042       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936027867263       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936027875438       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936027872051       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936027886752       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936027882183       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936027882204       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936027884277       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936027878534       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936027882130       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936027884267       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936027882180       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936027886385       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936027882289       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936027885826       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936027885170       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936027884109       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936027884239       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936027884320       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936027885594       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936027885868       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936027886425       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936027886281       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+00 is 5.234824e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936024162092       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936024809214       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936024933661       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936024983915       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936024998710       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936025011621       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936025012702       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936025038087       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936025047935       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936025056719       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936025062197       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936025062149       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936025058491       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936025068251       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936025071653       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936025078831       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936025080005       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936025085903       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936025089761       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936025093309       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936025095352       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936025094495       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936025098161       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936025097026       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936025097012       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936025097539       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936025096115       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936025096980       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936025097543       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936025096991       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936025098061       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936025097037       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936025097914       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936025097750       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936025097474       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936025097518       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936025097538       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936025097858       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936025097922       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936025098062       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936025098026       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+01 is 1.311743e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936024162092       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936024324117       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936024355265       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936024367839       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936024371543       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936024374772       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936024375044       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936024381400       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936024383867       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936024386062       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936024387428       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936024387414       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936024386502       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936024388936       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936024389811       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936024391601       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936024391875       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936024393363       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936024394319       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936024395206       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936024395717       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936024395502       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936024396418       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936024396134       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936024396130       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936024396262       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936024395907       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936024396121       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936024396263       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936024396123       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936024396392       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936024396135       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936024396354       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936024396313       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936024396245       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936024396256       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936024396261       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936024396341       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936024396356       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936024396392       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936024396384       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+02 is 3.281262e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.873908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5731e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.084913e-01 1 1  ON 0
  uu_1                 5.267767e-02 1 1  ON 1
  uu_2                -3.672257e-02 1 1  ON 2
  uu_3                -8.984895e-02 1 1  ON 3
  uu_4                -1.217629e-01 1 1  ON 4
  uu_5                -1.312777e-01 1 1  ON 5
  uu_6                -1.137631e-01 1 1  ON 6
  uu_7                -5.647309e-02 1 1  ON 7
  uu_8                 5.950401e-02 1 1  ON 8
  uu_9                 1.220862e-01 1 1  ON 9
  ud_0                 3.006779e-01 1 1  ON 10
  ud_1                 7.340699e-02 1 1  ON 11
  ud_2                -2.594125e-02 1 1  ON 12
  ud_3                -7.709124e-02 1 1  ON 13
  ud_4                -1.122895e-01 1 1  ON 14
  ud_5                -1.317676e-01 1 1  ON 15
  ud_6                -1.269181e-01 1 1  ON 16
  ud_7                -8.780713e-02 1 1  ON 17
  ud_8                -4.224989e-03 1 1  ON 18
  ud_9                 8.491867e-02 1 1  ON 19
  eO_0                -6.932073e-01 1 1  ON 20
  eO_1                -4.132221e-01 1 1  ON 21
  eO_2                -4.142138e-02 1 1  ON 22
  eO_3                 1.783564e-01 1 1  ON 23
  eO_4                 2.499547e-01 1 1  ON 24
  eO_5                 2.747868e-01 1 1  ON 25
  eO_6                 2.477555e-01 1 1  ON 26
  eO_7                 1.370740e-01 1 1  ON 27
  eO_8                 2.907862e-02 1 1  ON 28
  eO_9                 1.941098e-02 1 1  ON 29
 eH1_0                -2.054494e-01 1 1  ON 30
 eH1_1                -1.005213e-01 1 1  ON 31
 eH1_2                -4.949549e-02 1 1  ON 32
 eH1_3                -1.791491e-02 1 1  ON 33
 eH1_4                 1.723037e-02 1 1  ON 34
 eH1_5                 2.534563e-02 1 1  ON 35
 eH1_6                 7.903420e-02 1 1  ON 36
 eH1_7                 1.070426e-01 1 1  ON 37
 eH1_8                 1.027335e-01 1 1  ON 38
 eH1_9                 2.587748e-02 1 1  ON 39
 eH2_0                -2.016964e-01 1 1  ON 40
 eH2_1                -9.694809e-02 1 1  ON 41
 eH2_2                -4.657657e-02 1 1  ON 42
 eH2_3                -1.598987e-02 1 1  ON 43
 eH2_4                 1.734043e-02 1 1  ON 44
 eH2_5                 2.121912e-02 1 1  ON 45
 eH2_6                 7.058819e-02 1 1  ON 46
 eH2_7                 1.059993e-01 1 1  ON 47
 eH2_8                 1.046925e-01 1 1  ON 48
 eH2_9                 2.830243e-02 1 1  ON 49
ci_001                -4.235224e-02 3 1  ON 50
ci_002                -3.116020e-02 3 1  ON 51
ci_003                -2.573422e-02 3 1  ON 52
ci_004                 2.449219e-02 3 1  ON 53
ci_005                 2.459699e-02 3 1  ON 54
ci_006                -2.028858e-02 3 1  ON 55
ci_007                -2.042857e-02 3 1  ON 56
ci_008                -8.986411e-03 3 1  ON 57
ci_009                -1.503709e-02 3 1  ON 58
ci_010                -9.450003e-03 3 1  ON 59
ci_011                -1.021582e-02 3 1  ON 60
ci_012                -1.008386e-02 3 1  ON 61
ci_013                -1.952985e-02 3 1  ON 62
ci_014                 1.299827e-02 3 1  ON 63
ci_015                 1.321309e-02 3 1  ON 64
ci_016                 1.641428e-02 3 1  ON 65
ci_017                 1.617735e-02 3 1  ON 66
ci_018                 1.019341e-02 3 1  ON 67
ci_019                 1.038148e-02 3 1  ON 68
ci_020                 1.646478e-02 3 1  ON 69
ci_021                 1.644470e-02 3 1  ON 70
ci_022                 1.057222e-02 3 1  ON 71
ci_023                 9.295413e-03 3 1  ON 72
ci_024                 7.519279e-03 3 1  ON 73
ci_025                 6.082734e-03 3 1  ON 74
ci_026                 1.168528e-02 3 1  ON 75
ci_027                 1.167028e-02 3 1  ON 76
ci_028                -1.519304e-02 3 1  ON 77
ci_029                -1.537022e-02 3 1  ON 78
ci_030                -4.445968e-03 3 1  ON 79
ci_031                -4.865709e-03 3 1  ON 80
ci_032                -1.535606e-02 3 1  ON 81
ci_033                 6.944896e-03 3 1  ON 82
ci_034                 7.340896e-03 3 1  ON 83
ci_035                -4.584360e-03 3 1  ON 84
ci_036                -1.273172e-02 3 1  ON 85
ci_037                -1.278334e-02 3 1  ON 86
ci_038                 1.163547e-03 3 1  ON 87
ci_039                 1.336118e-03 3 1  ON 88
ci_040                -2.705609e-03 3 1  ON 89
ci_041                 8.454403e-03 3 1  ON 90
ci_042                 8.386184e-03 3 1  ON 91
ci_043                -3.616978e-03 3 1  ON 92
ci_044                -4.713380e-03 3 1  ON 93
ci_045                -2.793206e-03 3 1  ON 94
ci_046                 5.834556e-03 3 1  ON 95
ci_047                 5.646411e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.267349
====================================================
  Execution time = 2.7315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8417e-01
  Total weights = 1.9662e+06
  Execution time = 2.3251e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276247333453
                                         uncertainty =       0.001449192801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276247333453
                                         uncertainty =       0.001449192801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371634800
  error estimate for blocks of size 2^( 2) =       0.000386103077
  error estimate for blocks of size 2^( 3) =       0.000399680954
  error estimate for blocks of size 2^( 4) =       0.000409717899
  error estimate for blocks of size 2^( 5) =       0.000416151448
  error estimate for blocks of size 2^( 6) =       0.000419428642
  error estimate for blocks of size 2^( 7) =       0.000420672662

      target function =      -0.937891677000
              le_mean =     -17.209915710341
             les_mean =     296.465361875190
             stat err =       0.000416492663
             autocorr =       1.255977793406
   target nu stat err =       0.000416492663
   target dn stat err =       0.001970914898
      target stat err =       0.003372140599
              std dev =       0.525579383204
             le_variance =       0.276233688049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276245497008
                                         uncertainty =       0.001449098540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276245497008
                                         uncertainty =       0.001449098540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371633560
  error estimate for blocks of size 2^( 2) =       0.000386103033
  error estimate for blocks of size 2^( 3) =       0.000399682114
  error estimate for blocks of size 2^( 4) =       0.000409720119
  error estimate for blocks of size 2^( 5) =       0.000416154101
  error estimate for blocks of size 2^( 6) =       0.000419431811
  error estimate for blocks of size 2^( 7) =       0.000420675886

      target function =      -0.020117641399
              le_mean =     -17.209915611976
             les_mean =     309.552183042537
             stat err =       0.000416495479
             autocorr =       1.256003162700
   target nu stat err =       0.000416495479
   target dn stat err =      13.093191022594
      target stat err =       0.019298799156
              std dev =       0.525577629441
             le_variance =       0.276231844568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276246402236
                                         uncertainty =       0.001449145286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276246402236
                                         uncertainty =       0.001449145286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371634171
  error estimate for blocks of size 2^( 2) =       0.000386103096
  error estimate for blocks of size 2^( 3) =       0.000399681593
  error estimate for blocks of size 2^( 4) =       0.000409719071
  error estimate for blocks of size 2^( 5) =       0.000416152880
  error estimate for blocks of size 2^( 6) =       0.000419430354
  error estimate for blocks of size 2^( 7) =       0.000420674329

      target function =      -0.937856672509
              le_mean =     -17.209915642341
             les_mean =     296.465380508708
             stat err =       0.000416494158
             autocorr =       1.255991064623
   target nu stat err =       0.000416494158
   target dn stat err =       0.001970939240
      target stat err =       0.003371934750
              std dev =       0.525578493959
             le_variance =       0.276232753313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276247216179
                                         uncertainty =       0.001449186844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276247216179
                                         uncertainty =       0.001449186844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371634721
  error estimate for blocks of size 2^( 2) =       0.000386103079
  error estimate for blocks of size 2^( 3) =       0.000399681034
  error estimate for blocks of size 2^( 4) =       0.000409718045
  error estimate for blocks of size 2^( 5) =       0.000416151627
  error estimate for blocks of size 2^( 6) =       0.000419428856
  error estimate for blocks of size 2^( 7) =       0.000420672870

      target function =      -0.937890134582
              le_mean =     -17.209915701733
             les_mean =     296.465362503281
             stat err =       0.000416492849
             autocorr =       1.255979454401
   target nu stat err =       0.000416492849
   target dn stat err =       0.001970895819
      target stat err =       0.003372098727
              std dev =       0.525579271219
             le_variance =       0.276233570335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937891677000        initial  <--
     9.7656e+00     9.7656e+01             5.2348e-05        -0.020117641399
     3.9062e+01     3.9062e+02             1.3117e-05        -0.937856672509
     1.5625e+02     1.5625e+03             3.2813e-06        -0.937890134582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0726
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.084902e-01 1 1  ON 0
  uu_1                 5.267560e-02 1 1  ON 1
  uu_2                -3.672542e-02 1 1  ON 2
  uu_3                -8.985145e-02 1 1  ON 3
  uu_4                -1.217643e-01 1 1  ON 4
  uu_5                -1.312768e-01 1 1  ON 5
  uu_6                -1.137604e-01 1 1  ON 6
  uu_7                -5.646880e-02 1 1  ON 7
  uu_8                 5.951310e-02 1 1  ON 8
  uu_9                 1.220853e-01 1 1  ON 9
  ud_0                 3.006852e-01 1 1  ON 10
  ud_1                 7.341451e-02 1 1  ON 11
  ud_2                -2.593594e-02 1 1  ON 12
  ud_3                -7.708726e-02 1 1  ON 13
  ud_4                -1.122877e-01 1 1  ON 14
  ud_5                -1.317682e-01 1 1  ON 15
  ud_6                -1.269229e-01 1 1  ON 16
  ud_7                -8.782024e-02 1 1  ON 17
  ud_8                -4.229664e-03 1 1  ON 18
  ud_9                 8.492182e-02 1 1  ON 19
  eO_0                -6.932116e-01 1 1  ON 20
  eO_1                -4.132240e-01 1 1  ON 21
  eO_2                -4.141817e-02 1 1  ON 22
  eO_3                 1.783622e-01 1 1  ON 23
  eO_4                 2.499569e-01 1 1  ON 24
  eO_5                 2.747924e-01 1 1  ON 25
  eO_6                 2.477541e-01 1 1  ON 26
  eO_7                 1.370672e-01 1 1  ON 27
  eO_8                 2.907702e-02 1 1  ON 28
  eO_9                 1.941077e-02 1 1  ON 29
 eH1_0                -2.054486e-01 1 1  ON 30
 eH1_1                -1.005209e-01 1 1  ON 31
 eH1_2                -4.949720e-02 1 1  ON 32
 eH1_3                -1.791558e-02 1 1  ON 33
 eH1_4                 1.723151e-02 1 1  ON 34
 eH1_5                 2.534669e-02 1 1  ON 35
 eH1_6                 7.903676e-02 1 1  ON 36
 eH1_7                 1.070447e-01 1 1  ON 37
 eH1_8                 1.027292e-01 1 1  ON 38
 eH1_9                 2.587658e-02 1 1  ON 39
 eH2_0                -2.016890e-01 1 1  ON 40
 eH2_1                -9.694513e-02 1 1  ON 41
 eH2_2                -4.657654e-02 1 1  ON 42
 eH2_3                -1.599026e-02 1 1  ON 43
 eH2_4                 1.734040e-02 1 1  ON 44
 eH2_5                 2.121964e-02 1 1  ON 45
 eH2_6                 7.058183e-02 1 1  ON 46
 eH2_7                 1.059990e-01 1 1  ON 47
 eH2_8                 1.046896e-01 1 1  ON 48
 eH2_9                 2.830190e-02 1 1  ON 49
ci_001                -4.235240e-02 3 1  ON 50
ci_002                -3.116004e-02 3 1  ON 51
ci_003                -2.573486e-02 3 1  ON 52
ci_004                 2.449084e-02 3 1  ON 53
ci_005                 2.459781e-02 3 1  ON 54
ci_006                -2.028886e-02 3 1  ON 55
ci_007                -2.042752e-02 3 1  ON 56
ci_008                -8.986055e-03 3 1  ON 57
ci_009                -1.503805e-02 3 1  ON 58
ci_010                -9.452164e-03 3 1  ON 59
ci_011                -1.021536e-02 3 1  ON 60
ci_012                -1.008202e-02 3 1  ON 61
ci_013                -1.953019e-02 3 1  ON 62
ci_014                 1.299765e-02 3 1  ON 63
ci_015                 1.321075e-02 3 1  ON 64
ci_016                 1.641308e-02 3 1  ON 65
ci_017                 1.617642e-02 3 1  ON 66
ci_018                 1.019301e-02 3 1  ON 67
ci_019                 1.038360e-02 3 1  ON 68
ci_020                 1.646418e-02 3 1  ON 69
ci_021                 1.644431e-02 3 1  ON 70
ci_022                 1.057208e-02 3 1  ON 71
ci_023                 9.294725e-03 3 1  ON 72
ci_024                 7.516982e-03 3 1  ON 73
ci_025                 6.079025e-03 3 1  ON 74
ci_026                 1.168713e-02 3 1  ON 75
ci_027                 1.167002e-02 3 1  ON 76
ci_028                -1.519491e-02 3 1  ON 77
ci_029                -1.537025e-02 3 1  ON 78
ci_030                -4.446885e-03 3 1  ON 79
ci_031                -4.866216e-03 3 1  ON 80
ci_032                -1.535650e-02 3 1  ON 81
ci_033                 6.941970e-03 3 1  ON 82
ci_034                 7.341217e-03 3 1  ON 83
ci_035                -4.584149e-03 3 1  ON 84
ci_036                -1.273325e-02 3 1  ON 85
ci_037                -1.278224e-02 3 1  ON 86
ci_038                 1.163504e-03 3 1  ON 87
ci_039                 1.336029e-03 3 1  ON 88
ci_040                -2.705020e-03 3 1  ON 89
ci_041                 8.454365e-03 3 1  ON 90
ci_042                 8.386091e-03 3 1  ON 91
ci_043                -3.617347e-03 3 1  ON 92
ci_044                -4.715486e-03 3 1  ON 93
ci_045                -2.791673e-03 3 1  ON 94
ci_046                 5.835316e-03 3 1  ON 95
ci_047                 5.644502e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.192
    reference variance = 0.179598
====================================================
  Execution time = 2.7753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8977e-01
  Total weights = 1.966234591e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3470e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280114564116
                                         uncertainty =       0.001983727658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280114564116
                                         uncertainty =       0.001983727658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374214993
  error estimate for blocks of size 2^( 2) =       0.000388347389
  error estimate for blocks of size 2^( 3) =       0.000401297292
  error estimate for blocks of size 2^( 4) =       0.000410975433
  error estimate for blocks of size 2^( 5) =       0.000416868864
  error estimate for blocks of size 2^( 6) =       0.000420457264
  error estimate for blocks of size 2^( 7) =       0.000422767516

      target function =      -0.928624756782
              le_mean =     -17.209626115773
             les_mean =     296.461004772130
             stat err =       0.000417767269
             autocorr =       1.246311082615
   target nu stat err =       0.000417767269
   target dn stat err =       0.002417279538
      target stat err =       0.004021098157
              std dev =       0.529228385225
             le_variance =       0.280082683728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720962611577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928641232177       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928641839935       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928641911662       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928641928215       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928641931975       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928641934744       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928641936534       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928641939386       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928641937749       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928641940684       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928641941199       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928641943113       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928641943874       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928641944410       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928641947512       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928641948211       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928641951124       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928641950855       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928641951257       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928641951304       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928641951615       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928641951629       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928641952748       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928641953539       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928641953396       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928641953161       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928641952972       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928641952930       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928641952670       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928641952723       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928641952751       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928641952558       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928641952611       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928641952869       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928641952682       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928641952669       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928641952669       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928641952590       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928641952588       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928641952683       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+01 is 3.814463e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928641232177       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928641384205       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928641402144       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928641406284       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928641407224       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928641407918       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928641408363       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928641409081       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928641408670       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928641409402       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928641409532       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928641410011       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928641410200       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928641410335       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928641411110       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928641411284       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928641412014       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928641411946       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928641412046       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928641412058       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928641412136       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928641412139       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928641412419       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928641412616       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928641412582       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928641412523       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928641412474       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928641412464       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928641412400       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928641412413       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928641412420       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928641412370       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928641412385       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928641412450       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928641412403       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928641412399       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928641412397       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928641412380       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928641412378       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928641412403       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+02 is 9.536701e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928641232177       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928641270190       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928641274675       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928641275710       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928641275944       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928641276120       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928641276227       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928641276408       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928641276307       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928641276487       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928641276522       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928641276641       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928641276688       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928641276723       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928641276915       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928641276965       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928641277146       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928641277131       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928641277149       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928641277150       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928641277175       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928641277180       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928641277245       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928641277291       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928641277286       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928641277269       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928641277258       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928641277253       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928641277238       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928641277245       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928641277243       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928641277231       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928641277238       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928641277256       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928641277244       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928641277237       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928641277227       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928641277231       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928641277229       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928641277240       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5625e+03 is 2.384209e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.943683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6177e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267583e-02 1 1  ON 1
  uu_2                -3.672524e-02 1 1  ON 2
  uu_3                -8.985134e-02 1 1  ON 3
  uu_4                -1.217643e-01 1 1  ON 4
  uu_5                -1.312767e-01 1 1  ON 5
  uu_6                -1.137605e-01 1 1  ON 6
  uu_7                -5.646918e-02 1 1  ON 7
  uu_8                 5.951215e-02 1 1  ON 8
  uu_9                 1.220855e-01 1 1  ON 9
  ud_0                 3.006849e-01 1 1  ON 10
  ud_1                 7.341431e-02 1 1  ON 11
  ud_2                -2.593602e-02 1 1  ON 12
  ud_3                -7.708727e-02 1 1  ON 13
  ud_4                -1.122878e-01 1 1  ON 14
  ud_5                -1.317681e-01 1 1  ON 15
  ud_6                -1.269229e-01 1 1  ON 16
  ud_7                -8.781991e-02 1 1  ON 17
  ud_8                -4.229694e-03 1 1  ON 18
  ud_9                 8.492167e-02 1 1  ON 19
  eO_0                -6.932116e-01 1 1  ON 20
  eO_1                -4.132241e-01 1 1  ON 21
  eO_2                -4.141850e-02 1 1  ON 22
  eO_3                 1.783621e-01 1 1  ON 23
  eO_4                 2.499571e-01 1 1  ON 24
  eO_5                 2.747920e-01 1 1  ON 25
  eO_6                 2.477539e-01 1 1  ON 26
  eO_7                 1.370679e-01 1 1  ON 27
  eO_8                 2.907708e-02 1 1  ON 28
  eO_9                 1.941078e-02 1 1  ON 29
 eH1_0                -2.054486e-01 1 1  ON 30
 eH1_1                -1.005205e-01 1 1  ON 31
 eH1_2                -4.949684e-02 1 1  ON 32
 eH1_3                -1.791539e-02 1 1  ON 33
 eH1_4                 1.723158e-02 1 1  ON 34
 eH1_5                 2.534598e-02 1 1  ON 35
 eH1_6                 7.903618e-02 1 1  ON 36
 eH1_7                 1.070445e-01 1 1  ON 37
 eH1_8                 1.027295e-01 1 1  ON 38
 eH1_9                 2.587664e-02 1 1  ON 39
 eH2_0                -2.016893e-01 1 1  ON 40
 eH2_1                -9.694538e-02 1 1  ON 41
 eH2_2                -4.657653e-02 1 1  ON 42
 eH2_3                -1.599015e-02 1 1  ON 43
 eH2_4                 1.734062e-02 1 1  ON 44
 eH2_5                 2.121975e-02 1 1  ON 45
 eH2_6                 7.058161e-02 1 1  ON 46
 eH2_7                 1.059989e-01 1 1  ON 47
 eH2_8                 1.046899e-01 1 1  ON 48
 eH2_9                 2.830195e-02 1 1  ON 49
ci_001                -4.235235e-02 3 1  ON 50
ci_002                -3.116002e-02 3 1  ON 51
ci_003                -2.573496e-02 3 1  ON 52
ci_004                 2.449106e-02 3 1  ON 53
ci_005                 2.459793e-02 3 1  ON 54
ci_006                -2.028886e-02 3 1  ON 55
ci_007                -2.042740e-02 3 1  ON 56
ci_008                -8.985958e-03 3 1  ON 57
ci_009                -1.503795e-02 3 1  ON 58
ci_010                -9.452129e-03 3 1  ON 59
ci_011                -1.021536e-02 3 1  ON 60
ci_012                -1.008190e-02 3 1  ON 61
ci_013                -1.953032e-02 3 1  ON 62
ci_014                 1.299790e-02 3 1  ON 63
ci_015                 1.321104e-02 3 1  ON 64
ci_016                 1.641292e-02 3 1  ON 65
ci_017                 1.617631e-02 3 1  ON 66
ci_018                 1.019298e-02 3 1  ON 67
ci_019                 1.038368e-02 3 1  ON 68
ci_020                 1.646407e-02 3 1  ON 69
ci_021                 1.644445e-02 3 1  ON 70
ci_022                 1.057195e-02 3 1  ON 71
ci_023                 9.294918e-03 3 1  ON 72
ci_024                 7.516692e-03 3 1  ON 73
ci_025                 6.079184e-03 3 1  ON 74
ci_026                 1.168696e-02 3 1  ON 75
ci_027                 1.166984e-02 3 1  ON 76
ci_028                -1.519479e-02 3 1  ON 77
ci_029                -1.537043e-02 3 1  ON 78
ci_030                -4.446998e-03 3 1  ON 79
ci_031                -4.866087e-03 3 1  ON 80
ci_032                -1.535658e-02 3 1  ON 81
ci_033                 6.941787e-03 3 1  ON 82
ci_034                 7.340431e-03 3 1  ON 83
ci_035                -4.584003e-03 3 1  ON 84
ci_036                -1.273302e-02 3 1  ON 85
ci_037                -1.278218e-02 3 1  ON 86
ci_038                 1.163542e-03 3 1  ON 87
ci_039                 1.335913e-03 3 1  ON 88
ci_040                -2.705024e-03 3 1  ON 89
ci_041                 8.454289e-03 3 1  ON 90
ci_042                 8.386027e-03 3 1  ON 91
ci_043                -3.617363e-03 3 1  ON 92
ci_044                -4.715164e-03 3 1  ON 93
ci_045                -2.791684e-03 3 1  ON 94
ci_046                 5.835368e-03 3 1  ON 95
ci_047                 5.644445e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1018
    reference variance = 0.228442
====================================================
  Execution time = 2.9370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8470e-01
  Total weights = 1.9660e+06
  Execution time = 2.3064e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328216233
                                         uncertainty =       0.001742516480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328216233
                                         uncertainty =       0.001742516480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712162
  error estimate for blocks of size 2^( 2) =       0.000386230783
  error estimate for blocks of size 2^( 3) =       0.000399724062
  error estimate for blocks of size 2^( 4) =       0.000409442088
  error estimate for blocks of size 2^( 5) =       0.000415157806
  error estimate for blocks of size 2^( 6) =       0.000417729108
  error estimate for blocks of size 2^( 7) =       0.000420049665

      target function =      -0.937000159040
              le_mean =     -17.209424507056
             les_mean =     296.448995478525
             stat err =       0.000415594667
             autocorr =       1.250047136772
   target nu stat err =       0.000415594667
   target dn stat err =       0.002034647998
      target stat err =       0.003465971754
              std dev =       0.525688791288
             le_variance =       0.276348705285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328269511
                                         uncertainty =       0.001742469055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328269511
                                         uncertainty =       0.001742469055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712201
  error estimate for blocks of size 2^( 2) =       0.000386230998
  error estimate for blocks of size 2^( 3) =       0.000399724453
  error estimate for blocks of size 2^( 4) =       0.000409442608
  error estimate for blocks of size 2^( 5) =       0.000415158424
  error estimate for blocks of size 2^( 6) =       0.000417729727
  error estimate for blocks of size 2^( 7) =       0.000420050316

      target function =      -0.937001506610
              le_mean =     -17.209424540712
             les_mean =     296.448995825779
             stat err =       0.000415595269
             autocorr =       1.250050494740
   target nu stat err =       0.000415595269
   target dn stat err =       0.002034795476
      target stat err =       0.003466221782
              std dev =       0.525688846851
             le_variance =       0.276348763703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328242776
                                         uncertainty =       0.001742492753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328242776
                                         uncertainty =       0.001742492753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712181
  error estimate for blocks of size 2^( 2) =       0.000386230890
  error estimate for blocks of size 2^( 3) =       0.000399724257
  error estimate for blocks of size 2^( 4) =       0.000409442348
  error estimate for blocks of size 2^( 5) =       0.000415158115
  error estimate for blocks of size 2^( 6) =       0.000417729418
  error estimate for blocks of size 2^( 7) =       0.000420049990

      target function =      -0.937000984085
              le_mean =     -17.209424523880
             les_mean =     296.448995561151
             stat err =       0.000415594968
             autocorr =       1.250048816705
   target nu stat err =       0.000415594968
   target dn stat err =       0.002034719236
      target stat err =       0.003466093793
              std dev =       0.525688818979
             le_variance =       0.276348734400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328219539
                                         uncertainty =       0.001742513514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276328219539
                                         uncertainty =       0.001742513514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371712164
  error estimate for blocks of size 2^( 2) =       0.000386230796
  error estimate for blocks of size 2^( 3) =       0.000399724086
  error estimate for blocks of size 2^( 4) =       0.000409442120
  error estimate for blocks of size 2^( 5) =       0.000415157844
  error estimate for blocks of size 2^( 6) =       0.000417729147
  error estimate for blocks of size 2^( 7) =       0.000420049706

      target function =      -0.937000279939
              le_mean =     -17.209424509158
             les_mean =     296.448995478140
             stat err =       0.000415594704
             autocorr =       1.250047346789
   target nu stat err =       0.000415594704
   target dn stat err =       0.002034656614
      target stat err =       0.003465986668
              std dev =       0.525688794737
             le_variance =       0.276348708913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937000159040        initial
     9.7656e+01     9.7656e+02             3.8145e-06        -0.937001506610  <--
     3.9062e+02     3.9062e+03             9.5367e-07        -0.937000984085
     1.5625e+03     1.5625e+04             2.3842e-07        -0.937000279939

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.1020e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.084915e-01 1 1  ON 0
  uu_1                 5.267653e-02 1 1  ON 1
  uu_2                -3.672472e-02 1 1  ON 2
  uu_3                -8.985104e-02 1 1  ON 3
  uu_4                -1.217641e-01 1 1  ON 4
  uu_5                -1.312766e-01 1 1  ON 5
  uu_6                -1.137607e-01 1 1  ON 6
  uu_7                -5.647033e-02 1 1  ON 7
  uu_8                 5.950928e-02 1 1  ON 8
  uu_9                 1.220861e-01 1 1  ON 9
  ud_0                 3.006841e-01 1 1  ON 10
  ud_1                 7.341370e-02 1 1  ON 11
  ud_2                -2.593626e-02 1 1  ON 12
  ud_3                -7.708730e-02 1 1  ON 13
  ud_4                -1.122878e-01 1 1  ON 14
  ud_5                -1.317678e-01 1 1  ON 15
  ud_6                -1.269228e-01 1 1  ON 16
  ud_7                -8.781890e-02 1 1  ON 17
  ud_8                -4.229783e-03 1 1  ON 18
  ud_9                 8.492124e-02 1 1  ON 19
  eO_0                -6.932113e-01 1 1  ON 20
  eO_1                -4.132241e-01 1 1  ON 21
  eO_2                -4.141951e-02 1 1  ON 22
  eO_3                 1.783618e-01 1 1  ON 23
  eO_4                 2.499576e-01 1 1  ON 24
  eO_5                 2.747909e-01 1 1  ON 25
  eO_6                 2.477534e-01 1 1  ON 26
  eO_7                 1.370699e-01 1 1  ON 27
  eO_8                 2.907726e-02 1 1  ON 28
  eO_9                 1.941084e-02 1 1  ON 29
 eH1_0                -2.054486e-01 1 1  ON 30
 eH1_1                -1.005194e-01 1 1  ON 31
 eH1_2                -4.949576e-02 1 1  ON 32
 eH1_3                -1.791480e-02 1 1  ON 33
 eH1_4                 1.723179e-02 1 1  ON 34
 eH1_5                 2.534383e-02 1 1  ON 35
 eH1_6                 7.903442e-02 1 1  ON 36
 eH1_7                 1.070442e-01 1 1  ON 37
 eH1_8                 1.027306e-01 1 1  ON 38
 eH1_9                 2.587681e-02 1 1  ON 39
 eH2_0                -2.016901e-01 1 1  ON 40
 eH2_1                -9.694612e-02 1 1  ON 41
 eH2_2                -4.657650e-02 1 1  ON 42
 eH2_3                -1.598983e-02 1 1  ON 43
 eH2_4                 1.734128e-02 1 1  ON 44
 eH2_5                 2.122007e-02 1 1  ON 45
 eH2_6                 7.058096e-02 1 1  ON 46
 eH2_7                 1.059985e-01 1 1  ON 47
 eH2_8                 1.046910e-01 1 1  ON 48
 eH2_9                 2.830209e-02 1 1  ON 49
ci_001                -4.235223e-02 3 1  ON 50
ci_002                -3.115993e-02 3 1  ON 51
ci_003                -2.573525e-02 3 1  ON 52
ci_004                 2.449171e-02 3 1  ON 53
ci_005                 2.459827e-02 3 1  ON 54
ci_006                -2.028886e-02 3 1  ON 55
ci_007                -2.042704e-02 3 1  ON 56
ci_008                -8.985668e-03 3 1  ON 57
ci_009                -1.503764e-02 3 1  ON 58
ci_010                -9.452024e-03 3 1  ON 59
ci_011                -1.021537e-02 3 1  ON 60
ci_012                -1.008154e-02 3 1  ON 61
ci_013                -1.953072e-02 3 1  ON 62
ci_014                 1.299865e-02 3 1  ON 63
ci_015                 1.321191e-02 3 1  ON 64
ci_016                 1.641241e-02 3 1  ON 65
ci_017                 1.617599e-02 3 1  ON 66
ci_018                 1.019289e-02 3 1  ON 67
ci_019                 1.038391e-02 3 1  ON 68
ci_020                 1.646373e-02 3 1  ON 69
ci_021                 1.644487e-02 3 1  ON 70
ci_022                 1.057154e-02 3 1  ON 71
ci_023                 9.295497e-03 3 1  ON 72
ci_024                 7.515821e-03 3 1  ON 73
ci_025                 6.079660e-03 3 1  ON 74
ci_026                 1.168646e-02 3 1  ON 75
ci_027                 1.166930e-02 3 1  ON 76
ci_028                -1.519446e-02 3 1  ON 77
ci_029                -1.537096e-02 3 1  ON 78
ci_030                -4.447336e-03 3 1  ON 79
ci_031                -4.865702e-03 3 1  ON 80
ci_032                -1.535684e-02 3 1  ON 81
ci_033                 6.941239e-03 3 1  ON 82
ci_034                 7.338077e-03 3 1  ON 83
ci_035                -4.583568e-03 3 1  ON 84
ci_036                -1.273235e-02 3 1  ON 85
ci_037                -1.278200e-02 3 1  ON 86
ci_038                 1.163658e-03 3 1  ON 87
ci_039                 1.335566e-03 3 1  ON 88
ci_040                -2.705036e-03 3 1  ON 89
ci_041                 8.454064e-03 3 1  ON 90
ci_042                 8.385837e-03 3 1  ON 91
ci_043                -3.617413e-03 3 1  ON 92
ci_044                -4.714199e-03 3 1  ON 93
ci_045                -2.791716e-03 3 1  ON 94
ci_046                 5.835525e-03 3 1  ON 95
ci_047                 5.644274e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.177071
====================================================
  Execution time = 2.7386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0505e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8472e-01
  Total weights = 1.966407511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1532e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276045071698
                                         uncertainty =       0.001504942565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276045071698
                                         uncertainty =       0.001504942565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371503811
  error estimate for blocks of size 2^( 2) =       0.000385421421
  error estimate for blocks of size 2^( 3) =       0.000398500961
  error estimate for blocks of size 2^( 4) =       0.000407395410
  error estimate for blocks of size 2^( 5) =       0.000412537973
  error estimate for blocks of size 2^( 6) =       0.000414988515
  error estimate for blocks of size 2^( 7) =       0.000414735365

      target function =      -0.936963987810
              le_mean =     -17.210070867265
             les_mean =     296.471255452517
             stat err =       0.000412414316
             autocorr =       1.232369430476
   target nu stat err =       0.000412414316
   target dn stat err =       0.002136498305
      target stat err =       0.003634820265
              std dev =       0.525394134590
             le_variance =       0.276038996662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721007086727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936977107719       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936978942447       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936979295465       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936979485679       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936979507564       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936979531797       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936979547772       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936979552631       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936979589931       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936979598351       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936979599153       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936979606282       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936979623018       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936979621422       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936979626405       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936979625092       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936979628045       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936979631165       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936979636230       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936979639211       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936979640120       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936979638168       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936979639069       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936979640111       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936979642438       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936979642550       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936979643403       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936979645873       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936979646722       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936979646005       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936979646724       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936979647655       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936979648218       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936979647965       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936979647314       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936979646682       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936979646486       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936979647061       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936979647195       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936979647531       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936979647427       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+01 is 1.582324e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936977107719       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936977567507       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936977655897       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936977703546       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936977709015       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936977715096       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936977719080       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936977720301       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936977729634       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936977731745       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936977731949       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936977733729       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936977737923       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936977737520       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936977738756       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936977738427       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936977739168       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936977739949       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936977741216       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936977741961       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936977742187       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936977741697       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936977741924       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936977742185       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936977742767       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936977742795       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936977743009       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936977743624       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936977743834       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936977743656       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936977743836       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936977744068       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936977744209       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936977744145       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936977743981       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936977743824       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936977743777       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936977743919       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936977743953       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936977744036       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936977744009       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+01 is 3.959747e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936977107719       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936977222736       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936977244841       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936977256760       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936977258127       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936977259649       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936977260644       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936977260950       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936977263283       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936977263811       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936977263863       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936977264308       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936977265357       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936977265255       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936977265565       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936977265481       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936977265668       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936977265863       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936977266180       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936977266363       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936977266423       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936977266299       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936977266355       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936977266421       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936977266566       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936977266572       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936977266627       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936977266780       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936977266834       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936977266788       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936977266834       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936977266892       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936977266926       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936977266910       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936977266870       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936977266828       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936977266819       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936977266854       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936977266865       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936977266883       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936977266877       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.9062e+02 is 9.901831e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.018339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5621e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267587e-02 1 1  ON 1
  uu_2                -3.672466e-02 1 1  ON 2
  uu_3                -8.985104e-02 1 1  ON 3
  uu_4                -1.217638e-01 1 1  ON 4
  uu_5                -1.312757e-01 1 1  ON 5
  uu_6                -1.137593e-01 1 1  ON 6
  uu_7                -5.646943e-02 1 1  ON 7
  uu_8                 5.950597e-02 1 1  ON 8
  uu_9                 1.220865e-01 1 1  ON 9
  ud_0                 3.006819e-01 1 1  ON 10
  ud_1                 7.341174e-02 1 1  ON 11
  ud_2                -2.593772e-02 1 1  ON 12
  ud_3                -7.708784e-02 1 1  ON 13
  ud_4                -1.122877e-01 1 1  ON 14
  ud_5                -1.317666e-01 1 1  ON 15
  ud_6                -1.269216e-01 1 1  ON 16
  ud_7                -8.781494e-02 1 1  ON 17
  ud_8                -4.230151e-03 1 1  ON 18
  ud_9                 8.492000e-02 1 1  ON 19
  eO_0                -6.932102e-01 1 1  ON 20
  eO_1                -4.132239e-01 1 1  ON 21
  eO_2                -4.142077e-02 1 1  ON 22
  eO_3                 1.783615e-01 1 1  ON 23
  eO_4                 2.499561e-01 1 1  ON 24
  eO_5                 2.747890e-01 1 1  ON 25
  eO_6                 2.477540e-01 1 1  ON 26
  eO_7                 1.370728e-01 1 1  ON 27
  eO_8                 2.907728e-02 1 1  ON 28
  eO_9                 1.941086e-02 1 1  ON 29
 eH1_0                -2.054473e-01 1 1  ON 30
 eH1_1                -1.005170e-01 1 1  ON 31
 eH1_2                -4.949374e-02 1 1  ON 32
 eH1_3                -1.791457e-02 1 1  ON 33
 eH1_4                 1.723051e-02 1 1  ON 34
 eH1_5                 2.534089e-02 1 1  ON 35
 eH1_6                 7.903194e-02 1 1  ON 36
 eH1_7                 1.070435e-01 1 1  ON 37
 eH1_8                 1.027317e-01 1 1  ON 38
 eH1_9                 2.587708e-02 1 1  ON 39
 eH2_0                -2.016909e-01 1 1  ON 40
 eH2_1                -9.694613e-02 1 1  ON 41
 eH2_2                -4.657569e-02 1 1  ON 42
 eH2_3                -1.598918e-02 1 1  ON 43
 eH2_4                 1.734019e-02 1 1  ON 44
 eH2_5                 2.121852e-02 1 1  ON 45
 eH2_6                 7.058227e-02 1 1  ON 46
 eH2_7                 1.059981e-01 1 1  ON 47
 eH2_8                 1.046917e-01 1 1  ON 48
 eH2_9                 2.830237e-02 1 1  ON 49
ci_001                -4.235154e-02 3 1  ON 50
ci_002                -3.115941e-02 3 1  ON 51
ci_003                -2.573693e-02 3 1  ON 52
ci_004                 2.449278e-02 3 1  ON 53
ci_005                 2.459836e-02 3 1  ON 54
ci_006                -2.028853e-02 3 1  ON 55
ci_007                -2.042734e-02 3 1  ON 56
ci_008                -8.985543e-03 3 1  ON 57
ci_009                -1.503734e-02 3 1  ON 58
ci_010                -9.451410e-03 3 1  ON 59
ci_011                -1.021626e-02 3 1  ON 60
ci_012                -1.008241e-02 3 1  ON 61
ci_013                -1.953096e-02 3 1  ON 62
ci_014                 1.299933e-02 3 1  ON 63
ci_015                 1.321250e-02 3 1  ON 64
ci_016                 1.641242e-02 3 1  ON 65
ci_017                 1.617603e-02 3 1  ON 66
ci_018                 1.019289e-02 3 1  ON 67
ci_019                 1.038324e-02 3 1  ON 68
ci_020                 1.646394e-02 3 1  ON 69
ci_021                 1.644478e-02 3 1  ON 70
ci_022                 1.057110e-02 3 1  ON 71
ci_023                 9.296838e-03 3 1  ON 72
ci_024                 7.515553e-03 3 1  ON 73
ci_025                 6.081244e-03 3 1  ON 74
ci_026                 1.168746e-02 3 1  ON 75
ci_027                 1.166827e-02 3 1  ON 76
ci_028                -1.519478e-02 3 1  ON 77
ci_029                -1.537108e-02 3 1  ON 78
ci_030                -4.447854e-03 3 1  ON 79
ci_031                -4.864698e-03 3 1  ON 80
ci_032                -1.535609e-02 3 1  ON 81
ci_033                 6.941653e-03 3 1  ON 82
ci_034                 7.337701e-03 3 1  ON 83
ci_035                -4.584164e-03 3 1  ON 84
ci_036                -1.273219e-02 3 1  ON 85
ci_037                -1.278220e-02 3 1  ON 86
ci_038                 1.163706e-03 3 1  ON 87
ci_039                 1.335683e-03 3 1  ON 88
ci_040                -2.705098e-03 3 1  ON 89
ci_041                 8.454981e-03 3 1  ON 90
ci_042                 8.385356e-03 3 1  ON 91
ci_043                -3.617321e-03 3 1  ON 92
ci_044                -4.713679e-03 3 1  ON 93
ci_045                -2.791550e-03 3 1  ON 94
ci_046                 5.835450e-03 3 1  ON 95
ci_047                 5.644186e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2752
    reference variance = 0.156123
====================================================
  Execution time = 2.7087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8527e-01
  Total weights = 1.9664e+06
  Execution time = 2.3061e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186425713
                                         uncertainty =       0.001690012801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186425713
                                         uncertainty =       0.001690012801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371589571
  error estimate for blocks of size 2^( 2) =       0.000385862176
  error estimate for blocks of size 2^( 3) =       0.000398400742
  error estimate for blocks of size 2^( 4) =       0.000408806260
  error estimate for blocks of size 2^( 5) =       0.000414399048
  error estimate for blocks of size 2^( 6) =       0.000415674744
  error estimate for blocks of size 2^( 7) =       0.000418597846

      target function =      -0.936061554693
              le_mean =     -17.208829587701
             les_mean =     296.429089769483
             stat err =       0.000414369475
             autocorr =       1.243507691220
   target nu stat err =       0.000414369475
   target dn stat err =       0.002252636936
      target stat err =       0.003809032834
              std dev =       0.525515419346
             le_variance =       0.276166455970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276185753742
                                         uncertainty =       0.001690062533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276185753742
                                         uncertainty =       0.001690062533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371589124
  error estimate for blocks of size 2^( 2) =       0.000385862138
  error estimate for blocks of size 2^( 3) =       0.000398401155
  error estimate for blocks of size 2^( 4) =       0.000408806996
  error estimate for blocks of size 2^( 5) =       0.000414399934
  error estimate for blocks of size 2^( 6) =       0.000415675944
  error estimate for blocks of size 2^( 7) =       0.000418598927

      target function =      -0.936072578337
              le_mean =     -17.208829675045
             les_mean =     296.429086136884
             stat err =       0.000414370450
             autocorr =       1.243516542906
   target nu stat err =       0.000414370450
   target dn stat err =       0.002251829893
      target stat err =       0.003807807874
              std dev =       0.525514786303
             le_variance =       0.276165790623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186087600
                                         uncertainty =       0.001690037679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186087600
                                         uncertainty =       0.001690037679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371589346
  error estimate for blocks of size 2^( 2) =       0.000385862155
  error estimate for blocks of size 2^( 3) =       0.000398400948
  error estimate for blocks of size 2^( 4) =       0.000408806628
  error estimate for blocks of size 2^( 5) =       0.000414399491
  error estimate for blocks of size 2^( 6) =       0.000415675344
  error estimate for blocks of size 2^( 7) =       0.000418598386

      target function =      -0.936067156529
              le_mean =     -17.208829631286
             les_mean =     296.429087895948
             stat err =       0.000414369962
             autocorr =       1.243512124723
   target nu stat err =       0.000414369962
   target dn stat err =       0.002252227551
      target stat err =       0.003808411532
              std dev =       0.525515100810
             le_variance =       0.276166121179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186383254
                                         uncertainty =       0.001690015906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276186383254
                                         uncertainty =       0.001690015906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371589543
  error estimate for blocks of size 2^( 2) =       0.000385862173
  error estimate for blocks of size 2^( 3) =       0.000398400768
  error estimate for blocks of size 2^( 4) =       0.000408806306
  error estimate for blocks of size 2^( 5) =       0.000414399103
  error estimate for blocks of size 2^( 6) =       0.000415674819
  error estimate for blocks of size 2^( 7) =       0.000418597913

      target function =      -0.936062264020
              le_mean =     -17.208829593130
             les_mean =     296.429089529155
             stat err =       0.000414369536
             autocorr =       1.243508245619
   target nu stat err =       0.000414369536
   target dn stat err =       0.002252585175
      target stat err =       0.003808954287
              std dev =       0.525515379344
             le_variance =       0.276166413927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936061554693        initial
     2.4414e+01     2.4414e+02             1.5823e-05        -0.936072578337  <--
     9.7656e+01     9.7656e+02             3.9597e-06        -0.936067156529
     3.9062e+02     3.9062e+03             9.9018e-07        -0.936062264020

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.8728e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.084880e-01 1 1  ON 0
  uu_1                 5.267388e-02 1 1  ON 1
  uu_2                -3.672451e-02 1 1  ON 2
  uu_3                -8.985105e-02 1 1  ON 3
  uu_4                -1.217628e-01 1 1  ON 4
  uu_5                -1.312731e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646672e-02 1 1  ON 7
  uu_8                 5.949602e-02 1 1  ON 8
  uu_9                 1.220880e-01 1 1  ON 9
  ud_0                 3.006752e-01 1 1  ON 10
  ud_1                 7.340587e-02 1 1  ON 11
  ud_2                -2.594211e-02 1 1  ON 12
  ud_3                -7.708944e-02 1 1  ON 13
  ud_4                -1.122874e-01 1 1  ON 14
  ud_5                -1.317629e-01 1 1  ON 15
  ud_6                -1.269179e-01 1 1  ON 16
  ud_7                -8.780307e-02 1 1  ON 17
  ud_8                -4.231251e-03 1 1  ON 18
  ud_9                 8.491630e-02 1 1  ON 19
  eO_0                -6.932072e-01 1 1  ON 20
  eO_1                -4.132234e-01 1 1  ON 21
  eO_2                -4.142455e-02 1 1  ON 22
  eO_3                 1.783607e-01 1 1  ON 23
  eO_4                 2.499518e-01 1 1  ON 24
  eO_5                 2.747834e-01 1 1  ON 25
  eO_6                 2.477559e-01 1 1  ON 26
  eO_7                 1.370817e-01 1 1  ON 27
  eO_8                 2.907735e-02 1 1  ON 28
  eO_9                 1.941095e-02 1 1  ON 29
 eH1_0                -2.054435e-01 1 1  ON 30
 eH1_1                -1.005097e-01 1 1  ON 31
 eH1_2                -4.948771e-02 1 1  ON 32
 eH1_3                -1.791387e-02 1 1  ON 33
 eH1_4                 1.722669e-02 1 1  ON 34
 eH1_5                 2.533208e-02 1 1  ON 35
 eH1_6                 7.902451e-02 1 1  ON 36
 eH1_7                 1.070417e-01 1 1  ON 37
 eH1_8                 1.027350e-01 1 1  ON 38
 eH1_9                 2.587789e-02 1 1  ON 39
 eH2_0                -2.016931e-01 1 1  ON 40
 eH2_1                -9.694615e-02 1 1  ON 41
 eH2_2                -4.657327e-02 1 1  ON 42
 eH2_3                -1.598726e-02 1 1  ON 43
 eH2_4                 1.733693e-02 1 1  ON 44
 eH2_5                 2.121389e-02 1 1  ON 45
 eH2_6                 7.058619e-02 1 1  ON 46
 eH2_7                 1.059969e-01 1 1  ON 47
 eH2_8                 1.046938e-01 1 1  ON 48
 eH2_9                 2.830322e-02 1 1  ON 49
ci_001                -4.234948e-02 3 1  ON 50
ci_002                -3.115783e-02 3 1  ON 51
ci_003                -2.574197e-02 3 1  ON 52
ci_004                 2.449598e-02 3 1  ON 53
ci_005                 2.459862e-02 3 1  ON 54
ci_006                -2.028753e-02 3 1  ON 55
ci_007                -2.042824e-02 3 1  ON 56
ci_008                -8.985172e-03 3 1  ON 57
ci_009                -1.503644e-02 3 1  ON 58
ci_010                -9.449574e-03 3 1  ON 59
ci_011                -1.021893e-02 3 1  ON 60
ci_012                -1.008502e-02 3 1  ON 61
ci_013                -1.953167e-02 3 1  ON 62
ci_014                 1.300135e-02 3 1  ON 63
ci_015                 1.321427e-02 3 1  ON 64
ci_016                 1.641245e-02 3 1  ON 65
ci_017                 1.617616e-02 3 1  ON 66
ci_018                 1.019288e-02 3 1  ON 67
ci_019                 1.038122e-02 3 1  ON 68
ci_020                 1.646457e-02 3 1  ON 69
ci_021                 1.644451e-02 3 1  ON 70
ci_022                 1.056977e-02 3 1  ON 71
ci_023                 9.300847e-03 3 1  ON 72
ci_024                 7.514751e-03 3 1  ON 73
ci_025                 6.085984e-03 3 1  ON 74
ci_026                 1.169045e-02 3 1  ON 75
ci_027                 1.166518e-02 3 1  ON 76
ci_028                -1.519572e-02 3 1  ON 77
ci_029                -1.537144e-02 3 1  ON 78
ci_030                -4.449403e-03 3 1  ON 79
ci_031                -4.861696e-03 3 1  ON 80
ci_032                -1.535385e-02 3 1  ON 81
ci_033                 6.942894e-03 3 1  ON 82
ci_034                 7.336576e-03 3 1  ON 83
ci_035                -4.585945e-03 3 1  ON 84
ci_036                -1.273171e-02 3 1  ON 85
ci_037                -1.278282e-02 3 1  ON 86
ci_038                 1.163850e-03 3 1  ON 87
ci_039                 1.336033e-03 3 1  ON 88
ci_040                -2.705284e-03 3 1  ON 89
ci_041                 8.457724e-03 3 1  ON 90
ci_042                 8.383918e-03 3 1  ON 91
ci_043                -3.617046e-03 3 1  ON 92
ci_044                -4.712123e-03 3 1  ON 93
ci_045                -2.791052e-03 3 1  ON 94
ci_046                 5.835224e-03 3 1  ON 95
ci_047                 5.643925e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.201299
====================================================
  Execution time = 2.7342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0466e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8923e-01
  Total weights = 1.966403750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2789e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278316927050
                                         uncertainty =       0.001637005488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278316927050
                                         uncertainty =       0.001637005488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373051840
  error estimate for blocks of size 2^( 2) =       0.000387236550
  error estimate for blocks of size 2^( 3) =       0.000400308510
  error estimate for blocks of size 2^( 4) =       0.000409501385
  error estimate for blocks of size 2^( 5) =       0.000415323376
  error estimate for blocks of size 2^( 6) =       0.000418568518
  error estimate for blocks of size 2^( 7) =       0.000422228933

      target function =      -0.929492490530
              le_mean =     -17.210118838563
             les_mean =     296.477416731348
             stat err =       0.000416405553
             autocorr =       1.245932893838
   target nu stat err =       0.000416405553
   target dn stat err =       0.003108326222
      target stat err =       0.005150356550
              std dev =       0.527583412905
             le_variance =       0.278344257572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721011883856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929519863268       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929528747936       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929529680912       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929530313948       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929530439272       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929530523604       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929530718303       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929530838877       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929530865210       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929530966633       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929530961810       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929530990721       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929531008959       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929531106168       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929531155540       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929531203540       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929531209386       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929531242640       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929531240820       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929531244054       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929531260284       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929531253220       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929531272242       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929531285725       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929531288379       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929531296103       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929531293380       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929531306260       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929531306496       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929531305875       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929531311125       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929531314155       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929531317874       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929531317240       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929531319611       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929531318076       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929531316672       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929531316167       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929531315111       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929531314637       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929531314920       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929531314567       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+00 is 7.147838e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929519863268       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929522105874       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929522340704       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929522500032       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929522531570       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929522552816       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929522601821       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929522632135       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929522638656       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929522664147       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929522662912       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929522670123       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929522674757       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929522699177       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929522711462       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929522723450       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929522724876       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929522733198       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929522732689       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929522733492       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929522737543       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929522735786       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929522740515       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929522743877       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929522744504       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929522746404       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929522745753       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929522748947       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929522748978       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929522748798       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929522750147       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929522750874       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929522751792       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929522751635       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929522752206       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929522751843       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929522751471       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929522751373       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929522751087       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929522750986       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929522751047       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929522750966       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+01 is 1.789094e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929519863268       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929520425275       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929520484083       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929520523982       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929520531880       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929520537202       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929520549474       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929520557063       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929520558689       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929520565070       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929520564760       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929520566561       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929520567725       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929520573837       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929520576905       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929520579901       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929520580255       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929520582336       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929520582206       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929520582406       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929520583418       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929520582979       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929520584160       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929520585000       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929520585155       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929520585628       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929520585467       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929520586263       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929520586270       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929520586223       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929520586562       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929520586742       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929520586971       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929520586932       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929520587073       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929520586984       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929520586890       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929520586867       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929520586794       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929520586770       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929520586785       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929520586764       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+01 is 4.474074e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.098067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5708e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.084872e-01 1 1  ON 0
  uu_1                 5.267457e-02 1 1  ON 1
  uu_2                -3.672152e-02 1 1  ON 2
  uu_3                -8.984683e-02 1 1  ON 3
  uu_4                -1.217573e-01 1 1  ON 4
  uu_5                -1.312698e-01 1 1  ON 5
  uu_6                -1.137590e-01 1 1  ON 6
  uu_7                -5.646743e-02 1 1  ON 7
  uu_8                 5.947812e-02 1 1  ON 8
  uu_9                 1.220867e-01 1 1  ON 9
  ud_0                 3.006692e-01 1 1  ON 10
  ud_1                 7.340063e-02 1 1  ON 11
  ud_2                -2.594662e-02 1 1  ON 12
  ud_3                -7.709191e-02 1 1  ON 13
  ud_4                -1.122865e-01 1 1  ON 14
  ud_5                -1.317605e-01 1 1  ON 15
  ud_6                -1.269169e-01 1 1  ON 16
  ud_7                -8.779184e-02 1 1  ON 17
  ud_8                -4.231876e-03 1 1  ON 18
  ud_9                 8.491405e-02 1 1  ON 19
  eO_0                -6.932104e-01 1 1  ON 20
  eO_1                -4.132320e-01 1 1  ON 21
  eO_2                -4.143765e-02 1 1  ON 22
  eO_3                 1.783485e-01 1 1  ON 23
  eO_4                 2.499581e-01 1 1  ON 24
  eO_5                 2.747991e-01 1 1  ON 25
  eO_6                 2.477577e-01 1 1  ON 26
  eO_7                 1.370919e-01 1 1  ON 27
  eO_8                 2.907921e-02 1 1  ON 28
  eO_9                 1.941133e-02 1 1  ON 29
 eH1_0                -2.054420e-01 1 1  ON 30
 eH1_1                -1.004997e-01 1 1  ON 31
 eH1_2                -4.947700e-02 1 1  ON 32
 eH1_3                -1.790751e-02 1 1  ON 33
 eH1_4                 1.722667e-02 1 1  ON 34
 eH1_5                 2.531847e-02 1 1  ON 35
 eH1_6                 7.901052e-02 1 1  ON 36
 eH1_7                 1.070326e-01 1 1  ON 37
 eH1_8                 1.027409e-01 1 1  ON 38
 eH1_9                 2.587978e-02 1 1  ON 39
 eH2_0                -2.016928e-01 1 1  ON 40
 eH2_1                -9.694553e-02 1 1  ON 41
 eH2_2                -4.656791e-02 1 1  ON 42
 eH2_3                -1.598340e-02 1 1  ON 43
 eH2_4                 1.732964e-02 1 1  ON 44
 eH2_5                 2.120640e-02 1 1  ON 45
 eH2_6                 7.058424e-02 1 1  ON 46
 eH2_7                 1.059965e-01 1 1  ON 47
 eH2_8                 1.046994e-01 1 1  ON 48
 eH2_9                 2.830402e-02 1 1  ON 49
ci_001                -4.234629e-02 3 1  ON 50
ci_002                -3.115812e-02 3 1  ON 51
ci_003                -2.574247e-02 3 1  ON 52
ci_004                 2.449879e-02 3 1  ON 53
ci_005                 2.459493e-02 3 1  ON 54
ci_006                -2.028810e-02 3 1  ON 55
ci_007                -2.042692e-02 3 1  ON 56
ci_008                -8.980294e-03 3 1  ON 57
ci_009                -1.503177e-02 3 1  ON 58
ci_010                -9.443107e-03 3 1  ON 59
ci_011                -1.022111e-02 3 1  ON 60
ci_012                -1.008535e-02 3 1  ON 61
ci_013                -1.952916e-02 3 1  ON 62
ci_014                 1.300176e-02 3 1  ON 63
ci_015                 1.321450e-02 3 1  ON 64
ci_016                 1.641288e-02 3 1  ON 65
ci_017                 1.617538e-02 3 1  ON 66
ci_018                 1.019381e-02 3 1  ON 67
ci_019                 1.037799e-02 3 1  ON 68
ci_020                 1.646329e-02 3 1  ON 69
ci_021                 1.644506e-02 3 1  ON 70
ci_022                 1.057015e-02 3 1  ON 71
ci_023                 9.304839e-03 3 1  ON 72
ci_024                 7.513049e-03 3 1  ON 73
ci_025                 6.089291e-03 3 1  ON 74
ci_026                 1.168861e-02 3 1  ON 75
ci_027                 1.166456e-02 3 1  ON 76
ci_028                -1.519696e-02 3 1  ON 77
ci_029                -1.537011e-02 3 1  ON 78
ci_030                -4.452423e-03 3 1  ON 79
ci_031                -4.863072e-03 3 1  ON 80
ci_032                -1.535381e-02 3 1  ON 81
ci_033                 6.943598e-03 3 1  ON 82
ci_034                 7.331206e-03 3 1  ON 83
ci_035                -4.586484e-03 3 1  ON 84
ci_036                -1.272903e-02 3 1  ON 85
ci_037                -1.277562e-02 3 1  ON 86
ci_038                 1.164780e-03 3 1  ON 87
ci_039                 1.337230e-03 3 1  ON 88
ci_040                -2.707066e-03 3 1  ON 89
ci_041                 8.457835e-03 3 1  ON 90
ci_042                 8.388515e-03 3 1  ON 91
ci_043                -3.617356e-03 3 1  ON 92
ci_044                -4.708121e-03 3 1  ON 93
ci_045                -2.791193e-03 3 1  ON 94
ci_046                 5.836811e-03 3 1  ON 95
ci_047                 5.643535e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1788
    reference variance = 0.250545
====================================================
  Execution time = 2.7301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8335e-01
  Total weights = 1.9663e+06
  Execution time = 2.3185e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274636697251
                                         uncertainty =       0.001379361127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274636697251
                                         uncertainty =       0.001379361127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370586224
  error estimate for blocks of size 2^( 2) =       0.000385069442
  error estimate for blocks of size 2^( 3) =       0.000398014656
  error estimate for blocks of size 2^( 4) =       0.000406732732
  error estimate for blocks of size 2^( 5) =       0.000412363816
  error estimate for blocks of size 2^( 6) =       0.000414223601
  error estimate for blocks of size 2^( 7) =       0.000416705487

      target function =      -0.939313985630
              le_mean =     -17.209900166516
             les_mean =     296.463976603720
             stat err =       0.000412506409
             autocorr =       1.239032959639
   target nu stat err =       0.000412506409
   target dn stat err =       0.001918318791
      target stat err =       0.003294585115
              std dev =       0.524096449379
             le_variance =       0.274677088252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274630676007
                                         uncertainty =       0.001378910129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274630676007
                                         uncertainty =       0.001378910129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370582147
  error estimate for blocks of size 2^( 2) =       0.000385068805
  error estimate for blocks of size 2^( 3) =       0.000398017678
  error estimate for blocks of size 2^( 4) =       0.000406738648
  error estimate for blocks of size 2^( 5) =       0.000412370823
  error estimate for blocks of size 2^( 6) =       0.000414231505
  error estimate for blocks of size 2^( 7) =       0.000416713814

      target function =      -0.938961362316
              le_mean =     -17.209899904559
             les_mean =     296.464177918014
             stat err =       0.000412513698
             autocorr =       1.239104005522
   target nu stat err =       0.000412513698
   target dn stat err =       0.001974141409
      target stat err =       0.003383268521
              std dev =       0.524090684043
             le_variance =       0.274671045101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274633631873
                                         uncertainty =       0.001379133075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274633631873
                                         uncertainty =       0.001379133075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370584149
  error estimate for blocks of size 2^( 2) =       0.000385069099
  error estimate for blocks of size 2^( 3) =       0.000398016156
  error estimate for blocks of size 2^( 4) =       0.000406735690
  error estimate for blocks of size 2^( 5) =       0.000412367320
  error estimate for blocks of size 2^( 6) =       0.000414227553
  error estimate for blocks of size 2^( 7) =       0.000416709654

      target function =      -0.939177105733
              le_mean =     -17.209900031423
             les_mean =     296.464053597581
             stat err =       0.000412510054
             autocorr =       1.239068734807
   target nu stat err =       0.000412510054
   target dn stat err =       0.001937736657
      target stat err =       0.003325336880
              std dev =       0.524093514390
             le_variance =       0.274674011825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274636310105
                                         uncertainty =       0.001379332496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274636310105
                                         uncertainty =       0.001379332496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370585962
  error estimate for blocks of size 2^( 2) =       0.000385069396
  error estimate for blocks of size 2^( 3) =       0.000398014841
  error estimate for blocks of size 2^( 4) =       0.000406733100
  error estimate for blocks of size 2^( 5) =       0.000412364253
  error estimate for blocks of size 2^( 6) =       0.000414224093
  error estimate for blocks of size 2^( 7) =       0.000416706006

      target function =      -0.939300280587
              le_mean =     -17.209900149193
             les_mean =     296.463984181834
             stat err =       0.000412506863
             autocorr =       1.239037438407
   target nu stat err =       0.000412506863
   target dn stat err =       0.001920150500
      target stat err =       0.003297480678
              std dev =       0.524096078714
             le_variance =       0.274676699723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939313985630        initial  <--
     6.1035e+00     6.1035e+01             7.1478e-05        -0.938961362316
     2.4414e+01     2.4414e+02             1.7891e-05        -0.939177105733
     9.7656e+01     9.7656e+02             4.4741e-06        -0.939300280587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9852
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.084880e-01 1 1  ON 0
  uu_1                 5.267388e-02 1 1  ON 1
  uu_2                -3.672451e-02 1 1  ON 2
  uu_3                -8.985105e-02 1 1  ON 3
  uu_4                -1.217628e-01 1 1  ON 4
  uu_5                -1.312731e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646672e-02 1 1  ON 7
  uu_8                 5.949602e-02 1 1  ON 8
  uu_9                 1.220880e-01 1 1  ON 9
  ud_0                 3.006752e-01 1 1  ON 10
  ud_1                 7.340587e-02 1 1  ON 11
  ud_2                -2.594211e-02 1 1  ON 12
  ud_3                -7.708944e-02 1 1  ON 13
  ud_4                -1.122874e-01 1 1  ON 14
  ud_5                -1.317629e-01 1 1  ON 15
  ud_6                -1.269179e-01 1 1  ON 16
  ud_7                -8.780307e-02 1 1  ON 17
  ud_8                -4.231251e-03 1 1  ON 18
  ud_9                 8.491630e-02 1 1  ON 19
  eO_0                -6.932072e-01 1 1  ON 20
  eO_1                -4.132234e-01 1 1  ON 21
  eO_2                -4.142455e-02 1 1  ON 22
  eO_3                 1.783607e-01 1 1  ON 23
  eO_4                 2.499518e-01 1 1  ON 24
  eO_5                 2.747834e-01 1 1  ON 25
  eO_6                 2.477559e-01 1 1  ON 26
  eO_7                 1.370817e-01 1 1  ON 27
  eO_8                 2.907735e-02 1 1  ON 28
  eO_9                 1.941095e-02 1 1  ON 29
 eH1_0                -2.054435e-01 1 1  ON 30
 eH1_1                -1.005097e-01 1 1  ON 31
 eH1_2                -4.948771e-02 1 1  ON 32
 eH1_3                -1.791387e-02 1 1  ON 33
 eH1_4                 1.722669e-02 1 1  ON 34
 eH1_5                 2.533208e-02 1 1  ON 35
 eH1_6                 7.902451e-02 1 1  ON 36
 eH1_7                 1.070417e-01 1 1  ON 37
 eH1_8                 1.027350e-01 1 1  ON 38
 eH1_9                 2.587789e-02 1 1  ON 39
 eH2_0                -2.016931e-01 1 1  ON 40
 eH2_1                -9.694615e-02 1 1  ON 41
 eH2_2                -4.657327e-02 1 1  ON 42
 eH2_3                -1.598726e-02 1 1  ON 43
 eH2_4                 1.733693e-02 1 1  ON 44
 eH2_5                 2.121389e-02 1 1  ON 45
 eH2_6                 7.058619e-02 1 1  ON 46
 eH2_7                 1.059969e-01 1 1  ON 47
 eH2_8                 1.046938e-01 1 1  ON 48
 eH2_9                 2.830322e-02 1 1  ON 49
ci_001                -4.234948e-02 3 1  ON 50
ci_002                -3.115783e-02 3 1  ON 51
ci_003                -2.574197e-02 3 1  ON 52
ci_004                 2.449598e-02 3 1  ON 53
ci_005                 2.459862e-02 3 1  ON 54
ci_006                -2.028753e-02 3 1  ON 55
ci_007                -2.042824e-02 3 1  ON 56
ci_008                -8.985172e-03 3 1  ON 57
ci_009                -1.503644e-02 3 1  ON 58
ci_010                -9.449574e-03 3 1  ON 59
ci_011                -1.021893e-02 3 1  ON 60
ci_012                -1.008502e-02 3 1  ON 61
ci_013                -1.953167e-02 3 1  ON 62
ci_014                 1.300135e-02 3 1  ON 63
ci_015                 1.321427e-02 3 1  ON 64
ci_016                 1.641245e-02 3 1  ON 65
ci_017                 1.617616e-02 3 1  ON 66
ci_018                 1.019288e-02 3 1  ON 67
ci_019                 1.038122e-02 3 1  ON 68
ci_020                 1.646457e-02 3 1  ON 69
ci_021                 1.644451e-02 3 1  ON 70
ci_022                 1.056977e-02 3 1  ON 71
ci_023                 9.300847e-03 3 1  ON 72
ci_024                 7.514751e-03 3 1  ON 73
ci_025                 6.085984e-03 3 1  ON 74
ci_026                 1.169045e-02 3 1  ON 75
ci_027                 1.166518e-02 3 1  ON 76
ci_028                -1.519572e-02 3 1  ON 77
ci_029                -1.537144e-02 3 1  ON 78
ci_030                -4.449403e-03 3 1  ON 79
ci_031                -4.861696e-03 3 1  ON 80
ci_032                -1.535385e-02 3 1  ON 81
ci_033                 6.942894e-03 3 1  ON 82
ci_034                 7.336576e-03 3 1  ON 83
ci_035                -4.585945e-03 3 1  ON 84
ci_036                -1.273171e-02 3 1  ON 85
ci_037                -1.278282e-02 3 1  ON 86
ci_038                 1.163850e-03 3 1  ON 87
ci_039                 1.336033e-03 3 1  ON 88
ci_040                -2.705284e-03 3 1  ON 89
ci_041                 8.457724e-03 3 1  ON 90
ci_042                 8.383918e-03 3 1  ON 91
ci_043                -3.617046e-03 3 1  ON 92
ci_044                -4.712123e-03 3 1  ON 93
ci_045                -2.791052e-03 3 1  ON 94
ci_046                 5.835224e-03 3 1  ON 95
ci_047                 5.643925e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2262
    reference variance = 0.115775
====================================================
  Execution time = 2.7028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0498e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8880e-01
  Total weights = 1.966435752e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2803e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278783933223
                                         uncertainty =       0.001832674703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278783933223
                                         uncertainty =       0.001832674703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373330628
  error estimate for blocks of size 2^( 2) =       0.000387349270
  error estimate for blocks of size 2^( 3) =       0.000400485240
  error estimate for blocks of size 2^( 4) =       0.000410057763
  error estimate for blocks of size 2^( 5) =       0.000415436242
  error estimate for blocks of size 2^( 6) =       0.000418972905
  error estimate for blocks of size 2^( 7) =       0.000421674434

      target function =      -0.930196112888
              le_mean =     -17.210062394507
             les_mean =     296.475049836562
             stat err =       0.000416535336
             autocorr =       1.244848378037
   target nu stat err =       0.000416535336
   target dn stat err =       0.002771182094
      target stat err =       0.004610166318
              std dev =       0.527977684994
             le_variance =       0.278760435852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721006239451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930217878516       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930218236534       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930218315799       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930218344423       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930218351315       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930218355070       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930218357420       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930218359205       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930218356737       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930218356470       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930218355515       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930218356421       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930218354945       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930218356346       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930218358936       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930218362782       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930218363261       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930218364213       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930218364867       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930218364912       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930218365268       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930218364383       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930218365524       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930218366744       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930218367156       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930218366883       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930218366739       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930218366231       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930218366230       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930218366240       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930218366225       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930218366227       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930218366287       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930218366215       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930218366345       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930218366472       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930218366482       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930218366554       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930218366445       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930218366476       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+01 is 5.859193e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930217878516       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930217968107       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930217987938       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930217995099       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930217996824       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930217997763       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930217998351       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930217998798       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930217998179       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930217998113       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930217997874       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930217998101       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930217997731       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930217998081       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930217998730       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930217999692       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930217999812       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930218000049       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930218000212       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930218000223       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930218000312       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930218000091       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930218000376       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930218000682       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930218000784       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930218000717       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930218000680       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930218000553       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930218000552       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930218000555       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930218000552       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930218000551       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930218000569       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930218000549       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930218000582       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930218000614       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930218000615       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930218000635       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930218000607       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930218000614       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+02 is 1.465047e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930217878516       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930217900919       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930217905878       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930217907668       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930217908100       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930217908335       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930217908481       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930217908593       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930217908440       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930217908422       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930217908360       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930217908418       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930217908323       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930217908413       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930217908577       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930217908815       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930217908846       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930217908904       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930217908946       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930217908950       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930217908973       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930217908916       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930217908991       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930217909063       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930217909090       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930217909075       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930217909064       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930217909032       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930217909031       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930217909030       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930217909033       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930217909029       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930217909033       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930217909033       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930217909038       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930217909044       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930217909048       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930217909050       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930217909044       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930217909045       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.7656e+02 is 3.662773e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.167826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5385e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.084883e-01 1 1  ON 0
  uu_1                 5.267385e-02 1 1  ON 1
  uu_2                -3.672456e-02 1 1  ON 2
  uu_3                -8.985108e-02 1 1  ON 3
  uu_4                -1.217628e-01 1 1  ON 4
  uu_5                -1.312729e-01 1 1  ON 5
  uu_6                -1.137551e-01 1 1  ON 6
  uu_7                -5.646632e-02 1 1  ON 7
  uu_8                 5.949455e-02 1 1  ON 8
  uu_9                 1.220879e-01 1 1  ON 9
  ud_0                 3.006749e-01 1 1  ON 10
  ud_1                 7.340561e-02 1 1  ON 11
  ud_2                -2.594232e-02 1 1  ON 12
  ud_3                -7.708968e-02 1 1  ON 13
  ud_4                -1.122875e-01 1 1  ON 14
  ud_5                -1.317628e-01 1 1  ON 15
  ud_6                -1.269169e-01 1 1  ON 16
  ud_7                -8.780277e-02 1 1  ON 17
  ud_8                -4.231476e-03 1 1  ON 18
  ud_9                 8.491595e-02 1 1  ON 19
  eO_0                -6.932071e-01 1 1  ON 20
  eO_1                -4.132233e-01 1 1  ON 21
  eO_2                -4.142453e-02 1 1  ON 22
  eO_3                 1.783610e-01 1 1  ON 23
  eO_4                 2.499513e-01 1 1  ON 24
  eO_5                 2.747823e-01 1 1  ON 25
  eO_6                 2.477559e-01 1 1  ON 26
  eO_7                 1.370825e-01 1 1  ON 27
  eO_8                 2.907745e-02 1 1  ON 28
  eO_9                 1.941096e-02 1 1  ON 29
 eH1_0                -2.054432e-01 1 1  ON 30
 eH1_1                -1.005093e-01 1 1  ON 31
 eH1_2                -4.948723e-02 1 1  ON 32
 eH1_3                -1.791371e-02 1 1  ON 33
 eH1_4                 1.722642e-02 1 1  ON 34
 eH1_5                 2.533160e-02 1 1  ON 35
 eH1_6                 7.902356e-02 1 1  ON 36
 eH1_7                 1.070414e-01 1 1  ON 37
 eH1_8                 1.027355e-01 1 1  ON 38
 eH1_9                 2.587801e-02 1 1  ON 39
 eH2_0                -2.016932e-01 1 1  ON 40
 eH2_1                -9.694600e-02 1 1  ON 41
 eH2_2                -4.657305e-02 1 1  ON 42
 eH2_3                -1.598732e-02 1 1  ON 43
 eH2_4                 1.733661e-02 1 1  ON 44
 eH2_5                 2.121389e-02 1 1  ON 45
 eH2_6                 7.058662e-02 1 1  ON 46
 eH2_7                 1.059963e-01 1 1  ON 47
 eH2_8                 1.046940e-01 1 1  ON 48
 eH2_9                 2.830322e-02 1 1  ON 49
ci_001                -4.234926e-02 3 1  ON 50
ci_002                -3.115780e-02 3 1  ON 51
ci_003                -2.574158e-02 3 1  ON 52
ci_004                 2.449591e-02 3 1  ON 53
ci_005                 2.459875e-02 3 1  ON 54
ci_006                -2.028785e-02 3 1  ON 55
ci_007                -2.042824e-02 3 1  ON 56
ci_008                -8.985416e-03 3 1  ON 57
ci_009                -1.503631e-02 3 1  ON 58
ci_010                -9.449701e-03 3 1  ON 59
ci_011                -1.021851e-02 3 1  ON 60
ci_012                -1.008510e-02 3 1  ON 61
ci_013                -1.953169e-02 3 1  ON 62
ci_014                 1.300153e-02 3 1  ON 63
ci_015                 1.321436e-02 3 1  ON 64
ci_016                 1.641236e-02 3 1  ON 65
ci_017                 1.617597e-02 3 1  ON 66
ci_018                 1.019265e-02 3 1  ON 67
ci_019                 1.038128e-02 3 1  ON 68
ci_020                 1.646465e-02 3 1  ON 69
ci_021                 1.644452e-02 3 1  ON 70
ci_022                 1.056986e-02 3 1  ON 71
ci_023                 9.301090e-03 3 1  ON 72
ci_024                 7.514470e-03 3 1  ON 73
ci_025                 6.086062e-03 3 1  ON 74
ci_026                 1.169035e-02 3 1  ON 75
ci_027                 1.166524e-02 3 1  ON 76
ci_028                -1.519563e-02 3 1  ON 77
ci_029                -1.537159e-02 3 1  ON 78
ci_030                -4.449395e-03 3 1  ON 79
ci_031                -4.861647e-03 3 1  ON 80
ci_032                -1.535425e-02 3 1  ON 81
ci_033                 6.942621e-03 3 1  ON 82
ci_034                 7.336596e-03 3 1  ON 83
ci_035                -4.586004e-03 3 1  ON 84
ci_036                -1.273185e-02 3 1  ON 85
ci_037                -1.278252e-02 3 1  ON 86
ci_038                 1.163872e-03 3 1  ON 87
ci_039                 1.335931e-03 3 1  ON 88
ci_040                -2.705197e-03 3 1  ON 89
ci_041                 8.457649e-03 3 1  ON 90
ci_042                 8.383584e-03 3 1  ON 91
ci_043                -3.617160e-03 3 1  ON 92
ci_044                -4.712033e-03 3 1  ON 93
ci_045                -2.790913e-03 3 1  ON 94
ci_046                 5.835214e-03 3 1  ON 95
ci_047                 5.644109e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1769
    reference variance = 0.239561
====================================================
  Execution time = 2.7347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8724e-01
  Total weights = 1.9664e+06
  Execution time = 2.3081e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278568926623
                                         uncertainty =       0.001822037062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278568926623
                                         uncertainty =       0.001822037062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373203016
  error estimate for blocks of size 2^( 2) =       0.000387022200
  error estimate for blocks of size 2^( 3) =       0.000400194047
  error estimate for blocks of size 2^( 4) =       0.000410168617
  error estimate for blocks of size 2^( 5) =       0.000415193243
  error estimate for blocks of size 2^( 6) =       0.000416909039
  error estimate for blocks of size 2^( 7) =       0.000418792397

      target function =      -0.932796338465
              le_mean =     -17.209036387771
             les_mean =     296.438177506209
             stat err =       0.000415265824
             autocorr =       1.238118154115
   target nu stat err =       0.000415265824
   target dn stat err =       0.002439580863
      target stat err =       0.004087523125
              std dev =       0.527797211295
             le_variance =       0.278569896250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278569214843
                                         uncertainty =       0.001822043078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278569214843
                                         uncertainty =       0.001822043078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373203209
  error estimate for blocks of size 2^( 2) =       0.000387022512
  error estimate for blocks of size 2^( 3) =       0.000400194466
  error estimate for blocks of size 2^( 4) =       0.000410169105
  error estimate for blocks of size 2^( 5) =       0.000415193726
  error estimate for blocks of size 2^( 6) =       0.000416909555
  error estimate for blocks of size 2^( 7) =       0.000418792935

      target function =      -0.932802971819
              le_mean =     -17.209036376065
             les_mean =     296.438173079066
             stat err =       0.000415266330
             autocorr =       1.238119890324
   target nu stat err =       0.000415266330
   target dn stat err =       0.002439571880
      target stat err =       0.004087565827
              std dev =       0.527797484469
             le_variance =       0.278570184612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278569070775
                                         uncertainty =       0.001822040073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278569070775
                                         uncertainty =       0.001822040073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373203113
  error estimate for blocks of size 2^( 2) =       0.000387022356
  error estimate for blocks of size 2^( 3) =       0.000400194257
  error estimate for blocks of size 2^( 4) =       0.000410168861
  error estimate for blocks of size 2^( 5) =       0.000415193484
  error estimate for blocks of size 2^( 6) =       0.000416909297
  error estimate for blocks of size 2^( 7) =       0.000418792666

      target function =      -0.932799995542
              le_mean =     -17.209036381900
             les_mean =     296.438175085511
             stat err =       0.000415266077
             autocorr =       1.238119022879
   target nu stat err =       0.000415266077
   target dn stat err =       0.002439574102
      target stat err =       0.004087543731
              std dev =       0.527797347922
             le_variance =       0.278570040474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278568944634
                                         uncertainty =       0.001822037439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278568944634
                                         uncertainty =       0.001822037439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373203028
  error estimate for blocks of size 2^( 2) =       0.000387022219
  error estimate for blocks of size 2^( 3) =       0.000400194073
  error estimate for blocks of size 2^( 4) =       0.000410168648
  error estimate for blocks of size 2^( 5) =       0.000415193273
  error estimate for blocks of size 2^( 6) =       0.000416909071
  error estimate for blocks of size 2^( 7) =       0.000418792430

      target function =      -0.932796838334
              le_mean =     -17.209036387035
             les_mean =     296.438177177642
             stat err =       0.000415265856
             autocorr =       1.238118262728
   target nu stat err =       0.000415265856
   target dn stat err =       0.002439579710
      target stat err =       0.004087525570
              std dev =       0.527797228365
             le_variance =       0.278569914269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932796338465        initial
     6.1035e+01     6.1035e+02             5.8592e-06        -0.932802971819  <--
     2.4414e+02     2.4414e+03             1.4650e-06        -0.932799995542
     9.7656e+02     9.7656e+03             3.6628e-07        -0.932796838334

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 3.8979e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.084893e-01 1 1  ON 0
  uu_1                 5.267376e-02 1 1  ON 1
  uu_2                -3.672470e-02 1 1  ON 2
  uu_3                -8.985118e-02 1 1  ON 3
  uu_4                -1.217627e-01 1 1  ON 4
  uu_5                -1.312721e-01 1 1  ON 5
  uu_6                -1.137546e-01 1 1  ON 6
  uu_7                -5.646514e-02 1 1  ON 7
  uu_8                 5.949016e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006737e-01 1 1  ON 10
  ud_1                 7.340484e-02 1 1  ON 11
  ud_2                -2.594296e-02 1 1  ON 12
  ud_3                -7.709040e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317626e-01 1 1  ON 15
  ud_6                -1.269140e-01 1 1  ON 16
  ud_7                -8.780187e-02 1 1  ON 17
  ud_8                -4.232154e-03 1 1  ON 18
  ud_9                 8.491492e-02 1 1  ON 19
  eO_0                -6.932068e-01 1 1  ON 20
  eO_1                -4.132231e-01 1 1  ON 21
  eO_2                -4.142447e-02 1 1  ON 22
  eO_3                 1.783621e-01 1 1  ON 23
  eO_4                 2.499497e-01 1 1  ON 24
  eO_5                 2.747792e-01 1 1  ON 25
  eO_6                 2.477558e-01 1 1  ON 26
  eO_7                 1.370851e-01 1 1  ON 27
  eO_8                 2.907775e-02 1 1  ON 28
  eO_9                 1.941100e-02 1 1  ON 29
 eH1_0                -2.054424e-01 1 1  ON 30
 eH1_1                -1.005081e-01 1 1  ON 31
 eH1_2                -4.948580e-02 1 1  ON 32
 eH1_3                -1.791324e-02 1 1  ON 33
 eH1_4                 1.722560e-02 1 1  ON 34
 eH1_5                 2.533016e-02 1 1  ON 35
 eH1_6                 7.902070e-02 1 1  ON 36
 eH1_7                 1.070407e-01 1 1  ON 37
 eH1_8                 1.027369e-01 1 1  ON 38
 eH1_9                 2.587837e-02 1 1  ON 39
 eH2_0                -2.016932e-01 1 1  ON 40
 eH2_1                -9.694558e-02 1 1  ON 41
 eH2_2                -4.657242e-02 1 1  ON 42
 eH2_3                -1.598750e-02 1 1  ON 43
 eH2_4                 1.733564e-02 1 1  ON 44
 eH2_5                 2.121389e-02 1 1  ON 45
 eH2_6                 7.058790e-02 1 1  ON 46
 eH2_7                 1.059943e-01 1 1  ON 47
 eH2_8                 1.046949e-01 1 1  ON 48
 eH2_9                 2.830322e-02 1 1  ON 49
ci_001                -4.234858e-02 3 1  ON 50
ci_002                -3.115769e-02 3 1  ON 51
ci_003                -2.574043e-02 3 1  ON 52
ci_004                 2.449567e-02 3 1  ON 53
ci_005                 2.459914e-02 3 1  ON 54
ci_006                -2.028880e-02 3 1  ON 55
ci_007                -2.042824e-02 3 1  ON 56
ci_008                -8.986146e-03 3 1  ON 57
ci_009                -1.503592e-02 3 1  ON 58
ci_010                -9.450082e-03 3 1  ON 59
ci_011                -1.021725e-02 3 1  ON 60
ci_012                -1.008534e-02 3 1  ON 61
ci_013                -1.953175e-02 3 1  ON 62
ci_014                 1.300207e-02 3 1  ON 63
ci_015                 1.321466e-02 3 1  ON 64
ci_016                 1.641209e-02 3 1  ON 65
ci_017                 1.617539e-02 3 1  ON 66
ci_018                 1.019195e-02 3 1  ON 67
ci_019                 1.038146e-02 3 1  ON 68
ci_020                 1.646489e-02 3 1  ON 69
ci_021                 1.644455e-02 3 1  ON 70
ci_022                 1.057012e-02 3 1  ON 71
ci_023                 9.301816e-03 3 1  ON 72
ci_024                 7.513625e-03 3 1  ON 73
ci_025                 6.086296e-03 3 1  ON 74
ci_026                 1.169004e-02 3 1  ON 75
ci_027                 1.166540e-02 3 1  ON 76
ci_028                -1.519534e-02 3 1  ON 77
ci_029                -1.537202e-02 3 1  ON 78
ci_030                -4.449372e-03 3 1  ON 79
ci_031                -4.861499e-03 3 1  ON 80
ci_032                -1.535544e-02 3 1  ON 81
ci_033                 6.941803e-03 3 1  ON 82
ci_034                 7.336654e-03 3 1  ON 83
ci_035                -4.586183e-03 3 1  ON 84
ci_036                -1.273227e-02 3 1  ON 85
ci_037                -1.278163e-02 3 1  ON 86
ci_038                 1.163939e-03 3 1  ON 87
ci_039                 1.335625e-03 3 1  ON 88
ci_040                -2.704938e-03 3 1  ON 89
ci_041                 8.457426e-03 3 1  ON 90
ci_042                 8.382582e-03 3 1  ON 91
ci_043                -3.617504e-03 3 1  ON 92
ci_044                -4.711761e-03 3 1  ON 93
ci_045                -2.790498e-03 3 1  ON 94
ci_046                 5.835184e-03 3 1  ON 95
ci_047                 5.644663e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4374e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.184
    reference variance = 0.126982
====================================================
  Execution time = 2.7319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8601e-01
  Total weights = 1.966192001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2003e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276574721003
                                         uncertainty =       0.001671594378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276574721003
                                         uncertainty =       0.001671594378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371853207
  error estimate for blocks of size 2^( 2) =       0.000385900606
  error estimate for blocks of size 2^( 3) =       0.000398817147
  error estimate for blocks of size 2^( 4) =       0.000408891663
  error estimate for blocks of size 2^( 5) =       0.000415114740
  error estimate for blocks of size 2^( 6) =       0.000418031222
  error estimate for blocks of size 2^( 7) =       0.000419530155

      target function =      -0.934834723775
              le_mean =     -17.209194393347
             les_mean =     296.442380438825
             stat err =       0.000415391945
             autocorr =       1.247880732884
   target nu stat err =       0.000415391945
   target dn stat err =       0.002333251814
      target stat err =       0.003933278808
              std dev =       0.525888262358
             le_variance =       0.276558464486


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720919439335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934850129618       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934852430563       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934852980881       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934853113301       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934853166795       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934853203456       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934853210544       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934853246118       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934853256155       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934853266523       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934853263798       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934853279005       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934853273280       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934853281886       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934853299454       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934853310697       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934853308834       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934853312778       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934853312129       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934853316133       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934853314934       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934853316698       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934853323668       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934853323854       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934853322235       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934853321247       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934853324575       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934853324475       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934853325908       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934853324602       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934853324110       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934853324036       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934853326104       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934853325267       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934853328183       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934853329216       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934853328968       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934853329286       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934853329063       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934853328512       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934853328095       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+01 is 2.387653e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934850129618       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934850707057       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934850845067       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934850878270       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934850891703       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934850900876       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934850902661       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934850911585       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934850914095       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934850916692       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934850916006       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934850919824       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934850918392       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934850920546       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934850924945       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934850927754       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934850927283       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934850928265       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934850928098       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934850929100       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934850928804       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934850929248       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934850930987       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934850931026       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934850930623       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934850930375       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934850931207       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934850931184       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934850931538       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934850931212       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934850931091       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934850931073       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934850931587       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934850931383       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934850932108       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934850932363       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934850932300       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934850932380       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934850932324       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934850932185       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934850932083       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+01 is 5.979846e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934850129618       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934850274116       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934850308646       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934850316953       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934850320315       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934850322608       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934850323056       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934850325288       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934850325916       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934850326566       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934850326394       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934850327349       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934850326990       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934850327529       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934850328630       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934850329332       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934850329214       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934850329459       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934850329417       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934850329668       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934850329595       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934850329705       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934850330140       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934850330149       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934850330048       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934850329986       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934850330194       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934850330188       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934850330278       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934850330196       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934850330165       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934850330161       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934850330289       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934850330238       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934850330421       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934850330483       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934850330468       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934850330487       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934850330474       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934850330439       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934850330413       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+02 is 1.495633e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.243008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5601e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.084913e-01 1 1  ON 0
  uu_1                 5.267506e-02 1 1  ON 1
  uu_2                -3.672367e-02 1 1  ON 2
  uu_3                -8.985090e-02 1 1  ON 3
  uu_4                -1.217627e-01 1 1  ON 4
  uu_5                -1.312722e-01 1 1  ON 5
  uu_6                -1.137556e-01 1 1  ON 6
  uu_7                -5.646531e-02 1 1  ON 7
  uu_8                 5.948455e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006706e-01 1 1  ON 10
  ud_1                 7.340182e-02 1 1  ON 11
  ud_2                -2.594463e-02 1 1  ON 12
  ud_3                -7.709105e-02 1 1  ON 13
  ud_4                -1.122881e-01 1 1  ON 14
  ud_5                -1.317625e-01 1 1  ON 15
  ud_6                -1.269122e-01 1 1  ON 16
  ud_7                -8.779589e-02 1 1  ON 17
  ud_8                -4.233709e-03 1 1  ON 18
  ud_9                 8.491526e-02 1 1  ON 19
  eO_0                -6.932060e-01 1 1  ON 20
  eO_1                -4.132231e-01 1 1  ON 21
  eO_2                -4.142464e-02 1 1  ON 22
  eO_3                 1.783618e-01 1 1  ON 23
  eO_4                 2.499476e-01 1 1  ON 24
  eO_5                 2.747758e-01 1 1  ON 25
  eO_6                 2.477560e-01 1 1  ON 26
  eO_7                 1.370895e-01 1 1  ON 27
  eO_8                 2.907804e-02 1 1  ON 28
  eO_9                 1.941134e-02 1 1  ON 29
 eH1_0                -2.054423e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948457e-02 1 1  ON 32
 eH1_3                -1.791277e-02 1 1  ON 33
 eH1_4                 1.722411e-02 1 1  ON 34
 eH1_5                 2.532843e-02 1 1  ON 35
 eH1_6                 7.901996e-02 1 1  ON 36
 eH1_7                 1.070400e-01 1 1  ON 37
 eH1_8                 1.027380e-01 1 1  ON 38
 eH1_9                 2.587861e-02 1 1  ON 39
 eH2_0                -2.016946e-01 1 1  ON 40
 eH2_1                -9.694471e-02 1 1  ON 41
 eH2_2                -4.657267e-02 1 1  ON 42
 eH2_3                -1.598717e-02 1 1  ON 43
 eH2_4                 1.733634e-02 1 1  ON 44
 eH2_5                 2.121446e-02 1 1  ON 45
 eH2_6                 7.058435e-02 1 1  ON 46
 eH2_7                 1.059937e-01 1 1  ON 47
 eH2_8                 1.046973e-01 1 1  ON 48
 eH2_9                 2.830393e-02 1 1  ON 49
ci_001                -4.234911e-02 3 1  ON 50
ci_002                -3.115673e-02 3 1  ON 51
ci_003                -2.573995e-02 3 1  ON 52
ci_004                 2.449540e-02 3 1  ON 53
ci_005                 2.459937e-02 3 1  ON 54
ci_006                -2.028899e-02 3 1  ON 55
ci_007                -2.042791e-02 3 1  ON 56
ci_008                -8.986825e-03 3 1  ON 57
ci_009                -1.503601e-02 3 1  ON 58
ci_010                -9.448369e-03 3 1  ON 59
ci_011                -1.021578e-02 3 1  ON 60
ci_012                -1.008565e-02 3 1  ON 61
ci_013                -1.953240e-02 3 1  ON 62
ci_014                 1.300073e-02 3 1  ON 63
ci_015                 1.321564e-02 3 1  ON 64
ci_016                 1.641110e-02 3 1  ON 65
ci_017                 1.617595e-02 3 1  ON 66
ci_018                 1.019042e-02 3 1  ON 67
ci_019                 1.038021e-02 3 1  ON 68
ci_020                 1.646565e-02 3 1  ON 69
ci_021                 1.644615e-02 3 1  ON 70
ci_022                 1.057237e-02 3 1  ON 71
ci_023                 9.303307e-03 3 1  ON 72
ci_024                 7.512504e-03 3 1  ON 73
ci_025                 6.087168e-03 3 1  ON 74
ci_026                 1.168887e-02 3 1  ON 75
ci_027                 1.166537e-02 3 1  ON 76
ci_028                -1.519484e-02 3 1  ON 77
ci_029                -1.537312e-02 3 1  ON 78
ci_030                -4.448726e-03 3 1  ON 79
ci_031                -4.861490e-03 3 1  ON 80
ci_032                -1.535492e-02 3 1  ON 81
ci_033                 6.941539e-03 3 1  ON 82
ci_034                 7.337373e-03 3 1  ON 83
ci_035                -4.586571e-03 3 1  ON 84
ci_036                -1.273272e-02 3 1  ON 85
ci_037                -1.278104e-02 3 1  ON 86
ci_038                 1.164012e-03 3 1  ON 87
ci_039                 1.335311e-03 3 1  ON 88
ci_040                -2.705917e-03 3 1  ON 89
ci_041                 8.457865e-03 3 1  ON 90
ci_042                 8.383020e-03 3 1  ON 91
ci_043                -3.617587e-03 3 1  ON 92
ci_044                -4.708513e-03 3 1  ON 93
ci_045                -2.790408e-03 3 1  ON 94
ci_046                 5.834334e-03 3 1  ON 95
ci_047                 5.644875e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.276
    reference variance = 0.133772
====================================================
  Execution time = 2.9494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8736e-01
  Total weights = 1.9665e+06
  Execution time = 2.3014e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652748124
                                         uncertainty =       0.001634188856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652748124
                                         uncertainty =       0.001634188856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372617043
  error estimate for blocks of size 2^( 2) =       0.000387137954
  error estimate for blocks of size 2^( 3) =       0.000400327384
  error estimate for blocks of size 2^( 4) =       0.000410030635
  error estimate for blocks of size 2^( 5) =       0.000415533271
  error estimate for blocks of size 2^( 6) =       0.000417802250
  error estimate for blocks of size 2^( 7) =       0.000418052162

      target function =      -0.932583002089
              le_mean =     -17.209727221428
             les_mean =     296.462073456230
             stat err =       0.000415354579
             autocorr =       1.242546289790
   target nu stat err =       0.000415354579
   target dn stat err =       0.002341810572
      target stat err =       0.003932499499
              std dev =       0.526968506422
             le_variance =       0.277695806761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652878121
                                         uncertainty =       0.001634205774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652878121
                                         uncertainty =       0.001634205774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372617132
  error estimate for blocks of size 2^( 2) =       0.000387138622
  error estimate for blocks of size 2^( 3) =       0.000400328768
  error estimate for blocks of size 2^( 4) =       0.000410032601
  error estimate for blocks of size 2^( 5) =       0.000415535173
  error estimate for blocks of size 2^( 6) =       0.000417804107
  error estimate for blocks of size 2^( 7) =       0.000418054334

      target function =      -0.932571248966
              le_mean =     -17.209727137734
             les_mean =     296.462077699711
             stat err =       0.000415356554
             autocorr =       1.242557509007
   target nu stat err =       0.000415356554
   target dn stat err =       0.002342060790
      target stat err =       0.003932807652
              std dev =       0.526968632543
             le_variance =       0.277695939684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652810140
                                         uncertainty =       0.001634197241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652810140
                                         uncertainty =       0.001634197241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372617085
  error estimate for blocks of size 2^( 2) =       0.000387138287
  error estimate for blocks of size 2^( 3) =       0.000400328076
  error estimate for blocks of size 2^( 4) =       0.000410031619
  error estimate for blocks of size 2^( 5) =       0.000415534223
  error estimate for blocks of size 2^( 6) =       0.000417803179
  error estimate for blocks of size 2^( 7) =       0.000418053250

      target function =      -0.932577420466
              le_mean =     -17.209727178857
             les_mean =     296.462075374301
             stat err =       0.000415355568
             autocorr =       1.242551919704
   target nu stat err =       0.000415355568
   target dn stat err =       0.002341927829
      target stat err =       0.003932643292
              std dev =       0.526968566663
             le_variance =       0.277695870251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652755477
                                         uncertainty =       0.001634189893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277652755477
                                         uncertainty =       0.001634189893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372617048
  error estimate for blocks of size 2^( 2) =       0.000387137996
  error estimate for blocks of size 2^( 3) =       0.000400327470
  error estimate for blocks of size 2^( 4) =       0.000410030758
  error estimate for blocks of size 2^( 5) =       0.000415533390
  error estimate for blocks of size 2^( 6) =       0.000417802366
  error estimate for blocks of size 2^( 7) =       0.000418052298

      target function =      -0.932582337833
              le_mean =     -17.209727216040
             les_mean =     296.462073673438
             stat err =       0.000415354703
             autocorr =       1.242546994288
   target nu stat err =       0.000415354703
   target dn stat err =       0.002341824364
      target stat err =       0.003932516347
              std dev =       0.526968513573
             le_variance =       0.277695814298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932583002089        initial  <--
     1.5259e+01     1.5259e+02             2.3877e-05        -0.932571248966
     6.1035e+01     6.1035e+02             5.9798e-06        -0.932577420466
     2.4414e+02     2.4414e+03             1.4956e-06        -0.932582337833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1411
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.084893e-01 1 1  ON 0
  uu_1                 5.267376e-02 1 1  ON 1
  uu_2                -3.672470e-02 1 1  ON 2
  uu_3                -8.985118e-02 1 1  ON 3
  uu_4                -1.217627e-01 1 1  ON 4
  uu_5                -1.312721e-01 1 1  ON 5
  uu_6                -1.137546e-01 1 1  ON 6
  uu_7                -5.646514e-02 1 1  ON 7
  uu_8                 5.949016e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006737e-01 1 1  ON 10
  ud_1                 7.340484e-02 1 1  ON 11
  ud_2                -2.594296e-02 1 1  ON 12
  ud_3                -7.709040e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317626e-01 1 1  ON 15
  ud_6                -1.269140e-01 1 1  ON 16
  ud_7                -8.780187e-02 1 1  ON 17
  ud_8                -4.232154e-03 1 1  ON 18
  ud_9                 8.491492e-02 1 1  ON 19
  eO_0                -6.932068e-01 1 1  ON 20
  eO_1                -4.132231e-01 1 1  ON 21
  eO_2                -4.142447e-02 1 1  ON 22
  eO_3                 1.783621e-01 1 1  ON 23
  eO_4                 2.499497e-01 1 1  ON 24
  eO_5                 2.747792e-01 1 1  ON 25
  eO_6                 2.477558e-01 1 1  ON 26
  eO_7                 1.370851e-01 1 1  ON 27
  eO_8                 2.907775e-02 1 1  ON 28
  eO_9                 1.941100e-02 1 1  ON 29
 eH1_0                -2.054424e-01 1 1  ON 30
 eH1_1                -1.005081e-01 1 1  ON 31
 eH1_2                -4.948580e-02 1 1  ON 32
 eH1_3                -1.791324e-02 1 1  ON 33
 eH1_4                 1.722560e-02 1 1  ON 34
 eH1_5                 2.533016e-02 1 1  ON 35
 eH1_6                 7.902070e-02 1 1  ON 36
 eH1_7                 1.070407e-01 1 1  ON 37
 eH1_8                 1.027369e-01 1 1  ON 38
 eH1_9                 2.587837e-02 1 1  ON 39
 eH2_0                -2.016932e-01 1 1  ON 40
 eH2_1                -9.694558e-02 1 1  ON 41
 eH2_2                -4.657242e-02 1 1  ON 42
 eH2_3                -1.598750e-02 1 1  ON 43
 eH2_4                 1.733564e-02 1 1  ON 44
 eH2_5                 2.121389e-02 1 1  ON 45
 eH2_6                 7.058790e-02 1 1  ON 46
 eH2_7                 1.059943e-01 1 1  ON 47
 eH2_8                 1.046949e-01 1 1  ON 48
 eH2_9                 2.830322e-02 1 1  ON 49
ci_001                -4.234858e-02 3 1  ON 50
ci_002                -3.115769e-02 3 1  ON 51
ci_003                -2.574043e-02 3 1  ON 52
ci_004                 2.449567e-02 3 1  ON 53
ci_005                 2.459914e-02 3 1  ON 54
ci_006                -2.028880e-02 3 1  ON 55
ci_007                -2.042824e-02 3 1  ON 56
ci_008                -8.986146e-03 3 1  ON 57
ci_009                -1.503592e-02 3 1  ON 58
ci_010                -9.450082e-03 3 1  ON 59
ci_011                -1.021725e-02 3 1  ON 60
ci_012                -1.008534e-02 3 1  ON 61
ci_013                -1.953175e-02 3 1  ON 62
ci_014                 1.300207e-02 3 1  ON 63
ci_015                 1.321466e-02 3 1  ON 64
ci_016                 1.641209e-02 3 1  ON 65
ci_017                 1.617539e-02 3 1  ON 66
ci_018                 1.019195e-02 3 1  ON 67
ci_019                 1.038146e-02 3 1  ON 68
ci_020                 1.646489e-02 3 1  ON 69
ci_021                 1.644455e-02 3 1  ON 70
ci_022                 1.057012e-02 3 1  ON 71
ci_023                 9.301816e-03 3 1  ON 72
ci_024                 7.513625e-03 3 1  ON 73
ci_025                 6.086296e-03 3 1  ON 74
ci_026                 1.169004e-02 3 1  ON 75
ci_027                 1.166540e-02 3 1  ON 76
ci_028                -1.519534e-02 3 1  ON 77
ci_029                -1.537202e-02 3 1  ON 78
ci_030                -4.449372e-03 3 1  ON 79
ci_031                -4.861499e-03 3 1  ON 80
ci_032                -1.535544e-02 3 1  ON 81
ci_033                 6.941803e-03 3 1  ON 82
ci_034                 7.336654e-03 3 1  ON 83
ci_035                -4.586183e-03 3 1  ON 84
ci_036                -1.273227e-02 3 1  ON 85
ci_037                -1.278163e-02 3 1  ON 86
ci_038                 1.163939e-03 3 1  ON 87
ci_039                 1.335625e-03 3 1  ON 88
ci_040                -2.704938e-03 3 1  ON 89
ci_041                 8.457426e-03 3 1  ON 90
ci_042                 8.382582e-03 3 1  ON 91
ci_043                -3.617504e-03 3 1  ON 92
ci_044                -4.711761e-03 3 1  ON 93
ci_045                -2.790498e-03 3 1  ON 94
ci_046                 5.835184e-03 3 1  ON 95
ci_047                 5.644663e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2504
    reference variance = 0.222733
====================================================
  Execution time = 2.6990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0490e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8328e-01
  Total weights = 1.966027560e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2371e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274188268482
                                         uncertainty =       0.001394789487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274188268482
                                         uncertainty =       0.001394789487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370286546
  error estimate for blocks of size 2^( 2) =       0.000384414318
  error estimate for blocks of size 2^( 3) =       0.000397773317
  error estimate for blocks of size 2^( 4) =       0.000406910681
  error estimate for blocks of size 2^( 5) =       0.000412497070
  error estimate for blocks of size 2^( 6) =       0.000415339684
  error estimate for blocks of size 2^( 7) =       0.000415709696

      target function =      -0.939375340346
              le_mean =     -17.209167772854
             les_mean =     296.438739225135
             stat err =       0.000412614283
             autocorr =       1.241688472525
   target nu stat err =       0.000412614283
   target dn stat err =       0.001857274685
      target stat err =       0.003191061705
              std dev =       0.523672633518
             le_variance =       0.274233027096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720916777285e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939385029869       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939385172400       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939385195813       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939385207745       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939385212085       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939385212389       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939385214702       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939385217369       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939385220133       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939385222593       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939385222852       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939385223376       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939385224189       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939385224897       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939385226437       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939385226550       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939385226423       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939385226057       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939385226627       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939385226938       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939385226890       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939385227107       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939385227334       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939385227682       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939385227623       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939385227537       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939385227545       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939385227469       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939385227377       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939385227320       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939385227475       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939385227561       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939385227515       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939385227526       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939385227544       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939385227530       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939385227540       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939385227533       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939385227552       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+02 is 2.209234e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939385029869       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939385065515       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939385071370       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939385074355       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939385075439       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939385075516       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939385076094       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939385076760       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939385077452       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939385078066       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939385078130       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939385078262       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939385078468       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939385078642       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939385079028       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939385079056       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939385079023       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939385078932       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939385079075       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939385079154       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939385079140       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939385079197       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939385079253       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939385079338       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939385079326       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939385079307       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939385079304       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939385079287       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939385079263       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939385079250       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939385079289       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939385079307       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939385079298       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939385079299       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939385079307       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939385079299       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939385079304       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939385079301       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939385079306       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+02 is 5.523434e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939385029869       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939385038781       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939385040245       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939385040991       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939385041262       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939385041287       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939385041426       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939385041593       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939385041766       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939385041919       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939385041935       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939385041972       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939385042019       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939385042065       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939385042158       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939385042162       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939385042157       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939385042137       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939385042169       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939385042194       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939385042184       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939385042213       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939385042222       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939385042239       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939385042238       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939385042223       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939385042234       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939385042227       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939385042215       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939385042219       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939385042223       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939385042235       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939385042221       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939385042228       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939385042225       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939385042226       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939385042223       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939385042225       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939385042235       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.4414e+03 is 1.380880e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.307657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5299e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.084891e-01 1 1  ON 0
  uu_1                 5.267378e-02 1 1  ON 1
  uu_2                -3.672467e-02 1 1  ON 2
  uu_3                -8.985113e-02 1 1  ON 3
  uu_4                -1.217626e-01 1 1  ON 4
  uu_5                -1.312721e-01 1 1  ON 5
  uu_6                -1.137547e-01 1 1  ON 6
  uu_7                -5.646494e-02 1 1  ON 7
  uu_8                 5.948960e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006734e-01 1 1  ON 10
  ud_1                 7.340459e-02 1 1  ON 11
  ud_2                -2.594310e-02 1 1  ON 12
  ud_3                -7.709045e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317623e-01 1 1  ON 15
  ud_6                -1.269138e-01 1 1  ON 16
  ud_7                -8.780176e-02 1 1  ON 17
  ud_8                -4.232274e-03 1 1  ON 18
  ud_9                 8.491490e-02 1 1  ON 19
  eO_0                -6.932065e-01 1 1  ON 20
  eO_1                -4.132230e-01 1 1  ON 21
  eO_2                -4.142467e-02 1 1  ON 22
  eO_3                 1.783618e-01 1 1  ON 23
  eO_4                 2.499494e-01 1 1  ON 24
  eO_5                 2.747792e-01 1 1  ON 25
  eO_6                 2.477560e-01 1 1  ON 26
  eO_7                 1.370853e-01 1 1  ON 27
  eO_8                 2.907779e-02 1 1  ON 28
  eO_9                 1.941105e-02 1 1  ON 29
 eH1_0                -2.054423e-01 1 1  ON 30
 eH1_1                -1.005080e-01 1 1  ON 31
 eH1_2                -4.948566e-02 1 1  ON 32
 eH1_3                -1.791319e-02 1 1  ON 33
 eH1_4                 1.722555e-02 1 1  ON 34
 eH1_5                 2.532978e-02 1 1  ON 35
 eH1_6                 7.902061e-02 1 1  ON 36
 eH1_7                 1.070408e-01 1 1  ON 37
 eH1_8                 1.027370e-01 1 1  ON 38
 eH1_9                 2.587839e-02 1 1  ON 39
 eH2_0                -2.016933e-01 1 1  ON 40
 eH2_1                -9.694545e-02 1 1  ON 41
 eH2_2                -4.657231e-02 1 1  ON 42
 eH2_3                -1.598748e-02 1 1  ON 43
 eH2_4                 1.733575e-02 1 1  ON 44
 eH2_5                 2.121374e-02 1 1  ON 45
 eH2_6                 7.058771e-02 1 1  ON 46
 eH2_7                 1.059941e-01 1 1  ON 47
 eH2_8                 1.046950e-01 1 1  ON 48
 eH2_9                 2.830326e-02 1 1  ON 49
ci_001                -4.234852e-02 3 1  ON 50
ci_002                -3.115765e-02 3 1  ON 51
ci_003                -2.574053e-02 3 1  ON 52
ci_004                 2.449557e-02 3 1  ON 53
ci_005                 2.459922e-02 3 1  ON 54
ci_006                -2.028892e-02 3 1  ON 55
ci_007                -2.042823e-02 3 1  ON 56
ci_008                -8.986171e-03 3 1  ON 57
ci_009                -1.503589e-02 3 1  ON 58
ci_010                -9.450178e-03 3 1  ON 59
ci_011                -1.021738e-02 3 1  ON 60
ci_012                -1.008538e-02 3 1  ON 61
ci_013                -1.953180e-02 3 1  ON 62
ci_014                 1.300220e-02 3 1  ON 63
ci_015                 1.321463e-02 3 1  ON 64
ci_016                 1.641203e-02 3 1  ON 65
ci_017                 1.617541e-02 3 1  ON 66
ci_018                 1.019182e-02 3 1  ON 67
ci_019                 1.038149e-02 3 1  ON 68
ci_020                 1.646488e-02 3 1  ON 69
ci_021                 1.644448e-02 3 1  ON 70
ci_022                 1.057014e-02 3 1  ON 71
ci_023                 9.301931e-03 3 1  ON 72
ci_024                 7.513697e-03 3 1  ON 73
ci_025                 6.086485e-03 3 1  ON 74
ci_026                 1.169010e-02 3 1  ON 75
ci_027                 1.166518e-02 3 1  ON 76
ci_028                -1.519532e-02 3 1  ON 77
ci_029                -1.537203e-02 3 1  ON 78
ci_030                -4.449320e-03 3 1  ON 79
ci_031                -4.861487e-03 3 1  ON 80
ci_032                -1.535544e-02 3 1  ON 81
ci_033                 6.941804e-03 3 1  ON 82
ci_034                 7.336662e-03 3 1  ON 83
ci_035                -4.586162e-03 3 1  ON 84
ci_036                -1.273226e-02 3 1  ON 85
ci_037                -1.278167e-02 3 1  ON 86
ci_038                 1.163976e-03 3 1  ON 87
ci_039                 1.335573e-03 3 1  ON 88
ci_040                -2.704918e-03 3 1  ON 89
ci_041                 8.457460e-03 3 1  ON 90
ci_042                 8.382543e-03 3 1  ON 91
ci_043                -3.617539e-03 3 1  ON 92
ci_044                -4.711751e-03 3 1  ON 93
ci_045                -2.790511e-03 3 1  ON 94
ci_046                 5.835178e-03 3 1  ON 95
ci_047                 5.644689e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.346624
====================================================
  Execution time = 2.6974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8585e-01
  Total weights = 1.9661e+06
  Execution time = 2.3007e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338857752
                                         uncertainty =       0.001994990633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338857752
                                         uncertainty =       0.001994990633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373038716
  error estimate for blocks of size 2^( 2) =       0.000387252626
  error estimate for blocks of size 2^( 3) =       0.000400406460
  error estimate for blocks of size 2^( 4) =       0.000409830740
  error estimate for blocks of size 2^( 5) =       0.000415773047
  error estimate for blocks of size 2^( 6) =       0.000418885167
  error estimate for blocks of size 2^( 7) =       0.000419649320

      target function =      -0.935077953646
              le_mean =     -17.210417038276
             les_mean =     296.484300495707
             stat err =       0.000416034569
             autocorr =       1.243801338757
   target nu stat err =       0.000416034569
   target dn stat err =       0.001989411104
      target stat err =       0.003385408562
              std dev =       0.527564852696
             le_variance =       0.278324673800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338629982
                                         uncertainty =       0.001994998966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338629982
                                         uncertainty =       0.001994998966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373038564
  error estimate for blocks of size 2^( 2) =       0.000387252543
  error estimate for blocks of size 2^( 3) =       0.000400406446
  error estimate for blocks of size 2^( 4) =       0.000409830758
  error estimate for blocks of size 2^( 5) =       0.000415773089
  error estimate for blocks of size 2^( 6) =       0.000418885206
  error estimate for blocks of size 2^( 7) =       0.000419649384

      target function =      -0.935078290154
              le_mean =     -17.210417039353
             les_mean =     296.484300329886
             stat err =       0.000416034609
             autocorr =       1.243802594944
   target nu stat err =       0.000416034609
   target dn stat err =       0.001989444123
      target stat err =       0.003385464478
              std dev =       0.527564637882
             le_variance =       0.278324447143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338743809
                                         uncertainty =       0.001994994801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338743809
                                         uncertainty =       0.001994994801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373038640
  error estimate for blocks of size 2^( 2) =       0.000387252584
  error estimate for blocks of size 2^( 3) =       0.000400406453
  error estimate for blocks of size 2^( 4) =       0.000409830749
  error estimate for blocks of size 2^( 5) =       0.000415773068
  error estimate for blocks of size 2^( 6) =       0.000418885187
  error estimate for blocks of size 2^( 7) =       0.000419649352

      target function =      -0.935078124550
              le_mean =     -17.210417038812
             les_mean =     296.484300411123
             stat err =       0.000416034589
             autocorr =       1.243801967064
   target nu stat err =       0.000416034589
   target dn stat err =       0.001989427598
      target stat err =       0.003385436514
              std dev =       0.527564745234
             le_variance =       0.278324560414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338843506
                                         uncertainty =       0.001994991154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278338843506
                                         uncertainty =       0.001994991154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373038707
  error estimate for blocks of size 2^( 2) =       0.000387252621
  error estimate for blocks of size 2^( 3) =       0.000400406459
  error estimate for blocks of size 2^( 4) =       0.000409830741
  error estimate for blocks of size 2^( 5) =       0.000415773050
  error estimate for blocks of size 2^( 6) =       0.000418885170
  error estimate for blocks of size 2^( 7) =       0.000419649324

      target function =      -0.935077975301
              le_mean =     -17.210417038343
             les_mean =     296.484300484949
             stat err =       0.000416034571
             autocorr =       1.243801417307
   target nu stat err =       0.000416034571
   target dn stat err =       0.001989413163
      target stat err =       0.003385412055
              std dev =       0.527564839260
             le_variance =       0.278324659623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935077953646        initial
     1.5259e+02     1.5259e+03             2.2092e-06        -0.935078290154  <--
     6.1035e+02     6.1035e+03             5.5234e-07        -0.935078124550
     2.4414e+03     2.4414e+04             1.3809e-07        -0.935077975301

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 3.8604e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.084888e-01 1 1  ON 0
  uu_1                 5.267384e-02 1 1  ON 1
  uu_2                -3.672456e-02 1 1  ON 2
  uu_3                -8.985097e-02 1 1  ON 3
  uu_4                -1.217624e-01 1 1  ON 4
  uu_5                -1.312720e-01 1 1  ON 5
  uu_6                -1.137549e-01 1 1  ON 6
  uu_7                -5.646437e-02 1 1  ON 7
  uu_8                 5.948795e-02 1 1  ON 8
  uu_9                 1.220873e-01 1 1  ON 9
  ud_0                 3.006723e-01 1 1  ON 10
  ud_1                 7.340384e-02 1 1  ON 11
  ud_2                -2.594351e-02 1 1  ON 12
  ud_3                -7.709061e-02 1 1  ON 13
  ud_4                -1.122878e-01 1 1  ON 14
  ud_5                -1.317615e-01 1 1  ON 15
  ud_6                -1.269134e-01 1 1  ON 16
  ud_7                -8.780144e-02 1 1  ON 17
  ud_8                -4.232635e-03 1 1  ON 18
  ud_9                 8.491483e-02 1 1  ON 19
  eO_0                -6.932059e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142527e-02 1 1  ON 22
  eO_3                 1.783609e-01 1 1  ON 23
  eO_4                 2.499487e-01 1 1  ON 24
  eO_5                 2.747791e-01 1 1  ON 25
  eO_6                 2.477565e-01 1 1  ON 26
  eO_7                 1.370861e-01 1 1  ON 27
  eO_8                 2.907792e-02 1 1  ON 28
  eO_9                 1.941117e-02 1 1  ON 29
 eH1_0                -2.054422e-01 1 1  ON 30
 eH1_1                -1.005077e-01 1 1  ON 31
 eH1_2                -4.948524e-02 1 1  ON 32
 eH1_3                -1.791306e-02 1 1  ON 33
 eH1_4                 1.722540e-02 1 1  ON 34
 eH1_5                 2.532865e-02 1 1  ON 35
 eH1_6                 7.902035e-02 1 1  ON 36
 eH1_7                 1.070409e-01 1 1  ON 37
 eH1_8                 1.027374e-01 1 1  ON 38
 eH1_9                 2.587846e-02 1 1  ON 39
 eH2_0                -2.016936e-01 1 1  ON 40
 eH2_1                -9.694507e-02 1 1  ON 41
 eH2_2                -4.657198e-02 1 1  ON 42
 eH2_3                -1.598739e-02 1 1  ON 43
 eH2_4                 1.733607e-02 1 1  ON 44
 eH2_5                 2.121332e-02 1 1  ON 45
 eH2_6                 7.058715e-02 1 1  ON 46
 eH2_7                 1.059936e-01 1 1  ON 47
 eH2_8                 1.046955e-01 1 1  ON 48
 eH2_9                 2.830336e-02 1 1  ON 49
ci_001                -4.234834e-02 3 1  ON 50
ci_002                -3.115752e-02 3 1  ON 51
ci_003                -2.574083e-02 3 1  ON 52
ci_004                 2.449525e-02 3 1  ON 53
ci_005                 2.459944e-02 3 1  ON 54
ci_006                -2.028926e-02 3 1  ON 55
ci_007                -2.042819e-02 3 1  ON 56
ci_008                -8.986245e-03 3 1  ON 57
ci_009                -1.503579e-02 3 1  ON 58
ci_010                -9.450465e-03 3 1  ON 59
ci_011                -1.021777e-02 3 1  ON 60
ci_012                -1.008549e-02 3 1  ON 61
ci_013                -1.953196e-02 3 1  ON 62
ci_014                 1.300259e-02 3 1  ON 63
ci_015                 1.321457e-02 3 1  ON 64
ci_016                 1.641185e-02 3 1  ON 65
ci_017                 1.617547e-02 3 1  ON 66
ci_018                 1.019143e-02 3 1  ON 67
ci_019                 1.038159e-02 3 1  ON 68
ci_020                 1.646486e-02 3 1  ON 69
ci_021                 1.644424e-02 3 1  ON 70
ci_022                 1.057019e-02 3 1  ON 71
ci_023                 9.302274e-03 3 1  ON 72
ci_024                 7.513912e-03 3 1  ON 73
ci_025                 6.087052e-03 3 1  ON 74
ci_026                 1.169027e-02 3 1  ON 75
ci_027                 1.166452e-02 3 1  ON 76
ci_028                -1.519525e-02 3 1  ON 77
ci_029                -1.537209e-02 3 1  ON 78
ci_030                -4.449164e-03 3 1  ON 79
ci_031                -4.861452e-03 3 1  ON 80
ci_032                -1.535546e-02 3 1  ON 81
ci_033                 6.941805e-03 3 1  ON 82
ci_034                 7.336684e-03 3 1  ON 83
ci_035                -4.586102e-03 3 1  ON 84
ci_036                -1.273224e-02 3 1  ON 85
ci_037                -1.278178e-02 3 1  ON 86
ci_038                 1.164090e-03 3 1  ON 87
ci_039                 1.335416e-03 3 1  ON 88
ci_040                -2.704859e-03 3 1  ON 89
ci_041                 8.457559e-03 3 1  ON 90
ci_042                 8.382425e-03 3 1  ON 91
ci_043                -3.617646e-03 3 1  ON 92
ci_044                -4.711720e-03 3 1  ON 93
ci_045                -2.790551e-03 3 1  ON 94
ci_046                 5.835159e-03 3 1  ON 95
ci_047                 5.644767e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.142108
====================================================
  Execution time = 2.7253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0471e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8739e-01
  Total weights = 1.966184158e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3014e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276751678456
                                         uncertainty =       0.001590615141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276751678456
                                         uncertainty =       0.001590615141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371932433
  error estimate for blocks of size 2^( 2) =       0.000385876550
  error estimate for blocks of size 2^( 3) =       0.000399018334
  error estimate for blocks of size 2^( 4) =       0.000408898634
  error estimate for blocks of size 2^( 5) =       0.000415182958
  error estimate for blocks of size 2^( 6) =       0.000419167904
  error estimate for blocks of size 2^( 7) =       0.000422323139

      target function =      -0.932519390544
              le_mean =     -17.210200963189
             les_mean =     296.478409657102
             stat err =       0.000416393159
             autocorr =       1.253369345086
   target nu stat err =       0.000416393159
   target dn stat err =       0.002309194607
      target stat err =       0.003882970297
              std dev =       0.526000307250
             le_variance =       0.276676323228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721020096319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932534666301       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932535603994       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932535744357       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932535778888       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932535813675       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932535813623       residual = 9.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932535817583       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932535831641       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932535839939       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932535849267       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932535853133       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932535860945       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932535865445       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932535867352       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932535865698       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932535863781       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932535864572       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932535866868       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932535867625       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932535868476       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932535868561       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932535870935       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932535872939       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932535874829       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932535874358       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932535876123       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932535876501       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932535875201       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932535875856       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932535876942       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932535877297       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932535877133       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932535877457       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932535878271       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932535877811       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932535877218       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932535877284       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932535877433       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932535877499       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932535877632       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932535877524       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932535877307       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932535877505       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+01 is 1.024982e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932534666301       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932534901090       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932534936226       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932534944866       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932534953576       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932534953554       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932534954555       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932534958064       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932534960144       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932534962477       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932534963446       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932534965401       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932534966525       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932534967000       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932534966585       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932534966105       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932534966303       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932534966878       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932534967067       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932534967281       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932534967302       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932534967896       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932534968397       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932534968869       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932534968752       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932534969191       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932534969287       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932534968961       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932534969124       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932534969396       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932534969484       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932534969443       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932534969524       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932534969728       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932534969611       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932534969464       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932534969481       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932534969518       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932534969535       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932534969567       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932534969540       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932534969487       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932534969536       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+02 is 2.563990e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932534666301       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932534725021       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932534733808       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932534735968       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932534738147       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932534738141       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932534738391       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932534739268       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932534739789       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932534740372       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932534740615       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932534741102       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932534741384       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932534741503       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932534741398       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932534741279       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932534741330       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932534741472       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932534741520       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932534741572       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932534741581       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932534741726       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932534741851       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932534741973       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932534741941       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932534742049       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932534742073       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932534741996       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932534742035       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932534742102       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932534742122       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932534742112       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932534742131       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932534742184       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932534742158       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932534742118       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932534742121       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932534742133       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932534742133       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932534742145       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932534742139       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932534742124       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932534742136       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+02 is 6.410935e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.392533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5647e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.084886e-01 1 1  ON 0
  uu_1                 5.267377e-02 1 1  ON 1
  uu_2                -3.672431e-02 1 1  ON 2
  uu_3                -8.985071e-02 1 1  ON 3
  uu_4                -1.217621e-01 1 1  ON 4
  uu_5                -1.312716e-01 1 1  ON 5
  uu_6                -1.137546e-01 1 1  ON 6
  uu_7                -5.646419e-02 1 1  ON 7
  uu_8                 5.948543e-02 1 1  ON 8
  uu_9                 1.220873e-01 1 1  ON 9
  ud_0                 3.006710e-01 1 1  ON 10
  ud_1                 7.340299e-02 1 1  ON 11
  ud_2                -2.594388e-02 1 1  ON 12
  ud_3                -7.709078e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317612e-01 1 1  ON 15
  ud_6                -1.269125e-01 1 1  ON 16
  ud_7                -8.779980e-02 1 1  ON 17
  ud_8                -4.233627e-03 1 1  ON 18
  ud_9                 8.491453e-02 1 1  ON 19
  eO_0                -6.932057e-01 1 1  ON 20
  eO_1                -4.132232e-01 1 1  ON 21
  eO_2                -4.142661e-02 1 1  ON 22
  eO_3                 1.783607e-01 1 1  ON 23
  eO_4                 2.499481e-01 1 1  ON 24
  eO_5                 2.747782e-01 1 1  ON 25
  eO_6                 2.477572e-01 1 1  ON 26
  eO_7                 1.370879e-01 1 1  ON 27
  eO_8                 2.907811e-02 1 1  ON 28
  eO_9                 1.941132e-02 1 1  ON 29
 eH1_0                -2.054415e-01 1 1  ON 30
 eH1_1                -1.005063e-01 1 1  ON 31
 eH1_2                -4.948391e-02 1 1  ON 32
 eH1_3                -1.791271e-02 1 1  ON 33
 eH1_4                 1.722427e-02 1 1  ON 34
 eH1_5                 2.532608e-02 1 1  ON 35
 eH1_6                 7.901931e-02 1 1  ON 36
 eH1_7                 1.070409e-01 1 1  ON 37
 eH1_8                 1.027382e-01 1 1  ON 38
 eH1_9                 2.587859e-02 1 1  ON 39
 eH2_0                -2.016940e-01 1 1  ON 40
 eH2_1                -9.694483e-02 1 1  ON 41
 eH2_2                -4.657175e-02 1 1  ON 42
 eH2_3                -1.598758e-02 1 1  ON 43
 eH2_4                 1.733494e-02 1 1  ON 44
 eH2_5                 2.121190e-02 1 1  ON 45
 eH2_6                 7.058880e-02 1 1  ON 46
 eH2_7                 1.059936e-01 1 1  ON 47
 eH2_8                 1.046964e-01 1 1  ON 48
 eH2_9                 2.830349e-02 1 1  ON 49
ci_001                -4.234745e-02 3 1  ON 50
ci_002                -3.115762e-02 3 1  ON 51
ci_003                -2.574118e-02 3 1  ON 52
ci_004                 2.449561e-02 3 1  ON 53
ci_005                 2.459969e-02 3 1  ON 54
ci_006                -2.028975e-02 3 1  ON 55
ci_007                -2.042808e-02 3 1  ON 56
ci_008                -8.986136e-03 3 1  ON 57
ci_009                -1.503598e-02 3 1  ON 58
ci_010                -9.450082e-03 3 1  ON 59
ci_011                -1.021797e-02 3 1  ON 60
ci_012                -1.008503e-02 3 1  ON 61
ci_013                -1.953154e-02 3 1  ON 62
ci_014                 1.300254e-02 3 1  ON 63
ci_015                 1.321478e-02 3 1  ON 64
ci_016                 1.641191e-02 3 1  ON 65
ci_017                 1.617602e-02 3 1  ON 66
ci_018                 1.019113e-02 3 1  ON 67
ci_019                 1.038180e-02 3 1  ON 68
ci_020                 1.646478e-02 3 1  ON 69
ci_021                 1.644455e-02 3 1  ON 70
ci_022                 1.056987e-02 3 1  ON 71
ci_023                 9.302706e-03 3 1  ON 72
ci_024                 7.513816e-03 3 1  ON 73
ci_025                 6.087132e-03 3 1  ON 74
ci_026                 1.168944e-02 3 1  ON 75
ci_027                 1.166456e-02 3 1  ON 76
ci_028                -1.519577e-02 3 1  ON 77
ci_029                -1.537199e-02 3 1  ON 78
ci_030                -4.449204e-03 3 1  ON 79
ci_031                -4.862047e-03 3 1  ON 80
ci_032                -1.535549e-02 3 1  ON 81
ci_033                 6.942080e-03 3 1  ON 82
ci_034                 7.336996e-03 3 1  ON 83
ci_035                -4.586075e-03 3 1  ON 84
ci_036                -1.273160e-02 3 1  ON 85
ci_037                -1.278241e-02 3 1  ON 86
ci_038                 1.164166e-03 3 1  ON 87
ci_039                 1.335685e-03 3 1  ON 88
ci_040                -2.705303e-03 3 1  ON 89
ci_041                 8.457630e-03 3 1  ON 90
ci_042                 8.382548e-03 3 1  ON 91
ci_043                -3.617501e-03 3 1  ON 92
ci_044                -4.711490e-03 3 1  ON 93
ci_045                -2.790477e-03 3 1  ON 94
ci_046                 5.835198e-03 3 1  ON 95
ci_047                 5.644740e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.271885
====================================================
  Execution time = 2.7108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8523e-01
  Total weights = 1.9663e+06
  Execution time = 2.3000e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202625554
                                         uncertainty =       0.001477029269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202625554
                                         uncertainty =       0.001477029269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371607060
  error estimate for blocks of size 2^( 2) =       0.000385732287
  error estimate for blocks of size 2^( 3) =       0.000399118313
  error estimate for blocks of size 2^( 4) =       0.000408632447
  error estimate for blocks of size 2^( 5) =       0.000412758019
  error estimate for blocks of size 2^( 6) =       0.000415456916
  error estimate for blocks of size 2^( 7) =       0.000418209323

      target function =      -0.936131952421
              le_mean =     -17.209503851043
             les_mean =     296.452247456867
             stat err =       0.000413764176
             autocorr =       1.239760683215
   target nu stat err =       0.000413764176
   target dn stat err =       0.002049530075
      target stat err =       0.003483694590
              std dev =       0.525540153043
             le_variance =       0.276192452460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201627983
                                         uncertainty =       0.001476981508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201627983
                                         uncertainty =       0.001476981508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371606392
  error estimate for blocks of size 2^( 2) =       0.000385732001
  error estimate for blocks of size 2^( 3) =       0.000399118399
  error estimate for blocks of size 2^( 4) =       0.000408632839
  error estimate for blocks of size 2^( 5) =       0.000412758483
  error estimate for blocks of size 2^( 6) =       0.000415457357
  error estimate for blocks of size 2^( 7) =       0.000418209833

      target function =      -0.936121652386
              le_mean =     -17.209503887907
             les_mean =     296.452254918434
             stat err =       0.000413764628
             autocorr =       1.239767855401
   target nu stat err =       0.000413764628
   target dn stat err =       0.002050352635
      target stat err =       0.003484956078
              std dev =       0.525539207357
             le_variance =       0.276191458470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202125552
                                         uncertainty =       0.001477005348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202125552
                                         uncertainty =       0.001477005348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371606725
  error estimate for blocks of size 2^( 2) =       0.000385732144
  error estimate for blocks of size 2^( 3) =       0.000399118355
  error estimate for blocks of size 2^( 4) =       0.000408632643
  error estimate for blocks of size 2^( 5) =       0.000412758251
  error estimate for blocks of size 2^( 6) =       0.000415457136
  error estimate for blocks of size 2^( 7) =       0.000418209578

      target function =      -0.936127098874
              le_mean =     -17.209503869465
             les_mean =     296.452251008901
             stat err =       0.000413764402
             autocorr =       1.239764273901
   target nu stat err =       0.000413764402
   target dn stat err =       0.002049933746
      target stat err =       0.003484315137
              std dev =       0.525539679045
             le_variance =       0.276191954251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202562977
                                         uncertainty =       0.001477026277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202562977
                                         uncertainty =       0.001477026277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371607018
  error estimate for blocks of size 2^( 2) =       0.000385732269
  error estimate for blocks of size 2^( 3) =       0.000399118318
  error estimate for blocks of size 2^( 4) =       0.000408632471
  error estimate for blocks of size 2^( 5) =       0.000412758048
  error estimate for blocks of size 2^( 6) =       0.000415456943
  error estimate for blocks of size 2^( 7) =       0.000418209355

      target function =      -0.936131380093
              le_mean =     -17.209503853342
             les_mean =     296.452247880083
             stat err =       0.000413764204
             autocorr =       1.239761132202
   target nu stat err =       0.000413764204
   target dn stat err =       0.002049579690
      target stat err =       0.003483771037
              std dev =       0.525540093720
             le_variance =       0.276192390108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936131952421        initial  <--
     3.8147e+01     3.8147e+02             1.0250e-05        -0.936121652386
     1.5259e+02     1.5259e+03             2.5640e-06        -0.936127098874
     6.1035e+02     6.1035e+03             6.4109e-07        -0.936131380093

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7348
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.084888e-01 1 1  ON 0
  uu_1                 5.267384e-02 1 1  ON 1
  uu_2                -3.672456e-02 1 1  ON 2
  uu_3                -8.985097e-02 1 1  ON 3
  uu_4                -1.217624e-01 1 1  ON 4
  uu_5                -1.312720e-01 1 1  ON 5
  uu_6                -1.137549e-01 1 1  ON 6
  uu_7                -5.646437e-02 1 1  ON 7
  uu_8                 5.948795e-02 1 1  ON 8
  uu_9                 1.220873e-01 1 1  ON 9
  ud_0                 3.006723e-01 1 1  ON 10
  ud_1                 7.340384e-02 1 1  ON 11
  ud_2                -2.594351e-02 1 1  ON 12
  ud_3                -7.709061e-02 1 1  ON 13
  ud_4                -1.122878e-01 1 1  ON 14
  ud_5                -1.317615e-01 1 1  ON 15
  ud_6                -1.269134e-01 1 1  ON 16
  ud_7                -8.780144e-02 1 1  ON 17
  ud_8                -4.232635e-03 1 1  ON 18
  ud_9                 8.491483e-02 1 1  ON 19
  eO_0                -6.932059e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142527e-02 1 1  ON 22
  eO_3                 1.783609e-01 1 1  ON 23
  eO_4                 2.499487e-01 1 1  ON 24
  eO_5                 2.747791e-01 1 1  ON 25
  eO_6                 2.477565e-01 1 1  ON 26
  eO_7                 1.370861e-01 1 1  ON 27
  eO_8                 2.907792e-02 1 1  ON 28
  eO_9                 1.941117e-02 1 1  ON 29
 eH1_0                -2.054422e-01 1 1  ON 30
 eH1_1                -1.005077e-01 1 1  ON 31
 eH1_2                -4.948524e-02 1 1  ON 32
 eH1_3                -1.791306e-02 1 1  ON 33
 eH1_4                 1.722540e-02 1 1  ON 34
 eH1_5                 2.532865e-02 1 1  ON 35
 eH1_6                 7.902035e-02 1 1  ON 36
 eH1_7                 1.070409e-01 1 1  ON 37
 eH1_8                 1.027374e-01 1 1  ON 38
 eH1_9                 2.587846e-02 1 1  ON 39
 eH2_0                -2.016936e-01 1 1  ON 40
 eH2_1                -9.694507e-02 1 1  ON 41
 eH2_2                -4.657198e-02 1 1  ON 42
 eH2_3                -1.598739e-02 1 1  ON 43
 eH2_4                 1.733607e-02 1 1  ON 44
 eH2_5                 2.121332e-02 1 1  ON 45
 eH2_6                 7.058715e-02 1 1  ON 46
 eH2_7                 1.059936e-01 1 1  ON 47
 eH2_8                 1.046955e-01 1 1  ON 48
 eH2_9                 2.830336e-02 1 1  ON 49
ci_001                -4.234834e-02 3 1  ON 50
ci_002                -3.115752e-02 3 1  ON 51
ci_003                -2.574083e-02 3 1  ON 52
ci_004                 2.449525e-02 3 1  ON 53
ci_005                 2.459944e-02 3 1  ON 54
ci_006                -2.028926e-02 3 1  ON 55
ci_007                -2.042819e-02 3 1  ON 56
ci_008                -8.986245e-03 3 1  ON 57
ci_009                -1.503579e-02 3 1  ON 58
ci_010                -9.450465e-03 3 1  ON 59
ci_011                -1.021777e-02 3 1  ON 60
ci_012                -1.008549e-02 3 1  ON 61
ci_013                -1.953196e-02 3 1  ON 62
ci_014                 1.300259e-02 3 1  ON 63
ci_015                 1.321457e-02 3 1  ON 64
ci_016                 1.641185e-02 3 1  ON 65
ci_017                 1.617547e-02 3 1  ON 66
ci_018                 1.019143e-02 3 1  ON 67
ci_019                 1.038159e-02 3 1  ON 68
ci_020                 1.646486e-02 3 1  ON 69
ci_021                 1.644424e-02 3 1  ON 70
ci_022                 1.057019e-02 3 1  ON 71
ci_023                 9.302274e-03 3 1  ON 72
ci_024                 7.513912e-03 3 1  ON 73
ci_025                 6.087052e-03 3 1  ON 74
ci_026                 1.169027e-02 3 1  ON 75
ci_027                 1.166452e-02 3 1  ON 76
ci_028                -1.519525e-02 3 1  ON 77
ci_029                -1.537209e-02 3 1  ON 78
ci_030                -4.449164e-03 3 1  ON 79
ci_031                -4.861452e-03 3 1  ON 80
ci_032                -1.535546e-02 3 1  ON 81
ci_033                 6.941805e-03 3 1  ON 82
ci_034                 7.336684e-03 3 1  ON 83
ci_035                -4.586102e-03 3 1  ON 84
ci_036                -1.273224e-02 3 1  ON 85
ci_037                -1.278178e-02 3 1  ON 86
ci_038                 1.164090e-03 3 1  ON 87
ci_039                 1.335416e-03 3 1  ON 88
ci_040                -2.704859e-03 3 1  ON 89
ci_041                 8.457559e-03 3 1  ON 90
ci_042                 8.382425e-03 3 1  ON 91
ci_043                -3.617646e-03 3 1  ON 92
ci_044                -4.711720e-03 3 1  ON 93
ci_045                -2.790551e-03 3 1  ON 94
ci_046                 5.835159e-03 3 1  ON 95
ci_047                 5.644767e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1682
    reference variance = 0.23554
====================================================
  Execution time = 2.7364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8335e-01
  Total weights = 1.966549471e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2560e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274229808074
                                         uncertainty =       0.001480475791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274229808074
                                         uncertainty =       0.001480475791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370470949
  error estimate for blocks of size 2^( 2) =       0.000384609880
  error estimate for blocks of size 2^( 3) =       0.000397768729
  error estimate for blocks of size 2^( 4) =       0.000407605764
  error estimate for blocks of size 2^( 5) =       0.000412811292
  error estimate for blocks of size 2^( 6) =       0.000414649272
  error estimate for blocks of size 2^( 7) =       0.000415675362

      target function =      -0.939254143810
              le_mean =     -17.209387180249
             les_mean =     296.446360294098
             stat err =       0.000412685423
             autocorr =       1.240880448544
   target nu stat err =       0.000412685423
   target dn stat err =       0.001996840226
      target stat err =       0.003419168736
              std dev =       0.523933422832
             le_variance =       0.274506231561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720938718025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939265603765       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939265684654       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939265698013       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939265700783       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939265701742       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939265703339       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939265703577       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939265705503       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939265706608       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939265706408       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939265706479       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939265706626       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939265706915       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939265707711       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939265707906       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939265708367       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939265708892       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939265709021       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939265708932       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939265709269       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939265709243       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939265709340       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939265709464       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939265709458       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939265709538       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939265709592       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939265709618       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939265709642       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939265709620       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939265709669       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939265709716       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939265709743       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939265709861       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939265709885       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939265709925       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939265709954       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939265709951       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939265709945       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939265709918       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939265709916       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939265709885       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939265709877       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939265709891       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939265709905       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+02 is 9.789469e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939265603765       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939265623990       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939265627331       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939265628023       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939265628263       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939265628662       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939265628722       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939265629205       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939265629480       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939265629430       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939265629445       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939265629486       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939265629556       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939265629755       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939265629804       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939265629919       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939265630051       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939265630083       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939265630056       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939265630145       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939265630139       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939265630162       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939265630190       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939265630192       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939265630212       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939265630219       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939265630231       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939265630238       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939265630229       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939265630245       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939265630250       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939265630266       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939265630292       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939265630304       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939265630305       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939265630309       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939265630312       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939265630305       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939265630307       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939265630308       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939265630301       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939265630302       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939265630301       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939265630314       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+03 is 2.447526e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939265603765       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939265608822       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939265609657       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939265609830       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939265609890       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939265609990       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939265610005       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939265610123       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939265610194       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939265610182       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939265610186       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939265610191       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939265610213       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939265610269       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939265610269       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939265610304       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939265610337       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939265610320       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939265610331       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939265610355       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939265610360       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939265610359       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939265610352       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939265610356       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939265610378       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939265610379       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939265610378       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939265610384       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939265610388       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939265610408       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939265610386       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939265610401       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939265610375       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939265610404       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939265610413       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939265610375       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939265610393       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939265610394       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939265610390       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939265610383       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939265610407       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939265610398       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939265610381       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939265610411       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 6.1035e+03 is 6.118913e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.482899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5718e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.084888e-01 1 1  ON 0
  uu_1                 5.267384e-02 1 1  ON 1
  uu_2                -3.672452e-02 1 1  ON 2
  uu_3                -8.985093e-02 1 1  ON 3
  uu_4                -1.217623e-01 1 1  ON 4
  uu_5                -1.312719e-01 1 1  ON 5
  uu_6                -1.137548e-01 1 1  ON 6
  uu_7                -5.646448e-02 1 1  ON 7
  uu_8                 5.948773e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006722e-01 1 1  ON 10
  ud_1                 7.340372e-02 1 1  ON 11
  ud_2                -2.594358e-02 1 1  ON 12
  ud_3                -7.709064e-02 1 1  ON 13
  ud_4                -1.122878e-01 1 1  ON 14
  ud_5                -1.317614e-01 1 1  ON 15
  ud_6                -1.269133e-01 1 1  ON 16
  ud_7                -8.780129e-02 1 1  ON 17
  ud_8                -4.232725e-03 1 1  ON 18
  ud_9                 8.491477e-02 1 1  ON 19
  eO_0                -6.932058e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142532e-02 1 1  ON 22
  eO_3                 1.783609e-01 1 1  ON 23
  eO_4                 2.499486e-01 1 1  ON 24
  eO_5                 2.747789e-01 1 1  ON 25
  eO_6                 2.477565e-01 1 1  ON 26
  eO_7                 1.370863e-01 1 1  ON 27
  eO_8                 2.907796e-02 1 1  ON 28
  eO_9                 1.941118e-02 1 1  ON 29
 eH1_0                -2.054421e-01 1 1  ON 30
 eH1_1                -1.005075e-01 1 1  ON 31
 eH1_2                -4.948512e-02 1 1  ON 32
 eH1_3                -1.791305e-02 1 1  ON 33
 eH1_4                 1.722525e-02 1 1  ON 34
 eH1_5                 2.532840e-02 1 1  ON 35
 eH1_6                 7.902031e-02 1 1  ON 36
 eH1_7                 1.070409e-01 1 1  ON 37
 eH1_8                 1.027374e-01 1 1  ON 38
 eH1_9                 2.587847e-02 1 1  ON 39
 eH2_0                -2.016936e-01 1 1  ON 40
 eH2_1                -9.694499e-02 1 1  ON 41
 eH2_2                -4.657191e-02 1 1  ON 42
 eH2_3                -1.598736e-02 1 1  ON 43
 eH2_4                 1.733601e-02 1 1  ON 44
 eH2_5                 2.121317e-02 1 1  ON 45
 eH2_6                 7.058713e-02 1 1  ON 46
 eH2_7                 1.059935e-01 1 1  ON 47
 eH2_8                 1.046956e-01 1 1  ON 48
 eH2_9                 2.830340e-02 1 1  ON 49
ci_001                -4.234834e-02 3 1  ON 50
ci_002                -3.115752e-02 3 1  ON 51
ci_003                -2.574086e-02 3 1  ON 52
ci_004                 2.449521e-02 3 1  ON 53
ci_005                 2.459946e-02 3 1  ON 54
ci_006                -2.028930e-02 3 1  ON 55
ci_007                -2.042818e-02 3 1  ON 56
ci_008                -8.986239e-03 3 1  ON 57
ci_009                -1.503578e-02 3 1  ON 58
ci_010                -9.450478e-03 3 1  ON 59
ci_011                -1.021780e-02 3 1  ON 60
ci_012                -1.008550e-02 3 1  ON 61
ci_013                -1.953198e-02 3 1  ON 62
ci_014                 1.300253e-02 3 1  ON 63
ci_015                 1.321461e-02 3 1  ON 64
ci_016                 1.641184e-02 3 1  ON 65
ci_017                 1.617549e-02 3 1  ON 66
ci_018                 1.019138e-02 3 1  ON 67
ci_019                 1.038157e-02 3 1  ON 68
ci_020                 1.646491e-02 3 1  ON 69
ci_021                 1.644420e-02 3 1  ON 70
ci_022                 1.057009e-02 3 1  ON 71
ci_023                 9.302357e-03 3 1  ON 72
ci_024                 7.513924e-03 3 1  ON 73
ci_025                 6.087098e-03 3 1  ON 74
ci_026                 1.169026e-02 3 1  ON 75
ci_027                 1.166448e-02 3 1  ON 76
ci_028                -1.519524e-02 3 1  ON 77
ci_029                -1.537216e-02 3 1  ON 78
ci_030                -4.449182e-03 3 1  ON 79
ci_031                -4.861428e-03 3 1  ON 80
ci_032                -1.535542e-02 3 1  ON 81
ci_033                 6.941831e-03 3 1  ON 82
ci_034                 7.336724e-03 3 1  ON 83
ci_035                -4.586123e-03 3 1  ON 84
ci_036                -1.273224e-02 3 1  ON 85
ci_037                -1.278177e-02 3 1  ON 86
ci_038                 1.164081e-03 3 1  ON 87
ci_039                 1.335428e-03 3 1  ON 88
ci_040                -2.704884e-03 3 1  ON 89
ci_041                 8.457577e-03 3 1  ON 90
ci_042                 8.382386e-03 3 1  ON 91
ci_043                -3.617651e-03 3 1  ON 92
ci_044                -4.711721e-03 3 1  ON 93
ci_045                -2.790580e-03 3 1  ON 94
ci_046                 5.835129e-03 3 1  ON 95
ci_047                 5.644799e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.153539
====================================================
  Execution time = 2.7317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8951e-01
  Total weights = 1.9664e+06
  Execution time = 2.2990e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248767426
                                         uncertainty =       0.001832054452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248767426
                                         uncertainty =       0.001832054452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373015857
  error estimate for blocks of size 2^( 2) =       0.000387184219
  error estimate for blocks of size 2^( 3) =       0.000400614566
  error estimate for blocks of size 2^( 4) =       0.000410900600
  error estimate for blocks of size 2^( 5) =       0.000416542909
  error estimate for blocks of size 2^( 6) =       0.000419879347
  error estimate for blocks of size 2^( 7) =       0.000422031397

      target function =      -0.929020197939
              le_mean =     -17.209893902108
             les_mean =     296.469961855916
             stat err =       0.000417338563
             autocorr =       1.251763962718
   target nu stat err =       0.000417338563
   target dn stat err =       0.003579138133
      target stat err =       0.005907399514
              std dev =       0.527532524759
             le_variance =       0.278290564679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248657923
                                         uncertainty =       0.001832040977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248657923
                                         uncertainty =       0.001832040977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373015784
  error estimate for blocks of size 2^( 2) =       0.000387184175
  error estimate for blocks of size 2^( 3) =       0.000400614557
  error estimate for blocks of size 2^( 4) =       0.000410900610
  error estimate for blocks of size 2^( 5) =       0.000416542934
  error estimate for blocks of size 2^( 6) =       0.000419879359
  error estimate for blocks of size 2^( 7) =       0.000422031410

      target function =      -0.929020454017
              le_mean =     -17.209893905519
             les_mean =     296.469961816914
             stat err =       0.000417338578
             autocorr =       1.251764541011
   target nu stat err =       0.000417338578
   target dn stat err =       0.003579136081
      target stat err =       0.005907399453
              std dev =       0.527532421562
             le_variance =       0.278290455799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248712663
                                         uncertainty =       0.001832047714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248712663
                                         uncertainty =       0.001832047714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373015821
  error estimate for blocks of size 2^( 2) =       0.000387184197
  error estimate for blocks of size 2^( 3) =       0.000400614562
  error estimate for blocks of size 2^( 4) =       0.000410900605
  error estimate for blocks of size 2^( 5) =       0.000416542922
  error estimate for blocks of size 2^( 6) =       0.000419879353
  error estimate for blocks of size 2^( 7) =       0.000422031404

      target function =      -0.929020336412
              le_mean =     -17.209893903813
             les_mean =     296.469961830019
             stat err =       0.000417338571
             autocorr =       1.251764251909
   target nu stat err =       0.000417338571
   target dn stat err =       0.003579137096
      target stat err =       0.005907399598
              std dev =       0.527532473150
             le_variance =       0.278290510228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248760580
                                         uncertainty =       0.001832053610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278248760580
                                         uncertainty =       0.001832053610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373015853
  error estimate for blocks of size 2^( 2) =       0.000387184216
  error estimate for blocks of size 2^( 3) =       0.000400614566
  error estimate for blocks of size 2^( 4) =       0.000410900601
  error estimate for blocks of size 2^( 5) =       0.000416542911
  error estimate for blocks of size 2^( 6) =       0.000419879348
  error estimate for blocks of size 2^( 7) =       0.000422031398

      target function =      -0.929020216330
              le_mean =     -17.209893902321
             les_mean =     296.469961852015
             stat err =       0.000417338564
             autocorr =       1.251763998870
   target nu stat err =       0.000417338564
   target dn stat err =       0.003579138002
      target stat err =       0.005907399536
              std dev =       0.527532518307
             le_variance =       0.278290557872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929020197939        initial
     3.8147e+02     3.8147e+03             9.7895e-07        -0.929020454017  <--
     1.5259e+03     1.5259e+04             2.4475e-07        -0.929020336412
     6.1035e+03     6.1035e+04             6.1189e-08        -0.929020216330

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 3.8944e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.084888e-01 1 1  ON 0
  uu_1                 5.267385e-02 1 1  ON 1
  uu_2                -3.672440e-02 1 1  ON 2
  uu_3                -8.985081e-02 1 1  ON 3
  uu_4                -1.217622e-01 1 1  ON 4
  uu_5                -1.312717e-01 1 1  ON 5
  uu_6                -1.137548e-01 1 1  ON 6
  uu_7                -5.646482e-02 1 1  ON 7
  uu_8                 5.948708e-02 1 1  ON 8
  uu_9                 1.220874e-01 1 1  ON 9
  ud_0                 3.006718e-01 1 1  ON 10
  ud_1                 7.340336e-02 1 1  ON 11
  ud_2                -2.594377e-02 1 1  ON 12
  ud_3                -7.709072e-02 1 1  ON 13
  ud_4                -1.122877e-01 1 1  ON 14
  ud_5                -1.317611e-01 1 1  ON 15
  ud_6                -1.269129e-01 1 1  ON 16
  ud_7                -8.780084e-02 1 1  ON 17
  ud_8                -4.232997e-03 1 1  ON 18
  ud_9                 8.491459e-02 1 1  ON 19
  eO_0                -6.932056e-01 1 1  ON 20
  eO_1                -4.132228e-01 1 1  ON 21
  eO_2                -4.142546e-02 1 1  ON 22
  eO_3                 1.783607e-01 1 1  ON 23
  eO_4                 2.499485e-01 1 1  ON 24
  eO_5                 2.747782e-01 1 1  ON 25
  eO_6                 2.477566e-01 1 1  ON 26
  eO_7                 1.370868e-01 1 1  ON 27
  eO_8                 2.907805e-02 1 1  ON 28
  eO_9                 1.941119e-02 1 1  ON 29
 eH1_0                -2.054416e-01 1 1  ON 30
 eH1_1                -1.005071e-01 1 1  ON 31
 eH1_2                -4.948478e-02 1 1  ON 32
 eH1_3                -1.791301e-02 1 1  ON 33
 eH1_4                 1.722480e-02 1 1  ON 34
 eH1_5                 2.532767e-02 1 1  ON 35
 eH1_6                 7.902017e-02 1 1  ON 36
 eH1_7                 1.070408e-01 1 1  ON 37
 eH1_8                 1.027375e-01 1 1  ON 38
 eH1_9                 2.587851e-02 1 1  ON 39
 eH2_0                -2.016935e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657170e-02 1 1  ON 42
 eH2_3                -1.598729e-02 1 1  ON 43
 eH2_4                 1.733580e-02 1 1  ON 44
 eH2_5                 2.121273e-02 1 1  ON 45
 eH2_6                 7.058706e-02 1 1  ON 46
 eH2_7                 1.059933e-01 1 1  ON 47
 eH2_8                 1.046958e-01 1 1  ON 48
 eH2_9                 2.830352e-02 1 1  ON 49
ci_001                -4.234834e-02 3 1  ON 50
ci_002                -3.115751e-02 3 1  ON 51
ci_003                -2.574098e-02 3 1  ON 52
ci_004                 2.449512e-02 3 1  ON 53
ci_005                 2.459954e-02 3 1  ON 54
ci_006                -2.028941e-02 3 1  ON 55
ci_007                -2.042816e-02 3 1  ON 56
ci_008                -8.986220e-03 3 1  ON 57
ci_009                -1.503576e-02 3 1  ON 58
ci_010                -9.450515e-03 3 1  ON 59
ci_011                -1.021790e-02 3 1  ON 60
ci_012                -1.008552e-02 3 1  ON 61
ci_013                -1.953202e-02 3 1  ON 62
ci_014                 1.300232e-02 3 1  ON 63
ci_015                 1.321472e-02 3 1  ON 64
ci_016                 1.641182e-02 3 1  ON 65
ci_017                 1.617555e-02 3 1  ON 66
ci_018                 1.019124e-02 3 1  ON 67
ci_019                 1.038149e-02 3 1  ON 68
ci_020                 1.646503e-02 3 1  ON 69
ci_021                 1.644406e-02 3 1  ON 70
ci_022                 1.056979e-02 3 1  ON 71
ci_023                 9.302603e-03 3 1  ON 72
ci_024                 7.513958e-03 3 1  ON 73
ci_025                 6.087235e-03 3 1  ON 74
ci_026                 1.169025e-02 3 1  ON 75
ci_027                 1.166436e-02 3 1  ON 76
ci_028                -1.519519e-02 3 1  ON 77
ci_029                -1.537238e-02 3 1  ON 78
ci_030                -4.449233e-03 3 1  ON 79
ci_031                -4.861357e-03 3 1  ON 80
ci_032                -1.535531e-02 3 1  ON 81
ci_033                 6.941908e-03 3 1  ON 82
ci_034                 7.336844e-03 3 1  ON 83
ci_035                -4.586186e-03 3 1  ON 84
ci_036                -1.273227e-02 3 1  ON 85
ci_037                -1.278175e-02 3 1  ON 86
ci_038                 1.164053e-03 3 1  ON 87
ci_039                 1.335466e-03 3 1  ON 88
ci_040                -2.704961e-03 3 1  ON 89
ci_041                 8.457630e-03 3 1  ON 90
ci_042                 8.382268e-03 3 1  ON 91
ci_043                -3.617665e-03 3 1  ON 92
ci_044                -4.711725e-03 3 1  ON 93
ci_045                -2.790665e-03 3 1  ON 94
ci_046                 5.835037e-03 3 1  ON 95
ci_047                 5.644897e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1384
    reference variance = 0.240459
====================================================
  Execution time = 2.7458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0465e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8945e-01
  Total weights = 1.966319188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2982e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277967136051
                                         uncertainty =       0.001626232970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277967136051
                                         uncertainty =       0.001626232970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372730374
  error estimate for blocks of size 2^( 2) =       0.000387082916
  error estimate for blocks of size 2^( 3) =       0.000399910067
  error estimate for blocks of size 2^( 4) =       0.000409696478
  error estimate for blocks of size 2^( 5) =       0.000415453514
  error estimate for blocks of size 2^( 6) =       0.000417993576
  error estimate for blocks of size 2^( 7) =       0.000420794215

      target function =      -0.929146289445
              le_mean =     -17.209404435947
             les_mean =     296.453051038272
             stat err =       0.000415984446
             autocorr =       1.245559885857
   target nu stat err =       0.000415984446
   target dn stat err =       0.003374124525
      target stat err =       0.005570413674
              std dev =       0.527128784582
             le_variance =       0.277864755535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720940443595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929178729752       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929179112919       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929179172955       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929179201641       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929179205166       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929179212142       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929179213379       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929179215011       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929179215415       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929179218782       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929179218305       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929179219413       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929179219166       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929179219242       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929179220646       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929179223114       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929179223777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929179227129       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929179226967       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929179228199       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929179226956       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929179228262       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929179228128       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929179228386       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929179228814       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929179228900       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929179228266       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929179228353       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929179227726       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929179227191       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929179227194       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929179227263       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929179227430       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929179227895       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929179228010       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929179227935       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929179227881       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929179227998       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929179227898       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929179227960       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929179227878       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929179227845       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+01 is 4.148145e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929178729752       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929178825602       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929178840618       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929178847793       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929178848675       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929178850420       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929178850729       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929178851138       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929178851238       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929178852080       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929178851961       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929178852238       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929178852176       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929178852195       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929178852546       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929178853164       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929178853330       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929178854167       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929178854126       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929178854435       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929178854124       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929178854451       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929178854416       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929178854480       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929178854587       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929178854609       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929178854450       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929178854474       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929178854317       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929178854184       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929178854185       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929178854201       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929178854242       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929178854359       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929178854388       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929178854369       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929178854356       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929178854384       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929178854358       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929178854376       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929178854354       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929178854347       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+02 is 1.037100e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929178729752       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929178753718       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929178757473       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929178759267       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929178759487       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929178759924       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929178760001       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929178760102       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929178760125       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929178760339       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929178760306       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929178760376       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929178760362       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929178760367       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929178760453       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929178760611       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929178760651       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929178760863       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929178760850       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929178760918       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929178760846       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929178760936       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929178760925       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929178760937       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929178760968       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929178760973       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929178760930       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929178760938       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929178760893       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929178760858       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929178760866       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929178760866       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929178760882       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929178760905       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929178760909       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929178760924       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929178760901       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929178760915       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929178760910       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929178760916       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929178760913       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929178760907       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.5259e+03 is 2.592791e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.563466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5845e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.084892e-01 1 1  ON 0
  uu_1                 5.267405e-02 1 1  ON 1
  uu_2                -3.672417e-02 1 1  ON 2
  uu_3                -8.985062e-02 1 1  ON 3
  uu_4                -1.217622e-01 1 1  ON 4
  uu_5                -1.312716e-01 1 1  ON 5
  uu_6                -1.137549e-01 1 1  ON 6
  uu_7                -5.646518e-02 1 1  ON 7
  uu_8                 5.948604e-02 1 1  ON 8
  uu_9                 1.220873e-01 1 1  ON 9
  ud_0                 3.006716e-01 1 1  ON 10
  ud_1                 7.340321e-02 1 1  ON 11
  ud_2                -2.594379e-02 1 1  ON 12
  ud_3                -7.709065e-02 1 1  ON 13
  ud_4                -1.122876e-01 1 1  ON 14
  ud_5                -1.317611e-01 1 1  ON 15
  ud_6                -1.269129e-01 1 1  ON 16
  ud_7                -8.780040e-02 1 1  ON 17
  ud_8                -4.233553e-03 1 1  ON 18
  ud_9                 8.491438e-02 1 1  ON 19
  eO_0                -6.932053e-01 1 1  ON 20
  eO_1                -4.132228e-01 1 1  ON 21
  eO_2                -4.142573e-02 1 1  ON 22
  eO_3                 1.783605e-01 1 1  ON 23
  eO_4                 2.499481e-01 1 1  ON 24
  eO_5                 2.747779e-01 1 1  ON 25
  eO_6                 2.477568e-01 1 1  ON 26
  eO_7                 1.370874e-01 1 1  ON 27
  eO_8                 2.907802e-02 1 1  ON 28
  eO_9                 1.941124e-02 1 1  ON 29
 eH1_0                -2.054420e-01 1 1  ON 30
 eH1_1                -1.005072e-01 1 1  ON 31
 eH1_2                -4.948442e-02 1 1  ON 32
 eH1_3                -1.791262e-02 1 1  ON 33
 eH1_4                 1.722496e-02 1 1  ON 34
 eH1_5                 2.532734e-02 1 1  ON 35
 eH1_6                 7.901987e-02 1 1  ON 36
 eH1_7                 1.070405e-01 1 1  ON 37
 eH1_8                 1.027378e-01 1 1  ON 38
 eH1_9                 2.587854e-02 1 1  ON 39
 eH2_0                -2.016937e-01 1 1  ON 40
 eH2_1                -9.694466e-02 1 1  ON 41
 eH2_2                -4.657128e-02 1 1  ON 42
 eH2_3                -1.598692e-02 1 1  ON 43
 eH2_4                 1.733562e-02 1 1  ON 44
 eH2_5                 2.121248e-02 1 1  ON 45
 eH2_6                 7.058649e-02 1 1  ON 46
 eH2_7                 1.059932e-01 1 1  ON 47
 eH2_8                 1.046961e-01 1 1  ON 48
 eH2_9                 2.830362e-02 1 1  ON 49
ci_001                -4.234831e-02 3 1  ON 50
ci_002                -3.115761e-02 3 1  ON 51
ci_003                -2.574080e-02 3 1  ON 52
ci_004                 2.449507e-02 3 1  ON 53
ci_005                 2.459960e-02 3 1  ON 54
ci_006                -2.028950e-02 3 1  ON 55
ci_007                -2.042794e-02 3 1  ON 56
ci_008                -8.986340e-03 3 1  ON 57
ci_009                -1.503580e-02 3 1  ON 58
ci_010                -9.450250e-03 3 1  ON 59
ci_011                -1.021788e-02 3 1  ON 60
ci_012                -1.008564e-02 3 1  ON 61
ci_013                -1.953197e-02 3 1  ON 62
ci_014                 1.300251e-02 3 1  ON 63
ci_015                 1.321461e-02 3 1  ON 64
ci_016                 1.641202e-02 3 1  ON 65
ci_017                 1.617558e-02 3 1  ON 66
ci_018                 1.019136e-02 3 1  ON 67
ci_019                 1.038139e-02 3 1  ON 68
ci_020                 1.646503e-02 3 1  ON 69
ci_021                 1.644409e-02 3 1  ON 70
ci_022                 1.056994e-02 3 1  ON 71
ci_023                 9.302778e-03 3 1  ON 72
ci_024                 7.513808e-03 3 1  ON 73
ci_025                 6.087465e-03 3 1  ON 74
ci_026                 1.169024e-02 3 1  ON 75
ci_027                 1.166431e-02 3 1  ON 76
ci_028                -1.519512e-02 3 1  ON 77
ci_029                -1.537250e-02 3 1  ON 78
ci_030                -4.449365e-03 3 1  ON 79
ci_031                -4.860956e-03 3 1  ON 80
ci_032                -1.535534e-02 3 1  ON 81
ci_033                 6.942049e-03 3 1  ON 82
ci_034                 7.336697e-03 3 1  ON 83
ci_035                -4.586192e-03 3 1  ON 84
ci_036                -1.273219e-02 3 1  ON 85
ci_037                -1.278191e-02 3 1  ON 86
ci_038                 1.164200e-03 3 1  ON 87
ci_039                 1.335500e-03 3 1  ON 88
ci_040                -2.705124e-03 3 1  ON 89
ci_041                 8.457645e-03 3 1  ON 90
ci_042                 8.382395e-03 3 1  ON 91
ci_043                -3.617664e-03 3 1  ON 92
ci_044                -4.712040e-03 3 1  ON 93
ci_045                -2.790670e-03 3 1  ON 94
ci_046                 5.835098e-03 3 1  ON 95
ci_047                 5.644641e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.223
    reference variance = 0.133751
====================================================
  Execution time = 2.9324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8505e-01
  Total weights = 1.9662e+06
  Execution time = 2.2992e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398687301
                                         uncertainty =       0.001746060907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398687301
                                         uncertainty =       0.001746060907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372392493
  error estimate for blocks of size 2^( 2) =       0.000386253225
  error estimate for blocks of size 2^( 3) =       0.000398804751
  error estimate for blocks of size 2^( 4) =       0.000408532090
  error estimate for blocks of size 2^( 5) =       0.000414156924
  error estimate for blocks of size 2^( 6) =       0.000417108940
  error estimate for blocks of size 2^( 7) =       0.000418665626

      target function =      -0.936418686278
              le_mean =     -17.209400453858
             les_mean =     296.448516386956
             stat err =       0.000414615895
             autocorr =       1.239624241208
   target nu stat err =       0.000414615895
   target dn stat err =       0.002172877783
      target stat err =       0.003686089521
              std dev =       0.526650939852
             le_variance =       0.277361212447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398584807
                                         uncertainty =       0.001745984163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398584807
                                         uncertainty =       0.001745984163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372392424
  error estimate for blocks of size 2^( 2) =       0.000386253305
  error estimate for blocks of size 2^( 3) =       0.000398804961
  error estimate for blocks of size 2^( 4) =       0.000408532408
  error estimate for blocks of size 2^( 5) =       0.000414157322
  error estimate for blocks of size 2^( 6) =       0.000417109342
  error estimate for blocks of size 2^( 7) =       0.000418666018

      target function =      -0.936424008357
              le_mean =     -17.209400438481
             les_mean =     296.448512656863
             stat err =       0.000414616272
             autocorr =       1.239626955687
   target nu stat err =       0.000414616272
   target dn stat err =       0.002172778862
      target stat err =       0.003685969485
              std dev =       0.526650842886
             le_variance =       0.277361110312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398635943
                                         uncertainty =       0.001746022508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398635943
                                         uncertainty =       0.001746022508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372392458
  error estimate for blocks of size 2^( 2) =       0.000386253265
  error estimate for blocks of size 2^( 3) =       0.000398804856
  error estimate for blocks of size 2^( 4) =       0.000408532249
  error estimate for blocks of size 2^( 5) =       0.000414157123
  error estimate for blocks of size 2^( 6) =       0.000417109141
  error estimate for blocks of size 2^( 7) =       0.000418665822

      target function =      -0.936421545477
              le_mean =     -17.209400446149
             les_mean =     296.448514402004
             stat err =       0.000414616084
             autocorr =       1.239625599169
   target nu stat err =       0.000414616084
   target dn stat err =       0.002172826823
      target stat err =       0.003686028589
              std dev =       0.526650891264
             le_variance =       0.277361161269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398680872
                                         uncertainty =       0.001746056106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277398680872
                                         uncertainty =       0.001746056106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372392488
  error estimate for blocks of size 2^( 2) =       0.000386253230
  error estimate for blocks of size 2^( 3) =       0.000398804764
  error estimate for blocks of size 2^( 4) =       0.000408532110
  error estimate for blocks of size 2^( 5) =       0.000414156948
  error estimate for blocks of size 2^( 6) =       0.000417108965
  error estimate for blocks of size 2^( 7) =       0.000418665650

      target function =      -0.936419067776
              le_mean =     -17.209400452893
             les_mean =     296.448516124274
             stat err =       0.000414615918
             autocorr =       1.239624410979
   target nu stat err =       0.000414615918
   target dn stat err =       0.002172871221
      target stat err =       0.003686081778
              std dev =       0.526650933769
             le_variance =       0.277361206040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936418686278        initial
     9.5367e+01     9.5367e+02             4.1481e-06        -0.936424008357  <--
     3.8147e+02     3.8147e+03             1.0371e-06        -0.936421545477
     1.5259e+03     1.5259e+04             2.5928e-07        -0.936419067776

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 4.0926e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.084903e-01 1 1  ON 0
  uu_1                 5.267466e-02 1 1  ON 1
  uu_2                -3.672349e-02 1 1  ON 2
  uu_3                -8.985006e-02 1 1  ON 3
  uu_4                -1.217619e-01 1 1  ON 4
  uu_5                -1.312713e-01 1 1  ON 5
  uu_6                -1.137551e-01 1 1  ON 6
  uu_7                -5.646628e-02 1 1  ON 7
  uu_8                 5.948293e-02 1 1  ON 8
  uu_9                 1.220870e-01 1 1  ON 9
  ud_0                 3.006708e-01 1 1  ON 10
  ud_1                 7.340276e-02 1 1  ON 11
  ud_2                -2.594383e-02 1 1  ON 12
  ud_3                -7.709045e-02 1 1  ON 13
  ud_4                -1.122875e-01 1 1  ON 14
  ud_5                -1.317608e-01 1 1  ON 15
  ud_6                -1.269128e-01 1 1  ON 16
  ud_7                -8.779907e-02 1 1  ON 17
  ud_8                -4.235220e-03 1 1  ON 18
  ud_9                 8.491375e-02 1 1  ON 19
  eO_0                -6.932045e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142652e-02 1 1  ON 22
  eO_3                 1.783601e-01 1 1  ON 23
  eO_4                 2.499469e-01 1 1  ON 24
  eO_5                 2.747768e-01 1 1  ON 25
  eO_6                 2.477576e-01 1 1  ON 26
  eO_7                 1.370892e-01 1 1  ON 27
  eO_8                 2.907791e-02 1 1  ON 28
  eO_9                 1.941140e-02 1 1  ON 29
 eH1_0                -2.054430e-01 1 1  ON 30
 eH1_1                -1.005074e-01 1 1  ON 31
 eH1_2                -4.948336e-02 1 1  ON 32
 eH1_3                -1.791147e-02 1 1  ON 33
 eH1_4                 1.722544e-02 1 1  ON 34
 eH1_5                 2.532635e-02 1 1  ON 35
 eH1_6                 7.901898e-02 1 1  ON 36
 eH1_7                 1.070397e-01 1 1  ON 37
 eH1_8                 1.027389e-01 1 1  ON 38
 eH1_9                 2.587862e-02 1 1  ON 39
 eH2_0                -2.016944e-01 1 1  ON 40
 eH2_1                -9.694435e-02 1 1  ON 41
 eH2_2                -4.657003e-02 1 1  ON 42
 eH2_3                -1.598580e-02 1 1  ON 43
 eH2_4                 1.733506e-02 1 1  ON 44
 eH2_5                 2.121173e-02 1 1  ON 45
 eH2_6                 7.058480e-02 1 1  ON 46
 eH2_7                 1.059930e-01 1 1  ON 47
 eH2_8                 1.046969e-01 1 1  ON 48
 eH2_9                 2.830391e-02 1 1  ON 49
ci_001                -4.234822e-02 3 1  ON 50
ci_002                -3.115791e-02 3 1  ON 51
ci_003                -2.574029e-02 3 1  ON 52
ci_004                 2.449494e-02 3 1  ON 53
ci_005                 2.459977e-02 3 1  ON 54
ci_006                -2.028976e-02 3 1  ON 55
ci_007                -2.042727e-02 3 1  ON 56
ci_008                -8.986701e-03 3 1  ON 57
ci_009                -1.503591e-02 3 1  ON 58
ci_010                -9.449454e-03 3 1  ON 59
ci_011                -1.021782e-02 3 1  ON 60
ci_012                -1.008598e-02 3 1  ON 61
ci_013                -1.953179e-02 3 1  ON 62
ci_014                 1.300308e-02 3 1  ON 63
ci_015                 1.321428e-02 3 1  ON 64
ci_016                 1.641262e-02 3 1  ON 65
ci_017                 1.617568e-02 3 1  ON 66
ci_018                 1.019172e-02 3 1  ON 67
ci_019                 1.038110e-02 3 1  ON 68
ci_020                 1.646502e-02 3 1  ON 69
ci_021                 1.644416e-02 3 1  ON 70
ci_022                 1.057040e-02 3 1  ON 71
ci_023                 9.303302e-03 3 1  ON 72
ci_024                 7.513359e-03 3 1  ON 73
ci_025                 6.088153e-03 3 1  ON 74
ci_026                 1.169022e-02 3 1  ON 75
ci_027                 1.166414e-02 3 1  ON 76
ci_028                -1.519491e-02 3 1  ON 77
ci_029                -1.537287e-02 3 1  ON 78
ci_030                -4.449760e-03 3 1  ON 79
ci_031                -4.859754e-03 3 1  ON 80
ci_032                -1.535544e-02 3 1  ON 81
ci_033                 6.942473e-03 3 1  ON 82
ci_034                 7.336257e-03 3 1  ON 83
ci_035                -4.586208e-03 3 1  ON 84
ci_036                -1.273194e-02 3 1  ON 85
ci_037                -1.278238e-02 3 1  ON 86
ci_038                 1.164641e-03 3 1  ON 87
ci_039                 1.335605e-03 3 1  ON 88
ci_040                -2.705614e-03 3 1  ON 89
ci_041                 8.457691e-03 3 1  ON 90
ci_042                 8.382778e-03 3 1  ON 91
ci_043                -3.617659e-03 3 1  ON 92
ci_044                -4.712984e-03 3 1  ON 93
ci_045                -2.790685e-03 3 1  ON 94
ci_046                 5.835281e-03 3 1  ON 95
ci_047                 5.643875e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.09
    reference variance = 0.509294
====================================================
  Execution time = 2.7224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8415e-01
  Total weights = 1.966376838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2471e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601451759
                                         uncertainty =       0.001472734298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275601451759
                                         uncertainty =       0.001472734298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371156393
  error estimate for blocks of size 2^( 2) =       0.000385426928
  error estimate for blocks of size 2^( 3) =       0.000398695595
  error estimate for blocks of size 2^( 4) =       0.000407908050
  error estimate for blocks of size 2^( 5) =       0.000413738793
  error estimate for blocks of size 2^( 6) =       0.000416479671
  error estimate for blocks of size 2^( 7) =       0.000416716804

      target function =      -0.937902637940
              le_mean =     -17.210314721303
             les_mean =     296.479084949399
             stat err =       0.000413710830
             autocorr =       1.242452768478
   target nu stat err =       0.000413710830
   target dn stat err =       0.001881569969
      target stat err =       0.003228208171
              std dev =       0.524902802830
             le_variance =       0.275522952419


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721031472130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937912771627       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937914236449       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937914538412       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937914584182       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937914597029       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937914612184       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937914606453       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937914626555       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937914627697       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937914628226       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937914631416       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937914635163       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937914634606       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937914646795       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937914653849       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937914653085       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937914658005       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937914661800       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937914660965       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937914668860       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937914667693       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937914664742       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937914673164       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937914675880       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937914676299       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937914676660       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937914676207       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937914676274       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937914676517       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937914676589       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937914677029       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937914677805       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937914677804       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937914677366       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937914677113       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937914677742       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937914677703       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937914677398       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937914676989       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937914676686       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937914676542       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+01 is 1.747409e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937912771627       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937913138742       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937913214363       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937913225816       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937913229037       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937913232825       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937913231391       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937913236429       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937913236708       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937913236841       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937913237642       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937913238580       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937913238443       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937913241488       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937913243257       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937913243063       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937913244293       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937913245245       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937913245038       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937913247011       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937913246716       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937913245978       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937913248086       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937913248761       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937913248865       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937913248954       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937913248840       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937913248857       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937913248917       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937913248936       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937913249046       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937913249239       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937913249239       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937913249129       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937913249066       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937913249223       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937913249213       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937913249136       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937913249035       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937913248960       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937913248924       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+01 is 4.369626e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937912771627       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937912863463       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937912882376       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937912885240       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937912886046       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937912886992       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937912886635       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937912887895       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937912887964       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937912887997       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937912888198       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937912888432       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937912888398       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937912889159       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937912889602       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937912889553       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937912889861       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937912890099       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937912890047       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937912890541       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937912890467       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937912890282       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937912890809       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937912890979       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937912891004       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937912891027       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937912890998       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937912891002       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937912891016       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937912891019       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937912891048       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937912891098       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937912891096       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937912891071       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937912891053       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937912891092       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937912891090       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937912891071       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937912891048       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937912891024       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937912891017       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+02 is 1.092475e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.638662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5553e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.084905e-01 1 1  ON 0
  uu_1                 5.267471e-02 1 1  ON 1
  uu_2                -3.672289e-02 1 1  ON 2
  uu_3                -8.984941e-02 1 1  ON 3
  uu_4                -1.217610e-01 1 1  ON 4
  uu_5                -1.312695e-01 1 1  ON 5
  uu_6                -1.137542e-01 1 1  ON 6
  uu_7                -5.646825e-02 1 1  ON 7
  uu_8                 5.947856e-02 1 1  ON 8
  uu_9                 1.220872e-01 1 1  ON 9
  ud_0                 3.006698e-01 1 1  ON 10
  ud_1                 7.340179e-02 1 1  ON 11
  ud_2                -2.594438e-02 1 1  ON 12
  ud_3                -7.709043e-02 1 1  ON 13
  ud_4                -1.122873e-01 1 1  ON 14
  ud_5                -1.317603e-01 1 1  ON 15
  ud_6                -1.269120e-01 1 1  ON 16
  ud_7                -8.779615e-02 1 1  ON 17
  ud_8                -4.237308e-03 1 1  ON 18
  ud_9                 8.491274e-02 1 1  ON 19
  eO_0                -6.932032e-01 1 1  ON 20
  eO_1                -4.132219e-01 1 1  ON 21
  eO_2                -4.142735e-02 1 1  ON 22
  eO_3                 1.783589e-01 1 1  ON 23
  eO_4                 2.499456e-01 1 1  ON 24
  eO_5                 2.747747e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370915e-01 1 1  ON 27
  eO_8                 2.907800e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054428e-01 1 1  ON 30
 eH1_1                -1.005061e-01 1 1  ON 31
 eH1_2                -4.948182e-02 1 1  ON 32
 eH1_3                -1.791079e-02 1 1  ON 33
 eH1_4                 1.722456e-02 1 1  ON 34
 eH1_5                 2.532382e-02 1 1  ON 35
 eH1_6                 7.901823e-02 1 1  ON 36
 eH1_7                 1.070391e-01 1 1  ON 37
 eH1_8                 1.027399e-01 1 1  ON 38
 eH1_9                 2.587867e-02 1 1  ON 39
 eH2_0                -2.016954e-01 1 1  ON 40
 eH2_1                -9.694521e-02 1 1  ON 41
 eH2_2                -4.657035e-02 1 1  ON 42
 eH2_3                -1.598640e-02 1 1  ON 43
 eH2_4                 1.733410e-02 1 1  ON 44
 eH2_5                 2.121237e-02 1 1  ON 45
 eH2_6                 7.058597e-02 1 1  ON 46
 eH2_7                 1.059927e-01 1 1  ON 47
 eH2_8                 1.046988e-01 1 1  ON 48
 eH2_9                 2.830420e-02 1 1  ON 49
ci_001                -4.234858e-02 3 1  ON 50
ci_002                -3.115790e-02 3 1  ON 51
ci_003                -2.574020e-02 3 1  ON 52
ci_004                 2.449533e-02 3 1  ON 53
ci_005                 2.459978e-02 3 1  ON 54
ci_006                -2.028961e-02 3 1  ON 55
ci_007                -2.042768e-02 3 1  ON 56
ci_008                -8.986333e-03 3 1  ON 57
ci_009                -1.503611e-02 3 1  ON 58
ci_010                -9.449880e-03 3 1  ON 59
ci_011                -1.021791e-02 3 1  ON 60
ci_012                -1.008584e-02 3 1  ON 61
ci_013                -1.953200e-02 3 1  ON 62
ci_014                 1.300370e-02 3 1  ON 63
ci_015                 1.321422e-02 3 1  ON 64
ci_016                 1.641274e-02 3 1  ON 65
ci_017                 1.617596e-02 3 1  ON 66
ci_018                 1.019128e-02 3 1  ON 67
ci_019                 1.038118e-02 3 1  ON 68
ci_020                 1.646507e-02 3 1  ON 69
ci_021                 1.644514e-02 3 1  ON 70
ci_022                 1.057083e-02 3 1  ON 71
ci_023                 9.304964e-03 3 1  ON 72
ci_024                 7.512318e-03 3 1  ON 73
ci_025                 6.089773e-03 3 1  ON 74
ci_026                 1.169008e-02 3 1  ON 75
ci_027                 1.166337e-02 3 1  ON 76
ci_028                -1.519535e-02 3 1  ON 77
ci_029                -1.537172e-02 3 1  ON 78
ci_030                -4.450102e-03 3 1  ON 79
ci_031                -4.859546e-03 3 1  ON 80
ci_032                -1.535533e-02 3 1  ON 81
ci_033                 6.941794e-03 3 1  ON 82
ci_034                 7.334580e-03 3 1  ON 83
ci_035                -4.586471e-03 3 1  ON 84
ci_036                -1.273089e-02 3 1  ON 85
ci_037                -1.278233e-02 3 1  ON 86
ci_038                 1.164486e-03 3 1  ON 87
ci_039                 1.335630e-03 3 1  ON 88
ci_040                -2.706119e-03 3 1  ON 89
ci_041                 8.456659e-03 3 1  ON 90
ci_042                 8.382254e-03 3 1  ON 91
ci_043                -3.618006e-03 3 1  ON 92
ci_044                -4.712938e-03 3 1  ON 93
ci_045                -2.790688e-03 3 1  ON 94
ci_046                 5.834929e-03 3 1  ON 95
ci_047                 5.643672e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1718
    reference variance = 0.534535
====================================================
  Execution time = 2.7027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9519e-01
  Total weights = 1.9664e+06
  Execution time = 2.2936e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879288141
                                         uncertainty =       0.002268465845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879288141
                                         uncertainty =       0.002268465845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376058459
  error estimate for blocks of size 2^( 2) =       0.000390492675
  error estimate for blocks of size 2^( 3) =       0.000403880753
  error estimate for blocks of size 2^( 4) =       0.000413567790
  error estimate for blocks of size 2^( 5) =       0.000419603512
  error estimate for blocks of size 2^( 6) =       0.000422254790
  error estimate for blocks of size 2^( 7) =       0.000425098668

      target function =      -0.919839193065
              le_mean =     -17.209544679723
             les_mean =     296.463618007100
             stat err =       0.000420131190
             autocorr =       1.248127996343
   target nu stat err =       0.000420131190
   target dn stat err =       0.003419192728
      target stat err =       0.005534416643
              std dev =       0.531835481484
             le_variance =       0.282848979365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282878948503
                                         uncertainty =       0.002268821276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282878948503
                                         uncertainty =       0.002268821276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376058222
  error estimate for blocks of size 2^( 2) =       0.000390492876
  error estimate for blocks of size 2^( 3) =       0.000403881473
  error estimate for blocks of size 2^( 4) =       0.000413568849
  error estimate for blocks of size 2^( 5) =       0.000419604728
  error estimate for blocks of size 2^( 6) =       0.000422256138
  error estimate for blocks of size 2^( 7) =       0.000425100443

      target function =      -0.919838789715
              le_mean =     -17.209544717502
             les_mean =     296.463619565593
             stat err =       0.000420132539
             autocorr =       1.248137588182
   target nu stat err =       0.000420132539
   target dn stat err =       0.003418524495
      target stat err =       0.005533349804
              std dev =       0.531835146517
             le_variance =       0.282848623071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879116549
                                         uncertainty =       0.002268643926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879116549
                                         uncertainty =       0.002268643926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376058339
  error estimate for blocks of size 2^( 2) =       0.000390492775
  error estimate for blocks of size 2^( 3) =       0.000403881113
  error estimate for blocks of size 2^( 4) =       0.000413568320
  error estimate for blocks of size 2^( 5) =       0.000419604120
  error estimate for blocks of size 2^( 6) =       0.000422255464
  error estimate for blocks of size 2^( 7) =       0.000425099556

      target function =      -0.919839053034
              le_mean =     -17.209544698470
             les_mean =     296.463618743061
             stat err =       0.000420131865
             autocorr =       1.248132802678
   target nu stat err =       0.000420131865
   target dn stat err =       0.003418856141
      target stat err =       0.005533880029
              std dev =       0.531835312317
             le_variance =       0.282848799427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879266518
                                         uncertainty =       0.002268488115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282879266518
                                         uncertainty =       0.002268488115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376058443
  error estimate for blocks of size 2^( 2) =       0.000390492688
  error estimate for blocks of size 2^( 3) =       0.000403880798
  error estimate for blocks of size 2^( 4) =       0.000413567856
  error estimate for blocks of size 2^( 5) =       0.000419603588
  error estimate for blocks of size 2^( 6) =       0.000422254874
  error estimate for blocks of size 2^( 7) =       0.000425098779

      target function =      -0.919839182331
              le_mean =     -17.209544682047
             les_mean =     296.463618094208
             stat err =       0.000420131274
             autocorr =       1.248128597486
   target nu stat err =       0.000420131274
   target dn stat err =       0.003419150447
      target stat err =       0.005534349317
              std dev =       0.531835460173
             le_variance =       0.282848956698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919839193065        initial  <--
     2.3842e+01     2.3842e+02             1.7474e-05        -0.919838789715
     9.5367e+01     9.5367e+02             4.3696e-06        -0.919839053034
     3.8147e+02     3.8147e+03             1.0925e-06        -0.919839182331

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6174
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.084903e-01 1 1  ON 0
  uu_1                 5.267466e-02 1 1  ON 1
  uu_2                -3.672349e-02 1 1  ON 2
  uu_3                -8.985006e-02 1 1  ON 3
  uu_4                -1.217619e-01 1 1  ON 4
  uu_5                -1.312713e-01 1 1  ON 5
  uu_6                -1.137551e-01 1 1  ON 6
  uu_7                -5.646628e-02 1 1  ON 7
  uu_8                 5.948293e-02 1 1  ON 8
  uu_9                 1.220870e-01 1 1  ON 9
  ud_0                 3.006708e-01 1 1  ON 10
  ud_1                 7.340276e-02 1 1  ON 11
  ud_2                -2.594383e-02 1 1  ON 12
  ud_3                -7.709045e-02 1 1  ON 13
  ud_4                -1.122875e-01 1 1  ON 14
  ud_5                -1.317608e-01 1 1  ON 15
  ud_6                -1.269128e-01 1 1  ON 16
  ud_7                -8.779907e-02 1 1  ON 17
  ud_8                -4.235220e-03 1 1  ON 18
  ud_9                 8.491375e-02 1 1  ON 19
  eO_0                -6.932045e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142652e-02 1 1  ON 22
  eO_3                 1.783601e-01 1 1  ON 23
  eO_4                 2.499469e-01 1 1  ON 24
  eO_5                 2.747768e-01 1 1  ON 25
  eO_6                 2.477576e-01 1 1  ON 26
  eO_7                 1.370892e-01 1 1  ON 27
  eO_8                 2.907791e-02 1 1  ON 28
  eO_9                 1.941140e-02 1 1  ON 29
 eH1_0                -2.054430e-01 1 1  ON 30
 eH1_1                -1.005074e-01 1 1  ON 31
 eH1_2                -4.948336e-02 1 1  ON 32
 eH1_3                -1.791147e-02 1 1  ON 33
 eH1_4                 1.722544e-02 1 1  ON 34
 eH1_5                 2.532635e-02 1 1  ON 35
 eH1_6                 7.901898e-02 1 1  ON 36
 eH1_7                 1.070397e-01 1 1  ON 37
 eH1_8                 1.027389e-01 1 1  ON 38
 eH1_9                 2.587862e-02 1 1  ON 39
 eH2_0                -2.016944e-01 1 1  ON 40
 eH2_1                -9.694435e-02 1 1  ON 41
 eH2_2                -4.657003e-02 1 1  ON 42
 eH2_3                -1.598580e-02 1 1  ON 43
 eH2_4                 1.733506e-02 1 1  ON 44
 eH2_5                 2.121173e-02 1 1  ON 45
 eH2_6                 7.058480e-02 1 1  ON 46
 eH2_7                 1.059930e-01 1 1  ON 47
 eH2_8                 1.046969e-01 1 1  ON 48
 eH2_9                 2.830391e-02 1 1  ON 49
ci_001                -4.234822e-02 3 1  ON 50
ci_002                -3.115791e-02 3 1  ON 51
ci_003                -2.574029e-02 3 1  ON 52
ci_004                 2.449494e-02 3 1  ON 53
ci_005                 2.459977e-02 3 1  ON 54
ci_006                -2.028976e-02 3 1  ON 55
ci_007                -2.042727e-02 3 1  ON 56
ci_008                -8.986701e-03 3 1  ON 57
ci_009                -1.503591e-02 3 1  ON 58
ci_010                -9.449454e-03 3 1  ON 59
ci_011                -1.021782e-02 3 1  ON 60
ci_012                -1.008598e-02 3 1  ON 61
ci_013                -1.953179e-02 3 1  ON 62
ci_014                 1.300308e-02 3 1  ON 63
ci_015                 1.321428e-02 3 1  ON 64
ci_016                 1.641262e-02 3 1  ON 65
ci_017                 1.617568e-02 3 1  ON 66
ci_018                 1.019172e-02 3 1  ON 67
ci_019                 1.038110e-02 3 1  ON 68
ci_020                 1.646502e-02 3 1  ON 69
ci_021                 1.644416e-02 3 1  ON 70
ci_022                 1.057040e-02 3 1  ON 71
ci_023                 9.303302e-03 3 1  ON 72
ci_024                 7.513359e-03 3 1  ON 73
ci_025                 6.088153e-03 3 1  ON 74
ci_026                 1.169022e-02 3 1  ON 75
ci_027                 1.166414e-02 3 1  ON 76
ci_028                -1.519491e-02 3 1  ON 77
ci_029                -1.537287e-02 3 1  ON 78
ci_030                -4.449760e-03 3 1  ON 79
ci_031                -4.859754e-03 3 1  ON 80
ci_032                -1.535544e-02 3 1  ON 81
ci_033                 6.942473e-03 3 1  ON 82
ci_034                 7.336257e-03 3 1  ON 83
ci_035                -4.586208e-03 3 1  ON 84
ci_036                -1.273194e-02 3 1  ON 85
ci_037                -1.278238e-02 3 1  ON 86
ci_038                 1.164641e-03 3 1  ON 87
ci_039                 1.335605e-03 3 1  ON 88
ci_040                -2.705614e-03 3 1  ON 89
ci_041                 8.457691e-03 3 1  ON 90
ci_042                 8.382778e-03 3 1  ON 91
ci_043                -3.617659e-03 3 1  ON 92
ci_044                -4.712984e-03 3 1  ON 93
ci_045                -2.790685e-03 3 1  ON 94
ci_046                 5.835281e-03 3 1  ON 95
ci_047                 5.643875e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1282
    reference variance = 0.280861
====================================================
  Execution time = 2.7296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0495e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8512e-01
  Total weights = 1.966517175e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1712e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275584159444
                                         uncertainty =       0.001724968269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275584159444
                                         uncertainty =       0.001724968269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371177720
  error estimate for blocks of size 2^( 2) =       0.000385601309
  error estimate for blocks of size 2^( 3) =       0.000398858559
  error estimate for blocks of size 2^( 4) =       0.000407793906
  error estimate for blocks of size 2^( 5) =       0.000413779527
  error estimate for blocks of size 2^( 6) =       0.000416435693
  error estimate for blocks of size 2^( 7) =       0.000418647994

      target function =      -0.936291462314
              le_mean =     -17.209830994760
             les_mean =     296.463403094565
             stat err =       0.000414164280
             autocorr =       1.245034766498
   target nu stat err =       0.000414164280
   target dn stat err =       0.002535485624
      target stat err =       0.004280623315
              std dev =       0.524932965101
             le_variance =       0.275554617850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720983099476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936309954390       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936310124003       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936310140314       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936310149626       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936310152370       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936310153153       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936310153336       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936310153504       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936310154718       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936310156367       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936310157203       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936310158177       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936310160039       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936310160641       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936310161513       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936310161625       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936310161548       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936310161722       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936310161740       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936310161420       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936310161889       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936310162199       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936310161826       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936310161810       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936310161752       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936310161810       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936310161820       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936310161974       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936310162047       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936310162026       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936310162042       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936310161957       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936310161988       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936310161936       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936310162017       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936310161991       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936310161960       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936310161962       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936310161977       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936310161994       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936310162003       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936310162010       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936310162009       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+02 is 1.791824e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936309954390       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936309996804       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936310000882       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936310003210       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936310003897       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936310004092       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936310004138       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936310004180       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936310004484       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936310004896       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936310005105       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936310005351       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936310005815       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936310005964       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936310006181       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936310006209       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936310006193       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936310006236       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936310006239       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936310006160       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936310006278       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936310006354       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936310006260       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936310006254       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936310006241       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936310006258       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936310006258       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936310006297       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936310006317       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936310006308       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936310006318       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936310006292       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936310006304       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936310006286       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936310006312       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936310006303       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936310006298       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936310006294       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936310006294       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936310006302       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936310006303       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936310006305       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936310006309       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+02 is 4.479676e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936309954390       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936309964994       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936309966014       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936309966596       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936309966764       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936309966817       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936309966819       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936309966843       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936309966903       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936309967017       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936309967069       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936309967128       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936309967236       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936309967288       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936309967342       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936309967350       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936309967346       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936309967367       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936309967356       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936309967348       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936309967356       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936309967390       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936309967356       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936309967346       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936309967338       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936309967356       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936309967362       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936309967352       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936309967360       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936309967370       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936309967372       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936309967376       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936309967379       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936309967365       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936309967368       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936309967376       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936309967375       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936309967367       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936309967363       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936309967370       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936309967354       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936309967369       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936309967365       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.8147e+03 is 1.119926e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.722593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5559e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.084904e-01 1 1  ON 0
  uu_1                 5.267472e-02 1 1  ON 1
  uu_2                -3.672344e-02 1 1  ON 2
  uu_3                -8.985001e-02 1 1  ON 3
  uu_4                -1.217619e-01 1 1  ON 4
  uu_5                -1.312713e-01 1 1  ON 5
  uu_6                -1.137551e-01 1 1  ON 6
  uu_7                -5.646635e-02 1 1  ON 7
  uu_8                 5.948248e-02 1 1  ON 8
  uu_9                 1.220870e-01 1 1  ON 9
  ud_0                 3.006707e-01 1 1  ON 10
  ud_1                 7.340261e-02 1 1  ON 11
  ud_2                -2.594396e-02 1 1  ON 12
  ud_3                -7.709058e-02 1 1  ON 13
  ud_4                -1.122876e-01 1 1  ON 14
  ud_5                -1.317608e-01 1 1  ON 15
  ud_6                -1.269127e-01 1 1  ON 16
  ud_7                -8.779868e-02 1 1  ON 17
  ud_8                -4.235277e-03 1 1  ON 18
  ud_9                 8.491374e-02 1 1  ON 19
  eO_0                -6.932045e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142653e-02 1 1  ON 22
  eO_3                 1.783600e-01 1 1  ON 23
  eO_4                 2.499467e-01 1 1  ON 24
  eO_5                 2.747765e-01 1 1  ON 25
  eO_6                 2.477578e-01 1 1  ON 26
  eO_7                 1.370895e-01 1 1  ON 27
  eO_8                 2.907797e-02 1 1  ON 28
  eO_9                 1.941141e-02 1 1  ON 29
 eH1_0                -2.054430e-01 1 1  ON 30
 eH1_1                -1.005072e-01 1 1  ON 31
 eH1_2                -4.948330e-02 1 1  ON 32
 eH1_3                -1.791147e-02 1 1  ON 33
 eH1_4                 1.722537e-02 1 1  ON 34
 eH1_5                 2.532627e-02 1 1  ON 35
 eH1_6                 7.901860e-02 1 1  ON 36
 eH1_7                 1.070398e-01 1 1  ON 37
 eH1_8                 1.027390e-01 1 1  ON 38
 eH1_9                 2.587867e-02 1 1  ON 39
 eH2_0                -2.016946e-01 1 1  ON 40
 eH2_1                -9.694445e-02 1 1  ON 41
 eH2_2                -4.657005e-02 1 1  ON 42
 eH2_3                -1.598582e-02 1 1  ON 43
 eH2_4                 1.733501e-02 1 1  ON 44
 eH2_5                 2.121188e-02 1 1  ON 45
 eH2_6                 7.058491e-02 1 1  ON 46
 eH2_7                 1.059929e-01 1 1  ON 47
 eH2_8                 1.046971e-01 1 1  ON 48
 eH2_9                 2.830394e-02 1 1  ON 49
ci_001                -4.234821e-02 3 1  ON 50
ci_002                -3.115785e-02 3 1  ON 51
ci_003                -2.574030e-02 3 1  ON 52
ci_004                 2.449490e-02 3 1  ON 53
ci_005                 2.459974e-02 3 1  ON 54
ci_006                -2.028978e-02 3 1  ON 55
ci_007                -2.042723e-02 3 1  ON 56
ci_008                -8.986663e-03 3 1  ON 57
ci_009                -1.503576e-02 3 1  ON 58
ci_010                -9.449366e-03 3 1  ON 59
ci_011                -1.021790e-02 3 1  ON 60
ci_012                -1.008593e-02 3 1  ON 61
ci_013                -1.953185e-02 3 1  ON 62
ci_014                 1.300318e-02 3 1  ON 63
ci_015                 1.321425e-02 3 1  ON 64
ci_016                 1.641266e-02 3 1  ON 65
ci_017                 1.617572e-02 3 1  ON 66
ci_018                 1.019158e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646513e-02 3 1  ON 69
ci_021                 1.644425e-02 3 1  ON 70
ci_022                 1.057042e-02 3 1  ON 71
ci_023                 9.303383e-03 3 1  ON 72
ci_024                 7.513408e-03 3 1  ON 73
ci_025                 6.088129e-03 3 1  ON 74
ci_026                 1.169019e-02 3 1  ON 75
ci_027                 1.166408e-02 3 1  ON 76
ci_028                -1.519484e-02 3 1  ON 77
ci_029                -1.537291e-02 3 1  ON 78
ci_030                -4.449652e-03 3 1  ON 79
ci_031                -4.859775e-03 3 1  ON 80
ci_032                -1.535537e-02 3 1  ON 81
ci_033                 6.942451e-03 3 1  ON 82
ci_034                 7.336200e-03 3 1  ON 83
ci_035                -4.586174e-03 3 1  ON 84
ci_036                -1.273196e-02 3 1  ON 85
ci_037                -1.278231e-02 3 1  ON 86
ci_038                 1.164714e-03 3 1  ON 87
ci_039                 1.335633e-03 3 1  ON 88
ci_040                -2.705611e-03 3 1  ON 89
ci_041                 8.457648e-03 3 1  ON 90
ci_042                 8.382772e-03 3 1  ON 91
ci_043                -3.617693e-03 3 1  ON 92
ci_044                -4.712897e-03 3 1  ON 93
ci_045                -2.790653e-03 3 1  ON 94
ci_046                 5.835306e-03 3 1  ON 95
ci_047                 5.643894e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.3143
    reference variance = 0.325241
====================================================
  Execution time = 2.6991e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8853e-01
  Total weights = 1.9664e+06
  Execution time = 2.2904e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522638576
                                         uncertainty =       0.001983881996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522638576
                                         uncertainty =       0.001983881996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373255951
  error estimate for blocks of size 2^( 2) =       0.000387560306
  error estimate for blocks of size 2^( 3) =       0.000400558329
  error estimate for blocks of size 2^( 4) =       0.000409402710
  error estimate for blocks of size 2^( 5) =       0.000415417570
  error estimate for blocks of size 2^( 6) =       0.000419324366
  error estimate for blocks of size 2^( 7) =       0.000420488679

      target function =      -0.930682983264
              le_mean =     -17.209012806796
             les_mean =     296.438650089582
             stat err =       0.000416158331
             autocorr =       1.243093240804
   target nu stat err =       0.000416158331
   target dn stat err =       0.002588236702
      target stat err =       0.004309566878
              std dev =       0.527872073891
             le_variance =       0.278648926394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522613428
                                         uncertainty =       0.001983869064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522613428
                                         uncertainty =       0.001983869064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373255934
  error estimate for blocks of size 2^( 2) =       0.000387560345
  error estimate for blocks of size 2^( 3) =       0.000400558424
  error estimate for blocks of size 2^( 4) =       0.000409402844
  error estimate for blocks of size 2^( 5) =       0.000415417723
  error estimate for blocks of size 2^( 6) =       0.000419324526
  error estimate for blocks of size 2^( 7) =       0.000420488885

      target function =      -0.930683793493
              le_mean =     -17.209012805377
             les_mean =     296.438649547517
             stat err =       0.000416158495
             autocorr =       1.243094330963
   target nu stat err =       0.000416158495
   target dn stat err =       0.002588175245
      target stat err =       0.004309474942
              std dev =       0.527872049874
             le_variance =       0.278648901038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522625986
                                         uncertainty =       0.001983875528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522625986
                                         uncertainty =       0.001983875528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373255942
  error estimate for blocks of size 2^( 2) =       0.000387560325
  error estimate for blocks of size 2^( 3) =       0.000400558376
  error estimate for blocks of size 2^( 4) =       0.000409402777
  error estimate for blocks of size 2^( 5) =       0.000415417646
  error estimate for blocks of size 2^( 6) =       0.000419324446
  error estimate for blocks of size 2^( 7) =       0.000420488782

      target function =      -0.930683393223
              le_mean =     -17.209012806084
             les_mean =     296.438649815521
             stat err =       0.000416158413
             autocorr =       1.243093786007
   target nu stat err =       0.000416158413
   target dn stat err =       0.002588205939
      target stat err =       0.004309520899
              std dev =       0.527872061867
             le_variance =       0.278648913700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522637001
                                         uncertainty =       0.001983881188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278522637001
                                         uncertainty =       0.001983881188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373255950
  error estimate for blocks of size 2^( 2) =       0.000387560309
  error estimate for blocks of size 2^( 3) =       0.000400558335
  error estimate for blocks of size 2^( 4) =       0.000409402718
  error estimate for blocks of size 2^( 5) =       0.000415417579
  error estimate for blocks of size 2^( 6) =       0.000419324376
  error estimate for blocks of size 2^( 7) =       0.000420488692

      target function =      -0.930683035042
              le_mean =     -17.209012806706
             les_mean =     296.438650054991
             stat err =       0.000416158341
             autocorr =       1.243093308962
   target nu stat err =       0.000416158341
   target dn stat err =       0.002588232853
      target stat err =       0.004309561130
              std dev =       0.527872072387
             le_variance =       0.278648924806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930682983264        initial
     2.3842e+02     2.3842e+03             1.7918e-06        -0.930683793493  <--
     9.5367e+02     9.5367e+03             4.4797e-07        -0.930683393223
     3.8147e+03     3.8147e+04             1.1199e-07        -0.930683035042

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 3.8578e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340217e-02 1 1  ON 11
  ud_2                -2.594435e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779753e-02 1 1  ON 17
  ud_8                -4.235450e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142653e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901745e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830400e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303625e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088056e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449330e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942384e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712634e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643952e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4143e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1558
    reference variance = 0.200711
====================================================
  Execution time = 2.7221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8328e-01
  Total weights = 1.966453825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2632e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275033924596
                                         uncertainty =       0.001450510424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275033924596
                                         uncertainty =       0.001450510424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370785635
  error estimate for blocks of size 2^( 2) =       0.000385011074
  error estimate for blocks of size 2^( 3) =       0.000397960496
  error estimate for blocks of size 2^( 4) =       0.000407617613
  error estimate for blocks of size 2^( 5) =       0.000414022554
  error estimate for blocks of size 2^( 6) =       0.000416409806
  error estimate for blocks of size 2^( 7) =       0.000416797384

      target function =      -0.939360715593
              le_mean =     -17.210003273118
             les_mean =     296.467496646016
             stat err =       0.000413711839
             autocorr =       1.244944806356
   target nu stat err =       0.000413711839
   target dn stat err =       0.001894989636
      target stat err =       0.003257963843
              std dev =       0.524378463612
             le_variance =       0.274972773100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721000327312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939370951428       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939371223274       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939371287086       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939371300930       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939371315318       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939371316198       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939371321180       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939371327798       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939371331892       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939371339360       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939371339932       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939371344635       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939371347296       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939371352802       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939371356438       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939371356094       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939371358641       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939371359839       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939371359096       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939371359229       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939371360869       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939371362081       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939371363319       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939371364989       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939371363667       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939371362881       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939371364414       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939371363574       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939371363490       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939371363789       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939371364085       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939371364450       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939371364155       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939371364422       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939371364689       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939371364527       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939371364863       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939371364908       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939371364644       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939371364721       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939371364735       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939371364626       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939371364645       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939371364646       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+01 is 8.215429e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939370951428       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939371019458       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939371035423       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939371038886       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939371042486       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939371042705       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939371043952       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939371045607       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939371046631       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939371048498       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939371048643       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939371049818       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939371050485       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939371051861       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939371052770       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939371052684       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939371053321       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939371053621       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939371053434       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939371053467       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939371053877       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939371054181       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939371054490       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939371054907       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939371054576       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939371054381       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939371054765       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939371054553       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939371054532       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939371054606       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939371054680       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939371054772       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939371054697       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939371054765       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939371054831       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939371054791       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939371054876       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939371054886       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939371054821       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939371054840       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939371054844       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939371054815       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939371054821       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939371054820       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+02 is 2.054150e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939370951428       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939370968440       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939370972432       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939370973298       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939370974198       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939370974253       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939370974565       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939370974980       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939370975234       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939370975702       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939370975737       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939370976031       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939370976197       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939370976543       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939370976768       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939370976743       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939370976906       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939370976981       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939370976936       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939370976943       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939370977041       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939370977122       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939370977199       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939370977310       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939370977218       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939370977169       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939370977269       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939370977215       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939370977208       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939370977228       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939370977249       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939370977267       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939370977250       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939370977268       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939370977285       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939370977276       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939370977294       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939370977298       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939370977284       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939370977288       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939370977287       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939370977278       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939370977285       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939370977275       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+02 is 5.135559e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.813027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5582e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.084911e-01 1 1  ON 0
  uu_1                 5.267529e-02 1 1  ON 1
  uu_2                -3.672278e-02 1 1  ON 2
  uu_3                -8.984949e-02 1 1  ON 3
  uu_4                -1.217616e-01 1 1  ON 4
  uu_5                -1.312713e-01 1 1  ON 5
  uu_6                -1.137554e-01 1 1  ON 6
  uu_7                -5.646647e-02 1 1  ON 7
  uu_8                 5.947909e-02 1 1  ON 8
  uu_9                 1.220868e-01 1 1  ON 9
  ud_0                 3.006694e-01 1 1  ON 10
  ud_1                 7.340131e-02 1 1  ON 11
  ud_2                -2.594493e-02 1 1  ON 12
  ud_3                -7.709139e-02 1 1  ON 13
  ud_4                -1.122880e-01 1 1  ON 14
  ud_5                -1.317604e-01 1 1  ON 15
  ud_6                -1.269108e-01 1 1  ON 16
  ud_7                -8.779610e-02 1 1  ON 17
  ud_8                -4.236301e-03 1 1  ON 18
  ud_9                 8.491318e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142703e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499455e-01 1 1  ON 24
  eO_5                 2.747751e-01 1 1  ON 25
  eO_6                 2.477592e-01 1 1  ON 26
  eO_7                 1.370911e-01 1 1  ON 27
  eO_8                 2.907812e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054426e-01 1 1  ON 30
 eH1_1                -1.005062e-01 1 1  ON 31
 eH1_2                -4.948265e-02 1 1  ON 32
 eH1_3                -1.791155e-02 1 1  ON 33
 eH1_4                 1.722474e-02 1 1  ON 34
 eH1_5                 2.532512e-02 1 1  ON 35
 eH1_6                 7.901728e-02 1 1  ON 36
 eH1_7                 1.070398e-01 1 1  ON 37
 eH1_8                 1.027398e-01 1 1  ON 38
 eH1_9                 2.587887e-02 1 1  ON 39
 eH2_0                -2.016958e-01 1 1  ON 40
 eH2_1                -9.694501e-02 1 1  ON 41
 eH2_2                -4.656998e-02 1 1  ON 42
 eH2_3                -1.598604e-02 1 1  ON 43
 eH2_4                 1.733458e-02 1 1  ON 44
 eH2_5                 2.121214e-02 1 1  ON 45
 eH2_6                 7.058634e-02 1 1  ON 46
 eH2_7                 1.059925e-01 1 1  ON 47
 eH2_8                 1.046980e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234834e-02 3 1  ON 50
ci_002                -3.115773e-02 3 1  ON 51
ci_003                -2.574021e-02 3 1  ON 52
ci_004                 2.449497e-02 3 1  ON 53
ci_005                 2.459966e-02 3 1  ON 54
ci_006                -2.028987e-02 3 1  ON 55
ci_007                -2.042711e-02 3 1  ON 56
ci_008                -8.986602e-03 3 1  ON 57
ci_009                -1.503542e-02 3 1  ON 58
ci_010                -9.449194e-03 3 1  ON 59
ci_011                -1.021823e-02 3 1  ON 60
ci_012                -1.008584e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300369e-02 3 1  ON 63
ci_015                 1.321411e-02 3 1  ON 64
ci_016                 1.641291e-02 3 1  ON 65
ci_017                 1.617588e-02 3 1  ON 66
ci_018                 1.019103e-02 3 1  ON 67
ci_019                 1.038107e-02 3 1  ON 68
ci_020                 1.646555e-02 3 1  ON 69
ci_021                 1.644463e-02 3 1  ON 70
ci_022                 1.057058e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513687e-03 3 1  ON 73
ci_025                 6.088449e-03 3 1  ON 74
ci_026                 1.169039e-02 3 1  ON 75
ci_027                 1.166379e-02 3 1  ON 76
ci_028                -1.519452e-02 3 1  ON 77
ci_029                -1.537285e-02 3 1  ON 78
ci_030                -4.449387e-03 3 1  ON 79
ci_031                -4.860038e-03 3 1  ON 80
ci_032                -1.535514e-02 3 1  ON 81
ci_033                 6.942411e-03 3 1  ON 82
ci_034                 7.336262e-03 3 1  ON 83
ci_035                -4.585904e-03 3 1  ON 84
ci_036                -1.273187e-02 3 1  ON 85
ci_037                -1.278200e-02 3 1  ON 86
ci_038                 1.165011e-03 3 1  ON 87
ci_039                 1.335713e-03 3 1  ON 88
ci_040                -2.705709e-03 3 1  ON 89
ci_041                 8.457778e-03 3 1  ON 90
ci_042                 8.383060e-03 3 1  ON 91
ci_043                -3.617802e-03 3 1  ON 92
ci_044                -4.712976e-03 3 1  ON 93
ci_045                -2.790378e-03 3 1  ON 94
ci_046                 5.835163e-03 3 1  ON 95
ci_047                 5.643932e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.15444
====================================================
  Execution time = 2.7070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8610e-01
  Total weights = 1.9663e+06
  Execution time = 2.2997e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229934649
                                         uncertainty =       0.001550741937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229934649
                                         uncertainty =       0.001550741937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372349412
  error estimate for blocks of size 2^( 2) =       0.000387049726
  error estimate for blocks of size 2^( 3) =       0.000400604642
  error estimate for blocks of size 2^( 4) =       0.000409666066
  error estimate for blocks of size 2^( 5) =       0.000416254637
  error estimate for blocks of size 2^( 6) =       0.000418354612
  error estimate for blocks of size 2^( 7) =       0.000419710409

      target function =      -0.934689093152
              le_mean =     -17.209524090348
             les_mean =     296.453815477993
             stat err =       0.000415996431
             autocorr =       1.248181857323
   target nu stat err =       0.000415996431
   target dn stat err =       0.001747491520
      target stat err =       0.002987118412
              std dev =       0.526590013004
             le_variance =       0.277297041795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229838489
                                         uncertainty =       0.001550715985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229838489
                                         uncertainty =       0.001550715985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372349346
  error estimate for blocks of size 2^( 2) =       0.000387049765
  error estimate for blocks of size 2^( 3) =       0.000400604789
  error estimate for blocks of size 2^( 4) =       0.000409666284
  error estimate for blocks of size 2^( 5) =       0.000416254908
  error estimate for blocks of size 2^( 6) =       0.000418354946
  error estimate for blocks of size 2^( 7) =       0.000419710868

      target function =      -0.934685516698
              le_mean =     -17.209524078027
             les_mean =     296.453817213244
             stat err =       0.000415996751
             autocorr =       1.248184215430
   target nu stat err =       0.000415996751
   target dn stat err =       0.001747481982
      target stat err =       0.002987081006
              std dev =       0.526589920905
             le_variance =       0.277296944799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229886399
                                         uncertainty =       0.001550728947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229886399
                                         uncertainty =       0.001550728947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372349379
  error estimate for blocks of size 2^( 2) =       0.000387049745
  error estimate for blocks of size 2^( 3) =       0.000400604716
  error estimate for blocks of size 2^( 4) =       0.000409666175
  error estimate for blocks of size 2^( 5) =       0.000416254772
  error estimate for blocks of size 2^( 6) =       0.000418354779
  error estimate for blocks of size 2^( 7) =       0.000419710638

      target function =      -0.934687470324
              le_mean =     -17.209524084173
             les_mean =     296.453816245298
             stat err =       0.000415996591
             autocorr =       1.248183037111
   target nu stat err =       0.000415996591
   target dn stat err =       0.001747485228
      target stat err =       0.002987098289
              std dev =       0.526589966793
             le_variance =       0.277296993127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229928604
                                         uncertainty =       0.001550740312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277229928604
                                         uncertainty =       0.001550740312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372349407
  error estimate for blocks of size 2^( 2) =       0.000387049728
  error estimate for blocks of size 2^( 3) =       0.000400604652
  error estimate for blocks of size 2^( 4) =       0.000409666079
  error estimate for blocks of size 2^( 5) =       0.000416254654
  error estimate for blocks of size 2^( 6) =       0.000418354633
  error estimate for blocks of size 2^( 7) =       0.000419710437

      target function =      -0.934688907471
              le_mean =     -17.209524089575
             les_mean =     296.453815563496
             stat err =       0.000415996451
             autocorr =       1.248182004810
   target nu stat err =       0.000415996451
   target dn stat err =       0.001747490584
      target stat err =       0.002987115762
              std dev =       0.526590007215
             le_variance =       0.277297035698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934689093152        initial  <--
     5.9605e+01     5.9605e+02             8.2154e-06        -0.934685516698
     2.3842e+02     2.3842e+03             2.0542e-06        -0.934687470324
     9.5367e+02     9.5367e+03             5.1356e-07        -0.934688907471

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6555
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340217e-02 1 1  ON 11
  ud_2                -2.594435e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779753e-02 1 1  ON 17
  ud_8                -4.235450e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142653e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901745e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830400e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303625e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088056e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449330e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942384e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712634e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643952e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2274
    reference variance = 0.147536
====================================================
  Execution time = 2.7097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0452e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8896e-01
  Total weights = 1.966250736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2372e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277207840988
                                         uncertainty =       0.001389414464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277207840988
                                         uncertainty =       0.001389414464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372306192
  error estimate for blocks of size 2^( 2) =       0.000386550297
  error estimate for blocks of size 2^( 3) =       0.000399420305
  error estimate for blocks of size 2^( 4) =       0.000408996621
  error estimate for blocks of size 2^( 5) =       0.000413982065
  error estimate for blocks of size 2^( 6) =       0.000416012363
  error estimate for blocks of size 2^( 7) =       0.000420026734

      target function =      -0.929965807328
              le_mean =     -17.209213939558
             les_mean =     296.446005266784
             stat err =       0.000414754446
             autocorr =       1.241028000444
   target nu stat err =       0.000414754446
   target dn stat err =       0.002695231454
      target stat err =       0.004477151179
              std dev =       0.526528890999
             le_variance =       0.277232673057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720921393956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929986235761       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929986308692       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929986325859       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929986331706       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929986333568       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929986334110       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929986334266       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929986334958       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929986335189       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929986335330       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929986335469       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929986335213       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929986335224       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929986336019       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929986335784       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929986335979       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929986336215       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929986336575       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929986336759       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929986336899       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929986336845       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929986336860       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929986336822       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929986336928       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929986336929       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929986336906       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929986336931       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929986336920       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929986336899       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929986336868       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929986336899       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929986336923       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929986336924       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929986336960       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929986337001       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929986336993       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929986336990       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929986337013       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929986337015       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929986337013       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929986337024       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+02 is 5.610461e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929986235761       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929986253996       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929986258288       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929986259750       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929986260216       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929986260355       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929986260386       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929986260565       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929986260625       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929986260653       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929986260691       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929986260622       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929986260631       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929986260830       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929986260771       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929986260816       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929986260880       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929986260967       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929986261012       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929986261047       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929986261053       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929986261059       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929986261031       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929986261062       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929986261055       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929986261049       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929986261055       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929986261052       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929986261034       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929986261031       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929986261042       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929986261037       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929986261059       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929986261059       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929986261080       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929986261067       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929986261069       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929986261073       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929986261078       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929986261082       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929986261085       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+03 is 1.402627e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929986235761       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929986240320       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929986241393       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929986241759       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929986241875       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929986241920       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929986241899       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929986241949       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929986241976       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929986241978       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929986241992       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929986241975       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929986241986       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929986242034       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929986241973       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929986242014       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929986242025       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929986242058       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929986242050       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929986242086       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929986242079       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929986242091       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929986242056       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929986242038       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929986242112       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929986242107       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929986242122       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929986242057       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929986242079       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929986242078       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929986242064       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929986242079       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929986242090       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929986242105       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929986242079       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929986242083       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929986242109       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929986242092       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929986242077       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929986242093       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929986242097       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+03 is 3.506576e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.887046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5416e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267493e-02 1 1  ON 1
  uu_2                -3.672326e-02 1 1  ON 2
  uu_3                -8.984982e-02 1 1  ON 3
  uu_4                -1.217616e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646662e-02 1 1  ON 7
  uu_8                 5.948100e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006702e-01 1 1  ON 10
  ud_1                 7.340210e-02 1 1  ON 11
  ud_2                -2.594438e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779741e-02 1 1  ON 17
  ud_8                -4.235490e-03 1 1  ON 18
  ud_9                 8.491367e-02 1 1  ON 19
  eO_0                -6.932042e-01 1 1  ON 20
  eO_1                -4.132228e-01 1 1  ON 21
  eO_2                -4.142658e-02 1 1  ON 22
  eO_3                 1.783597e-01 1 1  ON 23
  eO_4                 2.499459e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477583e-01 1 1  ON 26
  eO_7                 1.370903e-01 1 1  ON 27
  eO_8                 2.907816e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948311e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722511e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901740e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587885e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657007e-02 1 1  ON 42
 eH2_3                -1.598590e-02 1 1  ON 43
 eH2_4                 1.733482e-02 1 1  ON 44
 eH2_5                 2.121235e-02 1 1  ON 45
 eH2_6                 7.058520e-02 1 1  ON 46
 eH2_7                 1.059927e-01 1 1  ON 47
 eH2_8                 1.046975e-01 1 1  ON 48
 eH2_9                 2.830402e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574035e-02 3 1  ON 52
ci_004                 2.449477e-02 3 1  ON 53
ci_005                 2.459961e-02 3 1  ON 54
ci_006                -2.028984e-02 3 1  ON 55
ci_007                -2.042711e-02 3 1  ON 56
ci_008                -8.986577e-03 3 1  ON 57
ci_009                -1.503530e-02 3 1  ON 58
ci_010                -9.449147e-03 3 1  ON 59
ci_011                -1.021816e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953201e-02 3 1  ON 62
ci_014                 1.300350e-02 3 1  ON 63
ci_015                 1.321418e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617584e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646546e-02 3 1  ON 69
ci_021                 1.644452e-02 3 1  ON 70
ci_022                 1.057050e-02 3 1  ON 71
ci_023                 9.303655e-03 3 1  ON 72
ci_024                 7.513599e-03 3 1  ON 73
ci_025                 6.088138e-03 3 1  ON 74
ci_026                 1.169007e-02 3 1  ON 75
ci_027                 1.166394e-02 3 1  ON 76
ci_028                -1.519462e-02 3 1  ON 77
ci_029                -1.537303e-02 3 1  ON 78
ci_030                -4.449276e-03 3 1  ON 79
ci_031                -4.859823e-03 3 1  ON 80
ci_032                -1.535512e-02 3 1  ON 81
ci_033                 6.942397e-03 3 1  ON 82
ci_034                 7.335990e-03 3 1  ON 83
ci_035                -4.586057e-03 3 1  ON 84
ci_036                -1.273197e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164922e-03 3 1  ON 87
ci_039                 1.335725e-03 3 1  ON 88
ci_040                -2.705590e-03 3 1  ON 89
ci_041                 8.457500e-03 3 1  ON 90
ci_042                 8.382759e-03 3 1  ON 91
ci_043                -3.617782e-03 3 1  ON 92
ci_044                -4.712585e-03 3 1  ON 93
ci_045                -2.790572e-03 3 1  ON 94
ci_046                 5.835384e-03 3 1  ON 95
ci_047                 5.643973e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1308
    reference variance = 0.245714
====================================================
  Execution time = 2.8902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8510e-01
  Total weights = 1.9664e+06
  Execution time = 2.3085e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763492284
                                         uncertainty =       0.001714968136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763492284
                                         uncertainty =       0.001714968136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370603760
  error estimate for blocks of size 2^( 2) =       0.000385170082
  error estimate for blocks of size 2^( 3) =       0.000398285851
  error estimate for blocks of size 2^( 4) =       0.000407997588
  error estimate for blocks of size 2^( 5) =       0.000413805912
  error estimate for blocks of size 2^( 6) =       0.000418406520
  error estimate for blocks of size 2^( 7) =       0.000421200186

      target function =      -0.936328533379
              le_mean =     -17.209434169470
             les_mean =     296.449726422166
             stat err =       0.000415352551
             autocorr =       1.256070806900
   target nu stat err =       0.000415352551
   target dn stat err =       0.002671639561
      target stat err =       0.004501186899
              std dev =       0.524121249738
             le_variance =       0.274703084427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763523984
                                         uncertainty =       0.001714965586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763523984
                                         uncertainty =       0.001714965586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370603782
  error estimate for blocks of size 2^( 2) =       0.000385170127
  error estimate for blocks of size 2^( 3) =       0.000398285917
  error estimate for blocks of size 2^( 4) =       0.000407997668
  error estimate for blocks of size 2^( 5) =       0.000413805999
  error estimate for blocks of size 2^( 6) =       0.000418406606
  error estimate for blocks of size 2^( 7) =       0.000421200261

      target function =      -0.936327734393
              le_mean =     -17.209434171556
             les_mean =     296.449726972997
             stat err =       0.000415352634
             autocorr =       1.256071158761
   target nu stat err =       0.000415352634
   target dn stat err =       0.002671818776
      target stat err =       0.004501473217
              std dev =       0.524121280058
             le_variance =       0.274703116209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763508132
                                         uncertainty =       0.001714966861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763508132
                                         uncertainty =       0.001714966861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370603771
  error estimate for blocks of size 2^( 2) =       0.000385170105
  error estimate for blocks of size 2^( 3) =       0.000398285884
  error estimate for blocks of size 2^( 4) =       0.000407997628
  error estimate for blocks of size 2^( 5) =       0.000413805956
  error estimate for blocks of size 2^( 6) =       0.000418406563
  error estimate for blocks of size 2^( 7) =       0.000421200223

      target function =      -0.936328134202
              le_mean =     -17.209434170513
             les_mean =     296.449726697382
             stat err =       0.000415352592
             autocorr =       1.256070982845
   target nu stat err =       0.000415352592
   target dn stat err =       0.002671729166
      target stat err =       0.004501330056
              std dev =       0.524121264897
             le_variance =       0.274703100317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763494265
                                         uncertainty =       0.001714967977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274763494265
                                         uncertainty =       0.001714967977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370603762
  error estimate for blocks of size 2^( 2) =       0.000385170085
  error estimate for blocks of size 2^( 3) =       0.000398285855
  error estimate for blocks of size 2^( 4) =       0.000407997593
  error estimate for blocks of size 2^( 5) =       0.000413805918
  error estimate for blocks of size 2^( 6) =       0.000418406525
  error estimate for blocks of size 2^( 7) =       0.000421200190

      target function =      -0.936328483519
              le_mean =     -17.209434169600
             les_mean =     296.449726456545
             stat err =       0.000415352556
             autocorr =       1.256070828882
   target nu stat err =       0.000415352556
   target dn stat err =       0.002671650761
      target stat err =       0.004501204792
              std dev =       0.524121251633
             le_variance =       0.274703086413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936328533379        initial  <--
     5.9605e+02     5.9605e+03             5.6105e-07        -0.936327734393
     2.3842e+03     2.3842e+04             1.4026e-07        -0.936328134202
     9.5367e+03     9.5367e+04             3.5066e-08        -0.936328483519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5065
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340217e-02 1 1  ON 11
  ud_2                -2.594435e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779753e-02 1 1  ON 17
  ud_8                -4.235450e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142653e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901745e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830400e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303625e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088056e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449330e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942384e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712634e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643952e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.335238
====================================================
  Execution time = 2.7019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8532e-01
  Total weights = 1.966336618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3984e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275474233279
                                         uncertainty =       0.001373068731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275474233279
                                         uncertainty =       0.001373068731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110075
  error estimate for blocks of size 2^( 2) =       0.000385309719
  error estimate for blocks of size 2^( 3) =       0.000398422008
  error estimate for blocks of size 2^( 4) =       0.000408532756
  error estimate for blocks of size 2^( 5) =       0.000414649564
  error estimate for blocks of size 2^( 6) =       0.000418467293
  error estimate for blocks of size 2^( 7) =       0.000420394236

      target function =      -0.935979723269
              le_mean =     -17.209276474801
             les_mean =     296.444514211275
             stat err =       0.000415510962
             autocorr =       1.253601437021
   target nu stat err =       0.000415510962
   target dn stat err =       0.002288564288
      target stat err =       0.003870539223
              std dev =       0.524837298946
             le_variance =       0.275454190365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720927647480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935994643115       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935994648517       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935994649336       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935994649806       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935994649991       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935994650016       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935994650160       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935994650304       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935994650357       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935994650361       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935994650359       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935994650386       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935994650444       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935994650523       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935994650551       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935994650576       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935994650622       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935994650603       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935994650639       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935994650646       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935994650656       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935994650661       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935994650645       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935994650667       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935994650678       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935994650645       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935994650690       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935994650684       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935994650671       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935994650702       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935994650698       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935994650696       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935994650670       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935994650701       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935994650714       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935994650686       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935994650706       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935994650670       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935994650674       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935994650684       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935994650669       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935994650694       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935994650680       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935994650697       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935994650686       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+03 is 8.312399e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935994643115       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935994644466       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935994644670       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935994644791       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935994644834       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935994644854       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935994644855       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935994644900       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935994644949       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935994644929       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935994644880       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935994644833       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935994644999       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935994644965       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935994644982       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935994644951       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935994644985       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935994645038       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935994644977       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935994645029       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935994645061       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935994644962       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935994645006       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935994644983       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935994645017       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935994644986       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935994645018       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935994644991       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935994644991       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935994644958       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935994644963       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935994644976       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935994644987       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935994644983       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935994645031       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935994645057       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935994644997       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935994644989       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935994645028       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935994645048       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935994644959       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935994645009       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935994644919       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935994645017       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935994645028       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+04 is 2.078101e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935994643115       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935994643453       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935994643504       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935994643533       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935994643545       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935994643547       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935994643557       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935994643565       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935994643377       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935994643755       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935994643448       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935994643253       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935994643317       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935994643723       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935994643601       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935994643359       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935994643534       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935994643598       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935994643517       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935994643584       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935994644052       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935994643431       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935994643501       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935994643801       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935994643583       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935994643948       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935994643613       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935994643718       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935994643472       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935994643273       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935994643527       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935994643649       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935994643811       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935994643626       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935994644150       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935994643170       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935994643838       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935994643337       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.935994643356       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935994643657       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935994643763       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935994643815       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935994643847       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935994643362       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.935994643538       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+04 is 5.195253e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.982671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5520e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984986e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646655e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594436e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779751e-02 1 1  ON 17
  ud_8                -4.235446e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532600e-02 1 1  ON 35
 eH1_6                 7.901744e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657010e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121232e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059927e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042713e-02 3 1  ON 56
ci_008                -8.986551e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449107e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641276e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644451e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303630e-03 3 1  ON 72
ci_024                 7.513554e-03 3 1  ON 73
ci_025                 6.088057e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166391e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449333e-03 3 1  ON 79
ci_031                -4.859833e-03 3 1  ON 80
ci_032                -1.535515e-02 3 1  ON 81
ci_033                 6.942385e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586070e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335717e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457515e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617791e-03 3 1  ON 92
ci_044                -4.712633e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643954e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.141914
====================================================
  Execution time = 2.7300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8794e-01
  Total weights = 1.9664e+06
  Execution time = 2.3187e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509921
                                         uncertainty =       0.001583871980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509921
                                         uncertainty =       0.001583871980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371913280
  error estimate for blocks of size 2^( 2) =       0.000385825469
  error estimate for blocks of size 2^( 3) =       0.000399016783
  error estimate for blocks of size 2^( 4) =       0.000409224061
  error estimate for blocks of size 2^( 5) =       0.000415078428
  error estimate for blocks of size 2^( 6) =       0.000417297498
  error estimate for blocks of size 2^( 7) =       0.000421048369

      target function =      -0.931612730399
              le_mean =     -17.209841485552
             les_mean =     296.466583942117
             stat err =       0.000415662089
             autocorr =       1.249100724006
   target nu stat err =       0.000415662089
   target dn stat err =       0.003260032055
      target stat err =       0.005418134586
              std dev =       0.525973219825
             le_variance =       0.276647827973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626508201
                                         uncertainty =       0.001583871936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626508201
                                         uncertainty =       0.001583871936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371913279
  error estimate for blocks of size 2^( 2) =       0.000385825470
  error estimate for blocks of size 2^( 3) =       0.000399016785
  error estimate for blocks of size 2^( 4) =       0.000409224064
  error estimate for blocks of size 2^( 5) =       0.000415078432
  error estimate for blocks of size 2^( 6) =       0.000417297502
  error estimate for blocks of size 2^( 7) =       0.000421048373

      target function =      -0.931612577741
              le_mean =     -17.209841485392
             les_mean =     296.466584029226
             stat err =       0.000415662093
             autocorr =       1.249100753686
   target nu stat err =       0.000415662093
   target dn stat err =       0.003260040550
      target stat err =       0.005418146686
              std dev =       0.525973218223
             le_variance =       0.276647826288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509061
                                         uncertainty =       0.001583871958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509061
                                         uncertainty =       0.001583871958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371913279
  error estimate for blocks of size 2^( 2) =       0.000385825470
  error estimate for blocks of size 2^( 3) =       0.000399016784
  error estimate for blocks of size 2^( 4) =       0.000409224062
  error estimate for blocks of size 2^( 5) =       0.000415078430
  error estimate for blocks of size 2^( 6) =       0.000417297500
  error estimate for blocks of size 2^( 7) =       0.000421048371

      target function =      -0.931612654187
              le_mean =     -17.209841485472
             les_mean =     296.466583985600
             stat err =       0.000415662091
             autocorr =       1.249100738861
   target nu stat err =       0.000415662091
   target dn stat err =       0.003260036301
      target stat err =       0.005418140635
              std dev =       0.525973219024
             le_variance =       0.276647827131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509813
                                         uncertainty =       0.001583871977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276626509813
                                         uncertainty =       0.001583871977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371913280
  error estimate for blocks of size 2^( 2) =       0.000385825469
  error estimate for blocks of size 2^( 3) =       0.000399016783
  error estimate for blocks of size 2^( 4) =       0.000409224061
  error estimate for blocks of size 2^( 5) =       0.000415078429
  error estimate for blocks of size 2^( 6) =       0.000417297498
  error estimate for blocks of size 2^( 7) =       0.000421048370

      target function =      -0.931612720885
              le_mean =     -17.209841485542
             les_mean =     296.466583947545
             stat err =       0.000415662089
             autocorr =       1.249100725872
   target nu stat err =       0.000415662089
   target dn stat err =       0.003260032586
      target stat err =       0.005418135342
              std dev =       0.525973219725
             le_variance =       0.276647827868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931612730399        initial  <--
     5.9605e+03     5.9605e+04             8.3124e-08        -0.931612577741
     2.3842e+04     2.3842e+05             2.0781e-08        -0.931612654187
     9.5367e+04     9.5367e+05             5.1953e-09        -0.931612720885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9727
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340217e-02 1 1  ON 11
  ud_2                -2.594435e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779753e-02 1 1  ON 17
  ud_8                -4.235450e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142653e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901745e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694477e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830400e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303625e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088056e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449330e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942384e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712634e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643952e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.315144
====================================================
  Execution time = 2.7717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0469e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8509e-01
  Total weights = 1.966300384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2849e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276567748476
                                         uncertainty =       0.002105613310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276567748476
                                         uncertainty =       0.002105613310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371835410
  error estimate for blocks of size 2^( 2) =       0.000385898683
  error estimate for blocks of size 2^( 3) =       0.000398980529
  error estimate for blocks of size 2^( 4) =       0.000408908210
  error estimate for blocks of size 2^( 5) =       0.000414801445
  error estimate for blocks of size 2^( 6) =       0.000418691805
  error estimate for blocks of size 2^( 7) =       0.000419626725

      target function =      -0.936329549719
              le_mean =     -17.210018585807
             les_mean =     296.469831737391
             stat err =       0.000415507046
             autocorr =       1.248691901944
   target nu stat err =       0.000415507046
   target dn stat err =       0.002832104848
      target stat err =       0.004769835561
              std dev =       0.525863093592
             le_variance =       0.276531993202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721001858581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936352526362       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936352526988       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936352527112       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936352527155       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936352527168       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936352527169       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936352527196       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936352527155       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936352527200       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936352527202       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936352527207       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936352527184       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936352527215       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936352527219       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936352527239       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936352527148       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936352527134       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936352527144       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936352527192       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936352527255       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936352527266       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936352527238       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936352527161       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936352527130       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936352527141       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936352527076       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936352527197       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936352527237       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936352527232       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936352527261       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936352527196       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936352527032       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936352527414       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936352527105       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936352527142       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936352527413       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936352527229       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936352527065       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936352527167       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936352527346       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936352527329       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936352527507       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936352527302       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936352527194       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+04 is 6.363280e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936352526362       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936352526519       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936352526550       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936352526561       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936352526636       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936352526469       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936352526597       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936352526353       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936352526707       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936352526927       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936352526088       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936352526644       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936352526012       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936352527033       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936352526994       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936352526789       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936352526386       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936352526276       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936352526431       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936352526327       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936352526854       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936352526882       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936352526430       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936352526211       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936352526150       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936352526174       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936352526683       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936352527231       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936352527558       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936352526271       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936352526234       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936352526937       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936352526570       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936352526466       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936352526676       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936352526198       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936352526242       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936352526503       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936352526085       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936352527332       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936352526454       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936352527076       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936352526709       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936352524903       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+05 is 1.590821e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936352526362       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936352526402       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936352526409       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936352526412       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936352526413       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936352526413       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936352524610       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936352525148       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936352526888       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936352524815       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936352525169       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936352524922       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936352526412       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936352524640       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936352523729       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936352525955       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936352526859       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936352524890       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936352527529       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936352526147       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936352525518       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936352526296       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936352525966       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936352526699       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936352523968       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936352524566       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936352524925       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936352524438       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936352526277       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936352528392       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936352529385       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936352525259       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.936352527080       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.936352526897       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936352523587       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936352527631       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936352524966       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936352526637       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936352528006       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936352524408       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936352524605       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.936352524447       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.936352528530       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936352529259       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         43 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.5367e+05 is 3.977049e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.073067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6101e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340216e-02 1 1  ON 11
  ud_2                -2.594435e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779752e-02 1 1  ON 17
  ud_8                -4.235450e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532601e-02 1 1  ON 35
 eH1_6                 7.901745e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830400e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303626e-03 3 1  ON 72
ci_024                 7.513556e-03 3 1  ON 73
ci_025                 6.088057e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449330e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942385e-03 3 1  ON 82
ci_034                 7.336029e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712634e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643952e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.171535
====================================================
  Execution time = 2.7009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8745e-01
  Total weights = 1.9663e+06
  Execution time = 2.3272e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332217
                                         uncertainty =       0.001737986785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332217
                                         uncertainty =       0.001737986785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373302702
  error estimate for blocks of size 2^( 2) =       0.000387246965
  error estimate for blocks of size 2^( 3) =       0.000399786291
  error estimate for blocks of size 2^( 4) =       0.000408976817
  error estimate for blocks of size 2^( 5) =       0.000414552858
  error estimate for blocks of size 2^( 6) =       0.000416901488
  error estimate for blocks of size 2^( 7) =       0.000418207649

      target function =      -0.932425461854
              le_mean =     -17.210149170574
             les_mean =     296.476686287178
             stat err =       0.000414659703
             autocorr =       1.233847250190
   target nu stat err =       0.000414659703
   target dn stat err =       0.002134007924
      target stat err =       0.003597725760
              std dev =       0.527938190904
             le_variance =       0.278718733415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332007
                                         uncertainty =       0.001737986806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332007
                                         uncertainty =       0.001737986806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373302702
  error estimate for blocks of size 2^( 2) =       0.000387246965
  error estimate for blocks of size 2^( 3) =       0.000399786291
  error estimate for blocks of size 2^( 4) =       0.000408976817
  error estimate for blocks of size 2^( 5) =       0.000414552859
  error estimate for blocks of size 2^( 6) =       0.000416901489
  error estimate for blocks of size 2^( 7) =       0.000418207649

      target function =      -0.932425462062
              le_mean =     -17.210149170573
             les_mean =     296.476686287038
             stat err =       0.000414659703
             autocorr =       1.233847254026
   target nu stat err =       0.000414659703
   target dn stat err =       0.002134008013
      target stat err =       0.003597725906
              std dev =       0.527938190707
             le_variance =       0.278718733207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332112
                                         uncertainty =       0.001737986795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332112
                                         uncertainty =       0.001737986795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373302702
  error estimate for blocks of size 2^( 2) =       0.000387246965
  error estimate for blocks of size 2^( 3) =       0.000399786291
  error estimate for blocks of size 2^( 4) =       0.000408976817
  error estimate for blocks of size 2^( 5) =       0.000414552858
  error estimate for blocks of size 2^( 6) =       0.000416901489
  error estimate for blocks of size 2^( 7) =       0.000418207649

      target function =      -0.932425461958
              le_mean =     -17.210149170573
             les_mean =     296.476686287108
             stat err =       0.000414659703
             autocorr =       1.233847252103
   target nu stat err =       0.000414659703
   target dn stat err =       0.002134007968
      target stat err =       0.003597725833
              std dev =       0.527938190805
             le_variance =       0.278718733311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332204
                                         uncertainty =       0.001737986787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278800332204
                                         uncertainty =       0.001737986787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373302702
  error estimate for blocks of size 2^( 2) =       0.000387246965
  error estimate for blocks of size 2^( 3) =       0.000399786291
  error estimate for blocks of size 2^( 4) =       0.000408976817
  error estimate for blocks of size 2^( 5) =       0.000414552858
  error estimate for blocks of size 2^( 6) =       0.000416901488
  error estimate for blocks of size 2^( 7) =       0.000418207649

      target function =      -0.932425461867
              le_mean =     -17.210149170574
             les_mean =     296.476686287169
             stat err =       0.000414659703
             autocorr =       1.233847250435
   target nu stat err =       0.000414659703
   target dn stat err =       0.002134007929
      target stat err =       0.003597725769
              std dev =       0.527938190892
             le_variance =       0.278718733402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932425461854        initial
     5.9605e+04     5.9605e+05             6.3633e-09        -0.932425462062  <--
     2.3842e+05     2.3842e+06             1.5908e-09        -0.932425461958
     9.5367e+05     9.5367e+06             3.9770e-10        -0.932425461867

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.8676e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948114e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340216e-02 1 1  ON 11
  ud_2                -2.594436e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779752e-02 1 1  ON 17
  ud_8                -4.235449e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532600e-02 1 1  ON 35
 eH1_6                 7.901744e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058524e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986549e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449102e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303626e-03 3 1  ON 72
ci_024                 7.513557e-03 3 1  ON 73
ci_025                 6.088059e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537305e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859839e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942386e-03 3 1  ON 82
ci_034                 7.336028e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164933e-03 3 1  ON 87
ci_039                 1.335715e-03 3 1  ON 88
ci_040                -2.705602e-03 3 1  ON 89
ci_041                 8.457519e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617793e-03 3 1  ON 92
ci_044                -4.712633e-03 3 1  ON 93
ci_045                -2.790559e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2717
    reference variance = 0.159163
====================================================
  Execution time = 2.7050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0462e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8604e-01
  Total weights = 1.966317212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1417e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276369452323
                                         uncertainty =       0.002056564433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276369452323
                                         uncertainty =       0.002056564433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371803603
  error estimate for blocks of size 2^( 2) =       0.000386117381
  error estimate for blocks of size 2^( 3) =       0.000398939314
  error estimate for blocks of size 2^( 4) =       0.000408851888
  error estimate for blocks of size 2^( 5) =       0.000415761476
  error estimate for blocks of size 2^( 6) =       0.000418873368
  error estimate for blocks of size 2^( 7) =       0.000420344343

      target function =      -0.934794567581
              le_mean =     -17.208849581553
             les_mean =     296.430540704695
             stat err =       0.000415957769
             autocorr =       1.251616536143
   target nu stat err =       0.000415957769
   target dn stat err =       0.002447020376
      target stat err =       0.004115652193
              std dev =       0.525818110397
             le_variance =       0.276484685221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720884958155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934811683728       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934811685620       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934811685999       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934811686097       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934811686195       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934811686163       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934811686223       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934811686213       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934811686266       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934811686289       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934811686294       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934811686327       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934811686339       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934811686358       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934811686405       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934811686390       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934811686319       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934811686376       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934811686416       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934811686418       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934811686384       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934811686409       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934811686411       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934811686392       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934811686426       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934811686340       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934811686348       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934811686353       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934811686398       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934811686352       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934811686329       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934811686369       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934811686392       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934811686395       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934811686408       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934811686357       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934811686380       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934811686392       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934811686454       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934811686360       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934811686347       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934811686357       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934811686337       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+04 is 3.266756e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934811683728       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934811684201       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934811684296       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934811684321       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934811684261       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934811684256       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934811684404       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934811684295       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934811684352       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934811684256       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934811684371       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934811684338       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934811684290       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934811684396       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934811684650       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934811684419       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934811684547       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934811684404       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934811684439       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934811684265       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934811684295       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934811684410       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934811684376       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934811684596       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934811684543       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934811684361       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934811684444       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934811684380       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934811684488       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934811684230       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934811684169       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934811684313       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934811684422       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934811684371       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934811684227       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934811684271       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934811684453       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934811684373       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934811684300       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934811684330       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934811684305       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934811684220       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934811684471       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+04 is 8.166901e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934811683728       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934811683847       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934811683870       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934811683874       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934811683691       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934811683907       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934811683875       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934811683938       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934811683897       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934811683918       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934811683576       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934811684085       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934811683861       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934811683667       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934811683557       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934811683971       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934811683589       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934811683729       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934811684438       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934811683697       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934811683380       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934811683820       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934811684649       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934811683471       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934811683966       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934811683891       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934811683625       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934811684300       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934811684327       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934811684155       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934811683907       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934811684048       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934811683959       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934811683766       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934811684099       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.934811683386       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934811684557       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934811683391       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934811683729       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934811683670       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934811683056       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934811683968       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.934811684242       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+05 is 2.041726e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.157302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5283e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267491e-02 1 1  ON 1
  uu_2                -3.672329e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948113e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340216e-02 1 1  ON 11
  ud_2                -2.594436e-02 1 1  ON 12
  ud_3                -7.709096e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269124e-01 1 1  ON 16
  ud_7                -8.779751e-02 1 1  ON 17
  ud_8                -4.235447e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005069e-01 1 1  ON 31
 eH1_2                -4.948313e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722513e-02 1 1  ON 34
 eH1_5                 2.532600e-02 1 1  ON 35
 eH1_6                 7.901744e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587883e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449475e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986547e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449102e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953205e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038109e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303627e-03 3 1  ON 72
ci_024                 7.513557e-03 3 1  ON 73
ci_025                 6.088059e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859838e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942385e-03 3 1  ON 82
ci_034                 7.336027e-03 3 1  ON 83
ci_035                -4.586069e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278211e-02 3 1  ON 86
ci_038                 1.164934e-03 3 1  ON 87
ci_039                 1.335714e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617792e-03 3 1  ON 92
ci_044                -4.712632e-03 3 1  ON 93
ci_045                -2.790558e-03 3 1  ON 94
ci_046                 5.835380e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1113
    reference variance = 0.163603
====================================================
  Execution time = 2.6922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9014e-01
  Total weights = 1.9668e+06
  Execution time = 2.3145e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076593
                                         uncertainty =       0.002159340230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076593
                                         uncertainty =       0.002159340230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375152844
  error estimate for blocks of size 2^( 2) =       0.000389368515
  error estimate for blocks of size 2^( 3) =       0.000402428593
  error estimate for blocks of size 2^( 4) =       0.000411991668
  error estimate for blocks of size 2^( 5) =       0.000417958955
  error estimate for blocks of size 2^( 6) =       0.000420459432
  error estimate for blocks of size 2^( 7) =       0.000423360299

      target function =      -0.928001868487
              le_mean =     -17.210112379224
             les_mean =     296.478111863502
             stat err =       0.000418442589
             autocorr =       1.244099951420
   target nu stat err =       0.000418442589
   target dn stat err =       0.002395591885
      target stat err =       0.003984871731
              std dev =       0.530554729146
             le_variance =       0.281488320619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531075910
                                         uncertainty =       0.002159339866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531075910
                                         uncertainty =       0.002159339866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375152844
  error estimate for blocks of size 2^( 2) =       0.000389368515
  error estimate for blocks of size 2^( 3) =       0.000402428594
  error estimate for blocks of size 2^( 4) =       0.000411991670
  error estimate for blocks of size 2^( 5) =       0.000417958957
  error estimate for blocks of size 2^( 6) =       0.000420459434
  error estimate for blocks of size 2^( 7) =       0.000423360301

      target function =      -0.928001869180
              le_mean =     -17.210112379302
             les_mean =     296.478111865743
             stat err =       0.000418442591
             autocorr =       1.244099966794
   target nu stat err =       0.000418442591
   target dn stat err =       0.002395591194
      target stat err =       0.003984870629
              std dev =       0.530554728500
             le_variance =       0.281488319934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076251
                                         uncertainty =       0.002159340048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076251
                                         uncertainty =       0.002159340048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375152844
  error estimate for blocks of size 2^( 2) =       0.000389368515
  error estimate for blocks of size 2^( 3) =       0.000402428593
  error estimate for blocks of size 2^( 4) =       0.000411991669
  error estimate for blocks of size 2^( 5) =       0.000417958956
  error estimate for blocks of size 2^( 6) =       0.000420459433
  error estimate for blocks of size 2^( 7) =       0.000423360300

      target function =      -0.928001868834
              le_mean =     -17.210112379263
             les_mean =     296.478111864623
             stat err =       0.000418442590
             autocorr =       1.244099959102
   target nu stat err =       0.000418442590
   target dn stat err =       0.002395591540
      target stat err =       0.003984871180
              std dev =       0.530554728823
             le_variance =       0.281488320276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076550
                                         uncertainty =       0.002159340207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281531076550
                                         uncertainty =       0.002159340207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375152844
  error estimate for blocks of size 2^( 2) =       0.000389368515
  error estimate for blocks of size 2^( 3) =       0.000402428593
  error estimate for blocks of size 2^( 4) =       0.000411991669
  error estimate for blocks of size 2^( 5) =       0.000417958955
  error estimate for blocks of size 2^( 6) =       0.000420459432
  error estimate for blocks of size 2^( 7) =       0.000423360299

      target function =      -0.928001868531
              le_mean =     -17.210112379229
             les_mean =     296.478111863642
             stat err =       0.000418442589
             autocorr =       1.244099952375
   target nu stat err =       0.000418442589
   target dn stat err =       0.002395591842
      target stat err =       0.003984871662
              std dev =       0.530554729106
             le_variance =       0.281488320576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928001868487        initial
     1.4901e+04     1.4901e+05             3.2668e-08        -0.928001869180  <--
     5.9605e+04     5.9605e+05             8.1669e-09        -0.928001868834
     2.3842e+05     2.3842e+06             2.0417e-09        -0.928001868531

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 3.8565e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2017
    reference variance = 0.23031
====================================================
  Execution time = 2.7333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0448e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8844e-01
  Total weights = 1.966261717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3118e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277912314844
                                         uncertainty =       0.001569046506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277912314844
                                         uncertainty =       0.001569046506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372753420
  error estimate for blocks of size 2^( 2) =       0.000386774301
  error estimate for blocks of size 2^( 3) =       0.000399739205
  error estimate for blocks of size 2^( 4) =       0.000409763042
  error estimate for blocks of size 2^( 5) =       0.000416328850
  error estimate for blocks of size 2^( 6) =       0.000419387521
  error estimate for blocks of size 2^( 7) =       0.000421134891

      target function =      -0.930799498475
              le_mean =     -17.209944950897
             les_mean =     296.470646844177
             stat err =       0.000416653576
             autocorr =       1.249415685009
   target nu stat err =       0.000416653576
   target dn stat err =       0.002295317293
      target stat err =       0.003844729130
              std dev =       0.527161376432
             le_variance =       0.277899116802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720994495090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930814409570       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930814414185       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930814415350       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930814415738       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930814415799       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930814415869       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930814415932       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930814416081       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930814416192       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930814416235       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930814416255       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930814416270       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930814416253       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930814416322       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930814416420       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930814416436       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930814416443       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930814416449       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930814416495       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930814416478       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930814416507       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930814416538       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930814416514       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930814416515       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930814416516       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930814416515       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930814416518       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930814416536       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930814416519       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930814416547       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930814416542       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930814416528       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930814416539       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930814416545       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930814416543       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930814416545       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930814416551       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930814416529       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930814416552       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930814416544       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+03 is 1.220362e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930814409570       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930814410724       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930814411015       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930814411112       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930814411127       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930814411168       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930814411159       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930814411182       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930814411237       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930814411237       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930814411213       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930814411248       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930814411247       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930814411240       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930814411279       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930814411297       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930814411262       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930814411289       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930814411266       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930814411303       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930814411325       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930814411292       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930814411296       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930814411343       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930814411304       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930814411279       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930814411329       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930814411290       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930814411285       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930814411273       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930814411286       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930814411279       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930814411278       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930814411287       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930814411278       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930814411308       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930814411295       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930814411308       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930814411311       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930814411305       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+04 is 3.050911e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930814409570       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930814409859       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930814409931       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930814409890       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930814410114       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930814409891       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930814410061       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930814409934       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930814409834       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930814409958       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930814410087       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930814409961       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930814409976       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930814410026       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930814410087       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930814410050       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930814410065       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930814409939       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930814409953       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930814410027       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930814410119       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930814409976       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930814409963       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930814410047       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930814409842       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930814410036       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930814410033       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930814410080       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930814410005       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930814409829       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930814409877       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930814410002       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930814410141       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930814410025       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930814410317       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930814410106       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930814409922       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930814409979       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930814409947       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930814410052       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+04 is 7.627280e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.227301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5723e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672327e-02 1 1  ON 2
  uu_3                -8.984986e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646655e-02 1 1  ON 7
  uu_8                 5.948109e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340214e-02 1 1  ON 11
  ud_2                -2.594438e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779747e-02 1 1  ON 17
  ud_8                -4.235442e-03 1 1  ON 18
  ud_9                 8.491369e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499459e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948311e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722511e-02 1 1  ON 34
 eH1_5                 2.532597e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121234e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059927e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574033e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028982e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449103e-03 3 1  ON 59
ci_011                -1.021814e-02 3 1  ON 60
ci_012                -1.008578e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300349e-02 3 1  ON 63
ci_015                 1.321416e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617586e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646543e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303634e-03 3 1  ON 72
ci_024                 7.513557e-03 3 1  ON 73
ci_025                 6.088059e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449327e-03 3 1  ON 79
ci_031                -4.859832e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942382e-03 3 1  ON 82
ci_034                 7.336026e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164936e-03 3 1  ON 87
ci_039                 1.335714e-03 3 1  ON 88
ci_040                -2.705604e-03 3 1  ON 89
ci_041                 8.457518e-03 3 1  ON 90
ci_042                 8.382753e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712623e-03 3 1  ON 93
ci_045                -2.790551e-03 3 1  ON 94
ci_046                 5.835379e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.271
    reference variance = 0.702697
====================================================
  Execution time = 2.9317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8332e-01
  Total weights = 1.9664e+06
  Execution time = 2.2827e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976032
                                         uncertainty =       0.001512602482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976032
                                         uncertainty =       0.001512602482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370777987
  error estimate for blocks of size 2^( 2) =       0.000384874192
  error estimate for blocks of size 2^( 3) =       0.000398188654
  error estimate for blocks of size 2^( 4) =       0.000407676367
  error estimate for blocks of size 2^( 5) =       0.000413392761
  error estimate for blocks of size 2^( 6) =       0.000418454474
  error estimate for blocks of size 2^( 7) =       0.000419157737

      target function =      -0.939302000812
              le_mean =     -17.210178755722
             les_mean =     296.473568066860
             stat err =       0.000414670335
             autocorr =       1.250771714192
   target nu stat err =       0.000414670335
   target dn stat err =       0.002153762228
      target stat err =       0.003682497015
              std dev =       0.524367646957
             le_variance =       0.274961429175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992977116
                                         uncertainty =       0.001512602199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992977116
                                         uncertainty =       0.001512602199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370777987
  error estimate for blocks of size 2^( 2) =       0.000384874195
  error estimate for blocks of size 2^( 3) =       0.000398188660
  error estimate for blocks of size 2^( 4) =       0.000407676376
  error estimate for blocks of size 2^( 5) =       0.000413392771
  error estimate for blocks of size 2^( 6) =       0.000418454485
  error estimate for blocks of size 2^( 7) =       0.000419157749

      target function =      -0.939301904003
              le_mean =     -17.210178755624
             les_mean =     296.473568121195
             stat err =       0.000414670345
             autocorr =       1.250771771702
   target nu stat err =       0.000414670345
   target dn stat err =       0.002153774614
      target stat err =       0.003682516598
              std dev =       0.524367647992
             le_variance =       0.274961430261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976574
                                         uncertainty =       0.001512602341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976574
                                         uncertainty =       0.001512602341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370777987
  error estimate for blocks of size 2^( 2) =       0.000384874193
  error estimate for blocks of size 2^( 3) =       0.000398188657
  error estimate for blocks of size 2^( 4) =       0.000407676372
  error estimate for blocks of size 2^( 5) =       0.000413392766
  error estimate for blocks of size 2^( 6) =       0.000418454480
  error estimate for blocks of size 2^( 7) =       0.000419157743

      target function =      -0.939301952411
              le_mean =     -17.210178755673
             les_mean =     296.473568094025
             stat err =       0.000414670340
             autocorr =       1.250771742945
   target nu stat err =       0.000414670340
   target dn stat err =       0.002153768421
      target stat err =       0.003682506806
              std dev =       0.524367647474
             le_variance =       0.274961429718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976099
                                         uncertainty =       0.001512602464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274992976099
                                         uncertainty =       0.001512602464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370777987
  error estimate for blocks of size 2^( 2) =       0.000384874192
  error estimate for blocks of size 2^( 3) =       0.000398188654
  error estimate for blocks of size 2^( 4) =       0.000407676368
  error estimate for blocks of size 2^( 5) =       0.000413392762
  error estimate for blocks of size 2^( 6) =       0.000418454475
  error estimate for blocks of size 2^( 7) =       0.000419157738

      target function =      -0.939301994763
              le_mean =     -17.210178755716
             les_mean =     296.473568070255
             stat err =       0.000414670335
             autocorr =       1.250771717793
   target nu stat err =       0.000414670335
   target dn stat err =       0.002153763002
      target stat err =       0.003682498238
              std dev =       0.524367647022
             le_variance =       0.274961429243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939302000812        initial  <--
     3.7253e+03     3.7253e+04             1.2204e-07        -0.939301904003
     1.4901e+04     1.4901e+05             3.0509e-08        -0.939301952411
     5.9605e+04     5.9605e+05             7.6273e-09        -0.939301994763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.8827
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2325
    reference variance = 0.50095
====================================================
  Execution time = 2.7143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8390e-01
  Total weights = 1.966349962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1598e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275784973532
                                         uncertainty =       0.001658721741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275784973532
                                         uncertainty =       0.001658721741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371352932
  error estimate for blocks of size 2^( 2) =       0.000385701721
  error estimate for blocks of size 2^( 3) =       0.000399228242
  error estimate for blocks of size 2^( 4) =       0.000409150886
  error estimate for blocks of size 2^( 5) =       0.000413641393
  error estimate for blocks of size 2^( 6) =       0.000418173395
  error estimate for blocks of size 2^( 7) =       0.000420822738

      target function =      -0.938330427823
              le_mean =     -17.210002058388
             les_mean =     296.468069511026
             stat err =       0.000415447103
             autocorr =       1.251577523659
   target nu stat err =       0.000415447103
   target dn stat err =       0.002064466820
      target stat err =       0.003528054489
              std dev =       0.525180755528
             le_variance =       0.275814825977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721000205839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938342742635       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938342743486       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938342743672       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938342743746       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938342743844       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938342743800       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938342743783       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938342743871       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938342743814       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938342743806       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938342743857       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938342743833       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938342743951       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938342743900       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938342743793       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938342743910       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938342743842       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938342743902       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938342743918       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938342743898       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938342743820       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938342743953       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938342743832       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938342743793       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938342743723       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938342743848       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938342743777       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938342743846       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938342743791       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938342743738       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938342743768       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938342743936       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938342743836       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938342743819       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938342743798       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938342743833       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938342743931       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938342743836       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938342743890       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938342743897       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+04 is 8.141244e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938342742635       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938342742848       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938342742895       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938342742901       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938342742926       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938342742958       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938342743190       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938342742887       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938342743132       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938342742967       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938342743575       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938342742998       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938342742469       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938342743246       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938342743077       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938342743103       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938342743030       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938342742763       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938342743612       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938342743189       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938342742952       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938342743021       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938342742560       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938342742648       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938342743235       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938342742789       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938342742831       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938342742953       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938342742721       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938342743004       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938342743192       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938342742721       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938342742917       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938342742839       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938342743025       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938342742603       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938342743396       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938342742652       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938342742808       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938342742775       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+05 is 2.035311e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938342742635       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938342742688       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938342742700       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938342742705       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938342742756       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938342742472       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938342743473       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938342742245       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938342742701       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938342743162       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938342742402       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938342742275       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938342742416       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938342743506       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938342743566       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938342740523       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938342742145       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938342743024       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938342742469       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938342742449       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938342740973       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938342742559       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938342742527       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938342742624       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938342742024       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938342741883       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938342742860       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938342741045       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938342740674       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938342739033       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938342741836       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938342742446       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938342743998       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938342741160       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938342743987       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938342741944       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938342742224       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938342744810       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938342742491       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938342743858       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+05 is 5.088278e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.296766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5379e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948111e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235441e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901744e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646543e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303630e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449328e-03 3 1  ON 79
ci_031                -4.859835e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942382e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.193373
====================================================
  Execution time = 2.7142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8878e-01
  Total weights = 1.9662e+06
  Execution time = 2.2832e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924149
                                         uncertainty =       0.001940203605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924149
                                         uncertainty =       0.001940203605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199191
  error estimate for blocks of size 2^( 2) =       0.000387603140
  error estimate for blocks of size 2^( 3) =       0.000401062610
  error estimate for blocks of size 2^( 4) =       0.000410884311
  error estimate for blocks of size 2^( 5) =       0.000416869048
  error estimate for blocks of size 2^( 6) =       0.000419111897
  error estimate for blocks of size 2^( 7) =       0.000420943277

      target function =      -0.930275230982
              le_mean =     -17.208903342879
             les_mean =     296.435133498957
             stat err =       0.000416952133
             autocorr =       1.248219644747
   target nu stat err =       0.000416952133
   target dn stat err =       0.002563964125
      target stat err =       0.004265996881
              std dev =       0.527791801497
             le_variance =       0.278564185727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924337
                                         uncertainty =       0.001940203576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924337
                                         uncertainty =       0.001940203576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199191
  error estimate for blocks of size 2^( 2) =       0.000387603141
  error estimate for blocks of size 2^( 3) =       0.000401062611
  error estimate for blocks of size 2^( 4) =       0.000410884312
  error estimate for blocks of size 2^( 5) =       0.000416869048
  error estimate for blocks of size 2^( 6) =       0.000419111898
  error estimate for blocks of size 2^( 7) =       0.000420943277

      target function =      -0.930275222075
              le_mean =     -17.208903342864
             les_mean =     296.435133503875
             stat err =       0.000416952134
             autocorr =       1.248219648700
   target nu stat err =       0.000416952134
   target dn stat err =       0.002563964630
      target stat err =       0.004265997616
              std dev =       0.527791801672
             le_variance =       0.278564185912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924243
                                         uncertainty =       0.001940203590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924243
                                         uncertainty =       0.001940203590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199191
  error estimate for blocks of size 2^( 2) =       0.000387603140
  error estimate for blocks of size 2^( 3) =       0.000401062611
  error estimate for blocks of size 2^( 4) =       0.000410884312
  error estimate for blocks of size 2^( 5) =       0.000416869048
  error estimate for blocks of size 2^( 6) =       0.000419111897
  error estimate for blocks of size 2^( 7) =       0.000420943277

      target function =      -0.930275226529
              le_mean =     -17.208903342872
             les_mean =     296.435133501416
             stat err =       0.000416952134
             autocorr =       1.248219646711
   target nu stat err =       0.000416952134
   target dn stat err =       0.002563964377
      target stat err =       0.004265997249
              std dev =       0.527791801584
             le_variance =       0.278564185820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924161
                                         uncertainty =       0.001940203603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278625924161
                                         uncertainty =       0.001940203603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373199191
  error estimate for blocks of size 2^( 2) =       0.000387603140
  error estimate for blocks of size 2^( 3) =       0.000401062610
  error estimate for blocks of size 2^( 4) =       0.000410884311
  error estimate for blocks of size 2^( 5) =       0.000416869048
  error estimate for blocks of size 2^( 6) =       0.000419111897
  error estimate for blocks of size 2^( 7) =       0.000420943277

      target function =      -0.930275230425
              le_mean =     -17.208903342878
             les_mean =     296.435133499265
             stat err =       0.000416952133
             autocorr =       1.248219644985
   target nu stat err =       0.000416952133
   target dn stat err =       0.002563964157
      target stat err =       0.004265996927
              std dev =       0.527791801508
             le_variance =       0.278564185739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930275230982        initial  <--
     3.7253e+04     3.7253e+05             8.1412e-09        -0.930275222075
     1.4901e+05     1.4901e+06             2.0353e-09        -0.930275226529
     5.9605e+05     5.9605e+06             5.0883e-10        -0.930275230425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6969
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2721
    reference variance = 0.220567
====================================================
  Execution time = 2.6972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0471e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8309e-01
  Total weights = 1.966385496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2479e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272334753812
                                         uncertainty =       0.001648215785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272334753812
                                         uncertainty =       0.001648215785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369001739
  error estimate for blocks of size 2^( 2) =       0.000383260661
  error estimate for blocks of size 2^( 3) =       0.000396308253
  error estimate for blocks of size 2^( 4) =       0.000405296842
  error estimate for blocks of size 2^( 5) =       0.000411568768
  error estimate for blocks of size 2^( 6) =       0.000414845852
  error estimate for blocks of size 2^( 7) =       0.000417345634

      target function =      -0.939680688876
              le_mean =     -17.208859997825
             les_mean =     296.427955907756
             stat err =       0.000412264274
             autocorr =       1.248229889827
   target nu stat err =       0.000412264274
   target dn stat err =       0.003036041038
      target stat err =       0.005129483658
              std dev =       0.521855612722
             le_variance =       0.272333280530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720885999783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939707623139       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939707623310       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939707623347       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939707623414       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939707623387       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939707624044       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939707622945       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939707623041       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939707624613       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939707622943       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939707623661       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939707623360       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939707623515       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939707623273       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939707623431       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939707623918       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939707623105       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939707623455       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939707623608       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939707623661       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939707622563       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939707623722       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939707624046       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939707622476       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939707621666       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939707624766       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939707625714       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939707622947       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939707623775       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939707623411       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939707620749       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939707623618       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939707621241       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939707621769       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939707623902       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939707622826       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939707624034       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939707624562       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939707623212       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939707623913       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939707623563       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939707625042       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+05 is 9.993649e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939707623139       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939707623182       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939707623191       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939707623193       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939707623561       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939707623159       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939707622373       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939707623290       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939707624426       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939707624845       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939707622683       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939707624295       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939707618163       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939707622633       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939707622945       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939707621499       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939707623581       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939707623843       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939707624071       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939707623152       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939707623717       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939707623348       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939707624884       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939707623390       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939707628074       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939707624330       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939707618819       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939707627672       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939707628864       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939707619464       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939707623274       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939707623297       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939707622210       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939707625600       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939707622781       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939707620136       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939707622389       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939707626662       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939707624730       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939707626274       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939707620999       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939707622389       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+06 is 2.498414e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939707623139       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939707623150       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939707623152       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939707623153       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939707623159       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939707616194       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939707605626       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939707623715       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939707625122       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939707626093       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939707623574       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939707636491       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939707629158       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939707626306       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939707627552       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939707602293       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939707610269       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939707621592       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939707632651       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939707626574       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939707622802       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939707639101       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939707618470       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939707629104       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939707609054       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939707628301       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939707618014       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939707619028       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939707618048       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939707625223       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939707613668       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939707626037       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939707606348       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939707625583       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939707613160       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939707616684       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939707642903       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939707601654       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939707616087       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939707646447       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939707608393       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939707623574       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+06 is 6.245992e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.376792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5309e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2735
    reference variance = 0.230213
====================================================
  Execution time = 2.7323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9033e-01
  Total weights = 1.9665e+06
  Execution time = 2.2960e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377314
                                         uncertainty =       0.002065947719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377314
                                         uncertainty =       0.002065947719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372934825
  error estimate for blocks of size 2^( 2) =       0.000387160808
  error estimate for blocks of size 2^( 3) =       0.000400116258
  error estimate for blocks of size 2^( 4) =       0.000410371535
  error estimate for blocks of size 2^( 5) =       0.000416460333
  error estimate for blocks of size 2^( 6) =       0.000419057231
  error estimate for blocks of size 2^( 7) =       0.000420242868

      target function =      -0.927696971790
              le_mean =     -17.209155825576
             les_mean =     296.445376975662
             stat err =       0.000416532992
             autocorr =       1.247478103051
   target nu stat err =       0.000416532992
   target dn stat err =       0.004118188162
      target stat err =       0.006755471285
              std dev =       0.527417925695
             le_variance =       0.278169668344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377354
                                         uncertainty =       0.002065947718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377354
                                         uncertainty =       0.002065947718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372934825
  error estimate for blocks of size 2^( 2) =       0.000387160808
  error estimate for blocks of size 2^( 3) =       0.000400116258
  error estimate for blocks of size 2^( 4) =       0.000410371535
  error estimate for blocks of size 2^( 5) =       0.000416460333
  error estimate for blocks of size 2^( 6) =       0.000419057231
  error estimate for blocks of size 2^( 7) =       0.000420242868

      target function =      -0.927696970172
              le_mean =     -17.209155825573
             les_mean =     296.445376976551
             stat err =       0.000416532992
             autocorr =       1.247478103298
   target nu stat err =       0.000416532992
   target dn stat err =       0.004118188247
      target stat err =       0.006755471399
              std dev =       0.527417925733
             le_variance =       0.278169668384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377334
                                         uncertainty =       0.002065947718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377334
                                         uncertainty =       0.002065947718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372934825
  error estimate for blocks of size 2^( 2) =       0.000387160808
  error estimate for blocks of size 2^( 3) =       0.000400116258
  error estimate for blocks of size 2^( 4) =       0.000410371535
  error estimate for blocks of size 2^( 5) =       0.000416460333
  error estimate for blocks of size 2^( 6) =       0.000419057231
  error estimate for blocks of size 2^( 7) =       0.000420242868

      target function =      -0.927696970981
              le_mean =     -17.209155825575
             les_mean =     296.445376976107
             stat err =       0.000416532992
             autocorr =       1.247478103174
   target nu stat err =       0.000416532992
   target dn stat err =       0.004118188204
      target stat err =       0.006755471342
              std dev =       0.527417925714
             le_variance =       0.278169668364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377317
                                         uncertainty =       0.002065947719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278106377317
                                         uncertainty =       0.002065947719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372934825
  error estimate for blocks of size 2^( 2) =       0.000387160808
  error estimate for blocks of size 2^( 3) =       0.000400116258
  error estimate for blocks of size 2^( 4) =       0.000410371535
  error estimate for blocks of size 2^( 5) =       0.000416460333
  error estimate for blocks of size 2^( 6) =       0.000419057231
  error estimate for blocks of size 2^( 7) =       0.000420242868

      target function =      -0.927696971689
              le_mean =     -17.209155825576
             les_mean =     296.445376975718
             stat err =       0.000416532992
             autocorr =       1.247478103070
   target nu stat err =       0.000416532992
   target dn stat err =       0.004118188167
      target stat err =       0.006755471292
              std dev =       0.527417925698
             le_variance =       0.278169668347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927696971790        initial  <--
     3.7253e+05     3.7253e+06             9.9936e-10        -0.927696970172
     1.4901e+06     1.4901e+07             2.4984e-10        -0.927696970981
     5.9605e+06     5.9605e+07             6.2460e-11        -0.927696971689

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9563
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.342492
====================================================
  Execution time = 2.7350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0504e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8800e-01
  Total weights = 1.966153473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1946e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278135881162
                                         uncertainty =       0.002024173147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278135881162
                                         uncertainty =       0.002024173147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372901391
  error estimate for blocks of size 2^( 2) =       0.000386731393
  error estimate for blocks of size 2^( 3) =       0.000399732058
  error estimate for blocks of size 2^( 4) =       0.000408940173
  error estimate for blocks of size 2^( 5) =       0.000414262816
  error estimate for blocks of size 2^( 6) =       0.000416347244
  error estimate for blocks of size 2^( 7) =       0.000417707455

      target function =      -0.931522546298
              le_mean =     -17.209798077464
             les_mean =     296.465150068834
             stat err =       0.000414314422
             autocorr =       1.234445993146
   target nu stat err =       0.000414314422
   target dn stat err =       0.002822773111
      target stat err =       0.004704093444
              std dev =       0.527370642788
             le_variance =       0.278119794874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720979807746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931545407312       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931545407323       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931545407324       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931545407324       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931545408720       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931545407345       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931545423821       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931545407062       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931545407983       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931545411009       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931545407137       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931545401519       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931545408477       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931545403429       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931545412823       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931545403495       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931545407608       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931545411560       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931545397137       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931545407929       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931545407970       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931545401174       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931545415259       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931545406598       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931545405730       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931545403812       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931545403994       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931545424154       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931545396666       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931545402311       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931545409105       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931545406665       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931545419902       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931545388240       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931545401957       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931545382271       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931545406731       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931545417524       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931545396464       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931545399109       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931545402205       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+06 is 9.205001e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931545407312       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931545407315       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931545407315       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931545407315       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931545407315       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931545412535       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931545462163       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931545398310       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931545416918       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931545398833       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931545427480       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931545386113       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931545395291       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931545384679       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931545384075       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931545413991       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931545376868       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931545416893       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931545395486       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931545419429       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931545405459       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931545374542       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931545363772       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931545382884       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931545409740       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931545450683       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931545391954       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931545393839       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931545370234       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931545462457       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931545382216       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931545385299       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931545408516       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931545418408       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931545459243       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931545415201       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931545401175       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931545331345       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931545353081       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931545449570       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931545424521       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+07 is 2.301240e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931545407312       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931545407313       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931545407313       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931545407313       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931545407250       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931545441407       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931545456338       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931545390266       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931545380261       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931545497645       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931545059561       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931545359866       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931545413565       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931545409281       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931545489432       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931545403819       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931545390599       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931545414213       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931545494087       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931545385518       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931545109448       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931545161262       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931545743296       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931545500267       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931545221190       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931545439021       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931545601721       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931545286460       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931545397096       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931545568071       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931545404996       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931545404915       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931545287066       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931545611994       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931545496700       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931545375475       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931545183592       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931545316383       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931545588654       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931545285277       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931545289492       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+07 is 5.753455e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.450746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5626e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1921
    reference variance = 0.169873
====================================================
  Execution time = 2.6913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8309e-01
  Total weights = 1.9660e+06
  Execution time = 2.2884e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331776
                                         uncertainty =       0.001541631513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331776
                                         uncertainty =       0.001541631513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370959361
  error estimate for blocks of size 2^( 2) =       0.000385340559
  error estimate for blocks of size 2^( 3) =       0.000398304215
  error estimate for blocks of size 2^( 4) =       0.000407618181
  error estimate for blocks of size 2^( 5) =       0.000413364098
  error estimate for blocks of size 2^( 6) =       0.000416363949
  error estimate for blocks of size 2^( 7) =       0.000417316664

      target function =      -0.939676594907
              le_mean =     -17.210142312598
             les_mean =     296.472091070679
             stat err =       0.000413665723
             autocorr =       1.243501757339
   target nu stat err =       0.000413665723
   target dn stat err =       0.002080129929
      target stat err =       0.003563921654
              std dev =       0.524624152764
             le_variance =       0.275230501663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331779
                                         uncertainty =       0.001541631514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331779
                                         uncertainty =       0.001541631514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370959361
  error estimate for blocks of size 2^( 2) =       0.000385340559
  error estimate for blocks of size 2^( 3) =       0.000398304215
  error estimate for blocks of size 2^( 4) =       0.000407618181
  error estimate for blocks of size 2^( 5) =       0.000413364098
  error estimate for blocks of size 2^( 6) =       0.000416363949
  error estimate for blocks of size 2^( 7) =       0.000417316664

      target function =      -0.939676594901
              le_mean =     -17.210142312598
             les_mean =     296.472091070669
             stat err =       0.000413665723
             autocorr =       1.243501757437
   target nu stat err =       0.000413665723
   target dn stat err =       0.002080129931
      target stat err =       0.003563921658
              std dev =       0.524624152767
             le_variance =       0.275230501666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331777
                                         uncertainty =       0.001541631514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331777
                                         uncertainty =       0.001541631514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370959361
  error estimate for blocks of size 2^( 2) =       0.000385340559
  error estimate for blocks of size 2^( 3) =       0.000398304215
  error estimate for blocks of size 2^( 4) =       0.000407618181
  error estimate for blocks of size 2^( 5) =       0.000413364098
  error estimate for blocks of size 2^( 6) =       0.000416363949
  error estimate for blocks of size 2^( 7) =       0.000417316664

      target function =      -0.939676594904
              le_mean =     -17.210142312598
             les_mean =     296.472091070674
             stat err =       0.000413665723
             autocorr =       1.243501757394
   target nu stat err =       0.000413665723
   target dn stat err =       0.002080129930
      target stat err =       0.003563921656
              std dev =       0.524624152765
             le_variance =       0.275230501664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331776
                                         uncertainty =       0.001541631513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275127331776
                                         uncertainty =       0.001541631513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370959361
  error estimate for blocks of size 2^( 2) =       0.000385340559
  error estimate for blocks of size 2^( 3) =       0.000398304215
  error estimate for blocks of size 2^( 4) =       0.000407618181
  error estimate for blocks of size 2^( 5) =       0.000413364098
  error estimate for blocks of size 2^( 6) =       0.000416363949
  error estimate for blocks of size 2^( 7) =       0.000417316664

      target function =      -0.939676594907
              le_mean =     -17.210142312598
             les_mean =     296.472091070678
             stat err =       0.000413665723
             autocorr =       1.243501757359
   target nu stat err =       0.000413665723
   target dn stat err =       0.002080129929
      target stat err =       0.003563921655
              std dev =       0.524624152764
             le_variance =       0.275230501663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939676594907        initial  <--
     3.7253e+06     3.7253e+07             9.2050e-11        -0.939676594901
     1.4901e+07     1.4901e+08             2.3012e-11        -0.939676594904
     5.9605e+07     5.9605e+08             5.7535e-12        -0.939676594907

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5268
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1418
    reference variance = 0.327648
====================================================
  Execution time = 2.6933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8821e-01
  Total weights = 1.966409690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2005e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277546915527
                                         uncertainty =       0.001483959744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277546915527
                                         uncertainty =       0.001483959744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372494455
  error estimate for blocks of size 2^( 2) =       0.000387039916
  error estimate for blocks of size 2^( 3) =       0.000399933133
  error estimate for blocks of size 2^( 4) =       0.000409153981
  error estimate for blocks of size 2^( 5) =       0.000414285518
  error estimate for blocks of size 2^( 6) =       0.000417755160
  error estimate for blocks of size 2^( 7) =       0.000419706126

      target function =      -0.931178776719
              le_mean =     -17.209872252291
             les_mean =     296.467912674277
             stat err =       0.000415225196
             autocorr =       1.242589771960
   target nu stat err =       0.000415225196
   target dn stat err =       0.002616023603
      target stat err =       0.004365907671
              std dev =       0.526795138284
             le_variance =       0.277513117719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720987225229e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198197485       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198197486       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931198197486       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931198197486       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931198195140       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931198175786       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931198199307       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931198195735       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931198152102       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931198162554       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931198182669       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931198150527       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931198226208       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931198171213       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931198257093       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931198157320       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931198193135       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931198164843       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931198198627       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931198176940       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931198146228       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931198058199       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931198156754       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931197958072       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931198104663       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931198385780       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931198211138       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931198149910       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931198280627       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931198127879       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931198189627       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931198269681       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931198096574       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931198226164       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931198216270       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931198231017       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931198221916       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931198236728       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931198097924       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931198139070       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931198085167       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931198271409       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+07 is 7.855682e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198197485       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198197485       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931198197485       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931198197485       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931198251247       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931198177690       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931198073248       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931198386602       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931198211183       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931197867683       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931198089937       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931198322404       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931197832404       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931198742263       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931197883610       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931197851747       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931198079582       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931198286711       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931197975956       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931197828893       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931198652441       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931197921054       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931198175680       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931198131148       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931198378295       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931198523558       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931197795481       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931198669744       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931198413596       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931197978921       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931198287898       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931198119844       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931198279248       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931198232044       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931197732687       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931198044369       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931198329701       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931198432907       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931197813691       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931197934016       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931198122274       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931198263612       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+08 is 1.963812e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931198197485       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931198197485       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931198197485       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931198197485       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931198197485       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931198180659       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931198195753       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931197880367       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931198988318       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931197706135       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931198251442       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931196923104       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931197991300       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931198834215       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931198463886       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931197904691       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931197315714       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931197846492       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931198807316       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931197145173       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931198094566       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931198046171       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931197687404       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931198339594       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931197679027       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931196736194       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931198837218       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931198034572       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931198245815       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931198449953       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931198086934       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931198634942       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931199223034       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931199199332       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931198825409       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931197263915       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931197701199       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.931197902552       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931197786741       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931199282209       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931196465418       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931198818380       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         41 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+08 is 4.908032e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.530001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5220e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2969
    reference variance = 0.460542
====================================================
  Execution time = 2.9067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8604e-01
  Total weights = 1.9666e+06
  Execution time = 2.2967e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712524
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712524
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264081
  error estimate for blocks of size 2^( 2) =       0.000385968782
  error estimate for blocks of size 2^( 3) =       0.000399497975
  error estimate for blocks of size 2^( 4) =       0.000409292047
  error estimate for blocks of size 2^( 5) =       0.000414732784
  error estimate for blocks of size 2^( 6) =       0.000417992524
  error estimate for blocks of size 2^( 7) =       0.000419339218

      target function =      -0.934731334599
              le_mean =     -17.210214110427
             les_mean =     296.477512495604
             stat err =       0.000415339143
             autocorr =       1.251525943542
   target nu stat err =       0.000415339143
   target dn stat err =       0.003542671309
      target stat err =       0.005922855723
              std dev =       0.525055099422
             le_variance =       0.275682857430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712525
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712525
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264081
  error estimate for blocks of size 2^( 2) =       0.000385968782
  error estimate for blocks of size 2^( 3) =       0.000399497975
  error estimate for blocks of size 2^( 4) =       0.000409292047
  error estimate for blocks of size 2^( 5) =       0.000414732784
  error estimate for blocks of size 2^( 6) =       0.000417992524
  error estimate for blocks of size 2^( 7) =       0.000419339218

      target function =      -0.934731334597
              le_mean =     -17.210214110427
             les_mean =     296.477512495606
             stat err =       0.000415339143
             autocorr =       1.251525943554
   target nu stat err =       0.000415339143
   target dn stat err =       0.003542671310
      target stat err =       0.005922855724
              std dev =       0.525055099423
             le_variance =       0.275682857430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712525
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712525
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264081
  error estimate for blocks of size 2^( 2) =       0.000385968782
  error estimate for blocks of size 2^( 3) =       0.000399497975
  error estimate for blocks of size 2^( 4) =       0.000409292047
  error estimate for blocks of size 2^( 5) =       0.000414732784
  error estimate for blocks of size 2^( 6) =       0.000417992524
  error estimate for blocks of size 2^( 7) =       0.000419339218

      target function =      -0.934731334598
              le_mean =     -17.210214110427
             les_mean =     296.477512495605
             stat err =       0.000415339143
             autocorr =       1.251525943550
   target nu stat err =       0.000415339143
   target dn stat err =       0.003542671309
      target stat err =       0.005922855723
              std dev =       0.525055099423
             le_variance =       0.275682857430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712524
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275688712524
                                         uncertainty =       0.001686845333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371264081
  error estimate for blocks of size 2^( 2) =       0.000385968782
  error estimate for blocks of size 2^( 3) =       0.000399497975
  error estimate for blocks of size 2^( 4) =       0.000409292047
  error estimate for blocks of size 2^( 5) =       0.000414732784
  error estimate for blocks of size 2^( 6) =       0.000417992524
  error estimate for blocks of size 2^( 7) =       0.000419339218

      target function =      -0.934731334599
              le_mean =     -17.210214110427
             les_mean =     296.477512495605
             stat err =       0.000415339143
             autocorr =       1.251525943546
   target nu stat err =       0.000415339143
   target dn stat err =       0.003542671309
      target stat err =       0.005922855723
              std dev =       0.525055099423
             le_variance =       0.275682857430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934731334599        initial  <--
     3.7253e+07     3.7253e+08             7.8557e-12        -0.934731334597
     1.4901e+08     1.4901e+09             1.9638e-12        -0.934731334598
     5.9605e+08     5.9605e+09             4.9080e-13        -0.934731334599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7098
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2594
    reference variance = 0.244694
====================================================
  Execution time = 2.7331e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0502e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8466e-01
  Total weights = 1.966299117e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2361e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276094927036
                                         uncertainty =       0.002361173330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276094927036
                                         uncertainty =       0.002361173330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371494630
  error estimate for blocks of size 2^( 2) =       0.000385802588
  error estimate for blocks of size 2^( 3) =       0.000398991157
  error estimate for blocks of size 2^( 4) =       0.000408684003
  error estimate for blocks of size 2^( 5) =       0.000414873805
  error estimate for blocks of size 2^( 6) =       0.000417264618
  error estimate for blocks of size 2^( 7) =       0.000418875342

      target function =      -0.937053799423
              le_mean =     -17.209978085451
             les_mean =     296.468004974713
             stat err =       0.000414924442
             autocorr =       1.247478180014
   target nu stat err =       0.000414924442
   target dn stat err =       0.002638895161
      target stat err =       0.004458775858
              std dev =       0.525381149340
             le_variance =       0.276025352082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720997808545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937074031846       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937074031846       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937074031846       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937074031846       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937074184053       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937074024504       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937074032771       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937074640026       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937073492005       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937072903644       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937073744098       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937073015122       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937073969131       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937074331332       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937073937191       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937073195718       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937074710646       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937074229663       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937072815138       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937074715452       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937073630284       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937073960231       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937074716186       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937073395802       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937074345950       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937073294971       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937073015527       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937073893605       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937073937731       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937073524447       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937072523713       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937074817520       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937072820641       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937073715911       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937074443704       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937073770914       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937074016717       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937074186061       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937074035760       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937072480252       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937073704961       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937074325041       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937073720159       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+08 is 8.973265e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937074031846       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937074031846       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937074031846       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937073774877       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937075453898       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937074490535       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937076194322       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937074734141       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937071534030       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937075098504       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937072537616       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937074719796       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937072865981       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937070603704       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937070639112       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937072999792       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937075049291       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937074210055       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937076400431       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937074747194       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937078494117       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937072113897       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937074820281       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937071788521       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937068886193       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937075011291       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937072089770       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937075711925       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937070555387       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937069208786       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937077863757       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937075953994       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937076971612       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937075334566       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937069187452       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937074874881       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937075614200       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937070958617       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937072024529       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937071999761       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937071169170       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937076803867       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937071685477       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+09 is 2.243597e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937074031846       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937074031846       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937074031846       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937073449515       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937072974906       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937071891174       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937073384910       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937075265006       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937069202747       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937067111687       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937091676460       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937072939742       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937069489786       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937070997162       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937053607058       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937063352303       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937064836547       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937082801387       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937069630763       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937076370240       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937089726220       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937093306609       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937077357397       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937066687230       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937068250754       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937081739000       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937082837013       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.937063483922       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937101593064       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937073917324       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937059000312       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937071343969       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937079423017       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937073245139       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.937037252057       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937075781435       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937097261409       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937082416204       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937049337670       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937068512423       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937066588614       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.937090989753       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937063851174       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937105704415       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937057973909       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937052384732       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.937061065651       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.937028185974       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937064615873       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937078102410       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.937047932201       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.937038623312       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.937086436081       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937089481515       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.937063473605       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.937082906379       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937078496505       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.937092446748       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937101666694       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.937010160121       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937120062768       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.936912595649       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.937112562110       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.937087838163       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.937115619090       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.936947213656       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.937214446566       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936946409084       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.937372171734       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937065112105       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.936934796540       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.936615317872       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937107524383       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.936862220882       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937038026465       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.936627050483       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.937500429512       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.936937191859       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.937445001796       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.936865658485       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.937458866768       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.936563604985       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936181103864       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.937681038148       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.940725627298       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.941317231788       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.925585654167       residual = 1.82e-02           smallest_sin_value = 9.98e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+09 is 5.570094e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.833971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5878e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.23548
====================================================
  Execution time = 2.6733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8691e-01
  Total weights = 1.9663e+06
  Execution time = 2.2862e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372584153
  error estimate for blocks of size 2^( 2) =       0.000387164380
  error estimate for blocks of size 2^( 3) =       0.000400448523
  error estimate for blocks of size 2^( 4) =       0.000409728163
  error estimate for blocks of size 2^( 5) =       0.000414965456
  error estimate for blocks of size 2^( 6) =       0.000418462249
  error estimate for blocks of size 2^( 7) =       0.000418523120

      target function =      -0.933310546495
              le_mean =     -17.210159066789
             les_mean =     296.476489684294
             stat err =       0.000415419747
             autocorr =       1.243155671929
   target nu stat err =       0.000415419747
   target dn stat err =       0.002293624371
      target stat err =       0.003863526959
              std dev =       0.526921992992
             le_variance =       0.277646786699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372584153
  error estimate for blocks of size 2^( 2) =       0.000387164380
  error estimate for blocks of size 2^( 3) =       0.000400448523
  error estimate for blocks of size 2^( 4) =       0.000409728163
  error estimate for blocks of size 2^( 5) =       0.000414965456
  error estimate for blocks of size 2^( 6) =       0.000418462249
  error estimate for blocks of size 2^( 7) =       0.000418523120

      target function =      -0.933310546494
              le_mean =     -17.210159066789
             les_mean =     296.476489684295
             stat err =       0.000415419747
             autocorr =       1.243155671927
   target nu stat err =       0.000415419747
   target dn stat err =       0.002293624371
      target stat err =       0.003863526959
              std dev =       0.526921992992
             le_variance =       0.277646786699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372584153
  error estimate for blocks of size 2^( 2) =       0.000387164380
  error estimate for blocks of size 2^( 3) =       0.000400448523
  error estimate for blocks of size 2^( 4) =       0.000409728163
  error estimate for blocks of size 2^( 5) =       0.000414965456
  error estimate for blocks of size 2^( 6) =       0.000418462249
  error estimate for blocks of size 2^( 7) =       0.000418523120

      target function =      -0.933310546495
              le_mean =     -17.210159066789
             les_mean =     296.476489684295
             stat err =       0.000415419747
             autocorr =       1.243155671930
   target nu stat err =       0.000415419747
   target dn stat err =       0.002293624371
      target stat err =       0.003863526959
              std dev =       0.526921992993
             le_variance =       0.277646786699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277736584724
                                         uncertainty =       0.001794472502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372584153
  error estimate for blocks of size 2^( 2) =       0.000387164380
  error estimate for blocks of size 2^( 3) =       0.000400448523
  error estimate for blocks of size 2^( 4) =       0.000409728163
  error estimate for blocks of size 2^( 5) =       0.000414965456
  error estimate for blocks of size 2^( 6) =       0.000418462249
  error estimate for blocks of size 2^( 7) =       0.000418523120

      target function =      -0.933310546495
              le_mean =     -17.210159066789
             les_mean =     296.476489684294
             stat err =       0.000415419747
             autocorr =       1.243155671925
   target nu stat err =       0.000415419747
   target dn stat err =       0.002293624371
      target stat err =       0.003863526959
              std dev =       0.526921992992
             le_variance =       0.277646786699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933310546495        initial  <--
     3.7253e+08     3.7253e+09             8.9733e-13        -0.933310546494
     1.4901e+09     1.4901e+10             2.2436e-13        -0.933310546495
     5.9605e+09     5.9605e+10             5.5701e-14        -0.933310546495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.3024
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.268
    reference variance = 0.314098
====================================================
  Execution time = 2.6748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0472e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8323e-01
  Total weights = 1.966467542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2799e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274429361708
                                         uncertainty =       0.001450140703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274429361708
                                         uncertainty =       0.001450140703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370388456
  error estimate for blocks of size 2^( 2) =       0.000384814653
  error estimate for blocks of size 2^( 3) =       0.000398078870
  error estimate for blocks of size 2^( 4) =       0.000407630427
  error estimate for blocks of size 2^( 5) =       0.000414071219
  error estimate for blocks of size 2^( 6) =       0.000417468341
  error estimate for blocks of size 2^( 7) =       0.000419634690

      target function =      -0.939451271244
              le_mean =     -17.210087389676
             les_mean =     296.470336253842
             stat err =       0.000414701170
             autocorr =       1.253590334257
   target nu stat err =       0.000414701170
   target dn stat err =       0.001993574640
      target stat err =       0.003420549714
              std dev =       0.523816758992
             le_variance =       0.274383997001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721008738968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939462721628       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939462721628       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939462721628       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939462721628       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939462721628       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939462721628       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939462721628       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939462721628       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939462721628       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939462721628       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939462721628       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939448768960       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939458194263       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939462721628       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939462721628       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939463494227       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939462721628       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939455798422       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939462721628       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939459617131       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939462279311       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939477170796       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939459622364       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939471981739       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939478495980       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939468427591       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939458112807       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939465973446       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939450341163       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939463059174       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939465749372       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939455319014       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939478574938       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939460707546       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939468047655       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939470971209       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939454912454       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939456180375       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939440231881       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939469546177       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939480047212       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939454715517       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939481568225       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939470511542       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939449802272       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939463785933       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939470565828       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939456945120       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939464510344       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         48 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+09 is 1.177831e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939462721628       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939462721628       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939462721628       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939462721628       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939481275892       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939466017446       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939462721628       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939462721628       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939462721628       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939462721628       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939486195866       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939441805535       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939462721628       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939462721628       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939462721628       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939490699344       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939448578279       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939477882240       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939448893332       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939477631192       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939454889543       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939484731638       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939430235574       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939443609194       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939492160674       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939394599995       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939460228085       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939441243315       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939402650544       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939451254647       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939418312263       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939446878266       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939448144664       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939450514953       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939502029163       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939483188423       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939443730163       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939458330778       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939485917368       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939442307682       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939509952446       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939425166719       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939611126114       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939387830309       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939434353121       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939410773042       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939517001010       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939434903292       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939472050836       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939404209168       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939650542041       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939444271611       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939534320986       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.939526919937       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939543827654       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939247494428       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939129582473       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939625362322       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.939541427537       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.939609548513       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939633601372       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939242244105       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938776033230       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940196594102       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.939597160020       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939447986215       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.939672867402       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.940425978672       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.939129950913       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.939492935053       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.939037885833       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.940212070165       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.940692406272       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.939882898058       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.939939660891       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938813408786       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.938451499909       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.942871815344       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.938550406084       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940802103756       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.937631504254       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.941431215096       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.937375074109       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.941852357710       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.939538472175       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.938343214927       residual = 5.81e-04           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+10 is 2.887325e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939462721628       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939462721628       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939462721628       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939462721628       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939462721628       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939462721628       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939513642103       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939456458555       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939407439912       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939399254835       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939441212089       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939479570729       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939328657748       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939439667664       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939519594353       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939346470386       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939539545982       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939304572522       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939479264626       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939585162902       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939287364482       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939441847438       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939528666003       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939340976693       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939618114719       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939316357466       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939490862484       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939256754093       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939577100380       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939726267685       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939486238283       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939555579061       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939196773629       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939259332422       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939544910403       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940231051507       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939446781645       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939405357560       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939516075527       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938596809332       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939316120261       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938962767139       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939170285097       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939505824817       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938961163953       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939839276507       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939151025415       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939861162010       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939049133348       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939052555523       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939474004018       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939118055319       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940113895495       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937777206760       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939450599066       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939760768805       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937953951777       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939800238301       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.939938455429       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.939170296023       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939028475730       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.940409921144       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940116846991       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.938488743543       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.940062345133       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939423199489       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.938996444060       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.938270420635       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.936478790067       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.938756508225       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.936887983365       residual = 6.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.936367789250       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.940013555500       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.936281037671       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.938367849805       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.943947628482       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.942337232806       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938919544366       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.943900547654       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.944944958190       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.957723630099       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.940224372692       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936598176180       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.908601609006       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.917703546564       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.943083254415       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.933326970726       residual = 4.76e-03           smallest_sin_value = 9.94e-01
davidson iteration   87 stopping due to small subspace S singular value of 7.25e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+10 is 6.749310e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.351267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5553e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2832
    reference variance = 0.257958
====================================================
  Execution time = 2.6883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8828e-01
  Total weights = 1.9665e+06
  Execution time = 2.2898e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373481181
  error estimate for blocks of size 2^( 2) =       0.000387662106
  error estimate for blocks of size 2^( 3) =       0.000400597293
  error estimate for blocks of size 2^( 4) =       0.000409725930
  error estimate for blocks of size 2^( 5) =       0.000415847501
  error estimate for blocks of size 2^( 6) =       0.000418726637
  error estimate for blocks of size 2^( 7) =       0.000419073316

      target function =      -0.931058692200
              le_mean =     -17.209913410729
             les_mean =     296.469402807693
             stat err =       0.000415843346
             autocorr =       1.239715603756
   target nu stat err =       0.000415843346
   target dn stat err =       0.002481848498
      target stat err =       0.004147924358
              std dev =       0.528190601709
             le_variance =       0.278985311734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373481181
  error estimate for blocks of size 2^( 2) =       0.000387662106
  error estimate for blocks of size 2^( 3) =       0.000400597293
  error estimate for blocks of size 2^( 4) =       0.000409725930
  error estimate for blocks of size 2^( 5) =       0.000415847501
  error estimate for blocks of size 2^( 6) =       0.000418726637
  error estimate for blocks of size 2^( 7) =       0.000419073316

      target function =      -0.931058692200
              le_mean =     -17.209913410729
             les_mean =     296.469402807693
             stat err =       0.000415843346
             autocorr =       1.239715603757
   target nu stat err =       0.000415843346
   target dn stat err =       0.002481848498
      target stat err =       0.004147924358
              std dev =       0.528190601709
             le_variance =       0.278985311734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373481181
  error estimate for blocks of size 2^( 2) =       0.000387662106
  error estimate for blocks of size 2^( 3) =       0.000400597293
  error estimate for blocks of size 2^( 4) =       0.000409725930
  error estimate for blocks of size 2^( 5) =       0.000415847501
  error estimate for blocks of size 2^( 6) =       0.000418726637
  error estimate for blocks of size 2^( 7) =       0.000419073316

      target function =      -0.931058692200
              le_mean =     -17.209913410729
             les_mean =     296.469402807693
             stat err =       0.000415843346
             autocorr =       1.239715603756
   target nu stat err =       0.000415843346
   target dn stat err =       0.002481848498
      target stat err =       0.004147924358
              std dev =       0.528190601709
             le_variance =       0.278985311734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653994
                                         uncertainty =       0.001953742424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373481181
  error estimate for blocks of size 2^( 2) =       0.000387662106
  error estimate for blocks of size 2^( 3) =       0.000400597293
  error estimate for blocks of size 2^( 4) =       0.000409725930
  error estimate for blocks of size 2^( 5) =       0.000415847501
  error estimate for blocks of size 2^( 6) =       0.000418726637
  error estimate for blocks of size 2^( 7) =       0.000419073316

      target function =      -0.931058692200
              le_mean =     -17.209913410729
             les_mean =     296.469402807693
             stat err =       0.000415843346
             autocorr =       1.239715603757
   target nu stat err =       0.000415843346
   target dn stat err =       0.002481848498
      target stat err =       0.004147924358
              std dev =       0.528190601709
             le_variance =       0.278985311734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931058692200        initial  <--
     3.7253e+09     3.7253e+10             1.1778e-13        -0.931058692200
     1.4901e+10     1.4901e+11             2.8873e-14        -0.931058692200
     5.9605e+10     5.9605e+11             6.7493e-15        -0.931058692200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4960
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1745
    reference variance = 0.214095
====================================================
  Execution time = 2.7199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8706e-01
  Total weights = 1.966293679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1427e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275178827364
                                         uncertainty =       0.001605719402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275178827364
                                         uncertainty =       0.001605719402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370983861
  error estimate for blocks of size 2^( 2) =       0.000385457125
  error estimate for blocks of size 2^( 3) =       0.000399029080
  error estimate for blocks of size 2^( 4) =       0.000408265659
  error estimate for blocks of size 2^( 5) =       0.000413868492
  error estimate for blocks of size 2^( 6) =       0.000416490715
  error estimate for blocks of size 2^( 7) =       0.000418092726

      target function =      -0.933081917296
              le_mean =     -17.208907557292
             les_mean =     296.433561022933
             stat err =       0.000414179398
             autocorr =       1.246427299148
   target nu stat err =       0.000414179398
   target dn stat err =       0.003505758309
      target stat err =       0.005826876264
              std dev =       0.524658801581
             le_variance =       0.275266858077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720890755729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933117223919       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933117223919       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933117223919       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933117223919       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933120127407       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933122566365       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933223885275       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933077027179       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933113098726       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933071074145       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933092357280       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933083216437       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933088464121       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933166898867       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933176405583       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933034468119       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933126321044       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933066850769       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933058748233       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933122776735       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933249372908       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933187441421       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933110680189       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933072192819       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933180428094       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933140817572       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933039797257       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932961120312       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932942064407       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933142546899       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932702648391       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932930908027       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933344213549       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933169659855       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933221673731       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933215787256       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933104962592       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933401830617       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933424276578       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932974734535       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933014331356       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932760992319       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932892006296       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933081822284       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933306925424       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.933225384234       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933177307138       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.933088057316       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933437676198       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.932717639000       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.933708787152       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932955112216       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.934003751116       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.933505215463       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932287311931       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.932840406698       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932958806136       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.933105116496       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932319549179       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.933079058977       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931852825177       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.933860281228       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.933238022699       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.930073249658       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.934473892509       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.934297647671       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.933950022043       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.930804244177       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938354244064       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.931309558109       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.934032556214       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.939765539756       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.934893000879       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.931384313170       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.929090246184       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.935290648956       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.938845629986       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.937226203287       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.935112905227       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.910058362226       residual = 5.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.919972678150       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.929814731017       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.924531804148       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.934697795254       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.921452118886       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.939446874230       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.934252117643       residual = 1.60e-02           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 1.065209e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933117223919       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933117223919       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933117223919       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933117223919       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933112469815       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933022250764       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933169980387       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933224535368       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933117223919       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933179225666       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932780895887       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933305719605       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933046769607       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932918407201       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933252740020       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933119024346       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932778922293       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933085024925       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933325916080       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933034774645       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933465428415       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933020585879       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933260871481       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933102928542       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933083249388       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930789160576       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933374250925       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932414422756       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934281861960       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933274233591       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.933872392758       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934079424937       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933271829594       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933168085352       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932793496257       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933085447432       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932341612890       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933814556807       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933732993757       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934675143686       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932665744731       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932729233348       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933908669397       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.931315574563       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934035438728       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935392462698       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.932082472037       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932346750374       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.930642019580       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.926154000258       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932581971567       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932516052568       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.932211150804       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931994664631       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.930860625225       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.934487821351       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.931487014045       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.934141463791       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.935405304064       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.935163526505       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931121194135       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.936757362977       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.936967455581       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933628755283       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.933869806904       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935968414275       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.924990673470       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.928447554212       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932325273421       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.941342353709       residual = 7.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.935646116890       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.918248822000       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.926014721636       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.946289373007       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.888579923786       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.942158465739       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.884351405768       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.904198597860       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.919482766169       residual = 8.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.962437933329       residual = 4.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.915770210751       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.842455669859       residual = 8.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.124521699267       residual = 3.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.892419361093       residual = 4.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.053378965697       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.063218333938       residual = 1.68e+00           smallest_sin_value = 9.98e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.960372966563       residual = 3.15e-01           smallest_sin_value = 9.97e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.93e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.989531e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933117223919       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933117223919       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933117223919       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933117223919       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933118045715       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933028166793       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933100718783       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933389577907       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933243474386       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932428611254       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933853308835       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932979084607       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934312591866       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932704904758       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934707054297       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932519985834       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932554658548       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933012990684       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933572214947       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933141486077       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930786455817       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927673089104       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931590105690       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932325685248       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932755372798       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934008068076       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.933300256777       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932215752793       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932506049406       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934028774072       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935388824290       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.933505433797       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930958711172       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932303552620       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928610876324       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927721339754       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932075521982       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926546137926       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929989569234       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.931570931317       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931443252575       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929647495473       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929974236351       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.932917720717       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936157738209       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941524710026       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933428513626       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.928447769249       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928531352167       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.938860823487       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932129113180       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932792825691       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942536995675       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.945612487513       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.919294597830       residual = 2.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.922106109425       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.921824095165       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939798168378       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.933682504263       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.925289489187       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.929665222888       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.928603144614       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.915005482374       residual = 5.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.952740325460       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.915581098797       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.941125674648       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.881579152090       residual = 3.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.974552392017       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.947158951854       residual = 4.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.915219293093       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.937305540049       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.940118306480       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.954855003629       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.904660902944       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944204431017       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.761284308562       residual = 3.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.953748913011       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.031833455057       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.886367373117       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.060555638987       residual = 2.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.864070611679       residual = 8.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.795931776912       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.300753068107       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.854147550530       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.149603407241       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.787702301941       residual = 5.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.172856733834       residual = 1.90e+01           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 4.642879e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.081332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6082e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.451631
====================================================
  Execution time = 2.7334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8762e-01
  Total weights = 1.9665e+06
  Execution time = 2.2891e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958919
  error estimate for blocks of size 2^( 2) =       0.000386087611
  error estimate for blocks of size 2^( 3) =       0.000399131015
  error estimate for blocks of size 2^( 4) =       0.000409063722
  error estimate for blocks of size 2^( 5) =       0.000414322977
  error estimate for blocks of size 2^( 6) =       0.000417969905
  error estimate for blocks of size 2^( 7) =       0.000419828371

      target function =      -0.932153337937
              le_mean =     -17.209462133614
             les_mean =     296.453211674684
             stat err =       0.000415296244
             autocorr =       1.246596928251
   target nu stat err =       0.000415296244
   target dn stat err =       0.002681965738
      target stat err =       0.004478671747
              std dev =       0.526037764298
             le_variance =       0.276715729468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958919
  error estimate for blocks of size 2^( 2) =       0.000386087611
  error estimate for blocks of size 2^( 3) =       0.000399131015
  error estimate for blocks of size 2^( 4) =       0.000409063722
  error estimate for blocks of size 2^( 5) =       0.000414322977
  error estimate for blocks of size 2^( 6) =       0.000417969905
  error estimate for blocks of size 2^( 7) =       0.000419828371

      target function =      -0.932153337937
              le_mean =     -17.209462133614
             les_mean =     296.453211674684
             stat err =       0.000415296244
             autocorr =       1.246596928250
   target nu stat err =       0.000415296244
   target dn stat err =       0.002681965738
      target stat err =       0.004478671747
              std dev =       0.526037764298
             le_variance =       0.276715729468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958919
  error estimate for blocks of size 2^( 2) =       0.000386087611
  error estimate for blocks of size 2^( 3) =       0.000399131015
  error estimate for blocks of size 2^( 4) =       0.000409063722
  error estimate for blocks of size 2^( 5) =       0.000414322977
  error estimate for blocks of size 2^( 6) =       0.000417969905
  error estimate for blocks of size 2^( 7) =       0.000419828371

      target function =      -0.932153337937
              le_mean =     -17.209462133614
             les_mean =     296.453211674684
             stat err =       0.000415296244
             autocorr =       1.246596928250
   target nu stat err =       0.000415296244
   target dn stat err =       0.002681965738
      target stat err =       0.004478671747
              std dev =       0.526037764298
             le_variance =       0.276715729468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276666512539
                                         uncertainty =       0.001890111284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958919
  error estimate for blocks of size 2^( 2) =       0.000386087611
  error estimate for blocks of size 2^( 3) =       0.000399131015
  error estimate for blocks of size 2^( 4) =       0.000409063722
  error estimate for blocks of size 2^( 5) =       0.000414322977
  error estimate for blocks of size 2^( 6) =       0.000417969905
  error estimate for blocks of size 2^( 7) =       0.000419828371

      target function =      -0.932153337937
              le_mean =     -17.209462133614
             les_mean =     296.453211674684
             stat err =       0.000415296244
             autocorr =       1.246596928253
   target nu stat err =       0.000415296244
   target dn stat err =       0.002681965738
      target stat err =       0.004478671747
              std dev =       0.526037764298
             le_variance =       0.276715729468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932153337937        initial
     3.7253e+10     3.7253e+11             1.0652e-14        -0.932153337937  <--
     1.4901e+11     1.4901e+12             2.9895e-15        -0.932153337937
     5.9605e+11     5.9605e+12             4.6429e-16        -0.932153337937

*****************************************************************************
Applying the update for shift_i =   3.7253e+10     and shift_s =   3.7253e+11
*****************************************************************************

  Execution time = 3.8921e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.89588
====================================================
  Execution time = 2.6987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0473e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8328e-01
  Total weights = 1.966391327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2313e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275530257995
                                         uncertainty =       0.001745085644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275530257995
                                         uncertainty =       0.001745085644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371161314
  error estimate for blocks of size 2^( 2) =       0.000385601296
  error estimate for blocks of size 2^( 3) =       0.000398777402
  error estimate for blocks of size 2^( 4) =       0.000408526048
  error estimate for blocks of size 2^( 5) =       0.000414101558
  error estimate for blocks of size 2^( 6) =       0.000417314347
  error estimate for blocks of size 2^( 7) =       0.000417782884

      target function =      -0.939375347055
              le_mean =     -17.209045860136
             les_mean =     296.434543281901
             stat err =       0.000414431209
             autocorr =       1.246750351661
   target nu stat err =       0.000414431209
   target dn stat err =       0.001992898260
      target stat err =       0.003412053990
              std dev =       0.524909762227
             le_variance =       0.275530258481


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720904586014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939386714174       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939386714174       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939386714174       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939386714174       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939386714174       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939394984520       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939386714174       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939379137245       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939385024281       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939386714174       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939400261294       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939408923948       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939388204634       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939387936208       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939386714174       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939388441065       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939364258775       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939358907120       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939309583089       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939396457041       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939398194458       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939405126128       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939379380338       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939395167027       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939395706027       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939405385903       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939400665395       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939387368895       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939364958577       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939366585854       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939450405796       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939380383626       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939375956500       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939378135842       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939283024902       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939339834183       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939526587612       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939399117555       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939411167592       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939277472614       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939335530806       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939413627084       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939416369409       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939439843772       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939451431213       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939285188752       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939613730984       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939354865262       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939389981079       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939348439883       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939297936018       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939297365888       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939287626557       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.939261862868       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939438466420       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939501976915       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939557817316       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939273011855       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.939466721471       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.939172256647       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939614544727       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.939232645228       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.939079183120       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.939378651109       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.939459426753       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939997106320       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.939153743712       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.939449290652       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.939180907567       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.939539323787       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.939249077208       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.937741637686       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937609254831       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.938485433770       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.938648209817       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938570014336       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.938591350793       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938317941662       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.936809853792       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.938819225442       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.937853448948       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.939702475131       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.941821956047       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.937703034876       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.936747089764       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.940768296293       residual = 6.21e-04           smallest_sin_value = 9.98e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.941657333681       residual = 8.50e-04           smallest_sin_value = 9.95e-01
davidson iteration   87 stopping due to small subspace S singular value of 7.21e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+09 is 3.659647e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939386714174       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939386714174       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939386714174       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939386714174       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939386714174       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939386714174       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939386714174       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939386714174       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939350791488       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939386714174       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939386714174       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939439788106       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939386714174       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939386714174       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939386714174       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939330914441       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939390216584       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939287362867       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939337353746       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939178992773       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939393043880       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939383823052       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939381467937       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939223830540       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939414792161       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939315214479       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939406549092       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939430917796       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939240372098       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939390430467       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939358149596       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939349222718       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939501342903       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939333196670       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939358732877       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939222619126       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939352262942       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939944945343       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939547076578       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939346296354       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939536717685       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.939521980600       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939504431324       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939244850772       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938837669436       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.939434712082       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939124047570       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939369757943       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.939633424380       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.939308390746       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.939202565926       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939431195442       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939252314502       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.939290512448       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.939783817641       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.940229516183       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939085182687       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.940749976273       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938192008933       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941288284811       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939549446182       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.938726929791       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.940103954656       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.939363934453       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.938975623665       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.938853143020       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940432273971       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.940133571859       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.939461788306       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.939959879617       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.938545599039       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.938175878264       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.939404036052       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.935999118052       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.938965412099       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.944316281414       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.933846782596       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.940807430325       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.943831506056       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.945654624436       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.941869990161       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.930024851618       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936359381717       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.942622956494       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.911587370529       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.936499022714       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.929889467511       residual = 1.48e-02           smallest_sin_value = 9.99e-01
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.944573474798       residual = 3.81e-02           smallest_sin_value = 9.98e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.04e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 9.289668e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939386714174       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939386714174       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939386714174       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939386714174       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939253202772       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939217064843       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939386714174       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939386714174       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939386714174       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940042848144       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939386714174       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939589303782       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939197209518       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939265272327       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939394330159       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938981640152       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939448388314       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939134902881       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938800988758       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939242614241       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939025471366       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939411824299       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939267053914       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938778645912       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938970979879       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939617149240       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939628586274       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939972259557       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939886616448       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938863001218       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939793916282       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939761088598       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939148580090       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938823740580       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938442270928       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939516314285       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940352953927       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939916556977       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940614982854       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941447014908       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937955415063       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940265725514       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.941481053797       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940086110019       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938472878527       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940583072209       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942465979950       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.939967367822       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.942621744482       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.938993099112       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.943281735389       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.939121661532       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.942299263343       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.940427636761       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934680409180       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.936167775822       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.938837645133       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942412921000       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.939525294109       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.941338639309       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.945552062484       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.938139808277       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.939929613123       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.936760283283       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.941358691894       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.938008015278       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.931416445208       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932336733035       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938320822036       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937881813977       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.948732183623       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.944644640386       residual = 9.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.926837225566       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.935757453454       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.949542022904       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.938836038840       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934783972543       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.932669039995       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.918073101701       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.941165494430       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.888752431370       residual = 3.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.950087918635       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.986783696523       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.960485447575       residual = 6.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.921127679602       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.873417508689       residual = 5.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.010375452966       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.921464775398       residual = 3.05e-01           smallest_sin_value = 9.99e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.251865e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.830585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5975e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.28
    reference variance = 0.510632
====================================================
  Execution time = 2.9079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8267e-01
  Total weights = 1.9664e+06
  Execution time = 2.3649e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369854604
  error estimate for blocks of size 2^( 2) =       0.000384524889
  error estimate for blocks of size 2^( 3) =       0.000398031092
  error estimate for blocks of size 2^( 4) =       0.000407570528
  error estimate for blocks of size 2^( 5) =       0.000414295711
  error estimate for blocks of size 2^( 6) =       0.000416041392
  error estimate for blocks of size 2^( 7) =       0.000418059585

      target function =      -0.940396673652
              le_mean =     -17.209914983553
             les_mean =     296.463840625359
             stat err =       0.000413991804
             autocorr =       1.252914480130
   target nu stat err =       0.000413991804
   target dn stat err =       0.001889054007
      target stat err =       0.003254834489
              std dev =       0.523061765569
             le_variance =       0.273593610600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369854604
  error estimate for blocks of size 2^( 2) =       0.000384524889
  error estimate for blocks of size 2^( 3) =       0.000398031092
  error estimate for blocks of size 2^( 4) =       0.000407570528
  error estimate for blocks of size 2^( 5) =       0.000414295711
  error estimate for blocks of size 2^( 6) =       0.000416041392
  error estimate for blocks of size 2^( 7) =       0.000418059585

      target function =      -0.940396673652
              le_mean =     -17.209914983553
             les_mean =     296.463840625359
             stat err =       0.000413991804
             autocorr =       1.252914480130
   target nu stat err =       0.000413991804
   target dn stat err =       0.001889054007
      target stat err =       0.003254834489
              std dev =       0.523061765569
             le_variance =       0.273593610600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369854604
  error estimate for blocks of size 2^( 2) =       0.000384524889
  error estimate for blocks of size 2^( 3) =       0.000398031092
  error estimate for blocks of size 2^( 4) =       0.000407570528
  error estimate for blocks of size 2^( 5) =       0.000414295711
  error estimate for blocks of size 2^( 6) =       0.000416041392
  error estimate for blocks of size 2^( 7) =       0.000418059585

      target function =      -0.940396673652
              le_mean =     -17.209914983553
             les_mean =     296.463840625359
             stat err =       0.000413991804
             autocorr =       1.252914480134
   target nu stat err =       0.000413991804
   target dn stat err =       0.001889054007
      target stat err =       0.003254834489
              std dev =       0.523061765569
             le_variance =       0.273593610600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273580831015
                                         uncertainty =       0.001436760837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369854604
  error estimate for blocks of size 2^( 2) =       0.000384524889
  error estimate for blocks of size 2^( 3) =       0.000398031092
  error estimate for blocks of size 2^( 4) =       0.000407570528
  error estimate for blocks of size 2^( 5) =       0.000414295711
  error estimate for blocks of size 2^( 6) =       0.000416041392
  error estimate for blocks of size 2^( 7) =       0.000418059585

      target function =      -0.940396673652
              le_mean =     -17.209914983553
             les_mean =     296.463840625359
             stat err =       0.000413991804
             autocorr =       1.252914480133
   target nu stat err =       0.000413991804
   target dn stat err =       0.001889054007
      target stat err =       0.003254834489
              std dev =       0.523061765569
             le_variance =       0.273593610600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940396673652        initial
     9.3132e+09     9.3132e+10             3.6596e-14        -0.940396673652
     3.7253e+10     3.7253e+11             9.2897e-15        -0.940396673652
     1.4901e+11     1.4901e+12             2.2519e-15        -0.940396673652  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 4.1032e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7014e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.589533
====================================================
  Execution time = 2.7070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0515e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9060e-01
  Total weights = 1.966243693e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3119e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280183331191
                                         uncertainty =       0.001857622486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280183331191
                                         uncertainty =       0.001857622486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374298516
  error estimate for blocks of size 2^( 2) =       0.000388596513
  error estimate for blocks of size 2^( 3) =       0.000401830072
  error estimate for blocks of size 2^( 4) =       0.000411390388
  error estimate for blocks of size 2^( 5) =       0.000416499066
  error estimate for blocks of size 2^( 6) =       0.000419293483
  error estimate for blocks of size 2^( 7) =       0.000422466799

      target function =      -0.927264808398
              le_mean =     -17.209513113090
             les_mean =     296.457943802151
             stat err =       0.000417412434
             autocorr =       1.243639628132
   target nu stat err =       0.000417412434
   target dn stat err =       0.003136619367
      target stat err =       0.005165972814
              std dev =       0.529346507727
             le_variance =       0.280207725242


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720951311309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927292640065       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927292640065       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927292640065       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927280566315       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927286435742       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927296329287       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927299964616       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927225784808       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927361687993       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927407903203       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927321034963       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927297448539       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927416980845       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927359976699       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927313800944       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927389557751       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927272483392       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927278625998       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927236888606       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927216259030       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927325201687       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927306826063       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927221586121       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927294077906       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927238082532       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927170683586       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927323200859       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927337691221       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927293908726       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927320549095       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927265157444       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927407510293       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927221270115       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.927363807156       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927164751482       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927346469400       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927304174476       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927459544580       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.927450830652       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927377544874       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.927177467032       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.926964544861       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.927375729407       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.927246020362       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.927673316165       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.927374412707       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.926975600874       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.927404277409       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.927307787062       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.927468852651       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.927719558698       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.927356441601       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.926745161344       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.927186576573       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.927310978808       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.927281654436       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.927891767507       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.926266865070       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.927146655822       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.926210216053       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.927316603905       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.927290482199       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.926464652066       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.926501730491       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.927449821363       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.927902365794       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.926553693329       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926745571074       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.926203670098       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.926668525509       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.926888888590       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.929241967034       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.927442209694       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.929798899565       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.928565722925       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.931586046251       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.930960768825       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.927923745751       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.930398550531       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.926686468643       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.925973947452       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.926385424961       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.923148155217       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.929272374760       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.922731309739       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.951448260418       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.927367493541       residual = 3.28e-02           smallest_sin_value = 9.93e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 9.118303e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927292640065       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927292640065       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927292640065       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927458717934       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927222162946       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927309559031       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927349172328       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926984319026       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927100699284       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927263455456       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926902231056       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927468292042       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.927443822892       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927753432847       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927366919179       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927227991081       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927679924537       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927225276485       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927321640459       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927190736591       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927984257919       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.926955484865       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927509455697       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927401163748       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927506036680       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.927573807199       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927314312102       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.927397598391       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927350501875       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927494710871       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.927290332394       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928410909083       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.926897131440       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.926327503376       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.928150920431       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.927312997565       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.927237324218       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927511607997       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.926824424086       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.927340228078       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925188475201       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928449097464       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.927310444114       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.928261028311       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.928187901355       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.924844973859       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930665817253       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.926925116159       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.926437254315       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.926245551361       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.925996824452       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.928925422532       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.924153280536       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.929852739285       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.929949414233       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.925699577958       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.926263201624       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.925245566017       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.926959230265       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.927990303679       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.926371984115       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.928008214433       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.928320166337       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.925374386525       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.933298806774       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.926424933327       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.925405635016       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.925753116787       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.931157311418       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.936179684147       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.931480703962       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.941196652824       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937300952081       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.933143616572       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.945090181019       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.922507507239       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.932489620785       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938969031337       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.918657229806       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.913569205474       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.922388415394       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.927903645772       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.903721388914       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.920848598424       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.935527429416       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   85 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.258513e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927292640065       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927292640065       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927292640065       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.927292640065       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.927241892535       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.927292640065       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.927292640065       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927692426749       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.927292640065       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927273972730       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925569439169       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927859506672       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929586189863       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926251531765       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927836655440       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926457704535       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.927249473515       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927902771065       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927799121045       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.927455150318       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928494567265       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927336428609       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.927035122933       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926632916399       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929516101461       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.925138629650       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922768913375       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.926687559768       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.927449646579       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.926082559088       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.925676461480       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922181079020       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924820510077       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925156218525       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920077538727       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922065553719       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.928182460799       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.926688485974       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.921593558400       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930380624548       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918944598824       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.925299983318       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.927436197542       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925151151614       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.923565872974       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.924562237882       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.923469589749       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.924948622416       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.934461818990       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.920748204537       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930382325230       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934782754206       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.926928408406       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.922384859962       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.936897719538       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.926022967104       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.924028530608       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.925638171403       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.941195344694       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936534828134       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.932548952134       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935894199503       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.924405873791       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.919876528382       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.915880567603       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.902165407635       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.916672234291       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.916986564206       residual = 7.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.913775344740       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.918650198246       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.981808707331       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.021383893187       residual = 8.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.969743672878       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.899825300843       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.903636684505       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.954884053528       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.901243809221       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.873747424977       residual = 5.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.950454113604       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.884034266338       residual = 7.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.965536218317       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.953215938907       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.629111430414       residual = 8.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.971803504812       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.941096488856       residual = 6.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   85 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 3.300409e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.529857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6089e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.247723
====================================================
  Execution time = 2.6896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9543e-01
  Total weights = 1.9666e+06
  Execution time = 2.3636e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372669493
  error estimate for blocks of size 2^( 2) =       0.000386944046
  error estimate for blocks of size 2^( 3) =       0.000400047746
  error estimate for blocks of size 2^( 4) =       0.000409575459
  error estimate for blocks of size 2^( 5) =       0.000414708867
  error estimate for blocks of size 2^( 6) =       0.000418921202
  error estimate for blocks of size 2^( 7) =       0.000419532416

      target function =      -0.919316147685
              le_mean =     -17.209451764572
             les_mean =     296.460660804579
             stat err =       0.000415684486
             autocorr =       1.244170635943
   target nu stat err =       0.000415684486
   target dn stat err =       0.007916097329
      target stat err =       0.012706397193
              std dev =       0.527042683867
             le_variance =       0.277773990618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372669493
  error estimate for blocks of size 2^( 2) =       0.000386944046
  error estimate for blocks of size 2^( 3) =       0.000400047746
  error estimate for blocks of size 2^( 4) =       0.000409575459
  error estimate for blocks of size 2^( 5) =       0.000414708867
  error estimate for blocks of size 2^( 6) =       0.000418921202
  error estimate for blocks of size 2^( 7) =       0.000419532416

      target function =      -0.919316147685
              le_mean =     -17.209451764572
             les_mean =     296.460660804579
             stat err =       0.000415684486
             autocorr =       1.244170635945
   target nu stat err =       0.000415684486
   target dn stat err =       0.007916097329
      target stat err =       0.012706397193
              std dev =       0.527042683867
             le_variance =       0.277773990618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372669493
  error estimate for blocks of size 2^( 2) =       0.000386944046
  error estimate for blocks of size 2^( 3) =       0.000400047746
  error estimate for blocks of size 2^( 4) =       0.000409575459
  error estimate for blocks of size 2^( 5) =       0.000414708867
  error estimate for blocks of size 2^( 6) =       0.000418921202
  error estimate for blocks of size 2^( 7) =       0.000419532416

      target function =      -0.919316147685
              le_mean =     -17.209451764572
             les_mean =     296.460660804578
             stat err =       0.000415684486
             autocorr =       1.244170635943
   target nu stat err =       0.000415684486
   target dn stat err =       0.007916097329
      target stat err =       0.012706397193
              std dev =       0.527042683867
             le_variance =       0.277773990618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277805180781
                                         uncertainty =       0.001752131188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372669493
  error estimate for blocks of size 2^( 2) =       0.000386944046
  error estimate for blocks of size 2^( 3) =       0.000400047746
  error estimate for blocks of size 2^( 4) =       0.000409575459
  error estimate for blocks of size 2^( 5) =       0.000414708867
  error estimate for blocks of size 2^( 6) =       0.000418921202
  error estimate for blocks of size 2^( 7) =       0.000419532416

      target function =      -0.919316147686
              le_mean =     -17.209451764572
             les_mean =     296.460660804578
             stat err =       0.000415684486
             autocorr =       1.244170635943
   target nu stat err =       0.000415684486
   target dn stat err =       0.007916097329
      target stat err =       0.012706397193
              std dev =       0.527042683867
             le_variance =       0.277773990618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919316147685        initial
     3.7253e+10     3.7253e+11             9.1183e-15        -0.919316147685
     1.4901e+11     1.4901e+12             2.2585e-15        -0.919316147685
     5.9605e+11     5.9605e+12             3.3004e-16        -0.919316147686  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 3.8830e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1623
    reference variance = 0.285467
====================================================
  Execution time = 2.7224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8921e-01
  Total weights = 1.966132024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2168e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280320752890
                                         uncertainty =       0.002372160413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280320752890
                                         uncertainty =       0.002372160413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374342440
  error estimate for blocks of size 2^( 2) =       0.000388100978
  error estimate for blocks of size 2^( 3) =       0.000401357179
  error estimate for blocks of size 2^( 4) =       0.000410946738
  error estimate for blocks of size 2^( 5) =       0.000416033979
  error estimate for blocks of size 2^( 6) =       0.000418810843
  error estimate for blocks of size 2^( 7) =       0.000423774071

      target function =      -0.929542041133
              le_mean =     -17.209522177692
             les_mean =     296.456865939648
             stat err =       0.000417391408
             autocorr =       1.243222542942
   target nu stat err =       0.000417391408
   target dn stat err =       0.002795623132
      target stat err =       0.004638824508
              std dev =       0.529408625616
             le_variance =       0.280273492877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720952217769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929563812077       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929563812077       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929563812077       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929563812077       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929563793277       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929600530612       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929591934813       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929179888728       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929434861482       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929461637146       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929390697515       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929717940935       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929719034404       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929300040949       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929300183094       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929479351234       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929643600776       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929726351424       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929355304242       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929561654002       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929644558867       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929736401224       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929276986575       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929401702842       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929768581548       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930480129436       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929546679144       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929558617770       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929634997434       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929302243183       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929326432352       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928953766342       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929715130738       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930156416190       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.930788163824       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930742630885       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929873486537       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929281391686       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930737714433       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929887731491       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.930091511927       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928948523007       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.928269883794       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.930223891837       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.931219357071       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.928660359842       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930286672986       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931162297668       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928883302975       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.928907542729       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930342993600       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.929995267736       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.929606353526       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.928957662072       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.928409851725       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.929742246145       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.930014115110       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932777753962       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.929692916490       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.932117534010       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.924573208946       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.929799160284       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.929248854837       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.922552964493       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930671122855       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.933701153445       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.912654204054       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.920564325615       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.933020579889       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.931886052008       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.914915990465       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.923310907577       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.942766984518       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.944342011840       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.935568585465       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.905748781540       residual = 8.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.938852819434       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.934170118067       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.937456804743       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.957949889881       residual = 8.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.919910688624       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.940158108709       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.925673020244       residual = 9.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.956525900959       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.895323386408       residual = 2.52e-01           smallest_sin_value = 9.99e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.782188e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929563812077       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929563812077       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929563812077       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929563812077       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929563811125       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929530880619       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929502071749       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929290005842       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930243322579       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930482406607       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930186995923       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929572364210       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929087045442       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.928896496448       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929927960935       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930300750727       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928475366339       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930292339334       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929370701158       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931831867739       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928120316019       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928689625754       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930601501091       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929454080375       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928519126946       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929540824084       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929344767231       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929017628372       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.926920510619       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930021404172       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928636314339       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.929003919449       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932487347155       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931079171645       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929379386033       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928686690084       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920589890189       residual = 7.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925561602530       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930316754128       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929224628617       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.926660640419       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929381455629       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935626153360       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.925247514648       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.923203029602       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934112576894       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931816309270       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.935529197267       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.927474430446       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.922417046066       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.931361221713       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.928972273077       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.949167856361       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.947105662456       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.919567520084       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914343640826       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.915046318367       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.938145734326       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.925112770929       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.924930596655       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934223895968       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.936400031876       residual = 6.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.933596753464       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.923299575944       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.957391616594       residual = 8.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935757078105       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.922669942344       residual = 9.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.977065903366       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.850102891845       residual = 5.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.916603294586       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.914076833145       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.914853992733       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.910665255682       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.922361607793       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.875028441868       residual = 3.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.865068065152       residual = 4.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.958709715016       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.908773806125       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.058815301322       residual = 2.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.974638563608       residual = 5.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.008766228305       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.737069012236       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.024346358548       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.635719950266       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.908125669116       residual = 2.11e+00           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.916908309818       residual = 3.63e+00           smallest_sin_value = 9.94e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 5.559288e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929563812077       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929563812077       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929563812077       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929563812077       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929563812077       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929563812072       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928379147225       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923013994527       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926360410891       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925633100852       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928149819950       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.927796238537       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931231143623       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926702486158       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931901177207       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.927282121341       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934604702120       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925892528010       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931914580890       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925119986585       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917401201524       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925504511377       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938035551024       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929337397005       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935877125107       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921469782583       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930986052702       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924744705802       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934327221353       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938472250602       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.967833104989       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897489681701       residual = 9.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.891007348994       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925384909994       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.962905478224       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922629404217       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.982487220280       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944895940044       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.872865629753       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.890723189951       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.921409673783       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944240543653       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.922679443573       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.822132799202       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.861559429662       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.905827645705       residual = 8.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.925223097441       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.910428231156       residual = 4.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.929749267632       residual = 6.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.909083641059       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.895103226018       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.907479414074       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.883755207846       residual = 6.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.895725101870       residual = 9.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.926753248406       residual = 5.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.892701510821       residual = 3.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.001835853355       residual = 8.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.897565370981       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.911502383112       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.065526944851       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.901422866964       residual = 3.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.086474276701       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.943379946404       residual = 8.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.847117438372       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.982015467276       residual = 8.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.028136903147       residual = 2.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.974611443135       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.985990215263       residual = 2.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.000899781794       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.206615179970       residual = 8.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.501829072820       residual = 2.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.692632535469       residual = 6.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.920478897107       residual = 3.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.624899499996       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.109201809674       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.275348760188       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.161560122506       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.380347682512       residual = 2.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.685739938100       residual = 2.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.172417509266       residual = 3.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =       0.030701278944       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =       1.304887523965       residual = 4.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.773645474905       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.908664244757       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.620412389649       residual = 6.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   85 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+12 is 9.054986e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.225266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6144e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1988
    reference variance = 0.302697
====================================================
  Execution time = 2.7011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8486e-01
  Total weights = 1.9659e+06
  Execution time = 2.3584e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371392535
  error estimate for blocks of size 2^( 2) =       0.000385516646
  error estimate for blocks of size 2^( 3) =       0.000398714534
  error estimate for blocks of size 2^( 4) =       0.000409113886
  error estimate for blocks of size 2^( 5) =       0.000415062086
  error estimate for blocks of size 2^( 6) =       0.000417044585
  error estimate for blocks of size 2^( 7) =       0.000418295441

      target function =      -0.936715648421
              le_mean =     -17.210182295842
             les_mean =     296.475232629229
             stat err =       0.000414878999
             autocorr =       1.247890746608
   target nu stat err =       0.000414878999
   target dn stat err =       0.002800227873
      target stat err =       0.004722576831
              std dev =       0.525236763063
             le_variance =       0.275873657273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371392535
  error estimate for blocks of size 2^( 2) =       0.000385516646
  error estimate for blocks of size 2^( 3) =       0.000398714534
  error estimate for blocks of size 2^( 4) =       0.000409113886
  error estimate for blocks of size 2^( 5) =       0.000415062086
  error estimate for blocks of size 2^( 6) =       0.000417044585
  error estimate for blocks of size 2^( 7) =       0.000418295441

      target function =      -0.936715648421
              le_mean =     -17.210182295842
             les_mean =     296.475232629229
             stat err =       0.000414878999
             autocorr =       1.247890746606
   target nu stat err =       0.000414878999
   target dn stat err =       0.002800227873
      target stat err =       0.004722576831
              std dev =       0.525236763063
             le_variance =       0.275873657273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371392535
  error estimate for blocks of size 2^( 2) =       0.000385516646
  error estimate for blocks of size 2^( 3) =       0.000398714534
  error estimate for blocks of size 2^( 4) =       0.000409113886
  error estimate for blocks of size 2^( 5) =       0.000415062086
  error estimate for blocks of size 2^( 6) =       0.000417044585
  error estimate for blocks of size 2^( 7) =       0.000418295441

      target function =      -0.936715648421
              le_mean =     -17.210182295842
             les_mean =     296.475232629229
             stat err =       0.000414878999
             autocorr =       1.247890746606
   target nu stat err =       0.000414878999
   target dn stat err =       0.002800227873
      target stat err =       0.004722576831
              std dev =       0.525236763063
             le_variance =       0.275873657273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275852684277
                                         uncertainty =       0.002308616819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371392535
  error estimate for blocks of size 2^( 2) =       0.000385516646
  error estimate for blocks of size 2^( 3) =       0.000398714534
  error estimate for blocks of size 2^( 4) =       0.000409113886
  error estimate for blocks of size 2^( 5) =       0.000415062086
  error estimate for blocks of size 2^( 6) =       0.000417044585
  error estimate for blocks of size 2^( 7) =       0.000418295441

      target function =      -0.936715648421
              le_mean =     -17.210182295842
             les_mean =     296.475232629229
             stat err =       0.000414878999
             autocorr =       1.247890746606
   target nu stat err =       0.000414878999
   target dn stat err =       0.002800227873
      target stat err =       0.004722576831
              std dev =       0.525236763063
             le_variance =       0.275873657273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936715648421        initial
     1.4901e+11     1.4901e+12             2.7822e-15        -0.936715648421
     5.9605e+11     5.9605e+12             5.5593e-16        -0.936715648421  <--
     2.3842e+12     2.3842e+13             9.0550e-17        -0.936715648421

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 3.8921e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.204126
====================================================
  Execution time = 2.7209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0453e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8955e-01
  Total weights = 1.966353388e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279797264659
                                         uncertainty =       0.001866815788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279797264659
                                         uncertainty =       0.001866815788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373974146
  error estimate for blocks of size 2^( 2) =       0.000388062909
  error estimate for blocks of size 2^( 3) =       0.000401746325
  error estimate for blocks of size 2^( 4) =       0.000411296830
  error estimate for blocks of size 2^( 5) =       0.000417493629
  error estimate for blocks of size 2^( 6) =       0.000422033432
  error estimate for blocks of size 2^( 7) =       0.000426517306

      target function =      -0.928960207901
              le_mean =     -17.210270850554
             les_mean =     296.482976458306
             stat err =       0.000419335299
             autocorr =       1.257302234271
   target nu stat err =       0.000419335299
   target dn stat err =       0.002539710967
      target stat err =       0.004226757435
              std dev =       0.528887770905
             le_variance =       0.279722274213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721027085055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928977473376       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928977473376       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928977473376       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928977473376       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928977473376       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928977473376       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928987980877       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928907654778       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928977473376       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928977473376       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.928977473376       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928628465114       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929252602559       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929075236556       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929547980980       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928610448638       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929050392980       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929038516322       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929348957493       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928572129701       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928388892616       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929245504512       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928764229493       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.928820622583       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928527920679       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929636919853       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927394592090       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928591376500       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929011231179       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.928396221732       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928309168865       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.926354366755       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929300050351       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928320594773       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929740926996       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929159479153       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929353575381       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929502657753       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928294052114       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929279083344       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.929409079823       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.928920302688       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.930052247363       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.929617410325       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929477034577       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929304687286       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.928346526904       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.927902737431       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928488587395       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.928310434271       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.928622148096       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931595978514       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.926910613505       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934421722481       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932142522976       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.927866383121       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.934170889429       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.923152363259       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.931141586306       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.927719917773       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.933271658516       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.928786175221       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.927045099170       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.921354613163       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.928479612397       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937361431735       residual = 7.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.931110250963       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932967258271       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.929743548545       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.921927954830       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.923646917060       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932228244783       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.921031684352       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.930276107568       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.928836145051       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.925740282834       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934922259405       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.919966238735       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.912925266103       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.940710458271       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.922845711014       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.944019408516       residual = 4.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.893851255535       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.995845508177       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.826129011118       residual = 1.10e+00           smallest_sin_value = 9.98e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.923953894790       residual = 7.59e-02           smallest_sin_value = 9.96e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.973405758090       residual = 2.39e-01           smallest_sin_value = 9.91e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.899726e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928977473376       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928977473376       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928977473376       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928977473376       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929262358546       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929233383419       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928977473376       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930283637802       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.928977473376       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.928977473376       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929616193099       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.928493681534       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928832744763       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929390654953       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927111883314       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928523793999       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928135286546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928427623792       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930151033288       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929242499190       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928119299710       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930393934346       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930245018494       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931298064971       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929204891451       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929472183413       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931216690721       residual = 5.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928479925887       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932101633735       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.925094775022       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929281014632       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931585847494       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931795534758       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932869246220       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.926298197658       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918472168825       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924193779958       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927259685843       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.926401301000       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919237915905       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928190852102       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941890717385       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940853883195       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946323254190       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943996353519       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.926413079323       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930700738419       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.926327272286       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.940969187034       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934931177070       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.929736155889       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.910903025764       residual = 7.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.925607948207       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918552072124       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.931295293411       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.921372851542       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932198919395       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.928071302340       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.924957590071       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.931069072874       residual = 4.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.919490676034       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.871779372842       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.903037274264       residual = 7.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933824254172       residual = 6.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.975264814053       residual = 2.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.952127601236       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.937369252079       residual = 7.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.908213115376       residual = 4.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938477676677       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.911963744132       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.926640235781       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.915039539359       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.938897796840       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.906223262928       residual = 6.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.937670625419       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.900598492480       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.976804038925       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.950685150019       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.940171381536       residual = 6.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.927952297054       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.939624831855       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.943395362372       residual = 5.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.840488463220       residual = 7.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.980508905385       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.943562622212       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.836133090084       residual = 1.16e+00           smallest_sin_value = 9.96e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.01e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 4.018462e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928977473376       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928977473376       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928977473376       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928977473376       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928977473376       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928869210318       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928977473376       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927674443733       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931643487890       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926882055758       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927060394026       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931551899377       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928383854919       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922719141717       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930418407151       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923539945587       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922525280770       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927863258026       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.928946375979       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932282710139       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923524797779       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930975625387       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934756415789       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936138594176       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.962746227391       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941850748625       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935568854333       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914549456955       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.954061730914       residual = 5.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913365849831       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.926310441274       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944071717556       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.960018058767       residual = 9.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.972854565892       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943352226902       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924354741388       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.925407906505       residual = 6.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946589397935       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.934816309125       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935968111461       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935151096175       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.916765206662       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908910631701       residual = 4.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.972625602947       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.905637973824       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.954638431546       residual = 8.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.959308061778       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.945770510427       residual = 9.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.873006496951       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.917377965390       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.923333014360       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.964757367546       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915267351907       residual = 9.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.875160318001       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.925718969894       residual = 7.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.867858730081       residual = 3.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.906662410634       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.948859776657       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.905247352665       residual = 8.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.903579798131       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.996848534736       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.860513922002       residual = 7.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.952422087984       residual = 8.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.937609962496       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930684065796       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.868006664272       residual = 5.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.906958521678       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.651098713960       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.504647657930       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.964865900348       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.011864822386       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.155136206665       residual = 5.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.117769771998       residual = 4.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.599420344195       residual = 1.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.649831554360       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.786053856935       residual = 3.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.788134479641       residual = 5.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.800567592043       residual = 3.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.905059672799       residual = 8.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.079684174137       residual = 1.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.983982595879       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.627174856614       residual = 4.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.769058389292       residual = 3.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.648178026993       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.701649257304       residual = 3.64e+01           smallest_sin_value = 9.95e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.148135668585       residual = 1.84e+01           smallest_sin_value = 9.94e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.30e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+12 is 9.382462e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.942232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6189e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.3199
    reference variance = 0.794892
====================================================
  Execution time = 2.6877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8773e-01
  Total weights = 1.9664e+06
  Execution time = 2.3580e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372909987
  error estimate for blocks of size 2^( 2) =       0.000386998148
  error estimate for blocks of size 2^( 3) =       0.000400096606
  error estimate for blocks of size 2^( 4) =       0.000409358056
  error estimate for blocks of size 2^( 5) =       0.000415172693
  error estimate for blocks of size 2^( 6) =       0.000419702226
  error estimate for blocks of size 2^( 7) =       0.000422336078

      target function =      -0.931988652111
              le_mean =     -17.209161552238
             les_mean =     296.442971760432
             stat err =       0.000416642263
             autocorr =       1.248298976022
   target nu stat err =       0.000416642263
   target dn stat err =       0.002635965850
      target stat err =       0.004400288145
              std dev =       0.527382799345
             le_variance =       0.278132617045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372909987
  error estimate for blocks of size 2^( 2) =       0.000386998148
  error estimate for blocks of size 2^( 3) =       0.000400096606
  error estimate for blocks of size 2^( 4) =       0.000409358056
  error estimate for blocks of size 2^( 5) =       0.000415172693
  error estimate for blocks of size 2^( 6) =       0.000419702226
  error estimate for blocks of size 2^( 7) =       0.000422336078

      target function =      -0.931988652111
              le_mean =     -17.209161552238
             les_mean =     296.442971760432
             stat err =       0.000416642263
             autocorr =       1.248298976021
   target nu stat err =       0.000416642263
   target dn stat err =       0.002635965850
      target stat err =       0.004400288145
              std dev =       0.527382799345
             le_variance =       0.278132617045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372909987
  error estimate for blocks of size 2^( 2) =       0.000386998148
  error estimate for blocks of size 2^( 3) =       0.000400096606
  error estimate for blocks of size 2^( 4) =       0.000409358056
  error estimate for blocks of size 2^( 5) =       0.000415172693
  error estimate for blocks of size 2^( 6) =       0.000419702226
  error estimate for blocks of size 2^( 7) =       0.000422336078

      target function =      -0.931988652111
              le_mean =     -17.209161552238
             les_mean =     296.442971760432
             stat err =       0.000416642263
             autocorr =       1.248298976022
   target nu stat err =       0.000416642263
   target dn stat err =       0.002635965850
      target stat err =       0.004400288145
              std dev =       0.527382799345
             le_variance =       0.278132617045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278199713295
                                         uncertainty =       0.001857836898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372909987
  error estimate for blocks of size 2^( 2) =       0.000386998148
  error estimate for blocks of size 2^( 3) =       0.000400096606
  error estimate for blocks of size 2^( 4) =       0.000409358056
  error estimate for blocks of size 2^( 5) =       0.000415172693
  error estimate for blocks of size 2^( 6) =       0.000419702226
  error estimate for blocks of size 2^( 7) =       0.000422336078

      target function =      -0.931988652111
              le_mean =     -17.209161552238
             les_mean =     296.442971760432
             stat err =       0.000416642263
             autocorr =       1.248298976020
   target nu stat err =       0.000416642263
   target dn stat err =       0.002635965850
      target stat err =       0.004400288145
              std dev =       0.527382799345
             le_variance =       0.278132617045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931988652111        initial
     1.4901e+11     1.4901e+12             2.8997e-15        -0.931988652111  <--
     5.9605e+11     5.9605e+12             4.0185e-16        -0.931988652111
     2.3842e+12     2.3842e+13             9.3825e-17        -0.931988652111

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 3.8775e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.12978
====================================================
  Execution time = 2.7137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8746e-01
  Total weights = 1.966209858e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1215e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276423726141
                                         uncertainty =       0.001758362773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276423726141
                                         uncertainty =       0.001758362773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371824716
  error estimate for blocks of size 2^( 2) =       0.000386271156
  error estimate for blocks of size 2^( 3) =       0.000399530299
  error estimate for blocks of size 2^( 4) =       0.000408536435
  error estimate for blocks of size 2^( 5) =       0.000413706888
  error estimate for blocks of size 2^( 6) =       0.000415956279
  error estimate for blocks of size 2^( 7) =       0.000418200643

      target function =      -0.932412386596
              le_mean =     -17.209808652772
             les_mean =     296.464969823520
             stat err =       0.000414100061
             autocorr =       1.240320952420
   target nu stat err =       0.000414100061
   target dn stat err =       0.003206623941
      target stat err =       0.005339367247
              std dev =       0.525847969017
             le_variance =       0.276516086520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720980865277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932441891179       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932441891179       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932441891179       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932426876131       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932441891179       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932446949159       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932495840101       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932421565265       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932461472903       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932408760097       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932451098212       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932422868861       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932438372197       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932414476963       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932480010235       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932500280810       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932501975461       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932388793112       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932408763023       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932393256012       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932558292838       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932400322708       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932353843095       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932470639068       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932444902426       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932338129143       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932560669467       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932623552145       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932448254575       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932424763740       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932319788859       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932466245267       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932444077533       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932506583215       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932478380805       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932423408215       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932543468506       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932622259962       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.932473392388       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.932526745404       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932505744014       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932424517142       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.932456590010       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.932538591895       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932699407181       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.932541320757       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.932371617150       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932226661056       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932579063545       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.932315311050       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932436292934       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932165900372       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.932418880574       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.932606445317       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932475471823       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.932380708045       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.931519022133       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932172946322       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.931604094710       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.932041490710       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.932123072865       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.932448105529       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932736333222       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.932852122837       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.932669573415       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.932639418749       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.933340504206       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.932934189765       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932327808852       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.932003390929       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.931603468689       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932915432086       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.929691009443       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.934058509083       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.930347311690       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.932358744444       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.926281536649       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.931693014526       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.935911286677       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.932991775473       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.917973182981       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.921652967336       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.930872391176       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.935110150650       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.932010387411       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.932829523439       residual = 7.12e-03           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 8.649668e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932441891179       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932441891179       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932441891179       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932441891179       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932441891179       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932441891178       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932447491125       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932525609928       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932295463106       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932696831211       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932641411444       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932086575171       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933117177032       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932036965525       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932079958754       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932208684153       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932682028153       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932630170287       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932112567693       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932062051359       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932156299692       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932380082748       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932465780447       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932367528616       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932232835355       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.931783498062       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932307377436       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932329923040       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931557831372       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932133997462       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931110423530       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932831015495       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932106620878       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931854084093       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931936288371       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931726583715       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930668569329       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932935570600       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931983651245       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933294214713       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.933156934067       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.932504984421       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931203017516       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933165609630       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.931613456604       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.931339090166       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934352525408       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932860021184       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.930562506277       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.931581393659       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.934164491357       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.928969667916       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.932512640410       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931490471174       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.931878013227       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.932202003407       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.927695627209       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.934207383473       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.933671227783       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.930131778703       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931780249617       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935988891701       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.932997430873       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933898406970       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.939630962559       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937042489337       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.936336845787       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.931863079429       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.937059863863       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.934548057213       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.933745196718       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.945560172802       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.929641135506       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.931166442362       residual = 2.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936245247340       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.931459233023       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.947702056997       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.928795142217       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934674188682       residual = 7.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.894940177735       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.885351607959       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.894172591020       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.927048756031       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.954114172424       residual = 5.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.919015978256       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.931935354481       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.939796935118       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   87 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.058764e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932441891179       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932441891179       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932441891179       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932441891179       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932413481050       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932441907196       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932530764097       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932505767630       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931229238272       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932777474533       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932034917697       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931530246273       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930850883123       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932425828194       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932642060014       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932554524217       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931813669226       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931975778584       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933798495575       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932451106581       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931896205300       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932257249986       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931876161816       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929933386179       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934076522717       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933217602051       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936687575732       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.930801980930       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932013424614       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932864583873       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935117310081       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932188332710       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.934147365818       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930097947822       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927505277594       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932180270240       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933603322635       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929477934054       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930677972245       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936764299028       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939960630464       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929838830918       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.930699728460       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.934950225595       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932909382928       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937116398658       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.928518315512       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.930350898562       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933048429260       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.941314736515       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.941162594977       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.938801444863       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.935172737944       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.929948057259       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.928984502989       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.929604633896       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.937493496100       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.939920668018       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.934931760396       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.933347985345       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.915965209490       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.950162358745       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.950174586821       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.963441888392       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.925669029575       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.921769675509       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.917293269249       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.927043216474       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.001690892477       residual = 5.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937454853653       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.925127335556       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.971002408926       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.983231678629       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.911567171865       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.997780087905       residual = 6.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.926082413991       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.927979125699       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.962114927299       residual = 3.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.868784741438       residual = 8.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.032847208996       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.868223582124       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.059017017044       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.001369098429       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.854397751590       residual = 5.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.812184469054       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.733064796520       residual = 6.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -1.147541844677       residual = 7.71e+00           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 3.613212e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               7.665190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5989e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.246106
====================================================
  Execution time = 2.9276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8588e-01
  Total weights = 1.9661e+06
  Execution time = 2.3237e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372383030
  error estimate for blocks of size 2^( 2) =       0.000386480169
  error estimate for blocks of size 2^( 3) =       0.000399507613
  error estimate for blocks of size 2^( 4) =       0.000409385812
  error estimate for blocks of size 2^( 5) =       0.000415513407
  error estimate for blocks of size 2^( 6) =       0.000418850799
  error estimate for blocks of size 2^( 7) =       0.000421927676

      target function =      -0.935044404785
              le_mean =     -17.209507858716
             les_mean =     296.453039204163
             stat err =       0.000416419424
             autocorr =       1.250495675702
   target nu stat err =       0.000416419424
   target dn stat err =       0.002234365172
      target stat err =       0.003776793256
              std dev =       0.526637557711
             le_variance =       0.277347117192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372383030
  error estimate for blocks of size 2^( 2) =       0.000386480169
  error estimate for blocks of size 2^( 3) =       0.000399507613
  error estimate for blocks of size 2^( 4) =       0.000409385812
  error estimate for blocks of size 2^( 5) =       0.000415513407
  error estimate for blocks of size 2^( 6) =       0.000418850799
  error estimate for blocks of size 2^( 7) =       0.000421927676

      target function =      -0.935044404785
              le_mean =     -17.209507858716
             les_mean =     296.453039204163
             stat err =       0.000416419424
             autocorr =       1.250495675701
   target nu stat err =       0.000416419424
   target dn stat err =       0.002234365172
      target stat err =       0.003776793256
              std dev =       0.526637557711
             le_variance =       0.277347117192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372383030
  error estimate for blocks of size 2^( 2) =       0.000386480169
  error estimate for blocks of size 2^( 3) =       0.000399507613
  error estimate for blocks of size 2^( 4) =       0.000409385812
  error estimate for blocks of size 2^( 5) =       0.000415513407
  error estimate for blocks of size 2^( 6) =       0.000418850799
  error estimate for blocks of size 2^( 7) =       0.000421927676

      target function =      -0.935044404785
              le_mean =     -17.209507858716
             les_mean =     296.453039204163
             stat err =       0.000416419424
             autocorr =       1.250495675702
   target nu stat err =       0.000416419424
   target dn stat err =       0.002234365172
      target stat err =       0.003776793256
              std dev =       0.526637557711
             le_variance =       0.277347117192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277259863677
                                         uncertainty =       0.001751009235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372383030
  error estimate for blocks of size 2^( 2) =       0.000386480169
  error estimate for blocks of size 2^( 3) =       0.000399507613
  error estimate for blocks of size 2^( 4) =       0.000409385812
  error estimate for blocks of size 2^( 5) =       0.000415513407
  error estimate for blocks of size 2^( 6) =       0.000418850799
  error estimate for blocks of size 2^( 7) =       0.000421927676

      target function =      -0.935044404785
              le_mean =     -17.209507858716
             les_mean =     296.453039204163
             stat err =       0.000416419424
             autocorr =       1.250495675702
   target nu stat err =       0.000416419424
   target dn stat err =       0.002234365172
      target stat err =       0.003776793256
              std dev =       0.526637557711
             le_variance =       0.277347117192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935044404785        initial
     3.7253e+10     3.7253e+11             8.6497e-15        -0.935044404785
     1.4901e+11     1.4901e+12             2.0588e-15        -0.935044404785
     5.9605e+11     5.9605e+12             3.6132e-16        -0.935044404785  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 4.1017e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.270034
====================================================
  Execution time = 2.7790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0471e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8299e-01
  Total weights = 1.966139879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2354e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273950196641
                                         uncertainty =       0.001672452410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273950196641
                                         uncertainty =       0.001672452410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370057927
  error estimate for blocks of size 2^( 2) =       0.000384481326
  error estimate for blocks of size 2^( 3) =       0.000397332744
  error estimate for blocks of size 2^( 4) =       0.000406783948
  error estimate for blocks of size 2^( 5) =       0.000411988208
  error estimate for blocks of size 2^( 6) =       0.000414299870
  error estimate for blocks of size 2^( 7) =       0.000416557413

      target function =      -0.939849152989
              le_mean =     -17.209706608900
             les_mean =     296.456994993275
             stat err =       0.000412407360
             autocorr =       1.241976532865
   target nu stat err =       0.000412407360
   target dn stat err =       0.002153834144
      target stat err =       0.003682711527
              std dev =       0.523349313305
             le_variance =       0.273894503737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720970660890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939862667196       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939862667196       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939862667196       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939862667196       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939862667196       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939862667196       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939862667196       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940003513801       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939862667196       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939862667196       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939768334780       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939862667196       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939573425623       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939862667196       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939583636020       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940171265206       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939770807346       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940137188326       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939577858011       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939756759790       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940174950570       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940114804912       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939638959501       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940169512664       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940006325686       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939390501443       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940093318994       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940281602848       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939615597670       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.939663263988       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940053938635       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.939584438300       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939215848639       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938432669995       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939469282008       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939771577078       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939300017432       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940989414011       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939021321361       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939335722391       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939037946574       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941804667135       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938841001295       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.939580573861       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.939984068398       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.940148486074       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939914622303       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.940959772548       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.938118146650       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937633111917       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.942773316431       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.940192955148       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.940680810521       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.939001928574       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934676102904       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.940903816085       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939169212074       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.937117651364       residual = 9.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.945663420686       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.936453767404       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.940277958658       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.940742071029       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938124861227       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.937791589941       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.939280569566       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937120989793       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940323098155       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.929074155346       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.940424726369       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.933921621180       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.930078616892       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.948914588132       residual = 7.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.930050628443       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.937951290640       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.936197041361       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.940977524609       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.949799468141       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.923629956514       residual = 5.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.947343239068       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.935671984954       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.931467267826       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.937489235836       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.937375795586       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.952691212260       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.902312640216       residual = 4.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.944119757761       residual = 5.36e-02           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.392155e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939862667196       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939862667196       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939862667196       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939862667196       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939845992335       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940084070266       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940355026614       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939862667196       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940181101949       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940389071046       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939373764671       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940174578986       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939921124156       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939867634022       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938879419554       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938444619680       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940140661910       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940362439378       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939349591503       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940783828280       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940804077722       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943292338004       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936864800693       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938981957665       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939588484365       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940363550720       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940185594705       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939152698569       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939141445932       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940606760744       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.936918103072       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938957022117       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942876072453       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941882665849       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941333651145       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932586993334       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945815243371       residual = 5.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938187326696       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944959793249       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939924592242       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931067425848       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.946496692489       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.940511896118       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946106381074       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.932292810236       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.928145123110       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.930338806331       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.899447381295       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928831059310       residual = 5.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.928006323551       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.968358268328       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.944228427434       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.941798955399       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.942540665590       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.923360482172       residual = 5.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.926785730888       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.922237498108       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.933619148198       residual = 4.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938275937270       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.934877943346       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.930649723882       residual = 6.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.966811160127       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.935449634286       residual = 2.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.864341940292       residual = 5.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.878772538847       residual = 4.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.961680640694       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.839011117850       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.935622334669       residual = 9.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.922475097757       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.901361630132       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.953616298653       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.908398798363       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.943970213305       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.000598385914       residual = 7.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.855356706992       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.933084437391       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.789845661945       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.964600371113       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.996304949984       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.895171059332       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.897111190214       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.946844871695       residual = 4.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.901660793828       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.256132254686       residual = 1.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.026070076634       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.907618519903       residual = 3.87e+00           smallest_sin_value = 9.97e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 3.939203e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939862667196       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939862667196       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939862667196       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939862667196       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939862667196       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939862667196       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939862667196       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942605096471       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933214439257       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940321361698       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938643002711       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938715622299       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933374468373       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943398323199       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941526544908       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952740952967       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942710804180       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938067463218       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946838591695       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.928406876042       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936500692790       residual = 9.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940912663726       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946993951628       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940073648699       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930267453319       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.930835184504       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938102884015       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.959483115975       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940983971677       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943635376446       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943880276395       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941254921680       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929107136697       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932927743597       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.954917816189       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945895556354       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951450637742       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936739670361       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.960237402389       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937969356257       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928891698000       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.957875821150       residual = 5.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.965531023566       residual = 9.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936506103148       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944844185623       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.879228948747       residual = 3.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.931345587657       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.973762427508       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.983334782674       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.923189111073       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.900232278282       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.929151612616       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.866778374220       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.933344087825       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.934470675486       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.999384002485       residual = 6.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.868873252424       residual = 7.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.953162600618       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.965498180250       residual = 7.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.901395138494       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.911764141502       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.846475541137       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.896319945815       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.013679996502       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.963439841725       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937875162738       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.940413768087       residual = 6.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.915400226989       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.077981184318       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.925899805375       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.048554160349       residual = 8.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.971335090301       residual = 2.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.406175983876       residual = 4.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.073774944008       residual = 2.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.920452082207       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.065977244790       residual = 4.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.278477145410       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.456740543095       residual = 5.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.861516199212       residual = 6.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.484972137974       residual = 3.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.556646177416       residual = 3.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.132923421455       residual = 5.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.746092103283       residual = 1.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.733886082247       residual = 9.67e+00           smallest_sin_value = 9.99e-01
davidson iteration   84 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         84 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3842e+12 is 1.018764e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               8.366262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6734e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1286
    reference variance = 0.345878
====================================================
  Execution time = 2.7500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8409e-01
  Total weights = 1.9663e+06
  Execution time = 2.3259e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439074
  error estimate for blocks of size 2^( 2) =       0.000385513952
  error estimate for blocks of size 2^( 3) =       0.000398614579
  error estimate for blocks of size 2^( 4) =       0.000408827218
  error estimate for blocks of size 2^( 5) =       0.000415128167
  error estimate for blocks of size 2^( 6) =       0.000418380971
  error estimate for blocks of size 2^( 7) =       0.000419064499

      target function =      -0.938002226491
              le_mean =     -17.210623254398
             les_mean =     296.489641534524
             stat err =       0.000415350214
             autocorr =       1.250413634115
   target nu stat err =       0.000415350214
   target dn stat err =       0.001841358064
      target stat err =       0.003166036351
              std dev =       0.525302580954
             le_variance =       0.275942801557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439074
  error estimate for blocks of size 2^( 2) =       0.000385513952
  error estimate for blocks of size 2^( 3) =       0.000398614579
  error estimate for blocks of size 2^( 4) =       0.000408827218
  error estimate for blocks of size 2^( 5) =       0.000415128167
  error estimate for blocks of size 2^( 6) =       0.000418380971
  error estimate for blocks of size 2^( 7) =       0.000419064499

      target function =      -0.938002226491
              le_mean =     -17.210623254398
             les_mean =     296.489641534524
             stat err =       0.000415350214
             autocorr =       1.250413634110
   target nu stat err =       0.000415350214
   target dn stat err =       0.001841358064
      target stat err =       0.003166036351
              std dev =       0.525302580954
             le_variance =       0.275942801557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439074
  error estimate for blocks of size 2^( 2) =       0.000385513952
  error estimate for blocks of size 2^( 3) =       0.000398614579
  error estimate for blocks of size 2^( 4) =       0.000408827218
  error estimate for blocks of size 2^( 5) =       0.000415128167
  error estimate for blocks of size 2^( 6) =       0.000418380971
  error estimate for blocks of size 2^( 7) =       0.000419064499

      target function =      -0.938002226491
              le_mean =     -17.210623254398
             les_mean =     296.489641534524
             stat err =       0.000415350214
             autocorr =       1.250413634110
   target nu stat err =       0.000415350214
   target dn stat err =       0.001841358064
      target stat err =       0.003166036351
              std dev =       0.525302580954
             le_variance =       0.275942801557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275975788349
                                         uncertainty =       0.001411213028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439074
  error estimate for blocks of size 2^( 2) =       0.000385513952
  error estimate for blocks of size 2^( 3) =       0.000398614579
  error estimate for blocks of size 2^( 4) =       0.000408827218
  error estimate for blocks of size 2^( 5) =       0.000415128167
  error estimate for blocks of size 2^( 6) =       0.000418380971
  error estimate for blocks of size 2^( 7) =       0.000419064499

      target function =      -0.938002226491
              le_mean =     -17.210623254398
             les_mean =     296.489641534524
             stat err =       0.000415350214
             autocorr =       1.250413634111
   target nu stat err =       0.000415350214
   target dn stat err =       0.001841358064
      target stat err =       0.003166036351
              std dev =       0.525302580954
             le_variance =       0.275942801557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938002226491        initial
     1.4901e+11     1.4901e+12             2.3922e-15        -0.938002226491  <--
     5.9605e+11     5.9605e+12             3.9392e-16        -0.938002226491
     2.3842e+12     2.3842e+13             1.0188e-16        -0.938002226491

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 3.9234e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.213343
====================================================
  Execution time = 2.7559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8397e-01
  Total weights = 1.966603750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1780e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276488369118
                                         uncertainty =       0.001425588759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276488369118
                                         uncertainty =       0.001425588759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371778152
  error estimate for blocks of size 2^( 2) =       0.000386240069
  error estimate for blocks of size 2^( 3) =       0.000399274652
  error estimate for blocks of size 2^( 4) =       0.000408541980
  error estimate for blocks of size 2^( 5) =       0.000415127205
  error estimate for blocks of size 2^( 6) =       0.000417946419
  error estimate for blocks of size 2^( 7) =       0.000420859485

      target function =      -0.938234585754
              le_mean =     -17.209241082243
             les_mean =     296.441944413105
             stat err =       0.000415618772
             autocorr =       1.249748377797
   target nu stat err =       0.000415618772
   target dn stat err =       0.001897632631
      target stat err =       0.003250725903
              std dev =       0.525782116620
             le_variance =       0.276446834157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720924108224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938244825258       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938244825258       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938244825258       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938244825258       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938244824599       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938237905634       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938229277163       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938229624145       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938228161605       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938223693700       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938218134372       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938291129282       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938297557773       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938219045464       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938218658433       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938452247671       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938285995920       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938306555596       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938303246896       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938279998792       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938372313704       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938146586973       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938193407447       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938238998779       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938188455697       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938182712226       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938172891669       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938184910276       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938238423696       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938225277594       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938343359127       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938277459851       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938155461733       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938249592439       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938234325426       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938337472531       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938351169987       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938436948771       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938191863509       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.938293207750       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938246992182       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938108174781       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.937925258123       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.938021068569       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938268277868       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938220041751       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938195018514       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.938335157680       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937786333156       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937873265517       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.938083648953       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.938083330899       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.938585606110       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.938129658243       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.938161505720       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.938138303552       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.936705296724       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.938569357028       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.937409456263       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.938393597310       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.939023191690       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.938439663541       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.936778483036       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.939243319085       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.936847072096       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937365645515       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.938254812196       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.937733278175       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.938978702833       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937579341386       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.938017182600       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.938280520076       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.936404329415       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.936611412875       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.933096570008       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.936418336393       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.935240574321       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.938925079557       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.934975769558       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.942565516801       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.939044684738       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.935245078608       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.935101712537       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.938648542800       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.941263763407       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.928802964381       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.938152327949       residual = 1.45e-03           smallest_sin_value = 9.94e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+10 is 1.086587e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938244825258       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938244825258       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938244825258       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938300405672       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938205783579       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938244556934       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938191482146       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938348427393       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938273941542       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938383239576       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938088576915       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938067902534       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938354162267       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938340098151       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938332297577       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938791188062       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937994406473       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938715730177       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937838823864       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938038368050       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937895714386       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938294955476       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938447541679       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938694332599       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938621649980       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938588814505       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938115167600       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938699243309       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937928928209       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937341910477       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938274192407       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937948640555       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938563637921       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938296765547       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938493844334       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937968356045       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938166635601       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938194209218       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937921926894       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939108001004       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.938827230330       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938204615504       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.938998912777       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.937990006269       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.938449137178       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937848755144       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.939758955335       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.936000305390       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937802410157       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.938283556981       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.938881843784       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.936803455650       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.937723818868       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937883292484       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.936748658549       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939729087135       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.939783001950       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.938510653441       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932908917541       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.938332596533       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.937917282924       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.941379097305       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.937883764924       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.940084558728       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.943090532181       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.936412079160       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.939857773561       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936921522963       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.936415770613       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.938494478575       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.937595199356       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.937219097766       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.938056011504       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.940016126126       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.943512785035       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.937771824707       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.925439956607       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.927370317437       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.928116981930       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.925855112422       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.944958582814       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.942023879762       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944979510426       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.932569035273       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.930620050364       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.924046379645       residual = 4.89e-02           smallest_sin_value = 9.97e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+11 is 2.922432e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938244825258       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938244825258       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938244825258       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938244825259       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938188366032       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938179613089       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938119605716       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938244825258       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938085976266       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939076816540       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938619159759       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938625145356       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939353194143       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937952057831       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939354821867       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938050007286       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938787335780       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929517972502       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932971244036       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939973160168       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935935320128       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939124290722       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937783516760       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939913259723       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937661357720       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.936631325180       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938847979217       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.936731321236       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936141203961       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.937955322433       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938115277163       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941487010272       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935053702802       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.937193033337       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941510079039       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935720158084       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929236978982       residual = 8.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935431463438       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933238536442       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.930013684377       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950159556637       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945522600561       residual = 7.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.927625864772       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910078337986       residual = 8.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.894988556696       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929665745802       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946038612573       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931148699911       residual = 9.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.908910377053       residual = 8.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.948442701447       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947872768589       residual = 5.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.934446914854       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.930055010382       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.939697008753       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.942048278399       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.928056063202       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.925628797020       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941894563414       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.942296298161       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.926965471709       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.932199697852       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.935592485263       residual = 8.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.930305308025       residual = 5.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.939567518948       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.950898174979       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.945201961273       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.931652663861       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.922021920285       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.918124276480       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.998506368077       residual = 5.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.927502922066       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.937651587618       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.912662058177       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.932897611508       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.977981924392       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.871179633322       residual = 9.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.894891999982       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.889173813688       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.775778679377       residual = 2.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.779680120926       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.942115155509       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.909054837085       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.914305441631       residual = 5.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.954094202973       residual = 1.30e+00           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.912158107069       residual = 2.39e+00           smallest_sin_value = 9.93e-01
davidson iteration   85 stopping due to small subspace S singular value of 8.90e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+11 is 2.013202e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               9.083257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6462e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.176176
====================================================
  Execution time = 2.7423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8932e-01
  Total weights = 1.9664e+06
  Execution time = 2.3369e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514318
  error estimate for blocks of size 2^( 2) =       0.000388078503
  error estimate for blocks of size 2^( 3) =       0.000401241976
  error estimate for blocks of size 2^( 4) =       0.000411171615
  error estimate for blocks of size 2^( 5) =       0.000417086148
  error estimate for blocks of size 2^( 6) =       0.000419932999
  error estimate for blocks of size 2^( 7) =       0.000422104353

      target function =      -0.929373182299
              le_mean =     -17.209418791481
             les_mean =     296.453413511745
             stat err =       0.000417573779
             autocorr =       1.249832834687
   target nu stat err =       0.000417573779
   target dn stat err =       0.002693129122
      target stat err =       0.004470678415
              std dev =       0.528237465935
             le_variance =       0.279034820417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514318
  error estimate for blocks of size 2^( 2) =       0.000388078503
  error estimate for blocks of size 2^( 3) =       0.000401241976
  error estimate for blocks of size 2^( 4) =       0.000411171615
  error estimate for blocks of size 2^( 5) =       0.000417086148
  error estimate for blocks of size 2^( 6) =       0.000419932999
  error estimate for blocks of size 2^( 7) =       0.000422104353

      target function =      -0.929373182299
              le_mean =     -17.209418791481
             les_mean =     296.453413511745
             stat err =       0.000417573779
             autocorr =       1.249832834688
   target nu stat err =       0.000417573779
   target dn stat err =       0.002693129122
      target stat err =       0.004470678415
              std dev =       0.528237465935
             le_variance =       0.279034820417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514318
  error estimate for blocks of size 2^( 2) =       0.000388078503
  error estimate for blocks of size 2^( 3) =       0.000401241976
  error estimate for blocks of size 2^( 4) =       0.000411171615
  error estimate for blocks of size 2^( 5) =       0.000417086148
  error estimate for blocks of size 2^( 6) =       0.000419932999
  error estimate for blocks of size 2^( 7) =       0.000422104353

      target function =      -0.929373182299
              le_mean =     -17.209418791481
             les_mean =     296.453413511745
             stat err =       0.000417573779
             autocorr =       1.249832834688
   target nu stat err =       0.000417573779
   target dn stat err =       0.002693129122
      target stat err =       0.004470678415
              std dev =       0.528237465935
             le_variance =       0.279034820417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279071882773
                                         uncertainty =       0.001810223029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373514318
  error estimate for blocks of size 2^( 2) =       0.000388078503
  error estimate for blocks of size 2^( 3) =       0.000401241976
  error estimate for blocks of size 2^( 4) =       0.000411171615
  error estimate for blocks of size 2^( 5) =       0.000417086148
  error estimate for blocks of size 2^( 6) =       0.000419932999
  error estimate for blocks of size 2^( 7) =       0.000422104353

      target function =      -0.929373182299
              le_mean =     -17.209418791481
             les_mean =     296.453413511745
             stat err =       0.000417573779
             autocorr =       1.249832834688
   target nu stat err =       0.000417573779
   target dn stat err =       0.002693129122
      target stat err =       0.004470678415
              std dev =       0.528237465935
             le_variance =       0.279034820417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929373182299        initial  <--
     3.7253e+10     3.7253e+11             1.0866e-14        -0.929373182299
     1.4901e+11     1.4901e+12             2.9224e-15        -0.929373182299
     5.9605e+11     5.9605e+12             2.0132e-16        -0.929373182299

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2249
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1576
    reference variance = 0.179229
====================================================
  Execution time = 2.7419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0464e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8708e-01
  Total weights = 1.966286430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2391e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276365106757
                                         uncertainty =       0.001728906457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276365106757
                                         uncertainty =       0.001728906457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371751029
  error estimate for blocks of size 2^( 2) =       0.000386229092
  error estimate for blocks of size 2^( 3) =       0.000399176170
  error estimate for blocks of size 2^( 4) =       0.000408921512
  error estimate for blocks of size 2^( 5) =       0.000414741296
  error estimate for blocks of size 2^( 6) =       0.000418294286
  error estimate for blocks of size 2^( 7) =       0.000419844993

      target function =      -0.933037484509
              le_mean =     -17.210112586293
             les_mean =     296.475053700650
             stat err =       0.000415450522
             autocorr =       1.248918959659
   target nu stat err =       0.000415450522
   target dn stat err =       0.002547130258
      target stat err =       0.004272980359
              std dev =       0.525743759138
             le_variance =       0.276406500273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721011258629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933056010605       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933056010605       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933056010605       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933094509326       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933021166816       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933222697712       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932828005436       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933199428373       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932958444344       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932878835586       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933337748567       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932919877348       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932739676955       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933050615130       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932456683649       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933105760477       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932921987498       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933000263367       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932983318054       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932587189568       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934055816851       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932792683753       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932913932304       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931995289928       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934872865273       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929453716099       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.932249838363       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933764394710       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935767510152       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.931520450384       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931899094507       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.932383259263       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932757111283       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932979004548       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934369939863       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937053946175       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.933458253281       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933610181837       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933046361000       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934296278167       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935402257692       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.934710824489       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933900915779       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933062782634       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.930402916236       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.938423638269       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933413634918       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932432414229       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932124720164       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934553557260       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930651034286       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932583186428       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939478714825       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.942232044131       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932959095184       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935710455853       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932975408892       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932287346194       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.935749460409       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.932747574887       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.933371347237       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.959411406354       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.951358085373       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.937932501750       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.950304518996       residual = 5.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.937204330995       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.951195602439       residual = 5.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926177081460       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.905557839665       residual = 9.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.901278188920       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.934509240962       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.955469079072       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.968955508851       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.912140734438       residual = 7.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.888568735378       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.955735552544       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.979982238499       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.954653485968       residual = 7.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.944475468371       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.892172651427       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.964524906008       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.979551270995       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.919061983832       residual = 3.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.927397734585       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.030990672040       residual = 1.73e+00           smallest_sin_value = 9.98e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.994940595592       residual = 4.38e-01           smallest_sin_value = 9.91e-01
davidson iteration   86 stopping due to small subspace S singular value of 7.48e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+11 is 1.608399e-15

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933056010605       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933056010605       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933056010605       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933056010605       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933056010605       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933798774383       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933142196074       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933526399365       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930105681509       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933670685743       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931587478431       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935710706693       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932887621062       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935202562769       residual = 7.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929750638583       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928866082137       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931733037825       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932633253323       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938884898354       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933369080661       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934069643372       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938270114661       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925843311406       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941328841680       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924079708618       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935590147199       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929359439051       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.931349641153       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931359206041       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935436039374       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934959525210       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927160986918       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930311363407       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929872403753       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948010065702       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915671078650       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917815387785       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927115377507       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916005934800       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947817075263       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.897770259033       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.927762194717       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.897250808424       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.909071426538       residual = 9.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934542619694       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.871520429556       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938575437418       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.982391226253       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.017463982070       residual = 7.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.933233679520       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.910371995268       residual = 1.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.781061657688       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.916428416284       residual = 8.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.965552405585       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947032991920       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.918486273354       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.918953612621       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.942022122185       residual = 7.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.983697706693       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.920000673792       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.917915629201       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.980857778577       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.905028361906       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.912808828816       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.970894466606       residual = 8.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.978131598225       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.916261654260       residual = 7.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.892773322831       residual = 2.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.864279980995       residual = 5.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.892343146531       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.941445157934       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.930402938385       residual = 5.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.993403484502       residual = 5.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.883694134284       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.003490136342       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.133240808918       residual = 4.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.071473468951       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.854846869328       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.128974201396       residual = 6.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.829306392239       residual = 4.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.818200292785       residual = 3.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.107517561751       residual = 3.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.951349674057       residual = 3.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.774971958249       residual = 1.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.721254355233       residual = 5.63e+00           smallest_sin_value = 9.98e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.39e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 7.087488e-17

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933056010605       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933056010605       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933056010605       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933056010605       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932708859154       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932901212196       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935665987808       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933383051060       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942873317780       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927107696056       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940391151526       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934765332669       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916610254766       residual = 4.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937348389222       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943321302525       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.921101961066       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936842405079       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940354252520       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912696833089       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.994155372685       residual = 4.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906756097707       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923926367113       residual = 4.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945661037093       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914979760553       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940246762161       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.964998006719       residual = 9.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.878038387235       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.893090277034       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941010695608       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904143114924       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.972289057798       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916558459812       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.965564836893       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.881978766265       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.878489112146       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.004353182951       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912794684573       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.968337013257       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914367628299       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909119089845       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.976759057755       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917035658709       residual = 5.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914327037203       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.964300859824       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.880445067206       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.008834091404       residual = 6.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.902383303115       residual = 7.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.955134011164       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948822157179       residual = 7.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.998569370901       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.609077132753       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.978786292428       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.959151808749       residual = 7.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.883611874168       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.108723864115       residual = 4.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.861088588584       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.084467931182       residual = 3.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.948700303960       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.155215112699       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.907038580028       residual = 5.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.036776870664       residual = 9.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.059306701464       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.037602317803       residual = 2.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.030124171310       residual = 5.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.955213168585       residual = 7.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.980583720858       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.625610968170       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.970529295830       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.147913503957       residual = 9.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.497584254297       residual = 3.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.042517095259       residual = 5.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.564495231043       residual = 5.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.865266219703       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.156802323165       residual = 6.38e+01           smallest_sin_value = 9.99e-01
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.220385114316       residual = 8.44e+01           smallest_sin_value = 9.98e-01
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.980160300206       residual = 1.09e+02           smallest_sin_value = 9.97e-01
davidson iteration   76:   krylov dim =  77   tar_fn =       0.286323667874       residual = 2.17e+02           smallest_sin_value = 9.97e-01
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.245381005075       residual = 2.44e+02           smallest_sin_value = 9.97e-01
davidson iteration   78 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         78 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+12 is 1.837825e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               9.730997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6313e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1614
    reference variance = 0.152378
====================================================
  Execution time = 2.7127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8596e-01
  Total weights = 1.9662e+06
  Execution time = 2.3176e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372233982
  error estimate for blocks of size 2^( 2) =       0.000386517914
  error estimate for blocks of size 2^( 3) =       0.000400268635
  error estimate for blocks of size 2^( 4) =       0.000409973290
  error estimate for blocks of size 2^( 5) =       0.000414748282
  error estimate for blocks of size 2^( 6) =       0.000418612711
  error estimate for blocks of size 2^( 7) =       0.000420250192

      target function =      -0.934896478211
              le_mean =     -17.210334759363
             les_mean =     296.481578415710
             stat err =       0.000415896119
             autocorr =       1.248353828537
   target nu stat err =       0.000415896119
   target dn stat err =       0.002103612928
      target stat err =       0.003568769479
              std dev =       0.526426768924
             le_variance =       0.277125143040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372233982
  error estimate for blocks of size 2^( 2) =       0.000386517914
  error estimate for blocks of size 2^( 3) =       0.000400268635
  error estimate for blocks of size 2^( 4) =       0.000409973290
  error estimate for blocks of size 2^( 5) =       0.000414748282
  error estimate for blocks of size 2^( 6) =       0.000418612711
  error estimate for blocks of size 2^( 7) =       0.000420250192

      target function =      -0.934896478211
              le_mean =     -17.210334759363
             les_mean =     296.481578415710
             stat err =       0.000415896119
             autocorr =       1.248353828536
   target nu stat err =       0.000415896119
   target dn stat err =       0.002103612928
      target stat err =       0.003568769479
              std dev =       0.526426768924
             le_variance =       0.277125143040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372233982
  error estimate for blocks of size 2^( 2) =       0.000386517914
  error estimate for blocks of size 2^( 3) =       0.000400268635
  error estimate for blocks of size 2^( 4) =       0.000409973290
  error estimate for blocks of size 2^( 5) =       0.000414748282
  error estimate for blocks of size 2^( 6) =       0.000418612711
  error estimate for blocks of size 2^( 7) =       0.000420250192

      target function =      -0.934896478211
              le_mean =     -17.210334759363
             les_mean =     296.481578415710
             stat err =       0.000415896119
             autocorr =       1.248353828535
   target nu stat err =       0.000415896119
   target dn stat err =       0.002103612928
      target stat err =       0.003568769479
              std dev =       0.526426768924
             le_variance =       0.277125143040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277137900780
                                         uncertainty =       0.001567106847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372233982
  error estimate for blocks of size 2^( 2) =       0.000386517914
  error estimate for blocks of size 2^( 3) =       0.000400268635
  error estimate for blocks of size 2^( 4) =       0.000409973290
  error estimate for blocks of size 2^( 5) =       0.000414748282
  error estimate for blocks of size 2^( 6) =       0.000418612711
  error estimate for blocks of size 2^( 7) =       0.000420250192

      target function =      -0.934896478211
              le_mean =     -17.210334759363
             les_mean =     296.481578415710
             stat err =       0.000415896119
             autocorr =       1.248353828537
   target nu stat err =       0.000415896119
   target dn stat err =       0.002103612928
      target stat err =       0.003568769479
              std dev =       0.526426768924
             le_variance =       0.277125143040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934896478211        initial
     3.7253e+11     3.7253e+12             1.6084e-15        -0.934896478211
     1.4901e+12     1.4901e+13             7.0875e-17        -0.934896478211  <--
     5.9605e+12     5.9605e+13             1.8378e-17        -0.934896478211

*****************************************************************************
Applying the update for shift_i =   1.4901e+12     and shift_s =   1.4901e+13
*****************************************************************************

  Execution time = 3.8866e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.217377
====================================================
  Execution time = 2.7401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0507e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8655e-01
  Total weights = 1.966536499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3413e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276895005602
                                         uncertainty =       0.001578897904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276895005602
                                         uncertainty =       0.001578897904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372067976
  error estimate for blocks of size 2^( 2) =       0.000386085558
  error estimate for blocks of size 2^( 3) =       0.000399105379
  error estimate for blocks of size 2^( 4) =       0.000408974749
  error estimate for blocks of size 2^( 5) =       0.000416048648
  error estimate for blocks of size 2^( 6) =       0.000419776153
  error estimate for blocks of size 2^( 7) =       0.000420891783

      target function =      -0.933910566491
              le_mean =     -17.210099173023
             les_mean =     296.474067914106
             stat err =       0.000416422833
             autocorr =       1.252634838610
   target nu stat err =       0.000416422833
   target dn stat err =       0.002119092790
      target stat err =       0.003585084331
              std dev =       0.526191996337
             le_variance =       0.276878017009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721009917302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933923290710       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933923290710       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933923290710       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934001117885       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934000201665       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934036696630       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934006132348       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933923290710       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933923290710       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933923290710       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935079617488       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933822904008       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932721403202       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934833425992       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934127675536       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934270898365       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933081373796       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933434181353       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933773096441       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933470841721       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933603259173       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934044659602       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934069833375       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934423068845       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.933227666762       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933877740813       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935839076527       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933968210899       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933988808676       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.933611978242       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934158979840       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934360126315       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932936655099       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933637077566       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935683647513       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932489445773       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.935178387939       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933694060134       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933477163785       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.933781496521       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934692450558       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933830087975       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933813833786       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.936157793883       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.933619049570       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.934552914687       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934564755298       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934014512174       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.933646721640       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.929540775927       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930795808775       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.935008540879       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.937020935674       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.932512783059       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.931783206535       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.934646483865       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.933905890472       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.933086538446       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.934273010425       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.933797540770       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.931252353827       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.933740677408       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931348074595       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.928550199606       residual = 6.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.927087437304       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.931476512654       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.934774089773       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.937581442669       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.926323937795       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.935988009766       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.931029248471       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.929946053999       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.916936807152       residual = 9.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.923940686634       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.950431700278       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.917677193748       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.925254471608       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.941944030819       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.941438513766       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.908178657475       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.933844799040       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.951214245375       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.941201777986       residual = 8.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.925992885443       residual = 7.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.055689686369       residual = 2.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.090576931316       residual = 2.42e+00           smallest_sin_value = 9.97e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+11 is 5.576670e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933923290710       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933923290710       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933923290710       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933923290710       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933850926890       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933287577501       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933923290710       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934546364726       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931062075484       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932306697904       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931349732745       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934344986661       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932325768673       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933417378506       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934421410151       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928532713722       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935518159385       residual = 8.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934583072189       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933004027740       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933746203918       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929991039555       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937442110507       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937629601844       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934928736681       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931865637589       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938373819908       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.928786374356       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.928377776433       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933205049703       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935041465031       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929640083934       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.928520341210       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.932311269441       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.928870323589       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925792601365       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.926086214527       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940646703761       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946299002898       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940985464213       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936467881379       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934014295593       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933019416515       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935072837188       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944209410668       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951418934009       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.937047218549       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944041315103       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913321573786       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916281793154       residual = 9.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915181866478       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.899432158457       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.920547205186       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.922254089349       residual = 8.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.949565936860       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.937311493418       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.965063574103       residual = 3.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.946835492427       residual = 5.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912598945179       residual = 3.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.975446139916       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.866791096726       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.857801178830       residual = 6.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.952168846537       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.870250536343       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.958516442277       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.930425931149       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.939477807045       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.863237417066       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.062795262041       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.991436845737       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.951777825525       residual = 9.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.058596001507       residual = 3.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.987489000108       residual = 6.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.924905318914       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.915320986709       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.842228520831       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.913576186813       residual = 8.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.853841792926       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.803521494473       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.976662549538       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.171837635109       residual = 4.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.960058620568       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.738881752774       residual = 5.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.170350367466       residual = 9.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.973039666703       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.123867230930       residual = 6.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.805043649415       residual = 4.18e+00           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 8.800765e-17

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933923290710       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933923290710       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933923290710       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933923290710       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934220943988       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932896731475       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933801530629       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935731598161       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930602689344       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937672571920       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936135262843       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933951938218       residual = 7.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932094264438       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939272722402       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934803067459       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925181955145       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937976444166       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934744403881       residual = 6.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931062358982       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916267675333       residual = 5.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922987280850       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943798887723       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905433220697       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.972748828103       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.954274731790       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944540415755       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.903284143903       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910375934233       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928220145979       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934772890272       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940246296411       residual = 5.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.926098817381       residual = 5.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.968410506267       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934856652104       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942117974065       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.887839831859       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948630135112       residual = 8.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.032826267602       residual = 9.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950075465399       residual = 8.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.962397136651       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.883096729598       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.967198924546       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912628099096       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944519486697       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.753520125658       residual = 2.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.958877965949       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.005898914433       residual = 9.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.916878686836       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.909295422483       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.005224445121       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.841192612574       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.910149984478       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.925250880350       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.825691361085       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.005202021570       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.689140149966       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.051691498575       residual = 2.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.182801572017       residual = 6.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.076915493633       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.054137783975       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.105989533621       residual = 4.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.877196283959       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.871528819424       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.135025847423       residual = 4.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.897144708255       residual = 3.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.602776508773       residual = 9.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.842973348971       residual = 7.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.780323711013       residual = 8.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.884716757190       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.874949899258       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.299417580972       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.714229403812       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.886425507654       residual = 5.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.996786045187       residual = 2.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.944498736336       residual = 6.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.058561346299       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.570203567382       residual = 7.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.997147011662       residual = 1.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.858211520766       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.413155966326       residual = 3.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.318063833958       residual = 5.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.682121829909       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -2.545189700911       residual = 2.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -3.084295251806       residual = 4.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.113160799785       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.215610948919       residual = 1.57e+02           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+12 is 2.227001e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              10.448879 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6467e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2811
    reference variance = 0.604753
====================================================
  Execution time = 3.0016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8225e-01
  Total weights = 1.9664e+06
  Execution time = 2.3648e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370106871
  error estimate for blocks of size 2^( 2) =       0.000384074804
  error estimate for blocks of size 2^( 3) =       0.000397083669
  error estimate for blocks of size 2^( 4) =       0.000406861863
  error estimate for blocks of size 2^( 5) =       0.000412584945
  error estimate for blocks of size 2^( 6) =       0.000415643320
  error estimate for blocks of size 2^( 7) =       0.000416575464

      target function =      -0.941092149768
              le_mean =     -17.209934100421
             les_mean =     296.464082981527
             stat err =       0.000412916398
             autocorr =       1.244715116678
   target nu stat err =       0.000412916398
   target dn stat err =       0.002086560904
      target stat err =       0.003583324182
              std dev =       0.523418531193
             le_variance =       0.273966958797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370106871
  error estimate for blocks of size 2^( 2) =       0.000384074804
  error estimate for blocks of size 2^( 3) =       0.000397083669
  error estimate for blocks of size 2^( 4) =       0.000406861863
  error estimate for blocks of size 2^( 5) =       0.000412584945
  error estimate for blocks of size 2^( 6) =       0.000415643320
  error estimate for blocks of size 2^( 7) =       0.000416575464

      target function =      -0.941092149768
              le_mean =     -17.209934100421
             les_mean =     296.464082981527
             stat err =       0.000412916398
             autocorr =       1.244715116679
   target nu stat err =       0.000412916398
   target dn stat err =       0.002086560904
      target stat err =       0.003583324182
              std dev =       0.523418531194
             le_variance =       0.273966958797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370106871
  error estimate for blocks of size 2^( 2) =       0.000384074804
  error estimate for blocks of size 2^( 3) =       0.000397083669
  error estimate for blocks of size 2^( 4) =       0.000406861863
  error estimate for blocks of size 2^( 5) =       0.000412584945
  error estimate for blocks of size 2^( 6) =       0.000415643320
  error estimate for blocks of size 2^( 7) =       0.000416575464

      target function =      -0.941092149768
              le_mean =     -17.209934100421
             les_mean =     296.464082981527
             stat err =       0.000412916398
             autocorr =       1.244715116683
   target nu stat err =       0.000412916398
   target dn stat err =       0.002086560904
      target stat err =       0.003583324182
              std dev =       0.523418531193
             le_variance =       0.273966958797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274047091812
                                         uncertainty =       0.001510800533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370106871
  error estimate for blocks of size 2^( 2) =       0.000384074804
  error estimate for blocks of size 2^( 3) =       0.000397083669
  error estimate for blocks of size 2^( 4) =       0.000406861863
  error estimate for blocks of size 2^( 5) =       0.000412584945
  error estimate for blocks of size 2^( 6) =       0.000415643320
  error estimate for blocks of size 2^( 7) =       0.000416575464

      target function =      -0.941092149768
              le_mean =     -17.209934100421
             les_mean =     296.464082981527
             stat err =       0.000412916398
             autocorr =       1.244715116677
   target nu stat err =       0.000412916398
   target dn stat err =       0.002086560904
      target stat err =       0.003583324182
              std dev =       0.523418531193
             le_variance =       0.273966958797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941092149768        initial
     3.7253e+11     3.7253e+12             5.5767e-16        -0.941092149768  <--
     1.4901e+12     1.4901e+13             8.8008e-17        -0.941092149768
     5.9605e+12     5.9605e+13             2.2270e-17        -0.941092149768

*****************************************************************************
Applying the update for shift_i =   3.7253e+11     and shift_s =   3.7253e+12
*****************************************************************************

  Execution time = 4.2011e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.448611
====================================================
  Execution time = 2.8054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0476e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8632e-01
  Total weights = 1.966334792e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2445e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277747864944
                                         uncertainty =       0.002036033802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277747864944
                                         uncertainty =       0.002036033802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372684713
  error estimate for blocks of size 2^( 2) =       0.000387052153
  error estimate for blocks of size 2^( 3) =       0.000400236783
  error estimate for blocks of size 2^( 4) =       0.000409535577
  error estimate for blocks of size 2^( 5) =       0.000415430561
  error estimate for blocks of size 2^( 6) =       0.000418009081
  error estimate for blocks of size 2^( 7) =       0.000421045666

      target function =      -0.934306864887
              le_mean =     -17.209484749815
             les_mean =     296.452686733193
             stat err =       0.000416005221
             autocorr =       1.245989561555
   target nu stat err =       0.000416005221
   target dn stat err =       0.002556074423
      target stat err =       0.004294094423
              std dev =       0.527064208868
             le_variance =       0.277796680270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720948474981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934325478991       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934325478991       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934325478991       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934325478991       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934355702911       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934325479015       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934326483962       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934363872527       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934339801541       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934243229375       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934414743407       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934275783193       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934336429778       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934177004338       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934610994292       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934109565697       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934224382692       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934260067829       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934117737361       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934329092092       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934182364761       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934148058164       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933965387347       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934210145926       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934217532899       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934314561329       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934033336952       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934469050811       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.934196851253       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.934309609413       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934579210825       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934683038865       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.933324995999       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.933919853958       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.933941174472       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933858475484       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934104136362       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933036907937       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933891665900       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.934020669880       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935291995302       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933755356855       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.935030592410       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.933599007369       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934002631953       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935004842309       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.934568888818       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934807307209       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.936319811030       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.934502229540       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.932559996702       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.932979170451       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936308877298       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.934918674678       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932649182884       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935034819735       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932586627102       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.932663717883       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.930429963371       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.934313825214       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.935186470740       residual = 9.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.930805083105       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.934749635946       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.935135968825       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.932825123518       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.933735162151       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.936331493014       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.930787815068       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.932555959809       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.937475650568       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.929230174632       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.936660258222       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.937744201656       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.926897559998       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.931474749288       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.931881441386       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934166650945       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.930640551101       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.926479545350       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.927881976094       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.935026444042       residual = 6.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.940394909798       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.944663956980       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.928426694041       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.946708434510       residual = 5.52e-02           smallest_sin_value = 9.99e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.942933211312       residual = 2.44e-02           smallest_sin_value = 9.99e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.962791130101       residual = 1.96e-01           smallest_sin_value = 9.92e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+10 is 2.921241e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934325478991       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934325478991       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934325478991       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934325478991       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934661787547       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934325478991       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934344279740       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934196302975       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933558762868       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934557826537       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934267120231       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934107268510       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933697464160       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934411370723       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933659227985       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935312450922       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934400189673       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933973041206       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935808991405       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934054350824       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934121210924       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932664510125       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934386682659       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930492656225       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.936787106378       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932502785455       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.936348138809       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932984905947       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.933281951984       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936068553197       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934220862408       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936078903607       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937312845137       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.932393179575       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935119763434       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933653179799       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.931713898397       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.932572335650       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930861958876       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.939123577522       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934437185382       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.938832617120       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.931774749634       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.935140858820       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937811221240       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.936383043103       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933925644966       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.923997875888       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.936248432033       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.927909182889       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.934385872156       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.936519006164       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.936074385664       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.935280386077       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.922872854093       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.939824583529       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.936043588632       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.943047498266       residual = 9.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.930024866451       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.938056937899       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.930267420532       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.933419882564       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.929998788060       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.932424460585       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.937963053971       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.942302650673       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.935071338938       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.936297275372       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.934317732487       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.926079412699       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.939235565791       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.963430561630       residual = 7.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.892826503661       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.982444790097       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.929691983666       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.907911595326       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.909876327758       residual = 8.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.919439894617       residual = 8.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.933824067625       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.946062640707       residual = 2.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.952653284969       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.885097760303       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.929959282395       residual = 2.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.953431855945       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.994793261477       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.919308074896       residual = 7.71e-02           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+11 is 5.877230e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934325478991       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934325478991       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934325478991       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934325478991       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934429085954       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933920380019       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934325478991       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934648455768       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935176406446       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935295927718       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932942056651       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936514252321       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932470846597       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934570587039       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929868957987       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934258626784       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932037035070       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936113141429       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921305535044       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931142964038       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938955034887       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.927952040114       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934175027707       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938176840030       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928948207308       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934404315324       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.930905096695       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934717982401       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.926133044030       residual = 9.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.932350414323       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930493984696       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945633519112       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915756249343       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938176265904       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931000622798       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942628237263       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929452762099       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938492512072       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.923672198234       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943465327782       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.930567448045       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.953954311815       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.955724675466       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.938276524455       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.937686013012       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.930910330123       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.935120884739       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.921334432861       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916212116883       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.936484848324       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.919890784757       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.970066697822       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.939931884895       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.945563272120       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.929890655089       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.877247793786       residual = 4.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.945508423083       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.913611834329       residual = 7.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.910379891851       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.914552950357       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.917463785241       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.983759057083       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.875732273737       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.976377487260       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.928335290582       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.044608692379       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.900677879974       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.957313208515       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.927044916862       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.721646614856       residual = 4.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.837665928619       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.861709217505       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.099717808327       residual = 3.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.871679496124       residual = 8.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.733323999181       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.924130825343       residual = 7.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.861071327600       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.865376812266       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.962374882871       residual = 1.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.826963152900       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.238193476578       residual = 1.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.093467816811       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.713285546377       residual = 4.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.117101061219       residual = 6.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.612169637629       residual = 9.62e+00           smallest_sin_value = 9.98e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 8.896128e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              11.160268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7017e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1658
    reference variance = 0.188293
====================================================
  Execution time = 2.7351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8466e-01
  Total weights = 1.9665e+06
  Execution time = 2.3595e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371432382
  error estimate for blocks of size 2^( 2) =       0.000385474107
  error estimate for blocks of size 2^( 3) =       0.000398491532
  error estimate for blocks of size 2^( 4) =       0.000407718946
  error estimate for blocks of size 2^( 5) =       0.000413874732
  error estimate for blocks of size 2^( 6) =       0.000415910695
  error estimate for blocks of size 2^( 7) =       0.000417413406

      target function =      -0.937038013534
              le_mean =     -17.210576114716
             les_mean =     296.488589281201
             stat err =       0.000413729445
             autocorr =       1.240718717773
   target nu stat err =       0.000413729445
   target dn stat err =       0.002780791981
      target stat err =       0.004696979791
              std dev =       0.525293116589
             le_variance =       0.275932858336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371432382
  error estimate for blocks of size 2^( 2) =       0.000385474107
  error estimate for blocks of size 2^( 3) =       0.000398491532
  error estimate for blocks of size 2^( 4) =       0.000407718946
  error estimate for blocks of size 2^( 5) =       0.000413874732
  error estimate for blocks of size 2^( 6) =       0.000415910695
  error estimate for blocks of size 2^( 7) =       0.000417413406

      target function =      -0.937038013534
              le_mean =     -17.210576114716
             les_mean =     296.488589281201
             stat err =       0.000413729445
             autocorr =       1.240718717774
   target nu stat err =       0.000413729445
   target dn stat err =       0.002780791981
      target stat err =       0.004696979791
              std dev =       0.525293116589
             le_variance =       0.275932858336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371432382
  error estimate for blocks of size 2^( 2) =       0.000385474107
  error estimate for blocks of size 2^( 3) =       0.000398491532
  error estimate for blocks of size 2^( 4) =       0.000407718946
  error estimate for blocks of size 2^( 5) =       0.000413874732
  error estimate for blocks of size 2^( 6) =       0.000415910695
  error estimate for blocks of size 2^( 7) =       0.000417413406

      target function =      -0.937038013534
              le_mean =     -17.210576114716
             les_mean =     296.488589281201
             stat err =       0.000413729445
             autocorr =       1.240718717771
   target nu stat err =       0.000413729445
   target dn stat err =       0.002780791981
      target stat err =       0.004696979791
              std dev =       0.525293116589
             le_variance =       0.275932858336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275998018845
                                         uncertainty =       0.002048381867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371432382
  error estimate for blocks of size 2^( 2) =       0.000385474107
  error estimate for blocks of size 2^( 3) =       0.000398491532
  error estimate for blocks of size 2^( 4) =       0.000407718946
  error estimate for blocks of size 2^( 5) =       0.000413874732
  error estimate for blocks of size 2^( 6) =       0.000415910695
  error estimate for blocks of size 2^( 7) =       0.000417413406

      target function =      -0.937038013534
              le_mean =     -17.210576114716
             les_mean =     296.488589281201
             stat err =       0.000413729445
             autocorr =       1.240718717774
   target nu stat err =       0.000413729445
   target dn stat err =       0.002780791981
      target stat err =       0.004696979791
              std dev =       0.525293116589
             le_variance =       0.275932858336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937038013534        initial
     9.3132e+10     9.3132e+11             2.9212e-15        -0.937038013534
     3.7253e+11     3.7253e+12             5.8772e-16        -0.937038013534
     1.4901e+12     1.4901e+13             8.8961e-17        -0.937038013534  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+12     and shift_s =   1.4901e+13
*****************************************************************************

  Execution time = 3.9317e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.172399
====================================================
  Execution time = 2.7977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9359e-01
  Total weights = 1.966126508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2071e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280437737932
                                         uncertainty =       0.001839058949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280437737932
                                         uncertainty =       0.001839058949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374461650
  error estimate for blocks of size 2^( 2) =       0.000388653681
  error estimate for blocks of size 2^( 3) =       0.000401863598
  error estimate for blocks of size 2^( 4) =       0.000411494238
  error estimate for blocks of size 2^( 5) =       0.000417507776
  error estimate for blocks of size 2^( 6) =       0.000420842043
  error estimate for blocks of size 2^( 7) =       0.000422143314

      target function =      -0.922379340214
              le_mean =     -17.210245984390
             les_mean =     296.486152560983
             stat err =       0.000417996843
             autocorr =       1.246038066271
   target nu stat err =       0.000417996843
   target dn stat err =       0.003742821412
      target stat err =       0.006090365752
              std dev =       0.529577216821
             le_variance =       0.280452028576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721024598439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922418442195       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922418442195       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922418442195       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922418442195       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922418442195       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922418442195       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922418442195       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922418442195       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922418442195       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922418442195       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922418442195       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922418442195       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922348877251       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921644077802       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923009430764       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920758220622       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922103395574       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922133326721       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922427713969       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923516022158       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922010643691       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923107973244       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922386857528       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922135946136       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922476292183       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920545350612       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923383881613       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920974931273       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920922137396       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.921472645399       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923643132932       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918356188314       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923054046369       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919112511940       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920954452721       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920413361649       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923023491140       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.921973244792       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917857733601       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918954263342       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.920762744022       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.920076784543       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.921687714146       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.920107585204       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.919671701344       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.921457275478       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917783414385       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.923840997186       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928931996331       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.924953737965       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913908426629       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.921162484014       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.930663434390       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931613409542       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.923353633885       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914767192350       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.931029043867       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.909336137896       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.928612259181       residual = 8.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.922709592194       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.933295302617       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.955276033220       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.905743748315       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.906496283802       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.959505321914       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.967912257584       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.911241705157       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.927921298681       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.911836557072       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.952123400893       residual = 9.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.942677173270       residual = 9.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.932829186258       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.915313703707       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.915407744282       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.930611132180       residual = 4.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.960013237081       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.934310527264       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.943209109355       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.959351863632       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.923023455858       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.993057784987       residual = 4.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.092694892216       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.921031665146       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.824047876650       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.847662625680       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.719121071323       residual = 8.64e+00           smallest_sin_value = 9.99e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.999257767003       residual = 9.71e-01           smallest_sin_value = 9.98e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+11 is 9.029837e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922418442195       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922418442195       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922418442195       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922418442195       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922418442195       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922418442195       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922418442195       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922418442195       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922418442195       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922418442195       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922418442195       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923667405417       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925439239893       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919351840258       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923870565530       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917335519479       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923238851768       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922593492317       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.921052609363       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925470172145       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937459651067       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919889622754       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.926808635491       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922880368307       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919770028040       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919853472133       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922236182266       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919990764064       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923857858041       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924790459481       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935953855750       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918199090725       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.927667743201       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.931529947565       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906499651957       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928098782098       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905815454871       residual = 2.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.922442070842       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908648118323       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.921304360111       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911229850310       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.933732501652       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.933303321803       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.927648094259       residual = 6.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.925649824433       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913034598602       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.938349885328       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.904904498995       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943038049977       residual = 8.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.908548437520       residual = 4.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.925718759845       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.937563857567       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.907194791394       residual = 5.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.959158963910       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913591819517       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.928315674673       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.897038244487       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.923285064316       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.902445174698       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.913643761995       residual = 6.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.985537490885       residual = 9.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.878416319278       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.906713785501       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.972812173254       residual = 9.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.905616567306       residual = 4.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.829058292888       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.017047219195       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.901967375674       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.931442723640       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.832078387142       residual = 3.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.822035993067       residual = 5.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.850079291192       residual = 4.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.051182550135       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.960820917347       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.862188025120       residual = 6.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.935584364584       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.862536502351       residual = 4.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.597112757157       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.916766916376       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.151587704604       residual = 6.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.750828718405       residual = 5.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.860885308867       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.762706328768       residual = 4.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.269426646149       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.738540702377       residual = 1.64e+01           smallest_sin_value = 9.98e-01
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.016103298141       residual = 7.01e+00           smallest_sin_value = 9.94e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.45e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 2.091983e-16

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922418442195       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922418442195       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922418442195       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924245163659       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922418442195       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920679735317       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919902064776       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919696601340       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923536525924       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.927027391713       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923323244993       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917188180294       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928715533593       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930427972258       residual = 7.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913799032369       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.899698887683       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912513336028       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950826255355       residual = 8.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904038512751       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920891242232       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923739453385       residual = 4.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.926593088787       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918859376180       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.871945114836       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.968815694462       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908873468125       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.958137150995       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.966434545389       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904369191425       residual = 6.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918890874843       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.984589420361       residual = 4.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943895204559       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.962823672721       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919648993633       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.011689816692       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917111625108       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.891946620646       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.954534950676       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.890560994900       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912841099849       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.874974978484       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.876053880768       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.876171543585       residual = 5.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.953130286813       residual = 2.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.924090819915       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.928831317731       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.920926383553       residual = 3.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.932686975614       residual = 3.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.943556332815       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.043338632045       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.926803506740       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.850595488930       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.883717395368       residual = 6.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.177965007285       residual = 5.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.964061932616       residual = 9.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.997263055328       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.998302424975       residual = 3.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.045907895906       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.033311297600       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.894631114978       residual = 4.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.795000421035       residual = 4.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.572207155722       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.067349181041       residual = 7.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.250238940191       residual = 1.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.397042108782       residual = 2.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.334508552486       residual = 3.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.978074516157       residual = 9.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.477783584733       residual = 2.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.826256648940       residual = 3.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.609355325311       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.557586636995       residual = 4.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.798679869197       residual = 7.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.332040221553       residual = 3.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.978342970499       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.929287021223       residual = 4.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.000012313646       residual = 5.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.681799649653       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =       0.166187415785       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.158067911126       residual = 8.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.025844798192       residual = 1.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -2.602724197774       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.369109482866       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.887431384231       residual = 1.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.731949970060       residual = 4.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =       1.494445818442       residual = 6.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.928515761657       residual = 5.18e+02           smallest_sin_value = 9.95e-01
davidson iteration   86 stopping due to small subspace S singular value of 8.21e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+12 is 3.410209e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              11.885342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6917e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.149457
====================================================
  Execution time = 2.7685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8759e-01
  Total weights = 1.9666e+06
  Execution time = 2.3654e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372257285
  error estimate for blocks of size 2^( 2) =       0.000386418062
  error estimate for blocks of size 2^( 3) =       0.000399728467
  error estimate for blocks of size 2^( 4) =       0.000409488044
  error estimate for blocks of size 2^( 5) =       0.000415052441
  error estimate for blocks of size 2^( 6) =       0.000418270402
  error estimate for blocks of size 2^( 7) =       0.000421972847

      target function =      -0.932222535909
              le_mean =     -17.209487948819
             les_mean =     296.454061980139
             stat err =       0.000416195933
             autocorr =       1.249997812432
   target nu stat err =       0.000416195933
   target dn stat err =       0.002195485812
      target stat err =       0.003691448646
              std dev =       0.526459724721
             le_variance =       0.277159841754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372257285
  error estimate for blocks of size 2^( 2) =       0.000386418062
  error estimate for blocks of size 2^( 3) =       0.000399728467
  error estimate for blocks of size 2^( 4) =       0.000409488044
  error estimate for blocks of size 2^( 5) =       0.000415052441
  error estimate for blocks of size 2^( 6) =       0.000418270402
  error estimate for blocks of size 2^( 7) =       0.000421972847

      target function =      -0.932222535909
              le_mean =     -17.209487948819
             les_mean =     296.454061980139
             stat err =       0.000416195933
             autocorr =       1.249997812431
   target nu stat err =       0.000416195933
   target dn stat err =       0.002195485812
      target stat err =       0.003691448646
              std dev =       0.526459724721
             le_variance =       0.277159841754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372257285
  error estimate for blocks of size 2^( 2) =       0.000386418062
  error estimate for blocks of size 2^( 3) =       0.000399728467
  error estimate for blocks of size 2^( 4) =       0.000409488044
  error estimate for blocks of size 2^( 5) =       0.000415052441
  error estimate for blocks of size 2^( 6) =       0.000418270402
  error estimate for blocks of size 2^( 7) =       0.000421972847

      target function =      -0.932222535909
              le_mean =     -17.209487948819
             les_mean =     296.454061980139
             stat err =       0.000416195933
             autocorr =       1.249997812431
   target nu stat err =       0.000416195933
   target dn stat err =       0.002195485812
      target stat err =       0.003691448646
              std dev =       0.526459724721
             le_variance =       0.277159841754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277156733723
                                         uncertainty =       0.001282829658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372257285
  error estimate for blocks of size 2^( 2) =       0.000386418062
  error estimate for blocks of size 2^( 3) =       0.000399728467
  error estimate for blocks of size 2^( 4) =       0.000409488044
  error estimate for blocks of size 2^( 5) =       0.000415052441
  error estimate for blocks of size 2^( 6) =       0.000418270402
  error estimate for blocks of size 2^( 7) =       0.000421972847

      target function =      -0.932222535909
              le_mean =     -17.209487948819
             les_mean =     296.454061980139
             stat err =       0.000416195933
             autocorr =       1.249997812432
   target nu stat err =       0.000416195933
   target dn stat err =       0.002195485812
      target stat err =       0.003691448646
              std dev =       0.526459724721
             le_variance =       0.277159841754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932222535909        initial
     3.7253e+11     3.7253e+12             9.0298e-16        -0.932222535909  <--
     1.4901e+12     1.4901e+13             2.0920e-16        -0.932222535909
     5.9605e+12     5.9605e+13             3.4102e-17        -0.932222535909

*****************************************************************************
Applying the update for shift_i =   3.7253e+11     and shift_s =   3.7253e+12
*****************************************************************************

  Execution time = 3.9679e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1624
    reference variance = 0.27101
====================================================
  Execution time = 2.7574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0464e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8900e-01
  Total weights = 1.966085803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2208e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280398127572
                                         uncertainty =       0.002741245241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280398127572
                                         uncertainty =       0.002741245241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374468039
  error estimate for blocks of size 2^( 2) =       0.000388369978
  error estimate for blocks of size 2^( 3) =       0.000401699318
  error estimate for blocks of size 2^( 4) =       0.000410875231
  error estimate for blocks of size 2^( 5) =       0.000416028893
  error estimate for blocks of size 2^( 6) =       0.000418820997
  error estimate for blocks of size 2^( 7) =       0.000419777396

      target function =      -0.929888133073
              le_mean =     -17.209600450660
             les_mean =     296.459343694460
             stat err =       0.000416375629
             autocorr =       1.236349023149
   target nu stat err =       0.000416375629
   target dn stat err =       0.003101628956
      target stat err =       0.005138754080
              std dev =       0.529586253308
             le_variance =       0.280461599692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720960045066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929915730422       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929915730422       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929915730422       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929884075307       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929974676133       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929901953998       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929670169341       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929935267539       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929932859204       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930017223749       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929989799597       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929919288767       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929784027606       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930059755579       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930055923032       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929612969980       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929755217527       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930106648146       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929841971441       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930048770268       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929820894487       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929933740056       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930116492215       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929927842193       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929755378249       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929629898073       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929694484388       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929852988566       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929777083546       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929633983727       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.929651450723       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930108164139       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929680654090       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930278444355       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.929368583433       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.929676859145       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.929895313767       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.930310656763       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929617524622       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929356379857       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.930046133073       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.929961519079       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929819510233       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.930732888560       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929402212255       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.929941864889       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.929566737866       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.928921618120       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928222214344       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.926134242752       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.927828467741       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931762105575       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.929270488504       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.929894991501       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.927659149949       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.929564619934       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.929046180794       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.927255508796       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.932396032137       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.928987176976       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.928512279542       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.930935301636       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.931647482046       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.929896138454       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.927450551807       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.932392657955       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.932525061453       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.929151606561       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.933308211388       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.931054116714       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.930635448771       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.927723971659       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.927073860409       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.930384192254       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.933471525548       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.922337195618       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.928816479412       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.926441118945       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.914013235002       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.951501821148       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.953629521813       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.927909547064       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.859415470640       residual = 4.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.904563522252       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.862387343890       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.924292196087       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.898384004214       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   87 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+10 is 3.423468e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929915730422       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929915730422       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929915730422       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929720178058       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930020174005       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930252371099       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929859060737       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930087843075       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930387756991       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929790233052       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930146309323       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930284953526       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930345967396       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929888172389       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930257938492       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929632543011       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928856979366       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929508844628       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929784306510       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929894470770       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929138541647       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930951149631       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928482870207       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931054745195       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930092954240       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929818566922       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.929683081557       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929369187631       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.930053839447       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.929485467959       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932305181324       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930832015748       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.930341233554       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929020494520       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931534761873       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.930186658360       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930974016917       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.929573801729       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.929261496026       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.929887182613       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.930129400301       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.931011436298       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.929426612749       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.928718088396       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.930035250037       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.931354563655       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.928416726589       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.933146361461       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.930273191457       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.928097530815       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.928341429591       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.929494970496       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.931225252514       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.931957498744       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.924454735552       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.936460910729       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.922138970007       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.901094495646       residual = 8.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.922283601161       residual = 5.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.919046276734       residual = 5.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.959666391797       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912360491266       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.916457701503       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.926303029422       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.925702377618       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.928508281132       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.919838829752       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.922768736225       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.933478016447       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.940427777323       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.964225403229       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.871112247736       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.890105853844       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.884208032555       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.903126657052       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.936839341660       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.923310693755       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.964971556658       residual = 2.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.924188108436       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.943791483474       residual = 8.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.961577800024       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.923660359189       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.936151274134       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.803307117761       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.981807199377       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.895288508445       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.867756690196       residual = 1.10e+00           smallest_sin_value = 9.96e-01
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.830381360278       residual = 2.99e+00           smallest_sin_value = 9.93e-01
davidson iteration   88 stopping due to small subspace S singular value of 8.24e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+11 is 6.436821e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929915730422       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929915730422       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929915730422       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929157837438       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929432167052       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.928775893062       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931157416633       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928685936352       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923130958787       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931679437696       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932241617770       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930244266686       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.928384656519       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929633272943       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.928143054032       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.928577517139       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930211790314       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928835782141       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930041097102       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933298701235       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.927132827805       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.928858392397       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930793156507       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929715014138       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928713061265       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933830245433       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927359746599       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929306053071       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.926587842841       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.927157084118       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.928623829791       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900836559888       residual = 7.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923492646962       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934867928940       residual = 9.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.934981524142       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.932560895344       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934624833639       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928757721325       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.922182816595       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936563036927       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.924446415693       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.921008185609       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.942296009824       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915246606860       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941810436293       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951819778638       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.933424543149       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.902276129685       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.937512368760       residual = 5.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937772979359       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947987767528       residual = 7.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.924699812148       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.907552639998       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.927301948490       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.883742323336       residual = 2.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.967361168756       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.949170885305       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.907953852169       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.988261087917       residual = 4.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.954228928277       residual = 9.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.916933043509       residual = 8.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.887290828265       residual = 4.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.046630000577       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.992949008324       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.982462803499       residual = 5.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.800053738383       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.240447788648       residual = 9.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.085489545883       residual = 2.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.939911926942       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.959247355340       residual = 7.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.849476555302       residual = 1.60e+00           smallest_sin_value = 9.99e-01
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.603586406444       residual = 4.24e+01           smallest_sin_value = 9.99e-01
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.441783233131       residual = 2.61e+01           smallest_sin_value = 9.99e-01
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.782961425870       residual = 2.08e+00           smallest_sin_value = 9.98e-01
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.830929182252       residual = 2.19e+00           smallest_sin_value = 9.98e-01
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.714337851852       residual = 4.44e+00           smallest_sin_value = 9.98e-01
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.778789200874       residual = 3.30e+00           smallest_sin_value = 9.96e-01
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.044481606242       residual = 4.35e+00           smallest_sin_value = 9.96e-01
davidson iteration   78 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         78 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+12 is 1.534743e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              12.562324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6479e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.3069
    reference variance = 0.181974
====================================================
  Execution time = 2.7418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8103e-01
  Total weights = 1.9665e+06
  Execution time = 2.3648e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369759714
  error estimate for blocks of size 2^( 2) =       0.000384080734
  error estimate for blocks of size 2^( 3) =       0.000397086728
  error estimate for blocks of size 2^( 4) =       0.000407325310
  error estimate for blocks of size 2^( 5) =       0.000413257018
  error estimate for blocks of size 2^( 6) =       0.000416354533
  error estimate for blocks of size 2^( 7) =       0.000417120465

      target function =      -0.943155494027
              le_mean =     -17.209022802426
             les_mean =     296.431498555796
             stat err =       0.000413514332
             autocorr =       1.250667737786
   target nu stat err =       0.000413514332
   target dn stat err =       0.001838909920
      target stat err =       0.003185490073
              std dev =       0.522927569333
             le_variance =       0.273453242768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369759714
  error estimate for blocks of size 2^( 2) =       0.000384080734
  error estimate for blocks of size 2^( 3) =       0.000397086728
  error estimate for blocks of size 2^( 4) =       0.000407325310
  error estimate for blocks of size 2^( 5) =       0.000413257018
  error estimate for blocks of size 2^( 6) =       0.000416354533
  error estimate for blocks of size 2^( 7) =       0.000417120465

      target function =      -0.943155494027
              le_mean =     -17.209022802426
             les_mean =     296.431498555796
             stat err =       0.000413514332
             autocorr =       1.250667737785
   target nu stat err =       0.000413514332
   target dn stat err =       0.001838909920
      target stat err =       0.003185490073
              std dev =       0.522927569333
             le_variance =       0.273453242768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369759714
  error estimate for blocks of size 2^( 2) =       0.000384080734
  error estimate for blocks of size 2^( 3) =       0.000397086728
  error estimate for blocks of size 2^( 4) =       0.000407325310
  error estimate for blocks of size 2^( 5) =       0.000413257018
  error estimate for blocks of size 2^( 6) =       0.000416354533
  error estimate for blocks of size 2^( 7) =       0.000417120465

      target function =      -0.943155494027
              le_mean =     -17.209022802426
             les_mean =     296.431498555796
             stat err =       0.000413514332
             autocorr =       1.250667737785
   target nu stat err =       0.000413514332
   target dn stat err =       0.001838909920
      target stat err =       0.003185490073
              std dev =       0.522927569333
             le_variance =       0.273453242768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273493876752
                                         uncertainty =       0.001463443549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369759714
  error estimate for blocks of size 2^( 2) =       0.000384080734
  error estimate for blocks of size 2^( 3) =       0.000397086728
  error estimate for blocks of size 2^( 4) =       0.000407325310
  error estimate for blocks of size 2^( 5) =       0.000413257018
  error estimate for blocks of size 2^( 6) =       0.000416354533
  error estimate for blocks of size 2^( 7) =       0.000417120465

      target function =      -0.943155494027
              le_mean =     -17.209022802426
             les_mean =     296.431498555796
             stat err =       0.000413514332
             autocorr =       1.250667737785
   target nu stat err =       0.000413514332
   target dn stat err =       0.001838909920
      target stat err =       0.003185490073
              std dev =       0.522927569333
             le_variance =       0.273453242768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943155494027        initial  <--
     9.3132e+10     9.3132e+11             3.4235e-15        -0.943155494027
     3.7253e+11     3.7253e+12             6.4368e-16        -0.943155494027
     1.4901e+12     1.4901e+13             1.5347e-16        -0.943155494027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.4036
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.223
    reference variance = 0.393184
====================================================
  Execution time = 2.7624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9698e-01
  Total weights = 1.966397514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2066e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276899700159
                                         uncertainty =       0.002492164571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276899700159
                                         uncertainty =       0.002492164571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372047073
  error estimate for blocks of size 2^( 2) =       0.000386197304
  error estimate for blocks of size 2^( 3) =       0.000399517141
  error estimate for blocks of size 2^( 4) =       0.000408543621
  error estimate for blocks of size 2^( 5) =       0.000414771335
  error estimate for blocks of size 2^( 6) =       0.000418163738
  error estimate for blocks of size 2^( 7) =       0.000418818402

      target function =      -0.916598715090
              le_mean =     -17.209869024773
             les_mean =     296.476567950072
             stat err =       0.000415074274
             autocorr =       1.244674665958
   target nu stat err =       0.000415074274
   target dn stat err =       0.011955209403
      target stat err =       0.019078791962
              std dev =       0.526162434563
             le_variance =       0.276846907545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720986902477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916995783110       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916995783110       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916995783110       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917363339959       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916995783110       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917047770717       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915971789197       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916099188944       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917408180275       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916955883925       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915840135841       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914694456159       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916508712119       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918720284697       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916248615671       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917728167652       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916166691034       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918207278997       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915346954472       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912948400104       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911238395076       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915837685023       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915184417307       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917105020399       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910786696394       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914922438944       residual = 9.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904470309170       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913522737068       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914506619214       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913730123684       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914921647285       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916498133282       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917618807358       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908839427966       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918096862512       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.928502461074       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912667626685       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911267637908       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908697818432       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912927168961       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918395827619       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913345174121       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916416343719       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.920975657666       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.903723352581       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.920616408952       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915846409339       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.908205161796       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.916041124399       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.918421643160       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913047978725       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.931815262577       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.886364862906       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.916042052528       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.928306515496       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.932378607105       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.918007165346       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.923461631108       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.930888372721       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.924320181759       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.934314791455       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.909788184699       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.914522616754       residual = 8.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.900155897375       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.899112302334       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.917490061241       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.876147918512       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.974890008257       residual = 6.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.905446158256       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.917492101056       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.930742984387       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.906373081338       residual = 9.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.886023334956       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.899884998548       residual = 8.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.874498337627       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.862179432244       residual = 4.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.851121083402       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.947175594572       residual = 6.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.848531792961       residual = 6.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.927846448985       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.958825242044       residual = 8.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.097491425617       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.993367411478       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.951855965810       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.848688369967       residual = 3.51e+00           smallest_sin_value = 9.97e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+11 is 4.478643e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916995783110       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916995783110       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916995783110       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915313405661       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915393806559       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916555902686       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916995783110       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914696668178       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916581062816       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918277216410       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917562398154       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914750272487       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918130135928       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.921039113814       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913738047198       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897017832894       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889929107627       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905321397618       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910619459590       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.898286693371       residual = 6.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913972470274       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905424366497       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932178440047       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929637948949       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927992249110       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913104391946       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906439961198       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912188328136       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.893898521402       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912812568692       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908160396904       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.882467467001       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928129186440       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.930775600781       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.898869387752       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.926354855567       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.082890134447       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.890452700645       residual = 9.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.819385138410       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.834613695004       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.932463219722       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.064099791846       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.901141888868       residual = 9.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.902832428509       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.874501718169       residual = 3.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.812723398811       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.855023449588       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.923901754210       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.903381573045       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.885314848600       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.870640263088       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.996811056765       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.776006399002       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.047587799113       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.986529982090       residual = 6.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.968338591330       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.213400918708       residual = 9.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.925999472426       residual = 3.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.840156591042       residual = 4.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.970105980819       residual = 7.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.915250196770       residual = 7.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.682449997033       residual = 5.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.026578783307       residual = 4.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.098661481914       residual = 3.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.071413446999       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.801697690773       residual = 5.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.719034689895       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.198154020646       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.857825624145       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.012073394551       residual = 3.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.801921037972       residual = 4.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.716555585703       residual = 2.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.057433720135       residual = 4.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.848326945190       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.690973444044       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.831521072138       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.744998758663       residual = 2.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.863312663190       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.665613014788       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.881424123936       residual = 9.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.866410442073       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.118745041505       residual = 9.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.478080786337       residual = 8.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.756469095813       residual = 9.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.471796790666       residual = 7.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.740167448259       residual = 9.88e+01           smallest_sin_value = 9.98e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+12 is 9.690793e-17

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916995783110       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916995783110       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916995783110       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917676454656       residual = 5.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915663222123       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920471994626       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921923192628       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.888033578220       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934578006844       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947997711645       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900940407050       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916018108355       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910973930808       residual = 6.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914069871194       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921441800767       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930192433192       residual = 4.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.928468157805       residual = 6.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924090300319       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.025185972917       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.819738326341       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.892773366236       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.887701889576       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.876181793925       residual = 8.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.968899599260       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.871512331256       residual = 4.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.006073513464       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.013083183064       residual = 8.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948998748975       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.847236185688       residual = 5.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737628458141       residual = 3.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.830203662777       residual = 8.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.059987114280       residual = 3.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.019969909925       residual = 1.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.133958816276       residual = 5.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.764908562965       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.807738572074       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.034642268086       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.712561196803       residual = 5.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.986785491910       residual = 5.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.556401693642       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.752474985339       residual = 2.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.003045419805       residual = 9.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.864789476494       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.128274627927       residual = 4.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.724317656282       residual = 4.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.153456845688       residual = 4.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.504522321576       residual = 1.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.386328543503       residual = 2.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.503115298714       residual = 3.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.625380581081       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.131873436621       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.858071803508       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.691034191989       residual = 7.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.599531924468       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.755189919861       residual = 9.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.391600704331       residual = 5.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.302504155457       residual = 3.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.351667615238       residual = 6.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.233842658830       residual = 1.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.024476582495       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.724912419327       residual = 4.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.115725475030       residual = 6.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.118394231692       residual = 5.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.701895419105       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.095021533089       residual = 3.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.134584622807       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.759010419322       residual = 8.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.260421274171       residual = 8.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.764128134132       residual = 7.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.222398238790       residual = 1.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -4.291815703504       residual = 1.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -4.134062631032       residual = 1.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.560681655139       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =       1.347430514590       residual = 6.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -2.273937678240       residual = 3.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.833916203410       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.061574499700       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -2.187223427283       residual = 1.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.900383238101       residual = 9.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -3.279756076704       residual = 5.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.567140525394       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -2.902371680318       residual = 4.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -8.766657648106       residual = 6.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.149428648412       residual = 3.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -2.165976569376       residual = 3.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =       3.438401526167       residual = 5.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =       2.502099573037       residual = 1.21e+03           smallest_sin_value = 9.98e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.32e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+13 is 2.528133e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              13.280929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6556e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.194082
====================================================
  Execution time = 2.9248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8166e-01
  Total weights = 1.9665e+06
  Execution time = 2.3269e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369797286
  error estimate for blocks of size 2^( 2) =       0.000384342928
  error estimate for blocks of size 2^( 3) =       0.000397707043
  error estimate for blocks of size 2^( 4) =       0.000407961465
  error estimate for blocks of size 2^( 5) =       0.000413963536
  error estimate for blocks of size 2^( 6) =       0.000415108864
  error estimate for blocks of size 2^( 7) =       0.000418340777

      target function =      -0.942095782929
              le_mean =     -17.209567788537
             les_mean =     296.450882528895
             stat err =       0.000413843661
             autocorr =       1.252406101805
   target nu stat err =       0.000413843661
   target dn stat err =       0.001817669838
      target stat err =       0.003147191379
              std dev =       0.522980704588
             le_variance =       0.273508817371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369797286
  error estimate for blocks of size 2^( 2) =       0.000384342928
  error estimate for blocks of size 2^( 3) =       0.000397707043
  error estimate for blocks of size 2^( 4) =       0.000407961465
  error estimate for blocks of size 2^( 5) =       0.000413963536
  error estimate for blocks of size 2^( 6) =       0.000415108864
  error estimate for blocks of size 2^( 7) =       0.000418340777

      target function =      -0.942095782929
              le_mean =     -17.209567788537
             les_mean =     296.450882528895
             stat err =       0.000413843661
             autocorr =       1.252406101804
   target nu stat err =       0.000413843661
   target dn stat err =       0.001817669838
      target stat err =       0.003147191379
              std dev =       0.522980704588
             le_variance =       0.273508817371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369797286
  error estimate for blocks of size 2^( 2) =       0.000384342928
  error estimate for blocks of size 2^( 3) =       0.000397707043
  error estimate for blocks of size 2^( 4) =       0.000407961465
  error estimate for blocks of size 2^( 5) =       0.000413963536
  error estimate for blocks of size 2^( 6) =       0.000415108864
  error estimate for blocks of size 2^( 7) =       0.000418340777

      target function =      -0.942095782929
              le_mean =     -17.209567788537
             les_mean =     296.450882528895
             stat err =       0.000413843661
             autocorr =       1.252406101806
   target nu stat err =       0.000413843661
   target dn stat err =       0.001817669838
      target stat err =       0.003147191379
              std dev =       0.522980704588
             le_variance =       0.273508817371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273436873377
                                         uncertainty =       0.001507683746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369797286
  error estimate for blocks of size 2^( 2) =       0.000384342928
  error estimate for blocks of size 2^( 3) =       0.000397707043
  error estimate for blocks of size 2^( 4) =       0.000407961465
  error estimate for blocks of size 2^( 5) =       0.000413963536
  error estimate for blocks of size 2^( 6) =       0.000415108864
  error estimate for blocks of size 2^( 7) =       0.000418340777

      target function =      -0.942095782929
              le_mean =     -17.209567788537
             les_mean =     296.450882528895
             stat err =       0.000413843661
             autocorr =       1.252406101804
   target nu stat err =       0.000413843661
   target dn stat err =       0.001817669838
      target stat err =       0.003147191379
              std dev =       0.522980704588
             le_variance =       0.273508817371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942095782929        initial
     9.3132e+11     9.3132e+12             4.4786e-16        -0.942095782929
     3.7253e+12     3.7253e+13             9.6908e-17        -0.942095782929
     1.4901e+13     1.4901e+14             2.5281e-17        -0.942095782929  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+13     and shift_s =   1.4901e+14
*****************************************************************************

  Execution time = 4.1010e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.261328
====================================================
  Execution time = 2.7259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8605e-01
  Total weights = 1.966200548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2848e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276393229294
                                         uncertainty =       0.001541239199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276393229294
                                         uncertainty =       0.001541239199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371696462
  error estimate for blocks of size 2^( 2) =       0.000386330148
  error estimate for blocks of size 2^( 3) =       0.000399534192
  error estimate for blocks of size 2^( 4) =       0.000409221758
  error estimate for blocks of size 2^( 5) =       0.000414624833
  error estimate for blocks of size 2^( 6) =       0.000418214188
  error estimate for blocks of size 2^( 7) =       0.000420207087

      target function =      -0.934761443439
              le_mean =     -17.209475138156
             les_mean =     296.452080126681
             stat err =       0.000415566966
             autocorr =       1.249986093765
   target nu stat err =       0.000415566966
   target dn stat err =       0.002709878500
      target stat err =       0.004549247273
              std dev =       0.525666588138
             le_variance =       0.276325361885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720947513816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934782377736       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934782377736       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934782377736       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934782377736       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933899391301       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934782377736       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934782377736       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934782377736       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934782377736       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934782377736       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931504924845       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941744424807       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929361461294       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944675558809       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930292550119       residual = 8.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936890603173       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936386031116       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934928119195       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932948379651       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935936461352       residual = 9.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.976757662503       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942175971766       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935463083095       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932488887173       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941272096434       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935513811587       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.931545719015       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.938195939410       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.931445249097       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936201851626       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937887241240       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935450069813       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.928876677900       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911974109107       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.936869422916       residual = 4.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.890357029540       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.939885929264       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948855430182       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925648525401       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944171769707       residual = 8.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.931648862028       residual = 7.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.924746535312       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.897380614480       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.981993321751       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.926769498709       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.926081295895       residual = 4.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.937783827536       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.967430177682       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.932447368984       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.887599226032       residual = 5.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.727296558474       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.121643426379       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.917788332182       residual = 7.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.920011561512       residual = 8.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.635834981259       residual = 7.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.065269384473       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.120866531264       residual = 4.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.132617140672       residual = 4.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.148204680172       residual = 6.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.830028902926       residual = 4.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.809300882752       residual = 3.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.911708100937       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.065825026204       residual = 9.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.040448591370       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.967312071475       residual = 9.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.984053995055       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.421470428656       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.635904685245       residual = 4.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.237733069664       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.756678051784       residual = 4.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.978152203504       residual = 4.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.529035328487       residual = 1.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.156165170695       residual = 5.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.574334188258       residual = 2.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.104957911075       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.049639626968       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.848655338916       residual = 6.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.778756638747       residual = 7.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.044348120545       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.592657564615       residual = 2.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.712821348774       residual = 7.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.153816779573       residual = 3.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.329301428905       residual = 3.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.837846267755       residual = 8.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =       0.331916235819       residual = 5.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -3.149902789452       residual = 7.05e+02           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+12 is 8.589300e-17

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934782377736       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934782377736       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.57e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934782377736       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934782377736       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.57e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              13.521227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5791e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1915
    reference variance = 0.128592
====================================================
  Execution time = 2.6786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8679e-01
  Total weights = 1.9666e+06
  Execution time = 2.3163e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178772
  error estimate for blocks of size 2^( 2) =       0.000386468833
  error estimate for blocks of size 2^( 3) =       0.000399502344
  error estimate for blocks of size 2^( 4) =       0.000409806277
  error estimate for blocks of size 2^( 5) =       0.000416012195
  error estimate for blocks of size 2^( 6) =       0.000418930113
  error estimate for blocks of size 2^( 7) =       0.000420461721

      target function =      -0.933515382780
              le_mean =     -17.210138487783
             les_mean =     296.475657082378
             stat err =       0.000416302576
             autocorr =       1.251166188506
   target nu stat err =       0.000416302576
   target dn stat err =       0.002385060366
      target stat err =       0.004013928741
              std dev =       0.526348688567
             le_variance =       0.277042941956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178772
  error estimate for blocks of size 2^( 2) =       0.000386468833
  error estimate for blocks of size 2^( 3) =       0.000399502344
  error estimate for blocks of size 2^( 4) =       0.000409806277
  error estimate for blocks of size 2^( 5) =       0.000416012195
  error estimate for blocks of size 2^( 6) =       0.000418930113
  error estimate for blocks of size 2^( 7) =       0.000420461721

      target function =      -0.933515382780
              le_mean =     -17.210138487783
             les_mean =     296.475657082378
             stat err =       0.000416302576
             autocorr =       1.251166188500
   target nu stat err =       0.000416302576
   target dn stat err =       0.002385060366
      target stat err =       0.004013928741
              std dev =       0.526348688567
             le_variance =       0.277042941956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178772
  error estimate for blocks of size 2^( 2) =       0.000386468833
  error estimate for blocks of size 2^( 3) =       0.000399502344
  error estimate for blocks of size 2^( 4) =       0.000409806277
  error estimate for blocks of size 2^( 5) =       0.000416012195
  error estimate for blocks of size 2^( 6) =       0.000418930113
  error estimate for blocks of size 2^( 7) =       0.000420461721

      target function =      -0.933515382780
              le_mean =     -17.210138487783
             les_mean =     296.475657082378
             stat err =       0.000416302576
             autocorr =       1.251166188506
   target nu stat err =       0.000416302576
   target dn stat err =       0.002385060366
      target stat err =       0.004013928741
              std dev =       0.526348688567
             le_variance =       0.277042941956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277052334661
                                         uncertainty =       0.001643338580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178772
  error estimate for blocks of size 2^( 2) =       0.000386468833
  error estimate for blocks of size 2^( 3) =       0.000399502344
  error estimate for blocks of size 2^( 4) =       0.000409806277
  error estimate for blocks of size 2^( 5) =       0.000416012195
  error estimate for blocks of size 2^( 6) =       0.000418930113
  error estimate for blocks of size 2^( 7) =       0.000420461721

      target function =      -0.933515382780
              le_mean =     -17.210138487783
             les_mean =     296.475657082378
             stat err =       0.000416302576
             autocorr =       1.251166188506
   target nu stat err =       0.000416302576
   target dn stat err =       0.002385060366
      target stat err =       0.004013928741
              std dev =       0.526348688567
             le_variance =       0.277042941956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933515382780        initial  <--
     3.7253e+12     3.7253e+13             8.5893e-17        -0.933515382780
     1.4901e+13     1.4901e+14             0.0000e+00        -0.933515382780
     5.9605e+13     5.9605e+14             0.0000e+00        -0.933515382780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4705
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.306835
====================================================
  Execution time = 2.7055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0504e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8574e-01
  Total weights = 1.966498065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2556e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276389274574
                                         uncertainty =       0.001641998314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276389274574
                                         uncertainty =       0.001641998314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371732437
  error estimate for blocks of size 2^( 2) =       0.000386264351
  error estimate for blocks of size 2^( 3) =       0.000399407351
  error estimate for blocks of size 2^( 4) =       0.000409506060
  error estimate for blocks of size 2^( 5) =       0.000414928210
  error estimate for blocks of size 2^( 6) =       0.000417259966
  error estimate for blocks of size 2^( 7) =       0.000419036751

      target function =      -0.935258239362
              le_mean =     -17.210218654348
             les_mean =     296.477362436314
             stat err =       0.000415182747
             autocorr =       1.247434291138
   target nu stat err =       0.000415182747
   target dn stat err =       0.002531349447
      target stat err =       0.004268008773
              std dev =       0.525717464896
             le_variance =       0.276378852897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721021865435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935276514943       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935276514943       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935276514943       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935276514943       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935276514943       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935276526266       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935309306761       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935626927821       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824917355368       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947467282637       residual = 6.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908533248094       residual = 8.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.966940634397       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.009388766159       residual = 9.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910202473549       residual = 3.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.271106975142       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.979483827333       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.769150096500       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.824878135611       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909447743620       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935484069621       residual = 5.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.108741164917       residual = 6.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.033322263295       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950455621522       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.058920669627       residual = 6.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931319340902       residual = 7.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900112883761       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.925738913195       residual = 3.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.974317311665       residual = 8.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.213873406014       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.870592167389       residual = 4.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.779618129529       residual = 4.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724180301504       residual = 6.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.284356048472       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.141436672753       residual = 6.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.809939259304       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.710099186667       residual = 5.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.828120498272       residual = 8.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.464091237287       residual = 5.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945900892144       residual = 5.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.126636063587       residual = 7.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.016185136456       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.042940520353       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.017143004856       residual = 5.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.260322886429       residual = 5.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.926424615841       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919821482311       residual = 5.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.854237101017       residual = 4.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.226124213161       residual = 9.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.196135639281       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.177729178025       residual = 1.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       0.861959260052       residual = 3.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.379194199134       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.405140908596       residual = 5.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.997857425098       residual = 2.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.693565471569       residual = 9.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.755776266303       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.932705430401       residual = 6.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.904628126435       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.395629888289       residual = 6.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =       0.122128200890       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =       0.240444519426       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.636562698557       residual = 5.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.223844462248       residual = 2.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =       1.480730877499       residual = 7.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.987978485583       residual = 2.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.032274720715       residual = 4.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -5.401631621847       residual = 2.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -5.720877600561       residual = 2.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =       2.655682400660       residual = 1.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.061585979901       residual = 5.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =       1.537693122972       residual = 8.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.754657226706       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.956898365476       residual = 5.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =       4.064174214496       residual = 3.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -3.207206505922       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.963047524207       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.245133772996       residual = 7.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -7.648748796795       residual = 5.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -6.699480885069       residual = 3.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   79 stopping due to too large eigenvalue change
davidson solver did not converge after         79 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+13 is 3.806015e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935276514943       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935276514943       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935276514943       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935276514943       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935276514943       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935276514943       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935276516138       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935369631294       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.282110393769       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.822995738074       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939468536881       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.629701509847       residual = 1.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.682038961971       residual = 5.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.012496845147       residual = 5.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.286574102490       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.156529083756       residual = 2.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.284896493671       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.277200962723       residual = 1.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.981522021291       residual = 6.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.759998212206       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.894569151288       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.972304621071       residual = 8.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.507413255675       residual = 4.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.710222386085       residual = 3.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.756934716938       residual = 2.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.274302452861       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.707203365422       residual = 2.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.028132932575       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.251923057135       residual = 6.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.218618975942       residual = 2.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.127589810345       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.796316603767       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.523490951817       residual = 4.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.000987206205       residual = 1.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.183217018636       residual = 4.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.456770613039       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.861008212671       residual = 4.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -2.197129445408       residual = 1.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -2.280083995644       residual = 3.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.998591624289       residual = 3.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.072692716269       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       2.629762203080       residual = 2.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       0.152671971066       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.830328098856       residual = 5.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.472002511230       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -4.285837611086       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.607566691921       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -2.619864026556       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.184963170115       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -4.104639889999       residual = 2.69e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -2.795487435425       residual = 9.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.666694320255       residual = 8.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.229768611310       residual = 4.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =       1.407675859477       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =       0.073283202988       residual = 8.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.334390176357       residual = 9.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.353016690348       residual = 5.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.545949943924       residual = 5.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -1.093000165692       residual = 3.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =       3.093944363649       residual = 1.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.050442701540       residual = 1.35e+03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -5.205813017812       residual = 6.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -3.867066599857       residual = 3.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =       0.089099768627       residual = 1.78e+03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =       0.945059901000       residual = 5.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -7.818911561493       residual = 7.66e+04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -4.361946246587       residual = 4.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   67 stopping due to too large eigenvalue change
davidson solver did not converge after         67 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+14 is 8.635373e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935276514943       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935276514943       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935276514943       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935276514943       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935276514943       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935276574481       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935277608165       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935281398002       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.773437436828       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       0.007123280650       residual = 7.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.757037330204       residual = 5.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.012266425486       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.953837571895       residual = 8.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.682442821447       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -2.331770713248       residual = 2.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.955469973019       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.362636920788       residual = 3.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.217749775581       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.922139786270       residual = 2.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.330297217174       residual = 3.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.818891219661       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -2.181659979752       residual = 4.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -2.371082141935       residual = 3.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -3.137488120134       residual = 5.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.713818687966       residual = 7.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.230690495962       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -2.887811168740       residual = 5.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.804860315447       residual = 8.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.490294941136       residual = 1.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.558786851490       residual = 5.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -3.564876082770       residual = 9.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -5.428360332450       residual = 2.60e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       1.938735326756       residual = 1.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       8.948233367764       residual = 9.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -8.761249667667       residual = 8.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.9605e+14 is 2.161872e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              13.839729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5637e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.336795
====================================================
  Execution time = 2.7027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8824e-01
  Total weights = 1.9664e+06
  Execution time = 2.3151e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372976979
  error estimate for blocks of size 2^( 2) =       0.000387115457
  error estimate for blocks of size 2^( 3) =       0.000400137057
  error estimate for blocks of size 2^( 4) =       0.000409863758
  error estimate for blocks of size 2^( 5) =       0.000415877953
  error estimate for blocks of size 2^( 6) =       0.000419147005
  error estimate for blocks of size 2^( 7) =       0.000422814027

      target function =      -0.931128944114
              le_mean =     -17.209883517224
             les_mean =     296.468326056766
             stat err =       0.000416925686
             autocorr =       1.249548878213
   target nu stat err =       0.000416925686
   target dn stat err =       0.003014481293
      target stat err =       0.005013388107
              std dev =       0.527477542138
             le_variance =       0.278232557460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372976979
  error estimate for blocks of size 2^( 2) =       0.000387115457
  error estimate for blocks of size 2^( 3) =       0.000400137057
  error estimate for blocks of size 2^( 4) =       0.000409863758
  error estimate for blocks of size 2^( 5) =       0.000415877953
  error estimate for blocks of size 2^( 6) =       0.000419147005
  error estimate for blocks of size 2^( 7) =       0.000422814027

      target function =      -0.931128944114
              le_mean =     -17.209883517224
             les_mean =     296.468326056766
             stat err =       0.000416925686
             autocorr =       1.249548878213
   target nu stat err =       0.000416925686
   target dn stat err =       0.003014481293
      target stat err =       0.005013388107
              std dev =       0.527477542138
             le_variance =       0.278232557460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372976979
  error estimate for blocks of size 2^( 2) =       0.000387115457
  error estimate for blocks of size 2^( 3) =       0.000400137057
  error estimate for blocks of size 2^( 4) =       0.000409863758
  error estimate for blocks of size 2^( 5) =       0.000415877953
  error estimate for blocks of size 2^( 6) =       0.000419147005
  error estimate for blocks of size 2^( 7) =       0.000422814027

      target function =      -0.931128944114
              le_mean =     -17.209883517224
             les_mean =     296.468326056766
             stat err =       0.000416925686
             autocorr =       1.249548878213
   target nu stat err =       0.000416925686
   target dn stat err =       0.003014481293
      target stat err =       0.005013388107
              std dev =       0.527477542138
             le_variance =       0.278232557460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278306384443
                                         uncertainty =       0.002037904730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372976979
  error estimate for blocks of size 2^( 2) =       0.000387115457
  error estimate for blocks of size 2^( 3) =       0.000400137057
  error estimate for blocks of size 2^( 4) =       0.000409863758
  error estimate for blocks of size 2^( 5) =       0.000415877953
  error estimate for blocks of size 2^( 6) =       0.000419147005
  error estimate for blocks of size 2^( 7) =       0.000422814027

      target function =      -0.931128944114
              le_mean =     -17.209883517224
             les_mean =     296.468326056766
             stat err =       0.000416925686
             autocorr =       1.249548878213
   target nu stat err =       0.000416925686
   target dn stat err =       0.003014481293
      target stat err =       0.005013388107
              std dev =       0.527477542138
             le_variance =       0.278232557460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931128944114        initial
     3.7253e+13     3.7253e+14             3.8060e-18        -0.931128944114  <--
     1.4901e+14     1.4901e+15             8.6354e-19        -0.931128944114
     5.9605e+14     5.9605e+15             2.1619e-19        -0.931128944114

*****************************************************************************
Applying the update for shift_i =   3.7253e+13     and shift_s =   3.7253e+14
*****************************************************************************

  Execution time = 3.8734e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.203566
====================================================
  Execution time = 2.6945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9099e-01
  Total weights = 1.966456100e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1876e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280964418254
                                         uncertainty =       0.004635120409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280964418254
                                         uncertainty =       0.004635120409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374785620
  error estimate for blocks of size 2^( 2) =       0.000389223651
  error estimate for blocks of size 2^( 3) =       0.000402628171
  error estimate for blocks of size 2^( 4) =       0.000412749673
  error estimate for blocks of size 2^( 5) =       0.000417924564
  error estimate for blocks of size 2^( 6) =       0.000420552235
  error estimate for blocks of size 2^( 7) =       0.000422427250

      target function =      -0.926572000675
              le_mean =     -17.209615483171
             les_mean =     296.461856155126
             stat err =       0.000418413430
             autocorr =       1.246365429961
   target nu stat err =       0.000418413430
   target dn stat err =       0.005384326296
      target stat err =       0.008797870279
              std dev =       0.530035386700
             le_variance =       0.280937511155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720961548317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926655026883       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926655026883       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926655026883       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926655026817       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929645933358       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925669401302       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919574762645       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929467535368       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905878283927       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936627786374       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936950865147       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907613829004       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925275077146       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931557930854       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.958252416286       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913987866056       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.890257814538       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920838463197       residual = 4.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.927713405562       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918882130713       residual = 7.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912909853841       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907790314748       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952782295046       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938586861503       residual = 8.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920725235734       residual = 5.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908862966671       residual = 8.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935920883830       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.989043401367       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916036087181       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935175458132       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.008342318581       residual = 5.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924144756609       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907327059454       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.970425155304       residual = 4.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.963684283283       residual = 3.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.015409953660       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.923319822513       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.887663874151       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.901690414457       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.004798803500       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916987142413       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919263650567       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.771270630552       residual = 2.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.854146168181       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.940218207777       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.756997419850       residual = 4.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.840850834913       residual = 8.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.796032110253       residual = 4.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.274851499569       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.851141482740       residual = 1.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.794907772118       residual = 4.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.882719403352       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.894999100289       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.718198202677       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.739811569802       residual = 6.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.926526569307       residual = 6.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.865609357580       residual = 7.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.855823987102       residual = 5.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.917131416124       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.822858736438       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.940003101639       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.966759891175       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.104327142018       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.157031911415       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.270876053573       residual = 7.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.065432455973       residual = 8.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.880132452643       residual = 3.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.110304961558       residual = 9.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.748854307050       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.530102382145       residual = 1.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.092853747576       residual = 9.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.054714945378       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.508560884373       residual = 4.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.496047047734       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.019830531158       residual = 4.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.598655732730       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.371333194813       residual = 4.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.523041651866       residual = 5.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.592428844364       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.510849275771       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.366717791183       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =       0.249460072348       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.272770038686       residual = 3.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.132435959586       residual = 6.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =       1.149300935431       residual = 4.34e+02           smallest_sin_value = 9.99e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+12 is 6.741083e-17

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926655026883       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926655026883       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926655026883       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926655026883       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+13 is 1.088981e-17

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926655026883       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926655026883       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926655026883       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874164428754       residual = 7.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926655026883       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+14 is 3.911342e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.075221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5375e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.179377
====================================================
  Execution time = 2.6785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8688e-01
  Total weights = 1.9664e+06
  Execution time = 2.3129e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372296663
  error estimate for blocks of size 2^( 2) =       0.000387041614
  error estimate for blocks of size 2^( 3) =       0.000400059842
  error estimate for blocks of size 2^( 4) =       0.000409148430
  error estimate for blocks of size 2^( 5) =       0.000414068196
  error estimate for blocks of size 2^( 6) =       0.000416601872
  error estimate for blocks of size 2^( 7) =       0.000420393976

      target function =      -0.933398089390
              le_mean =     -17.209090357221
             les_mean =     296.439670944244
             stat err =       0.000415053119
             autocorr =       1.242879643626
   target nu stat err =       0.000415053119
   target dn stat err =       0.002241875906
      target stat err =       0.003772469604
              std dev =       0.526515414385
             le_variance =       0.277218481585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372296663
  error estimate for blocks of size 2^( 2) =       0.000387041614
  error estimate for blocks of size 2^( 3) =       0.000400059842
  error estimate for blocks of size 2^( 4) =       0.000409148430
  error estimate for blocks of size 2^( 5) =       0.000414068196
  error estimate for blocks of size 2^( 6) =       0.000416601872
  error estimate for blocks of size 2^( 7) =       0.000420393976

      target function =      -0.933398089390
              le_mean =     -17.209090357221
             les_mean =     296.439670944244
             stat err =       0.000415053119
             autocorr =       1.242879643634
   target nu stat err =       0.000415053119
   target dn stat err =       0.002241875906
      target stat err =       0.003772469604
              std dev =       0.526515414385
             le_variance =       0.277218481585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372296663
  error estimate for blocks of size 2^( 2) =       0.000387041614
  error estimate for blocks of size 2^( 3) =       0.000400059842
  error estimate for blocks of size 2^( 4) =       0.000409148430
  error estimate for blocks of size 2^( 5) =       0.000414068196
  error estimate for blocks of size 2^( 6) =       0.000416601872
  error estimate for blocks of size 2^( 7) =       0.000420393976

      target function =      -0.933398089390
              le_mean =     -17.209090357221
             les_mean =     296.439670944244
             stat err =       0.000415053119
             autocorr =       1.242879643634
   target nu stat err =       0.000415053119
   target dn stat err =       0.002241875906
      target stat err =       0.003772469604
              std dev =       0.526515414385
             le_variance =       0.277218481585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277282469378
                                         uncertainty =       0.001719326448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372296663
  error estimate for blocks of size 2^( 2) =       0.000387041614
  error estimate for blocks of size 2^( 3) =       0.000400059842
  error estimate for blocks of size 2^( 4) =       0.000409148430
  error estimate for blocks of size 2^( 5) =       0.000414068196
  error estimate for blocks of size 2^( 6) =       0.000416601872
  error estimate for blocks of size 2^( 7) =       0.000420393976

      target function =      -0.933398089390
              le_mean =     -17.209090357221
             les_mean =     296.439670944244
             stat err =       0.000415053119
             autocorr =       1.242879643633
   target nu stat err =       0.000415053119
   target dn stat err =       0.002241875906
      target stat err =       0.003772469604
              std dev =       0.526515414385
             le_variance =       0.277218481585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933398089390        initial  <--
     9.3132e+12     9.3132e+13             6.7411e-17        -0.933398089390
     3.7253e+13     3.7253e+14             1.0890e-17        -0.933398089390
     1.4901e+14     1.4901e+15             3.9113e-18        -0.933398089390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4715
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.169098
====================================================
  Execution time = 2.6959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8622e-01
  Total weights = 1.966431334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2155e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277344707128
                                         uncertainty =       0.002186711854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277344707128
                                         uncertainty =       0.002186711854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372353643
  error estimate for blocks of size 2^( 2) =       0.000386600895
  error estimate for blocks of size 2^( 3) =       0.000399424205
  error estimate for blocks of size 2^( 4) =       0.000408598999
  error estimate for blocks of size 2^( 5) =       0.000413903167
  error estimate for blocks of size 2^( 6) =       0.000416416032
  error estimate for blocks of size 2^( 7) =       0.000417711668

      target function =      -0.934450275334
              le_mean =     -17.209904378263
             les_mean =     296.467033684778
             stat err =       0.000414157466
             autocorr =       1.237142639546
   target nu stat err =       0.000414157466
   target dn stat err =       0.002882944514
      target stat err =       0.004832781466
              std dev =       0.526595997466
             le_variance =       0.277303344547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720990437826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934474192647       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934474192647       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934474192647       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934474192647       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929695332309       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934474241849       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955660893967       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.063431250305       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.009453541160       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.834082537680       residual = 2.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.956279497937       residual = 3.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.831316397084       residual = 2.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.971961021360       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.022956510219       residual = 3.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.709594157637       residual = 5.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.662899730962       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.167393646017       residual = 6.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.077357142232       residual = 5.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.816650611792       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.974068266752       residual = 3.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.108157002570       residual = 7.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.246718196759       residual = 9.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.692921567620       residual = 6.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.432869309624       residual = 2.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.612641200630       residual = 1.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.475763303065       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.727427117628       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.252501223941       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746621784667       residual = 3.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.149017314038       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.193101462667       residual = 1.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.427669586483       residual = 3.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.229203110621       residual = 4.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.357081753935       residual = 9.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.799129685235       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.156111644003       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.080504726313       residual = 2.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.313826627357       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.311330389406       residual = 1.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.956340328856       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.818597659680       residual = 8.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.513434264054       residual = 6.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -2.720624748568       residual = 3.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.863686514758       residual = 6.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.907918284679       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.946821899157       residual = 9.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -2.386792017721       residual = 2.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.280128952560       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.174281798853       residual = 2.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.858282834845       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -2.974480419365       residual = 9.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.474243441542       residual = 3.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.822796461334       residual = 8.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =       0.224836567989       residual = 4.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =       0.670198168670       residual = 2.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.629167918487       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -1.194599809567       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.845281503298       residual = 6.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =       1.344977344945       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.596862539184       residual = 4.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -2.330633930214       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -6.052700369642       residual = 2.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =       3.007439750075       residual = 1.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.926921733805       residual = 3.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   64 stopping due to too large eigenvalue change
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+13 is 2.434882e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934474192647       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934474192647       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934474192647       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934474192647       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899791080967       residual = 8.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.174900066980       residual = 5.98e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.833655302306       residual = 9.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.187799129855       residual = 3.80e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.141361740645       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.358856850040       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.413574887601       residual = 9.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.536870275283       residual = 4.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.345207637650       residual = 6.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.144146848037       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.390388481195       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.050287666561       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       1.946927254948       residual = 7.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.438267500072       residual = 7.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932171332769       residual = 6.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       1.486431159432       residual = 5.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.998246369125       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.491597429753       residual = 9.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.372103792476       residual = 8.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -4.368191548732       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.374559143971       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.519549200019       residual = 4.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.529195216760       residual = 6.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.940600052753       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.048248834232       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.367425329947       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.103194290143       residual = 2.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.477493600026       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       1.148711374861       residual = 4.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.889458619877       residual = 3.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.624692803104       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       3.474736400752       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       0.548168467760       residual = 7.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -4.781326785136       residual = 3.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.103249373674       residual = 2.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -6.065458638243       residual = 3.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+14 is 6.087206e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934474192647       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934474192647       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934474192647       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934474192647       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934474183028       residual = 6.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934474191841       residual = 4.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948713672846       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.065504730681       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.440989393558       residual = 2.12e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.374685896086       residual = 7.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -2.312595036933       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.053142756669       residual = 5.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.406132827516       residual = 5.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.822147898812       residual = 1.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -3.596508451735       residual = 1.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.401630660951       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -2.455962020612       residual = 5.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.720935781026       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       4.204980069154       residual = 2.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -2.397206176424       residual = 8.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -3.023956996098       residual = 6.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       2.893884449827       residual = 1.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.303971695665       residual = 5.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -9.151662838138       residual = 7.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -4.631484123084       residual = 5.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.077453167401       residual = 4.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.429770454354       residual = 4.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.621938399858       residual = 1.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       6.347986703501       residual = 5.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       3.444966236220       residual = 3.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4901e+15 is 1.521801e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.212981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5320e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.146603
====================================================
  Execution time = 2.9591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8569e-01
  Total weights = 1.9665e+06
  Execution time = 2.3405e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371719130
  error estimate for blocks of size 2^( 2) =       0.000385994075
  error estimate for blocks of size 2^( 3) =       0.000398714351
  error estimate for blocks of size 2^( 4) =       0.000408432385
  error estimate for blocks of size 2^( 5) =       0.000413932745
  error estimate for blocks of size 2^( 6) =       0.000416988767
  error estimate for blocks of size 2^( 7) =       0.000417622817

      target function =      -0.935342766359
              le_mean =     -17.209705552514
             les_mean =     296.459658582038
             stat err =       0.000414244179
             autocorr =       1.241889639798
   target nu stat err =       0.000414244179
   target dn stat err =       0.002496044549
      target stat err =       0.004206629430
              std dev =       0.525698645885
             le_variance =       0.276359066286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371719130
  error estimate for blocks of size 2^( 2) =       0.000385994075
  error estimate for blocks of size 2^( 3) =       0.000398714351
  error estimate for blocks of size 2^( 4) =       0.000408432385
  error estimate for blocks of size 2^( 5) =       0.000413932745
  error estimate for blocks of size 2^( 6) =       0.000416988767
  error estimate for blocks of size 2^( 7) =       0.000417622817

      target function =      -0.935342766359
              le_mean =     -17.209705552514
             les_mean =     296.459658582038
             stat err =       0.000414244179
             autocorr =       1.241889639803
   target nu stat err =       0.000414244179
   target dn stat err =       0.002496044549
      target stat err =       0.004206629430
              std dev =       0.525698645885
             le_variance =       0.276359066286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371719130
  error estimate for blocks of size 2^( 2) =       0.000385994075
  error estimate for blocks of size 2^( 3) =       0.000398714351
  error estimate for blocks of size 2^( 4) =       0.000408432385
  error estimate for blocks of size 2^( 5) =       0.000413932745
  error estimate for blocks of size 2^( 6) =       0.000416988767
  error estimate for blocks of size 2^( 7) =       0.000417622817

      target function =      -0.935342766359
              le_mean =     -17.209705552514
             les_mean =     296.459658582038
             stat err =       0.000414244179
             autocorr =       1.241889639801
   target nu stat err =       0.000414244179
   target dn stat err =       0.002496044549
      target stat err =       0.004206629430
              std dev =       0.525698645885
             le_variance =       0.276359066286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276150097062
                                         uncertainty =       0.001721410414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371719130
  error estimate for blocks of size 2^( 2) =       0.000385994075
  error estimate for blocks of size 2^( 3) =       0.000398714351
  error estimate for blocks of size 2^( 4) =       0.000408432385
  error estimate for blocks of size 2^( 5) =       0.000413932745
  error estimate for blocks of size 2^( 6) =       0.000416988767
  error estimate for blocks of size 2^( 7) =       0.000417622817

      target function =      -0.935342766359
              le_mean =     -17.209705552514
             les_mean =     296.459658582038
             stat err =       0.000414244179
             autocorr =       1.241889639797
   target nu stat err =       0.000414244179
   target dn stat err =       0.002496044549
      target stat err =       0.004206629430
              std dev =       0.525698645885
             le_variance =       0.276359066286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935342766359        initial
     9.3132e+13     9.3132e+14             2.4349e-18        -0.935342766359  <--
     3.7253e+14     3.7253e+15             6.0872e-19        -0.935342766359
     1.4901e+15     1.4901e+16             1.5218e-19        -0.935342766359

*****************************************************************************
Applying the update for shift_i =   9.3132e+13     and shift_s =   9.3132e+14
*****************************************************************************

  Execution time = 4.1438e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.204379
====================================================
  Execution time = 2.7143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8548e-01
  Total weights = 1.966551800e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3320e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276511009422
                                         uncertainty =       0.001689934675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276511009422
                                         uncertainty =       0.001689934675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371815108
  error estimate for blocks of size 2^( 2) =       0.000385809903
  error estimate for blocks of size 2^( 3) =       0.000398624408
  error estimate for blocks of size 2^( 4) =       0.000408580642
  error estimate for blocks of size 2^( 5) =       0.000414111553
  error estimate for blocks of size 2^( 6) =       0.000417135765
  error estimate for blocks of size 2^( 7) =       0.000419749017

      target function =      -0.935689104104
              le_mean =     -17.210414123796
             les_mean =     296.483829911845
             stat err =       0.000414894244
             autocorr =       1.245147370488
   target nu stat err =       0.000414894244
   target dn stat err =       0.002320124107
      target stat err =       0.003927865623
              std dev =       0.525834381180
             le_variance =       0.276501796431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721041412380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935704654882       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935704654882       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935704654882       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.40e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3283e+13 is 5.950353e-18

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935704654882       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935704654882       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935704654882       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935704654891       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935704654882       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to small subspace S singular value of 6.39e-01
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+13 is 1.951867e-18

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935704654882       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935704654882       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935704654882       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955737895899       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946485779914       residual = 6.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.968822445670       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.111514038951       residual = 2.91e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912696084908       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.837167926895       residual = 5.50e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.679557189783       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.437843077546       residual = 5.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.530312744166       residual = 5.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       1.171044147688       residual = 4.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.545357919844       residual = 9.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.161097830812       residual = 4.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.243113628812       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -3.309055106140       residual = 5.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.486717256825       residual = 1.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.402495932687       residual = 1.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897107174843       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.014700524792       residual = 1.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -3.635909692536       residual = 7.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -2.595347575075       residual = 3.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -5.323544671452       residual = 1.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.683025680345       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.312329015320       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.102714181767       residual = 1.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.657106344134       residual = 2.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.624917293199       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.839083242880       residual = 4.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.017466718603       residual = 7.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       2.106153388859       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.074897232602       residual = 7.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.427126135644       residual = 8.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -4.325870553375       residual = 1.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -3.563000117371       residual = 1.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.560821097104       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       2.083855367038       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -6.745124879084       residual = 4.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       5.794286533014       residual = 5.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -3.485091364805       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -8.576004318916       residual = 6.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       4.761092643002       residual = 4.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.109943546600       residual = 4.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =     -10.304551388458       residual = 8.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       1.973754867792       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -7.025658858830       residual = 7.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       5.638735188693       residual = 4.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       8.633692954984       residual = 1.01e+04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -2.650205104089       residual = 2.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       0.544684721021       residual = 8.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       7.338382039935       residual = 7.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       6.976702151473       residual = 7.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -8.707526408597       residual = 6.45e+03           smallest_sin_value = 1.00e+00
davidson iteration   54 stopping due to too large eigenvalue change
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.7253e+14 is 3.718971e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.274843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5544e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.574628
====================================================
  Execution time = 2.6758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9007e-01
  Total weights = 1.9662e+06
  Execution time = 2.3355e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848982
  error estimate for blocks of size 2^( 2) =       0.000386312759
  error estimate for blocks of size 2^( 3) =       0.000399462904
  error estimate for blocks of size 2^( 4) =       0.000409145919
  error estimate for blocks of size 2^( 5) =       0.000415193147
  error estimate for blocks of size 2^( 6) =       0.000417286711
  error estimate for blocks of size 2^( 7) =       0.000418488781

      target function =      -0.928093928451
              le_mean =     -17.210237917353
             les_mean =     296.482355664043
             stat err =       0.000415028640
             autocorr =       1.245727182043
   target nu stat err =       0.000415028640
   target dn stat err =       0.003993670832
      target stat err =       0.006572382850
              std dev =       0.525882286817
             le_variance =       0.276552179587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848982
  error estimate for blocks of size 2^( 2) =       0.000386312759
  error estimate for blocks of size 2^( 3) =       0.000399462904
  error estimate for blocks of size 2^( 4) =       0.000409145919
  error estimate for blocks of size 2^( 5) =       0.000415193147
  error estimate for blocks of size 2^( 6) =       0.000417286711
  error estimate for blocks of size 2^( 7) =       0.000418488781

      target function =      -0.928093928451
              le_mean =     -17.210237917353
             les_mean =     296.482355664043
             stat err =       0.000415028640
             autocorr =       1.245727182040
   target nu stat err =       0.000415028640
   target dn stat err =       0.003993670832
      target stat err =       0.006572382850
              std dev =       0.525882286817
             le_variance =       0.276552179587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848982
  error estimate for blocks of size 2^( 2) =       0.000386312759
  error estimate for blocks of size 2^( 3) =       0.000399462904
  error estimate for blocks of size 2^( 4) =       0.000409145919
  error estimate for blocks of size 2^( 5) =       0.000415193147
  error estimate for blocks of size 2^( 6) =       0.000417286711
  error estimate for blocks of size 2^( 7) =       0.000418488781

      target function =      -0.928093928451
              le_mean =     -17.210237917353
             les_mean =     296.482355664043
             stat err =       0.000415028640
             autocorr =       1.245727182040
   target nu stat err =       0.000415028640
   target dn stat err =       0.003993670832
      target stat err =       0.006572382850
              std dev =       0.525882286817
             le_variance =       0.276552179587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276528104963
                                         uncertainty =       0.001661207223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371848982
  error estimate for blocks of size 2^( 2) =       0.000386312759
  error estimate for blocks of size 2^( 3) =       0.000399462904
  error estimate for blocks of size 2^( 4) =       0.000409145919
  error estimate for blocks of size 2^( 5) =       0.000415193147
  error estimate for blocks of size 2^( 6) =       0.000417286711
  error estimate for blocks of size 2^( 7) =       0.000418488781

      target function =      -0.928093928451
              le_mean =     -17.210237917353
             les_mean =     296.482355664043
             stat err =       0.000415028640
             autocorr =       1.245727182043
   target nu stat err =       0.000415028640
   target dn stat err =       0.003993670832
      target stat err =       0.006572382850
              std dev =       0.525882286817
             le_variance =       0.276552179587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928093928451        initial
     2.3283e+13     2.3283e+14             5.9504e-18        -0.928093928451  <--
     9.3132e+13     9.3132e+14             1.9519e-18        -0.928093928451
     3.7253e+14     3.7253e+15             3.7190e-19        -0.928093928451

*****************************************************************************
Applying the update for shift_i =   2.3283e+13     and shift_s =   2.3283e+14
*****************************************************************************

  Execution time = 3.8592e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.242179
====================================================
  Execution time = 2.7276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8847e-01
  Total weights = 1.966005308e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2512e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278554882176
                                         uncertainty =       0.002815843453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278554882176
                                         uncertainty =       0.002815843453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373146551
  error estimate for blocks of size 2^( 2) =       0.000387265578
  error estimate for blocks of size 2^( 3) =       0.000400507876
  error estimate for blocks of size 2^( 4) =       0.000410511522
  error estimate for blocks of size 2^( 5) =       0.000416026824
  error estimate for blocks of size 2^( 6) =       0.000417940179
  error estimate for blocks of size 2^( 7) =       0.000417562880

      target function =      -0.930753908971
              le_mean =     -17.208984431105
             les_mean =     296.437618890969
             stat err =       0.000415510351
             autocorr =       1.239951878398
   target nu stat err =       0.000415510351
   target dn stat err =       0.003674001568
      target stat err =       0.006073192969
              std dev =       0.527717356338
             le_variance =       0.278485608181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720898443111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930792279812       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930792279812       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930792279812       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930792279812       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930792279812       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930728177305       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932033517540       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932297201891       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912507179303       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934828928071       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931557566017       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924078819899       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939653460632       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934950720683       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930280302964       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926100588540       residual = 8.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.895141356233       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930832495800       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924502584715       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917113238495       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.928422531034       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.926223025181       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914324987914       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926627539435       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929887097696       residual = 9.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942148997790       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940089230916       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918000901874       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.925122801085       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930305703838       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.937454316828       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.955958119838       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900861817046       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906733107456       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.982304887403       residual = 3.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922996137474       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.107219551267       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.986325648079       residual = 6.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.826382408951       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.032940626362       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.910383408753       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.033009713847       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.846114751908       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.969051789255       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.057819463290       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.033571325571       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915458395499       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.850188919510       residual = 2.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.798653692965       residual = 2.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.007561090041       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.031015636245       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.960820547873       residual = 5.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.693905571225       residual = 5.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.225515457587       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.998900549174       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.525418478524       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.743240735845       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.980710150170       residual = 6.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912989437848       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.019294195598       residual = 9.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.181663255238       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.077256886770       residual = 5.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.889388676808       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.170142457434       residual = 7.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.907969963461       residual = 7.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.011111448351       residual = 3.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.899815425846       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.311135960529       residual = 5.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.819829251633       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.846614879039       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -1.147783627096       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.384129261401       residual = 4.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.976553049169       residual = 5.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.707785991477       residual = 1.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.783640230709       residual = 1.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.003412486262       residual = 2.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.923598033029       residual = 2.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.240628875520       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.127851705638       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.945891009027       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.444015087755       residual = 3.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.484927996104       residual = 4.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.401559701140       residual = 5.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.745430419772       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.213332055867       residual = 4.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -2.318900639204       residual = 1.28e+03           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+12 is 3.234526e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930792279812       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930792279812       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.75e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930792279812       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930792279812       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.75e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              14.521211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5781e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1805
    reference variance = 0.296128
====================================================
  Execution time = 2.7064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8694e-01
  Total weights = 1.9661e+06
  Execution time = 2.3450e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372443910
  error estimate for blocks of size 2^( 2) =       0.000387006514
  error estimate for blocks of size 2^( 3) =       0.000400128596
  error estimate for blocks of size 2^( 4) =       0.000409975016
  error estimate for blocks of size 2^( 5) =       0.000415982264
  error estimate for blocks of size 2^( 6) =       0.000417942052
  error estimate for blocks of size 2^( 7) =       0.000417671961

      target function =      -0.933267719044
              le_mean =     -17.210021311628
             les_mean =     296.471775763347
             stat err =       0.000415392823
             autocorr =       1.243930808128
   target nu stat err =       0.000415392823
   target dn stat err =       0.002380540435
      target stat err =       0.004003302067
              std dev =       0.526723655524
             le_variance =       0.277437809288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372443910
  error estimate for blocks of size 2^( 2) =       0.000387006514
  error estimate for blocks of size 2^( 3) =       0.000400128596
  error estimate for blocks of size 2^( 4) =       0.000409975016
  error estimate for blocks of size 2^( 5) =       0.000415982264
  error estimate for blocks of size 2^( 6) =       0.000417942052
  error estimate for blocks of size 2^( 7) =       0.000417671961

      target function =      -0.933267719044
              le_mean =     -17.210021311628
             les_mean =     296.471775763348
             stat err =       0.000415392823
             autocorr =       1.243930808127
   target nu stat err =       0.000415392823
   target dn stat err =       0.002380540435
      target stat err =       0.004003302067
              std dev =       0.526723655524
             le_variance =       0.277437809288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372443910
  error estimate for blocks of size 2^( 2) =       0.000387006514
  error estimate for blocks of size 2^( 3) =       0.000400128596
  error estimate for blocks of size 2^( 4) =       0.000409975016
  error estimate for blocks of size 2^( 5) =       0.000415982264
  error estimate for blocks of size 2^( 6) =       0.000417942052
  error estimate for blocks of size 2^( 7) =       0.000417671961

      target function =      -0.933267719044
              le_mean =     -17.210021311628
             les_mean =     296.471775763347
             stat err =       0.000415392823
             autocorr =       1.243930808128
   target nu stat err =       0.000415392823
   target dn stat err =       0.002380540435
      target stat err =       0.004003302067
              std dev =       0.526723655524
             le_variance =       0.277437809288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277397232333
                                         uncertainty =       0.001990511630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372443910
  error estimate for blocks of size 2^( 2) =       0.000387006514
  error estimate for blocks of size 2^( 3) =       0.000400128596
  error estimate for blocks of size 2^( 4) =       0.000409975016
  error estimate for blocks of size 2^( 5) =       0.000415982264
  error estimate for blocks of size 2^( 6) =       0.000417942052
  error estimate for blocks of size 2^( 7) =       0.000417671961

      target function =      -0.933267719044
              le_mean =     -17.210021311628
             les_mean =     296.471775763347
             stat err =       0.000415392823
             autocorr =       1.243930808128
   target nu stat err =       0.000415392823
   target dn stat err =       0.002380540435
      target stat err =       0.004003302067
              std dev =       0.526723655524
             le_variance =       0.277437809288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933267719044        initial
     5.8208e+12     5.8208e+13             3.2345e-17        -0.933267719044  <--
     2.3283e+13     2.3283e+14             0.0000e+00        -0.933267719044
     9.3132e+13     9.3132e+14             0.0000e+00        -0.933267719044

*****************************************************************************
Applying the update for shift_i =   5.8208e+12     and shift_s =   5.8208e+13
*****************************************************************************

  Execution time = 3.8934e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.136399
====================================================
  Execution time = 2.7242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8500e-01
  Total weights = 1.966396405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2695e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276120546236
                                         uncertainty =       0.001621114854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276120546236
                                         uncertainty =       0.001621114854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371536816
  error estimate for blocks of size 2^( 2) =       0.000385990545
  error estimate for blocks of size 2^( 3) =       0.000398836494
  error estimate for blocks of size 2^( 4) =       0.000409095487
  error estimate for blocks of size 2^( 5) =       0.000415263366
  error estimate for blocks of size 2^( 6) =       0.000419352009
  error estimate for blocks of size 2^( 7) =       0.000419832944

      target function =      -0.936473939288
              le_mean =     -17.210586172992
             les_mean =     296.489280165589
             stat err =       0.000415885951
             autocorr =       1.252981875420
   target nu stat err =       0.000415885951
   target dn stat err =       0.002026794819
      target stat err =       0.003457136863
              std dev =       0.525440811648
             le_variance =       0.276088046545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721058617299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936485664202       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936485664202       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936485664202       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936485664202       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936485664034       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936485668141       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936766100166       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938234012276       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930671780931       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935731378953       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936568714497       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936688758438       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935750758885       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932687971091       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940381351087       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931420141044       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936129323291       residual = 8.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937456862519       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938035207916       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936447306771       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935734610732       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934988992038       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939351155904       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933193196538       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938976441657       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937820125341       residual = 7.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941302211008       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935099920639       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.929097502195       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938362224050       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939270599362       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.925057148966       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.938117009207       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938563461793       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.957160196353       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945067081895       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938764592926       residual = 6.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934938844526       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908277216586       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940650137257       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.920243188107       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.861400005692       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.928023655646       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.909276078515       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.921248262980       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948307522314       residual = 7.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.927454554543       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.922067196201       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913392695317       residual = 9.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.997705270397       residual = 4.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.855755721095       residual = 7.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.834796584529       residual = 9.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.000842717077       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.037332076075       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.868385565949       residual = 9.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.814666217056       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.873298926393       residual = 7.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.930431501095       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.915540066042       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.927425543690       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.910417185908       residual = 5.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.966771907458       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.964358392473       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.933562054529       residual = 9.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.907856879662       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.879484382701       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.917185130921       residual = 3.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.931617932498       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.883792679386       residual = 8.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.067703643308       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.984613182232       residual = 5.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.997283896050       residual = 7.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.834373642495       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.951631378805       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.967334526928       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.989182214778       residual = 2.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.034789148486       residual = 4.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.029063416444       residual = 2.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.025371373552       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.806394318121       residual = 6.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.938278982707       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.825028869592       residual = 3.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.254712640316       residual = 4.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.663672689056       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.247097342102       residual = 2.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.690556508110       residual = 6.75e+00           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+12 is 8.725510e-17

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936485664202       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936485664202       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936485664202       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936849649671       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936673366863       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936676825606       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935110192976       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928362998079       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939331978108       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929852176035       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949891084916       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.954060272100       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935420594653       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934390462383       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935020037390       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.965013333349       residual = 8.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921877507636       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907099522296       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936074713587       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946016226473       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955022947556       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935125144557       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938492038753       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926229129216       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947197061617       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938294258762       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.982507114932       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.978420589737       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.955631645728       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947976756448       residual = 7.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.958117133958       residual = 4.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947436023719       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943408098043       residual = 5.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922565715975       residual = 5.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.979580748193       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.956013199849       residual = 6.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919788334532       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.922396134422       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954608276976       residual = 7.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.970556322049       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947594546612       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.980170822179       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.981776934884       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.959838345226       residual = 7.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.928191151372       residual = 9.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.980778589696       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.863241482658       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.934445275245       residual = 5.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.987347264629       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.958423917696       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.909921788205       residual = 4.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.936749486361       residual = 5.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911873111915       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.124945027497       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.995393858535       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.950065581709       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.884084705226       residual = 5.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.870317830638       residual = 2.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.915932737165       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.845848066995       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.928542079466       residual = 8.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.030058063977       residual = 1.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.759091423029       residual = 3.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.858819846776       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.023499430666       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.950100867697       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.916994735354       residual = 5.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.010683065143       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.824676514278       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.133437601199       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.850221292090       residual = 5.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -1.146267212138       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.770190505372       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.160316064051       residual = 2.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.845731980397       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.728353304618       residual = 7.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.232349210418       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.915302315352       residual = 9.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.319115569336       residual = 2.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -3.006366307736       residual = 3.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.900341909520       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =       0.266077251377       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.224461607461       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -2.038244500093       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.455804072205       residual = 4.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -2.749868659463       residual = 7.65e+02           smallest_sin_value = 9.98e-01
davidson iteration   86:   krylov dim =  87   tar_fn =      -4.606500449183       residual = 1.86e+03           smallest_sin_value = 9.96e-01
davidson iteration   87 stopping due to small subspace S singular value of 8.33e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+12 is 2.378064e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936485664202       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936485664202       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936485664202       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936485664202       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936485664202       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936485664202       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936474969591       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911062584742       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936845613241       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943315263572       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.967545299993       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934769707977       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931822817384       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923861097797       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925978266574       residual = 4.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.960756010699       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915654509769       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.822221251250       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.804973836226       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938035764494       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.963083000471       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904815959147       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.031847943311       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937650775342       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.903116045441       residual = 5.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.869543429774       residual = 7.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.977000017795       residual = 5.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914709779298       residual = 4.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.842841112889       residual = 9.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924524268801       residual = 6.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917983955627       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.011479668343       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.968089801125       residual = 9.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913135785307       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.986513947007       residual = 4.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.018996073083       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.812002642862       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.988559789262       residual = 8.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.056590766987       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.031847709932       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.800567666112       residual = 5.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.104938351830       residual = 5.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.635108462482       residual = 3.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.134343313003       residual = 8.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.941034312040       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.706368649917       residual = 2.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.979560589513       residual = 3.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.030067341106       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.160212490243       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.531269315763       residual = 5.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.661374442840       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.554732726461       residual = 6.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.084436462131       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.463206026755       residual = 9.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.796877703247       residual = 6.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.742626297539       residual = 1.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.905220205522       residual = 2.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.926513034011       residual = 9.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.767460331966       residual = 3.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.981334801324       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.887254337121       residual = 7.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.880381518039       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -1.266388342441       residual = 2.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.095353508162       residual = 1.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.655796342152       residual = 1.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.071487237598       residual = 1.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.741972307454       residual = 4.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.369937853258       residual = 6.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -1.297493506944       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.137949400412       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =       0.342961668050       residual = 8.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.494603934976       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.767538112294       residual = 1.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.117799227053       residual = 1.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =       0.110596804886       residual = 1.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.149597745852       residual = 1.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -2.064711968968       residual = 4.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -2.438786594119       residual = 1.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.731390343497       residual = 3.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.315272662408       residual = 3.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -2.618838700481       residual = 4.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -4.723623650916       residual = 4.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.904046918366       residual = 1.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.571343658886       residual = 8.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.660911253225       residual = 7.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =       0.405731577835       residual = 6.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   86 stopping due to too large eigenvalue change
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3283e+13 is 5.452211e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              15.252674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6250e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.599379
====================================================
  Execution time = 2.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8807e-01
  Total weights = 1.9664e+06
  Execution time = 2.3379e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371313688
  error estimate for blocks of size 2^( 2) =       0.000385699062
  error estimate for blocks of size 2^( 3) =       0.000399085828
  error estimate for blocks of size 2^( 4) =       0.000409416220
  error estimate for blocks of size 2^( 5) =       0.000415361794
  error estimate for blocks of size 2^( 6) =       0.000417909060
  error estimate for blocks of size 2^( 7) =       0.000420815529

      target function =      -0.931375278172
              le_mean =     -17.210438440386
             les_mean =     296.487257998898
             stat err =       0.000415875651
             autocorr =       1.254426064440
   target nu stat err =       0.000415875651
   target dn stat err =       0.003711405847
      target stat err =       0.006159310438
              std dev =       0.525125254764
             le_variance =       0.275756533191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371313688
  error estimate for blocks of size 2^( 2) =       0.000385699062
  error estimate for blocks of size 2^( 3) =       0.000399085828
  error estimate for blocks of size 2^( 4) =       0.000409416220
  error estimate for blocks of size 2^( 5) =       0.000415361794
  error estimate for blocks of size 2^( 6) =       0.000417909060
  error estimate for blocks of size 2^( 7) =       0.000420815529

      target function =      -0.931375278172
              le_mean =     -17.210438440386
             les_mean =     296.487257998898
             stat err =       0.000415875651
             autocorr =       1.254426064439
   target nu stat err =       0.000415875651
   target dn stat err =       0.003711405847
      target stat err =       0.006159310438
              std dev =       0.525125254764
             le_variance =       0.275756533191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371313688
  error estimate for blocks of size 2^( 2) =       0.000385699062
  error estimate for blocks of size 2^( 3) =       0.000399085828
  error estimate for blocks of size 2^( 4) =       0.000409416220
  error estimate for blocks of size 2^( 5) =       0.000415361794
  error estimate for blocks of size 2^( 6) =       0.000417909060
  error estimate for blocks of size 2^( 7) =       0.000420815529

      target function =      -0.931375278172
              le_mean =     -17.210438440386
             les_mean =     296.487257998898
             stat err =       0.000415875651
             autocorr =       1.254426064439
   target nu stat err =       0.000415875651
   target dn stat err =       0.003711405847
      target stat err =       0.006159310438
              std dev =       0.525125254764
             le_variance =       0.275756533191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802281859
                                         uncertainty =       0.001638469831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371313688
  error estimate for blocks of size 2^( 2) =       0.000385699062
  error estimate for blocks of size 2^( 3) =       0.000399085828
  error estimate for blocks of size 2^( 4) =       0.000409416220
  error estimate for blocks of size 2^( 5) =       0.000415361794
  error estimate for blocks of size 2^( 6) =       0.000417909060
  error estimate for blocks of size 2^( 7) =       0.000420815529

      target function =      -0.931375278172
              le_mean =     -17.210438440386
             les_mean =     296.487257998898
             stat err =       0.000415875651
             autocorr =       1.254426064440
   target nu stat err =       0.000415875651
   target dn stat err =       0.003711405847
      target stat err =       0.006159310438
              std dev =       0.525125254764
             le_variance =       0.275756533191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931375278172        initial
     1.4552e+12     1.4552e+13             8.7255e-17        -0.931375278172
     5.8208e+12     5.8208e+13             2.3781e-17        -0.931375278172
     2.3283e+13     2.3283e+14             5.4522e-18        -0.931375278172  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+13     and shift_s =   2.3283e+14
*****************************************************************************

  Execution time = 3.8891e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1321
    reference variance = 0.313221
====================================================
  Execution time = 2.7166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0480e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8910e-01
  Total weights = 1.966356741e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1942e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277376443646
                                         uncertainty =       0.001574195901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277376443646
                                         uncertainty =       0.001574195901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372388306
  error estimate for blocks of size 2^( 2) =       0.000386752865
  error estimate for blocks of size 2^( 3) =       0.000399997547
  error estimate for blocks of size 2^( 4) =       0.000409151906
  error estimate for blocks of size 2^( 5) =       0.000414964444
  error estimate for blocks of size 2^( 6) =       0.000417982012
  error estimate for blocks of size 2^( 7) =       0.000421042266

      target function =      -0.929722831674
              le_mean =     -17.209273160526
             les_mean =     296.448185830872
             stat err =       0.000415785157
             autocorr =       1.246653879911
   target nu stat err =       0.000415785157
   target dn stat err =       0.003159276514
      target stat err =       0.005227103875
              std dev =       0.526645019524
             le_variance =       0.277354976590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720927316053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929751175503       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929751175503       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929751175503       residual = 7.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929751175503       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934011309181       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929751175503       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.928939717691       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923750937258       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933159466830       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916471120591       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918784470968       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923008346269       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923624427320       residual = 7.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944657388194       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909278372470       residual = 4.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.978591775172       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933506988904       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.928372994798       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.970496546299       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952190781618       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.886090196867       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948583352362       residual = 6.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.993734097681       residual = 4.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944988684442       residual = 2.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912633544583       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.972893940120       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.921661343134       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902893994980       residual = 9.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.872424596447       residual = 3.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919433305623       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.858359255204       residual = 5.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.993150166012       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.840374929376       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.986212916674       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.979759530025       residual = 2.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.968714468795       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.842578498102       residual = 6.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.895852970654       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.933607714759       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.998011715225       residual = 5.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.956491849098       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.976399117339       residual = 8.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.894023996495       residual = 3.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904962126107       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915017676798       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.845162262991       residual = 8.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.986620266787       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.880841731876       residual = 4.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.014329778675       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.930958240646       residual = 3.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.000653536015       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.882674950565       residual = 7.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911573182159       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.153392894981       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.949717037806       residual = 4.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -1.052661982778       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.850273863238       residual = 7.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.798905296967       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.983722602418       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -1.005033046379       residual = 9.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.704474822258       residual = 5.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.984437647331       residual = 5.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.447785607629       residual = 2.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.229460524430       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -1.267562894768       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.266006898439       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.325779756110       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.220424980669       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.058257571285       residual = 8.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.045951835620       residual = 7.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.239602087646       residual = 5.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.619419762939       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.109043414362       residual = 2.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =       0.214106464247       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.202263648716       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.795049006028       residual = 2.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.478128360889       residual = 4.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.010703862510       residual = 5.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -1.311324910022       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =       0.010897392055       residual = 9.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.285544609491       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.220989881116       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =       1.608976847540       residual = 7.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -3.327655693521       residual = 7.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.219669890783       residual = 4.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -1.077507753026       residual = 8.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -4.488322365312       residual = 2.71e+03           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+12 is 2.477784e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929751175503       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929751175503       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.33e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929751175503       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929751175503       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.33e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              15.500448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5616e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1555
    reference variance = 0.286324
====================================================
  Execution time = 2.9445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8583e-01
  Total weights = 1.9665e+06
  Execution time = 2.3203e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225528
  error estimate for blocks of size 2^( 2) =       0.000386446423
  error estimate for blocks of size 2^( 3) =       0.000399393915
  error estimate for blocks of size 2^( 4) =       0.000409017004
  error estimate for blocks of size 2^( 5) =       0.000415320814
  error estimate for blocks of size 2^( 6) =       0.000418457473
  error estimate for blocks of size 2^( 7) =       0.000419228596

      target function =      -0.935115813414
              le_mean =     -17.210151834762
             les_mean =     296.475152093958
             stat err =       0.000415505972
             autocorr =       1.246069398471
   target nu stat err =       0.000415505972
   target dn stat err =       0.002189875948
      target stat err =       0.003709252862
              std dev =       0.526414812381
             le_variance =       0.277112554695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225528
  error estimate for blocks of size 2^( 2) =       0.000386446423
  error estimate for blocks of size 2^( 3) =       0.000399393915
  error estimate for blocks of size 2^( 4) =       0.000409017004
  error estimate for blocks of size 2^( 5) =       0.000415320814
  error estimate for blocks of size 2^( 6) =       0.000418457473
  error estimate for blocks of size 2^( 7) =       0.000419228596

      target function =      -0.935115813414
              le_mean =     -17.210151834762
             les_mean =     296.475152093958
             stat err =       0.000415505972
             autocorr =       1.246069398469
   target nu stat err =       0.000415505972
   target dn stat err =       0.002189875948
      target stat err =       0.003709252862
              std dev =       0.526414812381
             le_variance =       0.277112554695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225528
  error estimate for blocks of size 2^( 2) =       0.000386446423
  error estimate for blocks of size 2^( 3) =       0.000399393915
  error estimate for blocks of size 2^( 4) =       0.000409017004
  error estimate for blocks of size 2^( 5) =       0.000415320814
  error estimate for blocks of size 2^( 6) =       0.000418457473
  error estimate for blocks of size 2^( 7) =       0.000419228596

      target function =      -0.935115813414
              le_mean =     -17.210151834762
             les_mean =     296.475152093958
             stat err =       0.000415505972
             autocorr =       1.246069398471
   target nu stat err =       0.000415505972
   target dn stat err =       0.002189875948
      target stat err =       0.003709252862
              std dev =       0.526414812381
             le_variance =       0.277112554695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277120808726
                                         uncertainty =       0.001991768446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225528
  error estimate for blocks of size 2^( 2) =       0.000386446423
  error estimate for blocks of size 2^( 3) =       0.000399393915
  error estimate for blocks of size 2^( 4) =       0.000409017004
  error estimate for blocks of size 2^( 5) =       0.000415320814
  error estimate for blocks of size 2^( 6) =       0.000418457473
  error estimate for blocks of size 2^( 7) =       0.000419228596

      target function =      -0.935115813414
              le_mean =     -17.210151834762
             les_mean =     296.475152093958
             stat err =       0.000415505972
             autocorr =       1.246069398471
   target nu stat err =       0.000415505972
   target dn stat err =       0.002189875948
      target stat err =       0.003709252862
              std dev =       0.526414812381
             le_variance =       0.277112554695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935115813414        initial
     5.8208e+12     5.8208e+13             2.4778e-17        -0.935115813414  <--
     2.3283e+13     2.3283e+14             0.0000e+00        -0.935115813414
     9.3132e+13     9.3132e+14             0.0000e+00        -0.935115813414

*****************************************************************************
Applying the update for shift_i =   5.8208e+12     and shift_s =   5.8208e+13
*****************************************************************************

  Execution time = 4.1210e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1005
    reference variance = 0.67403
====================================================
  Execution time = 2.6787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0509e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8728e-01
  Total weights = 1.966110674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2307e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278004798450
                                         uncertainty =       0.001907628922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278004798450
                                         uncertainty =       0.001907628922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372896228
  error estimate for blocks of size 2^( 2) =       0.000387122783
  error estimate for blocks of size 2^( 3) =       0.000400326281
  error estimate for blocks of size 2^( 4) =       0.000410002128
  error estimate for blocks of size 2^( 5) =       0.000416312570
  error estimate for blocks of size 2^( 6) =       0.000420398274
  error estimate for blocks of size 2^( 7) =       0.000423549165

      target function =      -0.932705040013
              le_mean =     -17.210220512485
             les_mean =     296.478965437335
             stat err =       0.000417565534
             autocorr =       1.253930048433
   target nu stat err =       0.000417565534
   target dn stat err =       0.002802112617
      target stat err =       0.004686877333
              std dev =       0.527363340267
             le_variance =       0.278112092657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721022051248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932727457732       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932727457732       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932727457732       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932675113873       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932372393508       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932614691417       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934461919644       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933105774276       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930727222616       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935319877537       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930946373241       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931585838964       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929254878775       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932975724489       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932756026458       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931817799803       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932030845907       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934476699958       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929719619285       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933072623223       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933973040146       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932623834829       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939119209614       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941520190003       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934704023600       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932464065609       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927729399901       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935252519665       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.936418971389       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.930138801272       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941162367600       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942929481957       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917352347741       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.929655009027       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931889523090       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.933172596313       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952889364718       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.934195118596       residual = 8.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.936370448554       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947234629759       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.934344060165       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.907555006432       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949063441164       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.959079777868       residual = 8.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.925624794570       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.905111791142       residual = 7.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.891573037888       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.893394659938       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.921195859315       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.954409574520       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.882559022479       residual = 2.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.928551840024       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.889452097739       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.936991706937       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.920703972743       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.935348489071       residual = 5.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.972213820308       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.885263692089       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.920040124198       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.890323630220       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.923905862060       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.927514693632       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.995385500824       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.975791604236       residual = 4.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.963670841782       residual = 5.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.870050563291       residual = 8.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.848587381051       residual = 3.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.971428932408       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.872445942881       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.952312250005       residual = 7.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.769604922366       residual = 2.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.864463028262       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.853472120312       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.879015644786       residual = 7.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -1.091493774185       residual = 4.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.757988037475       residual = 5.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.732788144116       residual = 5.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.014967705483       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.583862028933       residual = 2.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.991280534320       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.608211607542       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.881757904183       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.635034459883       residual = 2.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -1.409746230890       residual = 4.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -0.507581449346       residual = 2.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.494472593382       residual = 1.76e+01           smallest_sin_value = 9.99e-01
davidson iteration   86 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         86 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+12 is 1.137672e-16

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932727457732       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932727457732       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932727457732       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932727457732       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932727457580       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933112052580       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935709348969       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.927334069602       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918786661423       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944635638573       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943929735880       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943945050947       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933274613246       residual = 5.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930513137527       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929910066467       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939274552523       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932950828166       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914187733662       residual = 4.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934787721901       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950030938183       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944915157995       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.901100414134       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948797738813       residual = 4.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944927273819       residual = 5.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923272114820       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921701503091       residual = 9.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916184823505       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.926432449231       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946836273936       residual = 9.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908206667337       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920715342358       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909551407676       residual = 9.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.953091494421       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912906762956       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.931553777483       residual = 6.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.970572840145       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909191780733       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.839667992195       residual = 7.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.877952395732       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.012780641176       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.922019877143       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749440989214       residual = 3.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.867046599920       residual = 5.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.175028805236       residual = 5.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.855779543052       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.895302548693       residual = 6.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.025810768731       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.980465519284       residual = 6.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.908580402063       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.950941759774       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.876797233989       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.905626647139       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.992819392263       residual = 2.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918281848975       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.010152269959       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.947024536838       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.875373124388       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.901556893687       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.810357872238       residual = 8.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.906234732137       residual = 2.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.364815212977       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.016235794707       residual = 5.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.903486984719       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.654452233243       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.733148734953       residual = 6.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.111514691198       residual = 5.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.350702264433       residual = 7.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.762314774089       residual = 3.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.395179190848       residual = 5.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -1.055828537254       residual = 3.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.980383677024       residual = 1.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.717855507783       residual = 2.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.725323549604       residual = 1.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.411525016094       residual = 4.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.734660496907       residual = 1.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.605202190329       residual = 2.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.378878870434       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.296877675395       residual = 4.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.843878627935       residual = 4.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.624275605781       residual = 3.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.370999178871       residual = 4.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.941653940581       residual = 5.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =       0.665553138941       residual = 2.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =       0.739899300952       residual = 4.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.804856241145       residual = 3.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =       0.631479414119       residual = 1.32e+03           smallest_sin_value = 9.99e-01
davidson iteration   86:   krylov dim =  87   tar_fn =       0.233561717668       residual = 1.28e+03           smallest_sin_value = 9.99e-01
davidson iteration   87 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         87 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+12 is 2.835229e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932727457732       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932727457732       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              15.993459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5518e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2895
    reference variance = 0.257134
====================================================
  Execution time = 2.7000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9177e-01
  Total weights = 1.9663e+06
  Execution time = 2.3173e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375737755
  error estimate for blocks of size 2^( 2) =       0.000389886757
  error estimate for blocks of size 2^( 3) =       0.000402847377
  error estimate for blocks of size 2^( 4) =       0.000412202492
  error estimate for blocks of size 2^( 5) =       0.000417941141
  error estimate for blocks of size 2^( 6) =       0.000420584518
  error estimate for blocks of size 2^( 7) =       0.000424869047

      target function =      -0.925297254035
              le_mean =     -17.210189969661
             les_mean =     296.482405497914
             stat err =       0.000418899300
             autocorr =       1.242938375032
   target nu stat err =       0.000418899300
   target dn stat err =       0.005003370431
      target stat err =       0.008166382224
              std dev =       0.531381930408
             le_variance =       0.282366755964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375737755
  error estimate for blocks of size 2^( 2) =       0.000389886757
  error estimate for blocks of size 2^( 3) =       0.000402847377
  error estimate for blocks of size 2^( 4) =       0.000412202492
  error estimate for blocks of size 2^( 5) =       0.000417941141
  error estimate for blocks of size 2^( 6) =       0.000420584518
  error estimate for blocks of size 2^( 7) =       0.000424869047

      target function =      -0.925297254035
              le_mean =     -17.210189969661
             les_mean =     296.482405497914
             stat err =       0.000418899300
             autocorr =       1.242938375031
   target nu stat err =       0.000418899300
   target dn stat err =       0.005003370431
      target stat err =       0.008166382224
              std dev =       0.531381930408
             le_variance =       0.282366755964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375737755
  error estimate for blocks of size 2^( 2) =       0.000389886757
  error estimate for blocks of size 2^( 3) =       0.000402847377
  error estimate for blocks of size 2^( 4) =       0.000412202492
  error estimate for blocks of size 2^( 5) =       0.000417941141
  error estimate for blocks of size 2^( 6) =       0.000420584518
  error estimate for blocks of size 2^( 7) =       0.000424869047

      target function =      -0.925297254035
              le_mean =     -17.210189969661
             les_mean =     296.482405497914
             stat err =       0.000418899300
             autocorr =       1.242938375028
   target nu stat err =       0.000418899300
   target dn stat err =       0.005003370431
      target stat err =       0.008166382224
              std dev =       0.531381930408
             le_variance =       0.282366755964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282410963745
                                         uncertainty =       0.004320439952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375737755
  error estimate for blocks of size 2^( 2) =       0.000389886757
  error estimate for blocks of size 2^( 3) =       0.000402847377
  error estimate for blocks of size 2^( 4) =       0.000412202492
  error estimate for blocks of size 2^( 5) =       0.000417941141
  error estimate for blocks of size 2^( 6) =       0.000420584518
  error estimate for blocks of size 2^( 7) =       0.000424869047

      target function =      -0.925297254035
              le_mean =     -17.210189969661
             les_mean =     296.482405497914
             stat err =       0.000418899300
             autocorr =       1.242938375028
   target nu stat err =       0.000418899300
   target dn stat err =       0.005003370431
      target stat err =       0.008166382224
              std dev =       0.531381930408
             le_variance =       0.282366755964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925297254035        initial
     1.4552e+12     1.4552e+13             1.1377e-16        -0.925297254035  <--
     5.8208e+12     5.8208e+13             2.8352e-17        -0.925297254035
     2.3283e+13     2.3283e+14             0.0000e+00        -0.925297254035

*****************************************************************************
Applying the update for shift_i =   1.4552e+12     and shift_s =   1.4552e+13
*****************************************************************************

  Execution time = 3.8724e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.21
    reference variance = 0.18857
====================================================
  Execution time = 2.6835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8225e-01
  Total weights = 1.966467786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1365e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273100623933
                                         uncertainty =       0.001357276056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273100623933
                                         uncertainty =       0.001357276056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369477844
  error estimate for blocks of size 2^( 2) =       0.000384107893
  error estimate for blocks of size 2^( 3) =       0.000397430073
  error estimate for blocks of size 2^( 4) =       0.000407538986
  error estimate for blocks of size 2^( 5) =       0.000413093772
  error estimate for blocks of size 2^( 6) =       0.000417617309
  error estimate for blocks of size 2^( 7) =       0.000419832615

      target function =      -0.941110486128
              le_mean =     -17.209465108161
             les_mean =     296.447935308747
             stat err =       0.000414520671
             autocorr =       1.258680729246
   target nu stat err =       0.000414520671
   target dn stat err =       0.001807307893
      target stat err =       0.003123558530
              std dev =       0.522528938025
             le_variance =       0.273036491074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720946510816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941119808895       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941119808895       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941119808895       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941119808895       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941119808895       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941119808895       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941119808895       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941119808895       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939656751281       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940988362359       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941894623965       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940831453186       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942129821356       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941406753895       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941462067428       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941527047256       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940686191672       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940068311853       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941622533684       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940811658796       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941020408609       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940939299955       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941511591543       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941546984683       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941379268715       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940910850841       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940159457323       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941773465511       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944019675814       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941227073299       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941157881675       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942766652140       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943625882286       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940575523550       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.938280663908       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942753511653       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.937653867780       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936898935055       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.942363345314       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942268629822       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.939343310799       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940137515367       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943522724572       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.940878762052       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.936790286490       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.941274829601       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.946030616593       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943849589902       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.940251770667       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.946279566380       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.933340959061       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.945182072942       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.928952793611       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.937927434102       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.932692844667       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.936159553494       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.938637860614       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.941842194811       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.938332110092       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.972992254080       residual = 9.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.942463607316       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.947379931248       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.944387442980       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.941566930760       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.969265427864       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.935333522963       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.947328496963       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.930396676432       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.887324043019       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.941856659826       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.956613076810       residual = 7.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.825929830462       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.920896665109       residual = 8.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -0.969187451932       residual = 8.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.939635352063       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.913595131042       residual = 7.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.001805288979       residual = 7.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.945890809224       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.787834833430       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.812506716927       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.816460592238       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.998372534019       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.857345880537       residual = 2.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.820654557456       residual = 6.81e+00           smallest_sin_value = 9.99e-01
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.109637466903       residual = 7.30e+00           smallest_sin_value = 9.98e-01
davidson iteration   85 stopping due to small subspace S singular value of 9.06e-01
davidson solver did not converge after         85 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+11 is 1.562603e-15

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941119808895       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941119808895       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941119808895       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941119808895       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941119808895       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940966523690       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940425994885       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941119808895       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942404902401       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939683344919       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940767607898       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940144322065       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941567656711       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942415075965       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937327723254       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938750367865       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937631894192       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945570204218       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941771964693       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939727641297       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943674880031       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939914146301       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939872456317       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940317538791       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938269063032       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938058805512       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941806382779       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942243754073       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943292658756       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.949921869604       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941804583658       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935714980512       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941601640826       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.921378186940       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946756905446       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944989418743       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.932868412917       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937068662817       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.953066677634       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950835659678       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.930448495994       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913038685064       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904152225734       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.962743465157       residual = 6.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.910872903497       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.015860154134       residual = 6.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.942838922209       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -1.004770222264       residual = 4.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.928902243429       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.937146585994       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.827267469239       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.955649990985       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912493584069       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.874051103631       residual = 7.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.968619675543       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.887652937585       residual = 4.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.967219083577       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.968807763510       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.928023242056       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.962632863451       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.865334261519       residual = 9.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.023374987835       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.938967153060       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.007506287315       residual = 7.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.922658931453       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.906745981433       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -1.039824647270       residual = 1.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.909176519700       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.898926448110       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.922281490839       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.745328272685       residual = 5.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.911097261880       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.023331443635       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.082762959146       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.952292738719       residual = 8.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -1.180352015972       residual = 8.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -1.173555994851       residual = 1.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -1.052855967023       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.768989133868       residual = 6.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -0.998009802917       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   80:   krylov dim =  81   tar_fn =      -0.945578062663       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   81:   krylov dim =  82   tar_fn =      -1.828189308815       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   82:   krylov dim =  83   tar_fn =      -0.951359386647       residual = 3.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   83:   krylov dim =  84   tar_fn =      -0.614857980154       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   84:   krylov dim =  85   tar_fn =      -1.244782187983       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   85:   krylov dim =  86   tar_fn =      -0.904112791737       residual = 6.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   86:   krylov dim =  87   tar_fn =      -0.497689026018       residual = 8.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   87:   krylov dim =  88   tar_fn =      -0.929411211953       residual = 2.83e+01           smallest_sin_value = 9.99e-01
davidson iteration   88 stopping due to small subspace S singular value of 9.28e-01
davidson solver did not converge after         88 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+12 is 8.054030e-17

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941119808895       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941119808895       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.482390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5468e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.318
    reference variance = 0.443666
====================================================
  Execution time = 2.6814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8279e-01
  Total weights = 1.9666e+06
  Execution time = 2.3201e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370303840
  error estimate for blocks of size 2^( 2) =       0.000384459832
  error estimate for blocks of size 2^( 3) =       0.000397451691
  error estimate for blocks of size 2^( 4) =       0.000407439336
  error estimate for blocks of size 2^( 5) =       0.000413057710
  error estimate for blocks of size 2^( 6) =       0.000415546180
  error estimate for blocks of size 2^( 7) =       0.000418737703

      target function =      -0.940181660509
              le_mean =     -17.210462391083
             les_mean =     296.482805346979
             stat err =       0.000413695232
             autocorr =       1.248086256778
   target nu stat err =       0.000413695232
   target dn stat err =       0.001867378118
      target stat err =       0.003221211866
              std dev =       0.523697091147
             le_variance =       0.274258643276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370303840
  error estimate for blocks of size 2^( 2) =       0.000384459832
  error estimate for blocks of size 2^( 3) =       0.000397451691
  error estimate for blocks of size 2^( 4) =       0.000407439336
  error estimate for blocks of size 2^( 5) =       0.000413057710
  error estimate for blocks of size 2^( 6) =       0.000415546180
  error estimate for blocks of size 2^( 7) =       0.000418737703

      target function =      -0.940181660509
              le_mean =     -17.210462391083
             les_mean =     296.482805346979
             stat err =       0.000413695232
             autocorr =       1.248086256776
   target nu stat err =       0.000413695232
   target dn stat err =       0.001867378118
      target stat err =       0.003221211866
              std dev =       0.523697091147
             le_variance =       0.274258643276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370303840
  error estimate for blocks of size 2^( 2) =       0.000384459832
  error estimate for blocks of size 2^( 3) =       0.000397451691
  error estimate for blocks of size 2^( 4) =       0.000407439336
  error estimate for blocks of size 2^( 5) =       0.000413057710
  error estimate for blocks of size 2^( 6) =       0.000415546180
  error estimate for blocks of size 2^( 7) =       0.000418737703

      target function =      -0.940181660509
              le_mean =     -17.210462391083
             les_mean =     296.482805346979
             stat err =       0.000413695232
             autocorr =       1.248086256781
   target nu stat err =       0.000413695232
   target dn stat err =       0.001867378118
      target stat err =       0.003221211866
              std dev =       0.523697091147
             le_variance =       0.274258643276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274211569874
                                         uncertainty =       0.001378498890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370303840
  error estimate for blocks of size 2^( 2) =       0.000384459832
  error estimate for blocks of size 2^( 3) =       0.000397451691
  error estimate for blocks of size 2^( 4) =       0.000407439336
  error estimate for blocks of size 2^( 5) =       0.000413057710
  error estimate for blocks of size 2^( 6) =       0.000415546180
  error estimate for blocks of size 2^( 7) =       0.000418737703

      target function =      -0.940181660509
              le_mean =     -17.210462391083
             les_mean =     296.482805346979
             stat err =       0.000413695232
             autocorr =       1.248086256778
   target nu stat err =       0.000413695232
   target dn stat err =       0.001867378118
      target stat err =       0.003221211866
              std dev =       0.523697091147
             le_variance =       0.274258643276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940181660509        initial  <--
     3.6380e+11     3.6380e+12             1.5626e-15        -0.940181660509
     1.4552e+12     1.4552e+13             8.0540e-17        -0.940181660509
     5.8208e+12     5.8208e+13             0.0000e+00        -0.940181660509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5811
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2448
    reference variance = 0.206791
====================================================
  Execution time = 2.6973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8695e-01
  Total weights = 1.966494571e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1316e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278079323682
                                         uncertainty =       0.001685108250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278079323682
                                         uncertainty =       0.001685108250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372870405
  error estimate for blocks of size 2^( 2) =       0.000386595748
  error estimate for blocks of size 2^( 3) =       0.000400184616
  error estimate for blocks of size 2^( 4) =       0.000410061709
  error estimate for blocks of size 2^( 5) =       0.000415986117
  error estimate for blocks of size 2^( 6) =       0.000418510859
  error estimate for blocks of size 2^( 7) =       0.000419477409

      target function =      -0.933250651289
              le_mean =     -17.210128374059
             les_mean =     296.475470692192
             stat err =       0.000416009023
             autocorr =       1.244771605739
   target nu stat err =       0.000416009023
   target dn stat err =       0.002214938762
      target stat err =       0.003735390010
              std dev =       0.527326820318
             le_variance =       0.278073575427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721012837406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933264518208       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933264518208       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933264518208       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933264518208       residual = 8.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933264518208       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933264518208       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933264518208       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936255551500       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933989657934       residual = 7.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939707031202       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937577086831       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935748255388       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930878991687       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930431265386       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937541737694       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929534065945       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950976070448       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923986680237       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.926831713021       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930078883241       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948713280639       residual = 6.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937676502440       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936659312296       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926138425217       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919664311429       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.956381570828       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917022633546       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.932057191217       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928497332121       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.936001632328       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943157751625       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.969031086865       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.923379833111       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913299869036       residual = 8.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.969472904501       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.979409830952       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944866495685       residual = 5.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936748083789       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.881275068085       residual = 3.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912296129872       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.955980779687       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.977170737090       residual = 4.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944203249852       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914054219140       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.967233901970       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.954390052269       residual = 4.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.981430199662       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.931297205005       residual = 6.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.874623686680       residual = 4.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.702615548974       residual = 5.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.907627792929       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.900651150653       residual = 8.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915794898811       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.965847443831       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.978921021343       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.996035414981       residual = 9.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.900163854722       residual = 5.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -1.048630602983       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.906382812904       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.960292178185       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -1.024919584159       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -1.040481895195       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.873505870054       residual = 8.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -1.383016290885       residual = 3.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.973375044433       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -1.047273414846       residual = 4.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.688244180467       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -1.014260500669       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.882118266076       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.561657244823       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.848446378742       residual = 3.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.698455155137       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -1.180596379896       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   73:   krylov dim =  74   tar_fn =      -1.021264369275       residual = 4.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   74:   krylov dim =  75   tar_fn =      -0.862208798753       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   75:   krylov dim =  76   tar_fn =      -0.971452577072       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   76:   krylov dim =  77   tar_fn =      -0.791671763006       residual = 4.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   77:   krylov dim =  78   tar_fn =      -0.667042604585       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   78:   krylov dim =  79   tar_fn =      -0.874484392016       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   79:   krylov dim =  80   tar_fn =      -1.150864556648       residual = 3.84e+01           smallest_sin_value = 9.99e-01
davidson iteration   80:   krylov dim =  81   tar_fn =      -1.089278098198       residual = 8.65e+00           smallest_sin_value = 9.99e-01
davidson iteration   81:   krylov dim =  82   tar_fn =      -0.547776921459       residual = 5.93e+01           smallest_sin_value = 9.99e-01
davidson iteration   82:   krylov dim =  83   tar_fn =      -1.109231843594       residual = 2.59e+01           smallest_sin_value = 9.99e-01
davidson iteration   83:   krylov dim =  84   tar_fn =       0.061918208935       residual = 9.28e+01           smallest_sin_value = 9.95e-01
davidson iteration   84 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         84 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+12 is 3.844216e-17

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933264518208       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933264518208       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.59e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933264518208       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933264518208       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.59e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.705691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5335e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.197231
====================================================
  Execution time = 2.7176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9117e-01
  Total weights = 1.9667e+06
  Execution time = 2.3180e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373530583
  error estimate for blocks of size 2^( 2) =       0.000388014723
  error estimate for blocks of size 2^( 3) =       0.000401489535
  error estimate for blocks of size 2^( 4) =       0.000412179684
  error estimate for blocks of size 2^( 5) =       0.000417232300
  error estimate for blocks of size 2^( 6) =       0.000420532282
  error estimate for blocks of size 2^( 7) =       0.000424624483

      target function =      -0.926313763174
              le_mean =     -17.209923625478
             les_mean =     296.472644020015
             stat err =       0.000418642187
             autocorr =       1.256127291726
   target nu stat err =       0.000418642187
   target dn stat err =       0.003415750686
      target stat err =       0.005610054842
              std dev =       0.528260467753
             le_variance =       0.279059121791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373530583
  error estimate for blocks of size 2^( 2) =       0.000388014723
  error estimate for blocks of size 2^( 3) =       0.000401489535
  error estimate for blocks of size 2^( 4) =       0.000412179684
  error estimate for blocks of size 2^( 5) =       0.000417232300
  error estimate for blocks of size 2^( 6) =       0.000420532282
  error estimate for blocks of size 2^( 7) =       0.000424624483

      target function =      -0.926313763174
              le_mean =     -17.209923625478
             les_mean =     296.472644020015
             stat err =       0.000418642187
             autocorr =       1.256127291727
   target nu stat err =       0.000418642187
   target dn stat err =       0.003415750686
      target stat err =       0.005610054842
              std dev =       0.528260467753
             le_variance =       0.279059121791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373530583
  error estimate for blocks of size 2^( 2) =       0.000388014723
  error estimate for blocks of size 2^( 3) =       0.000401489535
  error estimate for blocks of size 2^( 4) =       0.000412179684
  error estimate for blocks of size 2^( 5) =       0.000417232300
  error estimate for blocks of size 2^( 6) =       0.000420532282
  error estimate for blocks of size 2^( 7) =       0.000424624483

      target function =      -0.926313763174
              le_mean =     -17.209923625478
             les_mean =     296.472644020015
             stat err =       0.000418642187
             autocorr =       1.256127291726
   target nu stat err =       0.000418642187
   target dn stat err =       0.003415750686
      target stat err =       0.005610054842
              std dev =       0.528260467753
             le_variance =       0.279059121791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279011009366
                                         uncertainty =       0.002598024624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373530583
  error estimate for blocks of size 2^( 2) =       0.000388014723
  error estimate for blocks of size 2^( 3) =       0.000401489535
  error estimate for blocks of size 2^( 4) =       0.000412179684
  error estimate for blocks of size 2^( 5) =       0.000417232300
  error estimate for blocks of size 2^( 6) =       0.000420532282
  error estimate for blocks of size 2^( 7) =       0.000424624483

      target function =      -0.926313763174
              le_mean =     -17.209923625478
             les_mean =     296.472644020015
             stat err =       0.000418642187
             autocorr =       1.256127291726
   target nu stat err =       0.000418642187
   target dn stat err =       0.003415750686
      target stat err =       0.005610054842
              std dev =       0.528260467753
             le_variance =       0.279059121791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926313763174        initial  <--
     3.6380e+12     3.6380e+13             3.8442e-17        -0.926313763174
     1.4552e+13     1.4552e+14             0.0000e+00        -0.926313763174
     5.8208e+13     5.8208e+14             0.0000e+00        -0.926313763174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9005
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.0982
    reference variance = 0.164153
====================================================
  Execution time = 2.7125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0504e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8951e-01
  Total weights = 1.966730812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2455e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278478881382
                                         uncertainty =       0.001652602666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278478881382
                                         uncertainty =       0.001652602666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373180497
  error estimate for blocks of size 2^( 2) =       0.000387254899
  error estimate for blocks of size 2^( 3) =       0.000400439700
  error estimate for blocks of size 2^( 4) =       0.000410299559
  error estimate for blocks of size 2^( 5) =       0.000415891582
  error estimate for blocks of size 2^( 6) =       0.000417963327
  error estimate for blocks of size 2^( 7) =       0.000420365902

      target function =      -0.929036810634
              le_mean =     -17.209858325037
             les_mean =     296.468735167515
             stat err =       0.000416130093
             autocorr =       1.243427214315
   target nu stat err =       0.000416130093
   target dn stat err =       0.002968360799
      target stat err =       0.004915979988
              std dev =       0.527765364465
             le_variance =       0.278536279928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720985832504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+13, overlap shift 3.6380e+14 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+14, overlap shift 1.4552e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929061769059       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.706965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5379e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.244554
====================================================
  Execution time = 2.9112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8277e-01
  Total weights = 1.9661e+06
  Execution time = 2.3121e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370731143
  error estimate for blocks of size 2^( 2) =       0.000385240381
  error estimate for blocks of size 2^( 3) =       0.000398459722
  error estimate for blocks of size 2^( 4) =       0.000408088449
  error estimate for blocks of size 2^( 5) =       0.000414127919
  error estimate for blocks of size 2^( 6) =       0.000417186029
  error estimate for blocks of size 2^( 7) =       0.000421068745

      target function =      -0.940224705343
              le_mean =     -17.209768676466
             les_mean =     296.458909668483
             stat err =       0.000415117785
             autocorr =       1.253789249006
   target nu stat err =       0.000415117785
   target dn stat err =       0.001736961406
      target stat err =       0.003005424308
              std dev =       0.524301398834
             le_variance =       0.274891956819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370731143
  error estimate for blocks of size 2^( 2) =       0.000385240381
  error estimate for blocks of size 2^( 3) =       0.000398459722
  error estimate for blocks of size 2^( 4) =       0.000408088449
  error estimate for blocks of size 2^( 5) =       0.000414127919
  error estimate for blocks of size 2^( 6) =       0.000417186029
  error estimate for blocks of size 2^( 7) =       0.000421068745

      target function =      -0.940224705343
              le_mean =     -17.209768676466
             les_mean =     296.458909668483
             stat err =       0.000415117785
             autocorr =       1.253789249005
   target nu stat err =       0.000415117785
   target dn stat err =       0.001736961406
      target stat err =       0.003005424308
              std dev =       0.524301398834
             le_variance =       0.274891956819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370731143
  error estimate for blocks of size 2^( 2) =       0.000385240381
  error estimate for blocks of size 2^( 3) =       0.000398459722
  error estimate for blocks of size 2^( 4) =       0.000408088449
  error estimate for blocks of size 2^( 5) =       0.000414127919
  error estimate for blocks of size 2^( 6) =       0.000417186029
  error estimate for blocks of size 2^( 7) =       0.000421068745

      target function =      -0.940224705343
              le_mean =     -17.209768676466
             les_mean =     296.458909668483
             stat err =       0.000415117785
             autocorr =       1.253789249005
   target nu stat err =       0.000415117785
   target dn stat err =       0.001736961406
      target stat err =       0.003005424308
              std dev =       0.524301398834
             le_variance =       0.274891956819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274922008699
                                         uncertainty =       0.001247797405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370731143
  error estimate for blocks of size 2^( 2) =       0.000385240381
  error estimate for blocks of size 2^( 3) =       0.000398459722
  error estimate for blocks of size 2^( 4) =       0.000408088449
  error estimate for blocks of size 2^( 5) =       0.000414127919
  error estimate for blocks of size 2^( 6) =       0.000417186029
  error estimate for blocks of size 2^( 7) =       0.000421068745

      target function =      -0.940224705343
              le_mean =     -17.209768676466
             les_mean =     296.458909668483
             stat err =       0.000415117785
             autocorr =       1.253789249005
   target nu stat err =       0.000415117785
   target dn stat err =       0.001736961406
      target stat err =       0.003005424308
              std dev =       0.524301398834
             le_variance =       0.274891956819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940224705343        initial  <--
     3.6380e+13     3.6380e+14             0.0000e+00        -0.940224705343
     1.4552e+14     1.4552e+15             0.0000e+00        -0.940224705343
     5.8208e+14     5.8208e+15             0.0000e+00        -0.940224705343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7799
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.22935
====================================================
  Execution time = 2.7187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0439e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8728e-01
  Total weights = 1.966152908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1826e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276346088666
                                         uncertainty =       0.001505200432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276346088666
                                         uncertainty =       0.001505200432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371726138
  error estimate for blocks of size 2^( 2) =       0.000386057924
  error estimate for blocks of size 2^( 3) =       0.000399484176
  error estimate for blocks of size 2^( 4) =       0.000409939823
  error estimate for blocks of size 2^( 5) =       0.000415054644
  error estimate for blocks of size 2^( 6) =       0.000417512942
  error estimate for blocks of size 2^( 7) =       0.000418284036

      target function =      -0.932706822042
              le_mean =     -17.209510234941
             les_mean =     296.454524830219
             stat err =       0.000415197861
             autocorr =       1.247567395141
   target nu stat err =       0.000415197861
   target dn stat err =       0.003244312072
      target stat err =       0.005401537696
              std dev =       0.525708556717
             le_variance =       0.276369486605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720951023494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+14, overlap shift 3.6380e+15 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.62e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+15, overlap shift 1.4552e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.62e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932737059063       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.708243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5378e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2472
    reference variance = 0.186997
====================================================
  Execution time = 2.6853e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8451e-01
  Total weights = 1.9662e+06
  Execution time = 2.3189e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371477649
  error estimate for blocks of size 2^( 2) =       0.000385624738
  error estimate for blocks of size 2^( 3) =       0.000398441134
  error estimate for blocks of size 2^( 4) =       0.000408070566
  error estimate for blocks of size 2^( 5) =       0.000413712787
  error estimate for blocks of size 2^( 6) =       0.000418196313
  error estimate for blocks of size 2^( 7) =       0.000419562055

      target function =      -0.937318490433
              le_mean =     -17.209797507077
             les_mean =     296.461638405284
             stat err =       0.000414885430
             autocorr =       1.247357637212
   target nu stat err =       0.000414885430
   target dn stat err =       0.001992766229
      target stat err =       0.003402281258
              std dev =       0.525357135028
             le_variance =       0.276000119324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371477649
  error estimate for blocks of size 2^( 2) =       0.000385624738
  error estimate for blocks of size 2^( 3) =       0.000398441134
  error estimate for blocks of size 2^( 4) =       0.000408070566
  error estimate for blocks of size 2^( 5) =       0.000413712787
  error estimate for blocks of size 2^( 6) =       0.000418196313
  error estimate for blocks of size 2^( 7) =       0.000419562055

      target function =      -0.937318490433
              le_mean =     -17.209797507077
             les_mean =     296.461638405284
             stat err =       0.000414885430
             autocorr =       1.247357637212
   target nu stat err =       0.000414885430
   target dn stat err =       0.001992766229
      target stat err =       0.003402281258
              std dev =       0.525357135028
             le_variance =       0.276000119324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371477649
  error estimate for blocks of size 2^( 2) =       0.000385624738
  error estimate for blocks of size 2^( 3) =       0.000398441134
  error estimate for blocks of size 2^( 4) =       0.000408070566
  error estimate for blocks of size 2^( 5) =       0.000413712787
  error estimate for blocks of size 2^( 6) =       0.000418196313
  error estimate for blocks of size 2^( 7) =       0.000419562055

      target function =      -0.937318490433
              le_mean =     -17.209797507077
             les_mean =     296.461638405284
             stat err =       0.000414885430
             autocorr =       1.247357637212
   target nu stat err =       0.000414885430
   target dn stat err =       0.001992766229
      target stat err =       0.003402281258
              std dev =       0.525357135028
             le_variance =       0.276000119324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276027704653
                                         uncertainty =       0.001268837290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371477649
  error estimate for blocks of size 2^( 2) =       0.000385624738
  error estimate for blocks of size 2^( 3) =       0.000398441134
  error estimate for blocks of size 2^( 4) =       0.000408070566
  error estimate for blocks of size 2^( 5) =       0.000413712787
  error estimate for blocks of size 2^( 6) =       0.000418196313
  error estimate for blocks of size 2^( 7) =       0.000419562055

      target function =      -0.937318490433
              le_mean =     -17.209797507077
             les_mean =     296.461638405284
             stat err =       0.000414885430
             autocorr =       1.247357637212
   target nu stat err =       0.000414885430
   target dn stat err =       0.001992766229
      target stat err =       0.003402281258
              std dev =       0.525357135028
             le_variance =       0.276000119324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937318490433        initial  <--
     3.6380e+14     3.6380e+15             0.0000e+00        -0.937318490433
     1.4552e+15     1.4552e+16             0.0000e+00        -0.937318490433
     5.8208e+15     5.8208e+16             0.0000e+00        -0.937318490433

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5833
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3968e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2963
    reference variance = 0.175599
====================================================
  Execution time = 2.6917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0486e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8570e-01
  Total weights = 1.966393543e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1995e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277063733572
                                         uncertainty =       0.001473357335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277063733572
                                         uncertainty =       0.001473357335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372138321
  error estimate for blocks of size 2^( 2) =       0.000386594419
  error estimate for blocks of size 2^( 3) =       0.000400277488
  error estimate for blocks of size 2^( 4) =       0.000409370618
  error estimate for blocks of size 2^( 5) =       0.000415182433
  error estimate for blocks of size 2^( 6) =       0.000418701964
  error estimate for blocks of size 2^( 7) =       0.000421403748

      target function =      -0.935328182945
              le_mean =     -17.210160976182
             les_mean =     296.475336898333
             stat err =       0.000416164691
             autocorr =       1.250609352073
   target nu stat err =       0.000416164691
   target dn stat err =       0.002406119442
      target stat err =       0.004063784549
              std dev =       0.526291481052
             le_variance =       0.276982723028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721016097618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+15, overlap shift 3.6380e+16 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935344836225       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935344836225       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935344836225       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935344836225       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.436751377777       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935344836225       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.273579827553       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.086689140544       residual = 2.05e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.005213284382       residual = 2.47e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       7.994590856900       residual = 8.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       5.429545662666       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       2.207559108022       residual = 3.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       4.981915160997       residual = 7.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -6.077827041779       residual = 1.04e+04           smallest_sin_value = 1.00e+00
davidson iteration   14 stopping due to too large eigenvalue change
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+15 is 3.523892e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+16, overlap shift 1.4552e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935344836225       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935344836225       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935344836225       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935344836225       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935344836216       residual = 3.62e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935344836225       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.563011883212       residual = 3.62e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -6.091690755094       residual = 2.32e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       6.660333946896       residual = 8.06e+04           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+16 is 8.794126e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935344836225       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935344836225       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935344836225       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935344836225       residual = 3.16e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935345277727       residual = 7.70e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+16 is 2.532453e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.713372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5130e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.199322
====================================================
  Execution time = 2.7022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8606e-01
  Total weights = 1.9664e+06
  Execution time = 2.3151e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371611257
  error estimate for blocks of size 2^( 2) =       0.000385642107
  error estimate for blocks of size 2^( 3) =       0.000398724759
  error estimate for blocks of size 2^( 4) =       0.000408746042
  error estimate for blocks of size 2^( 5) =       0.000414069289
  error estimate for blocks of size 2^( 6) =       0.000416952032
  error estimate for blocks of size 2^( 7) =       0.000420751252

      target function =      -0.934744714920
              le_mean =     -17.209716419581
             les_mean =     296.460395950758
             stat err =       0.000415129654
             autocorr =       1.247928756517
   target nu stat err =       0.000415129654
   target dn stat err =       0.002191063420
      target stat err =       0.003705101027
              std dev =       0.525546087840
             le_variance =       0.276198690444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371611257
  error estimate for blocks of size 2^( 2) =       0.000385642107
  error estimate for blocks of size 2^( 3) =       0.000398724759
  error estimate for blocks of size 2^( 4) =       0.000408746042
  error estimate for blocks of size 2^( 5) =       0.000414069289
  error estimate for blocks of size 2^( 6) =       0.000416952032
  error estimate for blocks of size 2^( 7) =       0.000420751252

      target function =      -0.934744714920
              le_mean =     -17.209716419581
             les_mean =     296.460395950758
             stat err =       0.000415129654
             autocorr =       1.247928756517
   target nu stat err =       0.000415129654
   target dn stat err =       0.002191063420
      target stat err =       0.003705101027
              std dev =       0.525546087840
             le_variance =       0.276198690444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371611257
  error estimate for blocks of size 2^( 2) =       0.000385642107
  error estimate for blocks of size 2^( 3) =       0.000398724759
  error estimate for blocks of size 2^( 4) =       0.000408746042
  error estimate for blocks of size 2^( 5) =       0.000414069289
  error estimate for blocks of size 2^( 6) =       0.000416952032
  error estimate for blocks of size 2^( 7) =       0.000420751252

      target function =      -0.934744714920
              le_mean =     -17.209716419581
             les_mean =     296.460395950758
             stat err =       0.000415129654
             autocorr =       1.247928756517
   target nu stat err =       0.000415129654
   target dn stat err =       0.002191063420
      target stat err =       0.003705101027
              std dev =       0.525546087840
             le_variance =       0.276198690444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276231060068
                                         uncertainty =       0.001605735665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371611257
  error estimate for blocks of size 2^( 2) =       0.000385642107
  error estimate for blocks of size 2^( 3) =       0.000398724759
  error estimate for blocks of size 2^( 4) =       0.000408746042
  error estimate for blocks of size 2^( 5) =       0.000414069289
  error estimate for blocks of size 2^( 6) =       0.000416952032
  error estimate for blocks of size 2^( 7) =       0.000420751252

      target function =      -0.934744714920
              le_mean =     -17.209716419581
             les_mean =     296.460395950758
             stat err =       0.000415129654
             autocorr =       1.247928756517
   target nu stat err =       0.000415129654
   target dn stat err =       0.002191063420
      target stat err =       0.003705101027
              std dev =       0.525546087840
             le_variance =       0.276198690444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934744714920        initial  <--
     3.6380e+15     3.6380e+16             3.5239e-20        -0.934744714920
     1.4552e+16     1.4552e+17             8.7941e-21        -0.934744714920
     5.8208e+16     5.8208e+17             2.5325e-21        -0.934744714920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7352
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2887
    reference variance = 0.42953
====================================================
  Execution time = 2.6938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8494e-01
  Total weights = 1.966214112e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2354e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276961201492
                                         uncertainty =       0.002704772872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276961201492
                                         uncertainty =       0.002704772872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372130305
  error estimate for blocks of size 2^( 2) =       0.000386286707
  error estimate for blocks of size 2^( 3) =       0.000399374348
  error estimate for blocks of size 2^( 4) =       0.000408986134
  error estimate for blocks of size 2^( 5) =       0.000414540454
  error estimate for blocks of size 2^( 6) =       0.000417727728
  error estimate for blocks of size 2^( 7) =       0.000417818414

      target function =      -0.936588076481
              le_mean =     -17.208991519022
             les_mean =     296.434333209628
             stat err =       0.000414768182
             autocorr =       1.242283708169
   target nu stat err =       0.000414768182
   target dn stat err =       0.003331948221
      target stat err =       0.005585040765
              std dev =       0.526280144346
             le_variance =       0.276970790333


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720899151902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+16, overlap shift 3.6380e+17 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+17, overlap shift 1.4552e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936620603289       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.714655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5185e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2157
    reference variance = 0.172529
====================================================
  Execution time = 2.6831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8938e-01
  Total weights = 1.9665e+06
  Execution time = 2.3131e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862335
  error estimate for blocks of size 2^( 2) =       0.000387246833
  error estimate for blocks of size 2^( 3) =       0.000400514379
  error estimate for blocks of size 2^( 4) =       0.000409607031
  error estimate for blocks of size 2^( 5) =       0.000415996351
  error estimate for blocks of size 2^( 6) =       0.000419237666
  error estimate for blocks of size 2^( 7) =       0.000420672954

      target function =      -0.929261021753
              le_mean =     -17.209622548967
             les_mean =     296.460489615208
             stat err =       0.000416378500
             autocorr =       1.247037640055
   target nu stat err =       0.000416378500
   target dn stat err =       0.002823374179
      target stat err =       0.004681537728
              std dev =       0.527315408322
             le_variance =       0.278061539854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862335
  error estimate for blocks of size 2^( 2) =       0.000387246833
  error estimate for blocks of size 2^( 3) =       0.000400514379
  error estimate for blocks of size 2^( 4) =       0.000409607031
  error estimate for blocks of size 2^( 5) =       0.000415996351
  error estimate for blocks of size 2^( 6) =       0.000419237666
  error estimate for blocks of size 2^( 7) =       0.000420672954

      target function =      -0.929261021753
              le_mean =     -17.209622548967
             les_mean =     296.460489615208
             stat err =       0.000416378500
             autocorr =       1.247037640055
   target nu stat err =       0.000416378500
   target dn stat err =       0.002823374179
      target stat err =       0.004681537728
              std dev =       0.527315408322
             le_variance =       0.278061539854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862335
  error estimate for blocks of size 2^( 2) =       0.000387246833
  error estimate for blocks of size 2^( 3) =       0.000400514379
  error estimate for blocks of size 2^( 4) =       0.000409607031
  error estimate for blocks of size 2^( 5) =       0.000415996351
  error estimate for blocks of size 2^( 6) =       0.000419237666
  error estimate for blocks of size 2^( 7) =       0.000420672954

      target function =      -0.929261021753
              le_mean =     -17.209622548967
             les_mean =     296.460489615208
             stat err =       0.000416378500
             autocorr =       1.247037640055
   target nu stat err =       0.000416378500
   target dn stat err =       0.002823374179
      target stat err =       0.004681537728
              std dev =       0.527315408322
             le_variance =       0.278061539854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278154591793
                                         uncertainty =       0.002159310793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372862335
  error estimate for blocks of size 2^( 2) =       0.000387246833
  error estimate for blocks of size 2^( 3) =       0.000400514379
  error estimate for blocks of size 2^( 4) =       0.000409607031
  error estimate for blocks of size 2^( 5) =       0.000415996351
  error estimate for blocks of size 2^( 6) =       0.000419237666
  error estimate for blocks of size 2^( 7) =       0.000420672954

      target function =      -0.929261021753
              le_mean =     -17.209622548967
             les_mean =     296.460489615208
             stat err =       0.000416378500
             autocorr =       1.247037640055
   target nu stat err =       0.000416378500
   target dn stat err =       0.002823374179
      target stat err =       0.004681537728
              std dev =       0.527315408322
             le_variance =       0.278061539854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929261021753        initial  <--
     3.6380e+16     3.6380e+17             0.0000e+00        -0.929261021753
     1.4552e+17     1.4552e+18             0.0000e+00        -0.929261021753
     5.8208e+17     5.8208e+18             0.0000e+00        -0.929261021753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4991
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.170156
====================================================
  Execution time = 2.6985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8684e-01
  Total weights = 1.966320428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2119e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277301442000
                                         uncertainty =       0.001682659962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277301442000
                                         uncertainty =       0.001682659962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372317437
  error estimate for blocks of size 2^( 2) =       0.000386625254
  error estimate for blocks of size 2^( 3) =       0.000399634998
  error estimate for blocks of size 2^( 4) =       0.000410025011
  error estimate for blocks of size 2^( 5) =       0.000415325509
  error estimate for blocks of size 2^( 6) =       0.000418525465
  error estimate for blocks of size 2^( 7) =       0.000422067013

      target function =      -0.933439194127
              le_mean =     -17.210151898091
             les_mean =     296.476167440831
             stat err =       0.000416485750
             autocorr =       1.251334851863
   target nu stat err =       0.000416485750
   target dn stat err =       0.002024951042
      target stat err =       0.003429696163
              std dev =       0.526544792945
             le_variance =       0.277249418978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721015189809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+17, overlap shift 3.6380e+18 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+18, overlap shift 1.4552e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933450618100       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.715923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5205e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1606
    reference variance = 0.186464
====================================================
  Execution time = 2.9298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8820e-01
  Total weights = 1.9663e+06
  Execution time = 2.3006e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373286195
  error estimate for blocks of size 2^( 2) =       0.000387405935
  error estimate for blocks of size 2^( 3) =       0.000400792818
  error estimate for blocks of size 2^( 4) =       0.000410364973
  error estimate for blocks of size 2^( 5) =       0.000416050572
  error estimate for blocks of size 2^( 6) =       0.000418758361
  error estimate for blocks of size 2^( 7) =       0.000421919029

      target function =      -0.931194998902
              le_mean =     -17.209879844616
             les_mean =     296.468168305357
             stat err =       0.000416773234
             autocorr =       1.246567446434
   target nu stat err =       0.000416773234
   target dn stat err =       0.002095760509
      target stat err =       0.003525800132
              std dev =       0.527914846104
             le_variance =       0.278694084737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373286195
  error estimate for blocks of size 2^( 2) =       0.000387405935
  error estimate for blocks of size 2^( 3) =       0.000400792818
  error estimate for blocks of size 2^( 4) =       0.000410364973
  error estimate for blocks of size 2^( 5) =       0.000416050572
  error estimate for blocks of size 2^( 6) =       0.000418758361
  error estimate for blocks of size 2^( 7) =       0.000421919029

      target function =      -0.931194998902
              le_mean =     -17.209879844616
             les_mean =     296.468168305357
             stat err =       0.000416773234
             autocorr =       1.246567446434
   target nu stat err =       0.000416773234
   target dn stat err =       0.002095760509
      target stat err =       0.003525800132
              std dev =       0.527914846104
             le_variance =       0.278694084737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373286195
  error estimate for blocks of size 2^( 2) =       0.000387405935
  error estimate for blocks of size 2^( 3) =       0.000400792818
  error estimate for blocks of size 2^( 4) =       0.000410364973
  error estimate for blocks of size 2^( 5) =       0.000416050572
  error estimate for blocks of size 2^( 6) =       0.000418758361
  error estimate for blocks of size 2^( 7) =       0.000421919029

      target function =      -0.931194998902
              le_mean =     -17.209879844616
             les_mean =     296.468168305357
             stat err =       0.000416773234
             autocorr =       1.246567446434
   target nu stat err =       0.000416773234
   target dn stat err =       0.002095760509
      target stat err =       0.003525800132
              std dev =       0.527914846104
             le_variance =       0.278694084737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278644493285
                                         uncertainty =       0.001682735756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373286195
  error estimate for blocks of size 2^( 2) =       0.000387405935
  error estimate for blocks of size 2^( 3) =       0.000400792818
  error estimate for blocks of size 2^( 4) =       0.000410364973
  error estimate for blocks of size 2^( 5) =       0.000416050572
  error estimate for blocks of size 2^( 6) =       0.000418758361
  error estimate for blocks of size 2^( 7) =       0.000421919029

      target function =      -0.931194998902
              le_mean =     -17.209879844616
             les_mean =     296.468168305357
             stat err =       0.000416773234
             autocorr =       1.246567446434
   target nu stat err =       0.000416773234
   target dn stat err =       0.002095760509
      target stat err =       0.003525800132
              std dev =       0.527914846104
             le_variance =       0.278694084737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931194998902        initial  <--
     3.6380e+17     3.6380e+18             0.0000e+00        -0.931194998902
     1.4552e+18     1.4552e+19             0.0000e+00        -0.931194998902
     5.8208e+18     5.8208e+19             0.0000e+00        -0.931194998902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9415
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.307564
====================================================
  Execution time = 2.6897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8979e-01
  Total weights = 1.966314449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3537e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279796684363
                                         uncertainty =       0.001901435930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279796684363
                                         uncertainty =       0.001901435930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374074157
  error estimate for blocks of size 2^( 2) =       0.000388462533
  error estimate for blocks of size 2^( 3) =       0.000401307336
  error estimate for blocks of size 2^( 4) =       0.000410969115
  error estimate for blocks of size 2^( 5) =       0.000416942831
  error estimate for blocks of size 2^( 6) =       0.000420231538
  error estimate for blocks of size 2^( 7) =       0.000423374948

      target function =      -0.928569485931
              le_mean =     -17.209957266673
             les_mean =     296.472415827217
             stat err =       0.000417879608
             autocorr =       1.247920574741
   target nu stat err =       0.000417879608
   target dn stat err =       0.003663129689
      target stat err =       0.006038935208
              std dev =       0.529029210673
             le_variance =       0.279871905745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720995726667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+18, overlap shift 3.6380e+19 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+19, overlap shift 1.4552e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928607768989       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.717203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5260e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2623
    reference variance = 0.162869
====================================================
  Execution time = 2.7040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9061e-01
  Total weights = 1.9664e+06
  Execution time = 2.3034e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373349422
  error estimate for blocks of size 2^( 2) =       0.000387710711
  error estimate for blocks of size 2^( 3) =       0.000400871850
  error estimate for blocks of size 2^( 4) =       0.000409668196
  error estimate for blocks of size 2^( 5) =       0.000414966933
  error estimate for blocks of size 2^( 6) =       0.000417249759
  error estimate for blocks of size 2^( 7) =       0.000419728853

      target function =      -0.927242683284
              le_mean =     -17.209306454562
             les_mean =     296.450839963664
             stat err =       0.000415403435
             autocorr =       1.237967379173
   target nu stat err =       0.000415403435
   target dn stat err =       0.003895803290
      target stat err =       0.006390416525
              std dev =       0.528004263906
             le_variance =       0.278788502703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373349422
  error estimate for blocks of size 2^( 2) =       0.000387710711
  error estimate for blocks of size 2^( 3) =       0.000400871850
  error estimate for blocks of size 2^( 4) =       0.000409668196
  error estimate for blocks of size 2^( 5) =       0.000414966933
  error estimate for blocks of size 2^( 6) =       0.000417249759
  error estimate for blocks of size 2^( 7) =       0.000419728853

      target function =      -0.927242683284
              le_mean =     -17.209306454562
             les_mean =     296.450839963664
             stat err =       0.000415403435
             autocorr =       1.237967379173
   target nu stat err =       0.000415403435
   target dn stat err =       0.003895803290
      target stat err =       0.006390416525
              std dev =       0.528004263906
             le_variance =       0.278788502703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373349422
  error estimate for blocks of size 2^( 2) =       0.000387710711
  error estimate for blocks of size 2^( 3) =       0.000400871850
  error estimate for blocks of size 2^( 4) =       0.000409668196
  error estimate for blocks of size 2^( 5) =       0.000414966933
  error estimate for blocks of size 2^( 6) =       0.000417249759
  error estimate for blocks of size 2^( 7) =       0.000419728853

      target function =      -0.927242683284
              le_mean =     -17.209306454562
             les_mean =     296.450839963664
             stat err =       0.000415403435
             autocorr =       1.237967379173
   target nu stat err =       0.000415403435
   target dn stat err =       0.003895803290
      target stat err =       0.006390416525
              std dev =       0.528004263906
             le_variance =       0.278788502703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278744000505
                                         uncertainty =       0.001828827194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373349422
  error estimate for blocks of size 2^( 2) =       0.000387710711
  error estimate for blocks of size 2^( 3) =       0.000400871850
  error estimate for blocks of size 2^( 4) =       0.000409668196
  error estimate for blocks of size 2^( 5) =       0.000414966933
  error estimate for blocks of size 2^( 6) =       0.000417249759
  error estimate for blocks of size 2^( 7) =       0.000419728853

      target function =      -0.927242683284
              le_mean =     -17.209306454562
             les_mean =     296.450839963664
             stat err =       0.000415403435
             autocorr =       1.237967379173
   target nu stat err =       0.000415403435
   target dn stat err =       0.003895803290
      target stat err =       0.006390416525
              std dev =       0.528004263906
             le_variance =       0.278788502703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927242683284        initial  <--
     3.6380e+18     3.6380e+19             0.0000e+00        -0.927242683284
     1.4552e+19     1.4552e+20             0.0000e+00        -0.927242683284
     5.8208e+19     5.8208e+20             0.0000e+00        -0.927242683284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7084
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.190073
====================================================
  Execution time = 2.6816e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8734e-01
  Total weights = 1.966130761e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1945e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276294739397
                                         uncertainty =       0.001842053368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276294739397
                                         uncertainty =       0.001842053368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371635148
  error estimate for blocks of size 2^( 2) =       0.000386192326
  error estimate for blocks of size 2^( 3) =       0.000399356250
  error estimate for blocks of size 2^( 4) =       0.000408521314
  error estimate for blocks of size 2^( 5) =       0.000414802352
  error estimate for blocks of size 2^( 6) =       0.000416245065
  error estimate for blocks of size 2^( 7) =       0.000417989080

      target function =      -0.932618162560
              le_mean =     -17.209172459534
             les_mean =     296.442955275137
             stat err =       0.000414389453
             autocorr =       1.243322585130
   target nu stat err =       0.000414389453
   target dn stat err =       0.003514176709
      target stat err =       0.005837866560
              std dev =       0.525579875979
             le_variance =       0.276234206034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720917245953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+19, overlap shift 3.6380e+20 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+20, overlap shift 1.4552e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932653799865       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.718444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5020e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.194062
====================================================
  Execution time = 2.6912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8918e-01
  Total weights = 1.9662e+06
  Execution time = 2.3042e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372699295
  error estimate for blocks of size 2^( 2) =       0.000386843579
  error estimate for blocks of size 2^( 3) =       0.000399866210
  error estimate for blocks of size 2^( 4) =       0.000409665029
  error estimate for blocks of size 2^( 5) =       0.000415931898
  error estimate for blocks of size 2^( 6) =       0.000419739945
  error estimate for blocks of size 2^( 7) =       0.000419278897

      target function =      -0.929561437191
              le_mean =     -17.209816944477
             les_mean =     296.466980500433
             stat err =       0.000416153942
             autocorr =       1.246783031629
   target nu stat err =       0.000416153942
   target dn stat err =       0.003889151322
      target stat err =       0.006417745998
              std dev =       0.527084831174
             le_variance =       0.277818419254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372699295
  error estimate for blocks of size 2^( 2) =       0.000386843579
  error estimate for blocks of size 2^( 3) =       0.000399866210
  error estimate for blocks of size 2^( 4) =       0.000409665029
  error estimate for blocks of size 2^( 5) =       0.000415931898
  error estimate for blocks of size 2^( 6) =       0.000419739945
  error estimate for blocks of size 2^( 7) =       0.000419278897

      target function =      -0.929561437191
              le_mean =     -17.209816944477
             les_mean =     296.466980500433
             stat err =       0.000416153942
             autocorr =       1.246783031629
   target nu stat err =       0.000416153942
   target dn stat err =       0.003889151322
      target stat err =       0.006417745998
              std dev =       0.527084831174
             le_variance =       0.277818419254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372699295
  error estimate for blocks of size 2^( 2) =       0.000386843579
  error estimate for blocks of size 2^( 3) =       0.000399866210
  error estimate for blocks of size 2^( 4) =       0.000409665029
  error estimate for blocks of size 2^( 5) =       0.000415931898
  error estimate for blocks of size 2^( 6) =       0.000419739945
  error estimate for blocks of size 2^( 7) =       0.000419278897

      target function =      -0.929561437191
              le_mean =     -17.209816944477
             les_mean =     296.466980500433
             stat err =       0.000416153942
             autocorr =       1.246783031629
   target nu stat err =       0.000416153942
   target dn stat err =       0.003889151322
      target stat err =       0.006417745998
              std dev =       0.527084831174
             le_variance =       0.277818419254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653082528
                                         uncertainty =       0.001826352574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372699295
  error estimate for blocks of size 2^( 2) =       0.000386843579
  error estimate for blocks of size 2^( 3) =       0.000399866210
  error estimate for blocks of size 2^( 4) =       0.000409665029
  error estimate for blocks of size 2^( 5) =       0.000415931898
  error estimate for blocks of size 2^( 6) =       0.000419739945
  error estimate for blocks of size 2^( 7) =       0.000419278897

      target function =      -0.929561437191
              le_mean =     -17.209816944477
             les_mean =     296.466980500433
             stat err =       0.000416153942
             autocorr =       1.246783031629
   target nu stat err =       0.000416153942
   target dn stat err =       0.003889151322
      target stat err =       0.006417745998
              std dev =       0.527084831174
             le_variance =       0.277818419254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929561437191        initial  <--
     3.6380e+19     3.6380e+20             0.0000e+00        -0.929561437191
     1.4552e+20     1.4552e+21             0.0000e+00        -0.929561437191
     5.8208e+20     5.8208e+21             0.0000e+00        -0.929561437191

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5788
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.374472
====================================================
  Execution time = 2.7004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9148e-01
  Total weights = 1.966059379e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1217e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281362478783
                                         uncertainty =       0.002301334853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281362478783
                                         uncertainty =       0.002301334853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375030346
  error estimate for blocks of size 2^( 2) =       0.000389167692
  error estimate for blocks of size 2^( 3) =       0.000402422204
  error estimate for blocks of size 2^( 4) =       0.000412433614
  error estimate for blocks of size 2^( 5) =       0.000417563971
  error estimate for blocks of size 2^( 6) =       0.000420996075
  error estimate for blocks of size 2^( 7) =       0.000422825894

      target function =      -0.925844547854
              le_mean =     -17.209543307004
             les_mean =     296.459856746492
             stat err =       0.000418454888
             autocorr =       1.244986006480
   target nu stat err =       0.000418454888
   target dn stat err =       0.002962144087
      target stat err =       0.004870335524
              std dev =       0.530381487374
             le_variance =       0.281304522149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720954330700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+20, overlap shift 3.6380e+21 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925869165764       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925869165764       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925869165764       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925869165764       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925869165764       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925869143895       residual = 4.08e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926815322945       residual = 6.10e+00           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+20 is 4.760157e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+21, overlap shift 1.4552e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925869165764       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925869165764       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925869165764       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925869165764       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925869165764       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925869165764       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923600322969       residual = 2.20e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -6.848767575728       residual = 1.17e+05           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+21 is 1.190039e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+21, overlap shift 5.8208e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925869165764       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925869165764       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925869165764       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925869165764       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925869165764       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925869165764       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925869165765       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925868555016       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+21 is 4.408132e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.722000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5137e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.183455
====================================================
  Execution time = 2.6732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8614e-01
  Total weights = 1.9663e+06
  Execution time = 2.3118e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371921143
  error estimate for blocks of size 2^( 2) =       0.000386380113
  error estimate for blocks of size 2^( 3) =       0.000399363995
  error estimate for blocks of size 2^( 4) =       0.000409461231
  error estimate for blocks of size 2^( 5) =       0.000414146228
  error estimate for blocks of size 2^( 6) =       0.000416383715
  error estimate for blocks of size 2^( 7) =       0.000417132371

      target function =      -0.934592235651
              le_mean =     -17.210243836147
             les_mean =     296.478629861904
             stat err =       0.000414280886
             autocorr =       1.240760781385
   target nu stat err =       0.000414280886
   target dn stat err =       0.002554124682
      target stat err =       0.004299162312
              std dev =       0.525984340239
             le_variance =       0.276659526176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371921143
  error estimate for blocks of size 2^( 2) =       0.000386380113
  error estimate for blocks of size 2^( 3) =       0.000399363995
  error estimate for blocks of size 2^( 4) =       0.000409461231
  error estimate for blocks of size 2^( 5) =       0.000414146228
  error estimate for blocks of size 2^( 6) =       0.000416383715
  error estimate for blocks of size 2^( 7) =       0.000417132371

      target function =      -0.934592235651
              le_mean =     -17.210243836147
             les_mean =     296.478629861904
             stat err =       0.000414280886
             autocorr =       1.240760781385
   target nu stat err =       0.000414280886
   target dn stat err =       0.002554124682
      target stat err =       0.004299162312
              std dev =       0.525984340239
             le_variance =       0.276659526176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371921143
  error estimate for blocks of size 2^( 2) =       0.000386380113
  error estimate for blocks of size 2^( 3) =       0.000399363995
  error estimate for blocks of size 2^( 4) =       0.000409461231
  error estimate for blocks of size 2^( 5) =       0.000414146228
  error estimate for blocks of size 2^( 6) =       0.000416383715
  error estimate for blocks of size 2^( 7) =       0.000417132371

      target function =      -0.934592235651
              le_mean =     -17.210243836147
             les_mean =     296.478629861904
             stat err =       0.000414280886
             autocorr =       1.240760781385
   target nu stat err =       0.000414280886
   target dn stat err =       0.002554124682
      target stat err =       0.004299162312
              std dev =       0.525984340239
             le_variance =       0.276659526176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276697826341
                                         uncertainty =       0.001720968132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371921143
  error estimate for blocks of size 2^( 2) =       0.000386380113
  error estimate for blocks of size 2^( 3) =       0.000399363995
  error estimate for blocks of size 2^( 4) =       0.000409461231
  error estimate for blocks of size 2^( 5) =       0.000414146228
  error estimate for blocks of size 2^( 6) =       0.000416383715
  error estimate for blocks of size 2^( 7) =       0.000417132371

      target function =      -0.934592235651
              le_mean =     -17.210243836147
             les_mean =     296.478629861904
             stat err =       0.000414280886
             autocorr =       1.240760781385
   target nu stat err =       0.000414280886
   target dn stat err =       0.002554124682
      target stat err =       0.004299162312
              std dev =       0.525984340239
             le_variance =       0.276659526176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934592235651        initial  <--
     3.6380e+20     3.6380e+21             4.7602e-25        -0.934592235651
     1.4552e+21     1.4552e+22             1.1900e-25        -0.934592235651
     5.8208e+21     5.8208e+22             4.4081e-26        -0.934592235651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4416
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.376019
====================================================
  Execution time = 2.7123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0493e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8590e-01
  Total weights = 1.966274361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1740e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277455627109
                                         uncertainty =       0.001842565334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277455627109
                                         uncertainty =       0.001842565334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372448277
  error estimate for blocks of size 2^( 2) =       0.000386799322
  error estimate for blocks of size 2^( 3) =       0.000399801394
  error estimate for blocks of size 2^( 4) =       0.000409598344
  error estimate for blocks of size 2^( 5) =       0.000416161900
  error estimate for blocks of size 2^( 6) =       0.000419366168
  error estimate for blocks of size 2^( 7) =       0.000421913755

      target function =      -0.935006689388
              le_mean =     -17.209491052459
             les_mean =     296.452484953041
             stat err =       0.000416760042
             autocorr =       1.252103432146
   target nu stat err =       0.000416760042
   target dn stat err =       0.002074050299
      target stat err =       0.003516277422
              std dev =       0.526729832593
             le_variance =       0.277444316543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720949105246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+21, overlap shift 3.6380e+22 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+22, overlap shift 1.4552e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+22, overlap shift 5.8208e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935018835620       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.723256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5306e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1754
    reference variance = 0.723565
====================================================
  Execution time = 2.9417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8633e-01
  Total weights = 1.9665e+06
  Execution time = 2.3137e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371220048
  error estimate for blocks of size 2^( 2) =       0.000385497732
  error estimate for blocks of size 2^( 3) =       0.000399303434
  error estimate for blocks of size 2^( 4) =       0.000409543855
  error estimate for blocks of size 2^( 5) =       0.000416467067
  error estimate for blocks of size 2^( 6) =       0.000419700486
  error estimate for blocks of size 2^( 7) =       0.000423053776

      target function =      -0.934285280432
              le_mean =     -17.209805000253
             les_mean =     296.463720291731
             stat err =       0.000417191296
             autocorr =       1.263012451285
   target nu stat err =       0.000417191296
   target dn stat err =       0.002217496378
      target stat err =       0.003745785138
              std dev =       0.524992826807
             le_variance =       0.275617468199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371220048
  error estimate for blocks of size 2^( 2) =       0.000385497732
  error estimate for blocks of size 2^( 3) =       0.000399303434
  error estimate for blocks of size 2^( 4) =       0.000409543855
  error estimate for blocks of size 2^( 5) =       0.000416467067
  error estimate for blocks of size 2^( 6) =       0.000419700486
  error estimate for blocks of size 2^( 7) =       0.000423053776

      target function =      -0.934285280432
              le_mean =     -17.209805000253
             les_mean =     296.463720291731
             stat err =       0.000417191296
             autocorr =       1.263012451285
   target nu stat err =       0.000417191296
   target dn stat err =       0.002217496378
      target stat err =       0.003745785138
              std dev =       0.524992826807
             le_variance =       0.275617468199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371220048
  error estimate for blocks of size 2^( 2) =       0.000385497732
  error estimate for blocks of size 2^( 3) =       0.000399303434
  error estimate for blocks of size 2^( 4) =       0.000409543855
  error estimate for blocks of size 2^( 5) =       0.000416467067
  error estimate for blocks of size 2^( 6) =       0.000419700486
  error estimate for blocks of size 2^( 7) =       0.000423053776

      target function =      -0.934285280432
              le_mean =     -17.209805000253
             les_mean =     296.463720291731
             stat err =       0.000417191296
             autocorr =       1.263012451285
   target nu stat err =       0.000417191296
   target dn stat err =       0.002217496378
      target stat err =       0.003745785138
              std dev =       0.524992826807
             le_variance =       0.275617468199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275638514573
                                         uncertainty =       0.001548840090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371220048
  error estimate for blocks of size 2^( 2) =       0.000385497732
  error estimate for blocks of size 2^( 3) =       0.000399303434
  error estimate for blocks of size 2^( 4) =       0.000409543855
  error estimate for blocks of size 2^( 5) =       0.000416467067
  error estimate for blocks of size 2^( 6) =       0.000419700486
  error estimate for blocks of size 2^( 7) =       0.000423053776

      target function =      -0.934285280432
              le_mean =     -17.209805000253
             les_mean =     296.463720291731
             stat err =       0.000417191296
             autocorr =       1.263012451285
   target nu stat err =       0.000417191296
   target dn stat err =       0.002217496378
      target stat err =       0.003745785138
              std dev =       0.524992826807
             le_variance =       0.275617468199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934285280432        initial  <--
     3.6380e+21     3.6380e+22             0.0000e+00        -0.934285280432
     1.4552e+22     1.4552e+23             0.0000e+00        -0.934285280432
     5.8208e+22     5.8208e+23             0.0000e+00        -0.934285280432

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1278
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2181
    reference variance = 0.296614
====================================================
  Execution time = 2.6966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8839e-01
  Total weights = 1.966470157e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4023e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278738930425
                                         uncertainty =       0.002050747490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278738930425
                                         uncertainty =       0.002050747490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373313979
  error estimate for blocks of size 2^( 2) =       0.000387678008
  error estimate for blocks of size 2^( 3) =       0.000400817940
  error estimate for blocks of size 2^( 4) =       0.000410254647
  error estimate for blocks of size 2^( 5) =       0.000417368928
  error estimate for blocks of size 2^( 6) =       0.000420799375
  error estimate for blocks of size 2^( 7) =       0.000424228628

      target function =      -0.930884777024
              le_mean =     -17.209682707352
             les_mean =     296.461567474092
             stat err =       0.000418162895
             autocorr =       1.254707464342
   target nu stat err =       0.000418162895
   target dn stat err =       0.002986096765
      target stat err =       0.004963056656
              std dev =       0.527954139012
             le_variance =       0.278735572900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720968270735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+22, overlap shift 3.6380e+23 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+23, overlap shift 1.4552e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+23, overlap shift 5.8208e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930910243993       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.724513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5377e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.141
    reference variance = 0.26765
====================================================
  Execution time = 2.6827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8584e-01
  Total weights = 1.9663e+06
  Execution time = 2.2958e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225101
  error estimate for blocks of size 2^( 2) =       0.000386589523
  error estimate for blocks of size 2^( 3) =       0.000399859511
  error estimate for blocks of size 2^( 4) =       0.000409216265
  error estimate for blocks of size 2^( 5) =       0.000413932614
  error estimate for blocks of size 2^( 6) =       0.000416322641
  error estimate for blocks of size 2^( 7) =       0.000418000039

      target function =      -0.935104907737
              le_mean =     -17.210033748012
             les_mean =     296.471096912946
             stat err =       0.000414367890
             autocorr =       1.239255557321
   target nu stat err =       0.000414367890
   target dn stat err =       0.002058926305
      target stat err =       0.003495190981
              std dev =       0.526414208051
             le_variance =       0.277111918438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225101
  error estimate for blocks of size 2^( 2) =       0.000386589523
  error estimate for blocks of size 2^( 3) =       0.000399859511
  error estimate for blocks of size 2^( 4) =       0.000409216265
  error estimate for blocks of size 2^( 5) =       0.000413932614
  error estimate for blocks of size 2^( 6) =       0.000416322641
  error estimate for blocks of size 2^( 7) =       0.000418000039

      target function =      -0.935104907737
              le_mean =     -17.210033748012
             les_mean =     296.471096912946
             stat err =       0.000414367890
             autocorr =       1.239255557321
   target nu stat err =       0.000414367890
   target dn stat err =       0.002058926305
      target stat err =       0.003495190981
              std dev =       0.526414208051
             le_variance =       0.277111918438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225101
  error estimate for blocks of size 2^( 2) =       0.000386589523
  error estimate for blocks of size 2^( 3) =       0.000399859511
  error estimate for blocks of size 2^( 4) =       0.000409216265
  error estimate for blocks of size 2^( 5) =       0.000413932614
  error estimate for blocks of size 2^( 6) =       0.000416322641
  error estimate for blocks of size 2^( 7) =       0.000418000039

      target function =      -0.935104907737
              le_mean =     -17.210033748012
             les_mean =     296.471096912946
             stat err =       0.000414367890
             autocorr =       1.239255557321
   target nu stat err =       0.000414367890
   target dn stat err =       0.002058926305
      target stat err =       0.003495190981
              std dev =       0.526414208051
             le_variance =       0.277111918438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277140376056
                                         uncertainty =       0.001427284316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225101
  error estimate for blocks of size 2^( 2) =       0.000386589523
  error estimate for blocks of size 2^( 3) =       0.000399859511
  error estimate for blocks of size 2^( 4) =       0.000409216265
  error estimate for blocks of size 2^( 5) =       0.000413932614
  error estimate for blocks of size 2^( 6) =       0.000416322641
  error estimate for blocks of size 2^( 7) =       0.000418000039

      target function =      -0.935104907737
              le_mean =     -17.210033748012
             les_mean =     296.471096912946
             stat err =       0.000414367890
             autocorr =       1.239255557321
   target nu stat err =       0.000414367890
   target dn stat err =       0.002058926305
      target stat err =       0.003495190981
              std dev =       0.526414208051
             le_variance =       0.277111918438


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935104907737        initial  <--
     3.6380e+22     3.6380e+23             0.0000e+00        -0.935104907737
     1.4552e+23     1.4552e+24             0.0000e+00        -0.935104907737
     5.8208e+23     5.8208e+24             0.0000e+00        -0.935104907737

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4397
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2521
    reference variance = 0.141455
====================================================
  Execution time = 2.7468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0452e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8716e-01
  Total weights = 1.966188446e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1449e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278017216699
                                         uncertainty =       0.001812886376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278017216699
                                         uncertainty =       0.001812886376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372821337
  error estimate for blocks of size 2^( 2) =       0.000386954667
  error estimate for blocks of size 2^( 3) =       0.000400093723
  error estimate for blocks of size 2^( 4) =       0.000408942899
  error estimate for blocks of size 2^( 5) =       0.000415084546
  error estimate for blocks of size 2^( 6) =       0.000418140105
  error estimate for blocks of size 2^( 7) =       0.000419888100

      target function =      -0.932892930647
              le_mean =     -17.210292098270
             les_mean =     296.481316894763
             stat err =       0.000415513912
             autocorr =       1.242137348703
   target nu stat err =       0.000415513912
   target dn stat err =       0.002529755703
      target stat err =       0.004244869979
              std dev =       0.527257426671
             le_variance =       0.278000393980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721029209827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+23, overlap shift 3.6380e+24 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932911220007       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+23 is 3.778976e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+24, overlap shift 1.4552e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932911220007       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+24 is 9.447440e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+24, overlap shift 5.8208e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932911220007       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932911220007       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+24 is 2.361860e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.726119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5622e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.142453
====================================================
  Execution time = 2.6849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8556e-01
  Total weights = 1.9662e+06
  Execution time = 2.3084e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371820149
  error estimate for blocks of size 2^( 2) =       0.000386061696
  error estimate for blocks of size 2^( 3) =       0.000399125966
  error estimate for blocks of size 2^( 4) =       0.000408499036
  error estimate for blocks of size 2^( 5) =       0.000414547679
  error estimate for blocks of size 2^( 6) =       0.000417065363
  error estimate for blocks of size 2^( 7) =       0.000417886295

      target function =      -0.935551294792
              le_mean =     -17.210305562876
             les_mean =     296.480178306280
             stat err =       0.000414499593
             autocorr =       1.242746008275
   target nu stat err =       0.000414499593
   target dn stat err =       0.002257810397
      target stat err =       0.003824104869
              std dev =       0.525841510208
             le_variance =       0.276509293858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371820149
  error estimate for blocks of size 2^( 2) =       0.000386061696
  error estimate for blocks of size 2^( 3) =       0.000399125966
  error estimate for blocks of size 2^( 4) =       0.000408499036
  error estimate for blocks of size 2^( 5) =       0.000414547679
  error estimate for blocks of size 2^( 6) =       0.000417065363
  error estimate for blocks of size 2^( 7) =       0.000417886295

      target function =      -0.935551294792
              le_mean =     -17.210305562876
             les_mean =     296.480178306280
             stat err =       0.000414499593
             autocorr =       1.242746008275
   target nu stat err =       0.000414499593
   target dn stat err =       0.002257810397
      target stat err =       0.003824104869
              std dev =       0.525841510208
             le_variance =       0.276509293858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371820149
  error estimate for blocks of size 2^( 2) =       0.000386061696
  error estimate for blocks of size 2^( 3) =       0.000399125966
  error estimate for blocks of size 2^( 4) =       0.000408499036
  error estimate for blocks of size 2^( 5) =       0.000414547679
  error estimate for blocks of size 2^( 6) =       0.000417065363
  error estimate for blocks of size 2^( 7) =       0.000417886295

      target function =      -0.935551294792
              le_mean =     -17.210305562876
             les_mean =     296.480178306280
             stat err =       0.000414499593
             autocorr =       1.242746008275
   target nu stat err =       0.000414499593
   target dn stat err =       0.002257810397
      target stat err =       0.003824104869
              std dev =       0.525841510208
             le_variance =       0.276509293858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276483006508
                                         uncertainty =       0.001739691801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371820149
  error estimate for blocks of size 2^( 2) =       0.000386061696
  error estimate for blocks of size 2^( 3) =       0.000399125966
  error estimate for blocks of size 2^( 4) =       0.000408499036
  error estimate for blocks of size 2^( 5) =       0.000414547679
  error estimate for blocks of size 2^( 6) =       0.000417065363
  error estimate for blocks of size 2^( 7) =       0.000417886295

      target function =      -0.935551294792
              le_mean =     -17.210305562876
             les_mean =     296.480178306280
             stat err =       0.000414499593
             autocorr =       1.242746008275
   target nu stat err =       0.000414499593
   target dn stat err =       0.002257810397
      target stat err =       0.003824104869
              std dev =       0.525841510208
             le_variance =       0.276509293858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935551294792        initial  <--
     3.6380e+23     3.6380e+24             3.7790e-28        -0.935551294792
     1.4552e+24     1.4552e+25             9.4474e-29        -0.935551294792
     5.8208e+24     5.8208e+25             2.3619e-29        -0.935551294792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5108
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2091
    reference variance = 0.199161
====================================================
  Execution time = 2.7097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0489e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8139e-01
  Total weights = 1.966347888e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3518e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274414129929
                                         uncertainty =       0.001635945083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274414129929
                                         uncertainty =       0.001635945083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370423076
  error estimate for blocks of size 2^( 2) =       0.000384797905
  error estimate for blocks of size 2^( 3) =       0.000397920081
  error estimate for blocks of size 2^( 4) =       0.000407407801
  error estimate for blocks of size 2^( 5) =       0.000413594741
  error estimate for blocks of size 2^( 6) =       0.000415717805
  error estimate for blocks of size 2^( 7) =       0.000418886720

      target function =      -0.942554270917
              le_mean =     -17.209014345424
             les_mean =     296.431564304121
             stat err =       0.000413901767
             autocorr =       1.248528595524
   target nu stat err =       0.000413901767
   target dn stat err =       0.001864045972
      target stat err =       0.003222809068
              std dev =       0.523865719042
             le_variance =       0.274435291588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720901434542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+24, overlap shift 3.6380e+25 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942564321150       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942564321150       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942564321150       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942564321150       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942564321150       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+24 is 3.264696e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+25, overlap shift 1.4552e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942564321150       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942564321150       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942564321150       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942564321150       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+25 is 7.928146e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+25, overlap shift 5.8208e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942564321150       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942564321150       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942564321150       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942564321150       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942564321143       residual = 8.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+25 is 1.982037e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.728305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5459e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.198382
====================================================
  Execution time = 2.6748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8606e-01
  Total weights = 1.9664e+06
  Execution time = 2.3044e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372941580
  error estimate for blocks of size 2^( 2) =       0.000387238102
  error estimate for blocks of size 2^( 3) =       0.000400011236
  error estimate for blocks of size 2^( 4) =       0.000409152429
  error estimate for blocks of size 2^( 5) =       0.000414384030
  error estimate for blocks of size 2^( 6) =       0.000415672603
  error estimate for blocks of size 2^( 7) =       0.000419923297

      target function =      -0.934744916766
              le_mean =     -17.209680114298
             les_mean =     296.459146380561
             stat err =       0.000414783090
             autocorr =       1.236973717383
   target nu stat err =       0.000414783090
   target dn stat err =       0.002206987550
      target stat err =       0.003730595949
              std dev =       0.527427479149
             le_variance =       0.278179745761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372941580
  error estimate for blocks of size 2^( 2) =       0.000387238102
  error estimate for blocks of size 2^( 3) =       0.000400011236
  error estimate for blocks of size 2^( 4) =       0.000409152429
  error estimate for blocks of size 2^( 5) =       0.000414384030
  error estimate for blocks of size 2^( 6) =       0.000415672603
  error estimate for blocks of size 2^( 7) =       0.000419923297

      target function =      -0.934744916766
              le_mean =     -17.209680114298
             les_mean =     296.459146380561
             stat err =       0.000414783090
             autocorr =       1.236973717382
   target nu stat err =       0.000414783090
   target dn stat err =       0.002206987550
      target stat err =       0.003730595949
              std dev =       0.527427479149
             le_variance =       0.278179745761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372941580
  error estimate for blocks of size 2^( 2) =       0.000387238102
  error estimate for blocks of size 2^( 3) =       0.000400011236
  error estimate for blocks of size 2^( 4) =       0.000409152429
  error estimate for blocks of size 2^( 5) =       0.000414384030
  error estimate for blocks of size 2^( 6) =       0.000415672603
  error estimate for blocks of size 2^( 7) =       0.000419923297

      target function =      -0.934744916766
              le_mean =     -17.209680114298
             les_mean =     296.459146380561
             stat err =       0.000414783090
             autocorr =       1.236973717382
   target nu stat err =       0.000414783090
   target dn stat err =       0.002206987550
      target stat err =       0.003730595949
              std dev =       0.527427479149
             le_variance =       0.278179745761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278109721375
                                         uncertainty =       0.001964925510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372941580
  error estimate for blocks of size 2^( 2) =       0.000387238102
  error estimate for blocks of size 2^( 3) =       0.000400011236
  error estimate for blocks of size 2^( 4) =       0.000409152429
  error estimate for blocks of size 2^( 5) =       0.000414384030
  error estimate for blocks of size 2^( 6) =       0.000415672603
  error estimate for blocks of size 2^( 7) =       0.000419923297

      target function =      -0.934744916766
              le_mean =     -17.209680114298
             les_mean =     296.459146380561
             stat err =       0.000414783090
             autocorr =       1.236973717382
   target nu stat err =       0.000414783090
   target dn stat err =       0.002206987550
      target stat err =       0.003730595949
              std dev =       0.527427479149
             le_variance =       0.278179745761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934744916766        initial  <--
     3.6380e+24     3.6380e+25             3.2647e-29        -0.934744916766
     1.4552e+25     1.4552e+26             7.9281e-30        -0.934744916766
     5.8208e+25     5.8208e+26             1.9820e-30        -0.934744916766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4149
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2391
    reference variance = 0.217613
====================================================
  Execution time = 2.6876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0496e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8438e-01
  Total weights = 1.966468436e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0704e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276769778139
                                         uncertainty =       0.001504427826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276769778139
                                         uncertainty =       0.001504427826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371986574
  error estimate for blocks of size 2^( 2) =       0.000386301831
  error estimate for blocks of size 2^( 3) =       0.000399167137
  error estimate for blocks of size 2^( 4) =       0.000408927254
  error estimate for blocks of size 2^( 5) =       0.000415077666
  error estimate for blocks of size 2^( 6) =       0.000418531377
  error estimate for blocks of size 2^( 7) =       0.000421771810

      target function =      -0.937531793305
              le_mean =     -17.209809678257
             les_mean =     296.461930795754
             stat err =       0.000416077027
             autocorr =       1.251102648844
   target nu stat err =       0.000416077027
   target dn stat err =       0.001760686094
      target stat err =       0.003027754762
              std dev =       0.526076875209
             le_variance =       0.276756878630


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720980967826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+25, overlap shift 3.6380e+26 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937540435918       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937540435918       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937540435916       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+25 is 3.603487e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+26, overlap shift 1.4552e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937540435918       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937540435918       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937540435916       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+26 is 9.008717e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+26, overlap shift 5.8208e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937540435918       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937540435918       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937540435931       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+26 is 2.252179e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.729912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4956e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1745
    reference variance = 0.251312
====================================================
  Execution time = 2.9110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8490e-01
  Total weights = 1.9665e+06
  Execution time = 2.3115e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370951447
  error estimate for blocks of size 2^( 2) =       0.000385686447
  error estimate for blocks of size 2^( 3) =       0.000399009869
  error estimate for blocks of size 2^( 4) =       0.000409056763
  error estimate for blocks of size 2^( 5) =       0.000414979756
  error estimate for blocks of size 2^( 6) =       0.000419108239
  error estimate for blocks of size 2^( 7) =       0.000419529399

      target function =      -0.936647596508
              le_mean =     -17.209970339261
             les_mean =     296.467983801931
             stat err =       0.000415668539
             autocorr =       1.255625627783
   target nu stat err =       0.000415668539
   target dn stat err =       0.002475294280
      target stat err =       0.004186747407
              std dev =       0.524612960722
             le_variance =       0.275218758558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370951447
  error estimate for blocks of size 2^( 2) =       0.000385686447
  error estimate for blocks of size 2^( 3) =       0.000399009869
  error estimate for blocks of size 2^( 4) =       0.000409056763
  error estimate for blocks of size 2^( 5) =       0.000414979756
  error estimate for blocks of size 2^( 6) =       0.000419108239
  error estimate for blocks of size 2^( 7) =       0.000419529399

      target function =      -0.936647596508
              le_mean =     -17.209970339261
             les_mean =     296.467983801931
             stat err =       0.000415668539
             autocorr =       1.255625627783
   target nu stat err =       0.000415668539
   target dn stat err =       0.002475294280
      target stat err =       0.004186747407
              std dev =       0.524612960722
             le_variance =       0.275218758558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370951447
  error estimate for blocks of size 2^( 2) =       0.000385686447
  error estimate for blocks of size 2^( 3) =       0.000399009869
  error estimate for blocks of size 2^( 4) =       0.000409056763
  error estimate for blocks of size 2^( 5) =       0.000414979756
  error estimate for blocks of size 2^( 6) =       0.000419108239
  error estimate for blocks of size 2^( 7) =       0.000419529399

      target function =      -0.936647596508
              le_mean =     -17.209970339261
             les_mean =     296.467983801931
             stat err =       0.000415668539
             autocorr =       1.255625627783
   target nu stat err =       0.000415668539
   target dn stat err =       0.002475294280
      target stat err =       0.004186747407
              std dev =       0.524612960722
             le_variance =       0.275218758558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275082255082
                                         uncertainty =       0.001811643687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370951447
  error estimate for blocks of size 2^( 2) =       0.000385686447
  error estimate for blocks of size 2^( 3) =       0.000399009869
  error estimate for blocks of size 2^( 4) =       0.000409056763
  error estimate for blocks of size 2^( 5) =       0.000414979756
  error estimate for blocks of size 2^( 6) =       0.000419108239
  error estimate for blocks of size 2^( 7) =       0.000419529399

      target function =      -0.936647596508
              le_mean =     -17.209970339261
             les_mean =     296.467983801931
             stat err =       0.000415668539
             autocorr =       1.255625627783
   target nu stat err =       0.000415668539
   target dn stat err =       0.002475294280
      target stat err =       0.004186747407
              std dev =       0.524612960722
             le_variance =       0.275218758558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936647596508        initial  <--
     3.6380e+25     3.6380e+26             3.6035e-30        -0.936647596508
     1.4552e+26     1.4552e+27             9.0087e-31        -0.936647596508
     5.8208e+26     5.8208e+27             2.2522e-31        -0.936647596508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7669
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.191605
====================================================
  Execution time = 2.7135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0466e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8375e-01
  Total weights = 1.966301462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2127e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273515891784
                                         uncertainty =       0.001633817355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273515891784
                                         uncertainty =       0.001633817355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369821554
  error estimate for blocks of size 2^( 2) =       0.000384058005
  error estimate for blocks of size 2^( 3) =       0.000397484038
  error estimate for blocks of size 2^( 4) =       0.000406861149
  error estimate for blocks of size 2^( 5) =       0.000412708263
  error estimate for blocks of size 2^( 6) =       0.000416216437
  error estimate for blocks of size 2^( 7) =       0.000419276346

      target function =      -0.938584598164
              le_mean =     -17.209680597737
             les_mean =     296.456854891133
             stat err =       0.000413765549
             autocorr =       1.251769067817
   target nu stat err =       0.000413765549
   target dn stat err =       0.002282032013
      target stat err =       0.003883399020
              std dev =       0.523015025588
             le_variance =       0.273544716991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720968059774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+26, overlap shift 3.6380e+27 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938599567344       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938599567344       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938599567336       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+26 is 3.666741e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+27, overlap shift 1.4552e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938599567344       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938599567344       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938599567336       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+27 is 9.166852e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+27, overlap shift 5.8208e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938599567344       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938599567344       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938599567395       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+27 is 2.291713e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.731529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5357e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.3824
    reference variance = 1.68861
====================================================
  Execution time = 2.6821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8314e-01
  Total weights = 1.9665e+06
  Execution time = 2.3152e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369545725
  error estimate for blocks of size 2^( 2) =       0.000384175436
  error estimate for blocks of size 2^( 3) =       0.000397249700
  error estimate for blocks of size 2^( 4) =       0.000406941551
  error estimate for blocks of size 2^( 5) =       0.000412542824
  error estimate for blocks of size 2^( 6) =       0.000414647552
  error estimate for blocks of size 2^( 7) =       0.000417617690

      target function =      -0.939605336362
              le_mean =     -17.209295143281
             les_mean =     296.442980649820
             stat err =       0.000412937404
             autocorr =       1.248625163390
   target nu stat err =       0.000412937404
   target dn stat err =       0.002356216680
      target stat err =       0.004010539235
              std dev =       0.522624937306
             le_variance =       0.273136825094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369545725
  error estimate for blocks of size 2^( 2) =       0.000384175436
  error estimate for blocks of size 2^( 3) =       0.000397249700
  error estimate for blocks of size 2^( 4) =       0.000406941551
  error estimate for blocks of size 2^( 5) =       0.000412542824
  error estimate for blocks of size 2^( 6) =       0.000414647552
  error estimate for blocks of size 2^( 7) =       0.000417617690

      target function =      -0.939605336362
              le_mean =     -17.209295143281
             les_mean =     296.442980649820
             stat err =       0.000412937404
             autocorr =       1.248625163390
   target nu stat err =       0.000412937404
   target dn stat err =       0.002356216680
      target stat err =       0.004010539235
              std dev =       0.522624937306
             le_variance =       0.273136825094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369545725
  error estimate for blocks of size 2^( 2) =       0.000384175436
  error estimate for blocks of size 2^( 3) =       0.000397249700
  error estimate for blocks of size 2^( 4) =       0.000406941551
  error estimate for blocks of size 2^( 5) =       0.000412542824
  error estimate for blocks of size 2^( 6) =       0.000414647552
  error estimate for blocks of size 2^( 7) =       0.000417617690

      target function =      -0.939605336362
              le_mean =     -17.209295143281
             les_mean =     296.442980649820
             stat err =       0.000412937404
             autocorr =       1.248625163390
   target nu stat err =       0.000412937404
   target dn stat err =       0.002356216680
      target stat err =       0.004010539235
              std dev =       0.522624937306
             le_variance =       0.273136825094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273139218258
                                         uncertainty =       0.001548886670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369545725
  error estimate for blocks of size 2^( 2) =       0.000384175436
  error estimate for blocks of size 2^( 3) =       0.000397249700
  error estimate for blocks of size 2^( 4) =       0.000406941551
  error estimate for blocks of size 2^( 5) =       0.000412542824
  error estimate for blocks of size 2^( 6) =       0.000414647552
  error estimate for blocks of size 2^( 7) =       0.000417617690

      target function =      -0.939605336362
              le_mean =     -17.209295143281
             les_mean =     296.442980649820
             stat err =       0.000412937404
             autocorr =       1.248625163390
   target nu stat err =       0.000412937404
   target dn stat err =       0.002356216680
      target stat err =       0.004010539235
              std dev =       0.522624937306
             le_variance =       0.273136825094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939605336362        initial  <--
     3.6380e+26     3.6380e+27             3.6667e-31        -0.939605336362
     1.4552e+27     1.4552e+28             9.1669e-32        -0.939605336362
     5.8208e+27     5.8208e+28             2.2917e-32        -0.939605336362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5465
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1662
    reference variance = 0.158942
====================================================
  Execution time = 2.7051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0509e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8506e-01
  Total weights = 1.966155939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2333e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277245278873
                                         uncertainty =       0.001428408571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277245278873
                                         uncertainty =       0.001428408571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372273687
  error estimate for blocks of size 2^( 2) =       0.000386497699
  error estimate for blocks of size 2^( 3) =       0.000399899315
  error estimate for blocks of size 2^( 4) =       0.000409327374
  error estimate for blocks of size 2^( 5) =       0.000415434813
  error estimate for blocks of size 2^( 6) =       0.000420314766
  error estimate for blocks of size 2^( 7) =       0.000424501246

      target function =      -0.936413284085
              le_mean =     -17.209448069365
             les_mean =     296.450159638797
             stat err =       0.000417394550
             autocorr =       1.257097219936
   target nu stat err =       0.000417394550
   target dn stat err =       0.001951330150
      target stat err =       0.003327397969
              std dev =       0.526482920876
             le_variance =       0.277184265974


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720944806937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+27, overlap shift 3.6380e+28 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936423955530       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936423955530       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936423955530       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936423955530       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+27 is 2.229469e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+28, overlap shift 1.4552e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936423955530       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936423955530       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936423955530       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936423955543       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936423957348       residual = 7.57e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+28 is 5.541824e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+28, overlap shift 5.8208e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936423955530       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936423955530       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936423955530       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+28 is 1.385456e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.733461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5294e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1318
    reference variance = 0.246143
====================================================
  Execution time = 2.7167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9034e-01
  Total weights = 1.9662e+06
  Execution time = 2.3162e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373453057
  error estimate for blocks of size 2^( 2) =       0.000387525572
  error estimate for blocks of size 2^( 3) =       0.000400755251
  error estimate for blocks of size 2^( 4) =       0.000410289597
  error estimate for blocks of size 2^( 5) =       0.000416729045
  error estimate for blocks of size 2^( 6) =       0.000421442772
  error estimate for blocks of size 2^( 7) =       0.000421991987

      target function =      -0.927535737350
              le_mean =     -17.210216186113
             les_mean =     296.481880896011
             stat err =       0.000417613350
             autocorr =       1.250479885484
   target nu stat err =       0.000417613350
   target dn stat err =       0.007573801233
      target stat err =       0.012394728484
              std dev =       0.528150828298
             le_variance =       0.278943297432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373453057
  error estimate for blocks of size 2^( 2) =       0.000387525572
  error estimate for blocks of size 2^( 3) =       0.000400755251
  error estimate for blocks of size 2^( 4) =       0.000410289597
  error estimate for blocks of size 2^( 5) =       0.000416729045
  error estimate for blocks of size 2^( 6) =       0.000421442772
  error estimate for blocks of size 2^( 7) =       0.000421991987

      target function =      -0.927535737350
              le_mean =     -17.210216186113
             les_mean =     296.481880896011
             stat err =       0.000417613350
             autocorr =       1.250479885484
   target nu stat err =       0.000417613350
   target dn stat err =       0.007573801233
      target stat err =       0.012394728484
              std dev =       0.528150828298
             le_variance =       0.278943297432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373453057
  error estimate for blocks of size 2^( 2) =       0.000387525572
  error estimate for blocks of size 2^( 3) =       0.000400755251
  error estimate for blocks of size 2^( 4) =       0.000410289597
  error estimate for blocks of size 2^( 5) =       0.000416729045
  error estimate for blocks of size 2^( 6) =       0.000421442772
  error estimate for blocks of size 2^( 7) =       0.000421991987

      target function =      -0.927535737350
              le_mean =     -17.210216186113
             les_mean =     296.481880896011
             stat err =       0.000417613350
             autocorr =       1.250479885484
   target nu stat err =       0.000417613350
   target dn stat err =       0.007573801233
      target stat err =       0.012394728484
              std dev =       0.528150828298
             le_variance =       0.278943297432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278945924934
                                         uncertainty =       0.005506506638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373453057
  error estimate for blocks of size 2^( 2) =       0.000387525572
  error estimate for blocks of size 2^( 3) =       0.000400755251
  error estimate for blocks of size 2^( 4) =       0.000410289597
  error estimate for blocks of size 2^( 5) =       0.000416729045
  error estimate for blocks of size 2^( 6) =       0.000421442772
  error estimate for blocks of size 2^( 7) =       0.000421991987

      target function =      -0.927535737350
              le_mean =     -17.210216186113
             les_mean =     296.481880896011
             stat err =       0.000417613350
             autocorr =       1.250479885484
   target nu stat err =       0.000417613350
   target dn stat err =       0.007573801233
      target stat err =       0.012394728484
              std dev =       0.528150828298
             le_variance =       0.278943297432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927535737350        initial  <--
     3.6380e+27     3.6380e+28             2.2295e-32        -0.927535737350
     1.4552e+28     1.4552e+29             5.5418e-33        -0.927535737350
     5.8208e+28     5.8208e+29             1.3855e-33        -0.927535737350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8931
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.262495
====================================================
  Execution time = 2.7091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0503e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8779e-01
  Total weights = 1.966379054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2979e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778962869
                                         uncertainty =       0.002523612832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778962869
                                         uncertainty =       0.002523612832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373393099
  error estimate for blocks of size 2^( 2) =       0.000387444456
  error estimate for blocks of size 2^( 3) =       0.000400306727
  error estimate for blocks of size 2^( 4) =       0.000409919452
  error estimate for blocks of size 2^( 5) =       0.000416070329
  error estimate for blocks of size 2^( 6) =       0.000418558458
  error estimate for blocks of size 2^( 7) =       0.000419059815

      target function =      -0.931894653357
              le_mean =     -17.209028240342
             les_mean =     296.438441796205
             stat err =       0.000415902014
             autocorr =       1.240650549942
   target nu stat err =       0.000415902014
   target dn stat err =       0.002763244369
      target stat err =       0.004604669883
              std dev =       0.528066033267
             le_variance =       0.278853735490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720902824034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+28, overlap shift 3.6380e+29 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931916368458       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931916368458       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931916368458       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931916368427       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931916370988       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+28 is 5.722747e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+29, overlap shift 1.4552e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931916368458       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931916368458       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931916368458       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931916368458       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931916368457       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937500000000       residual = 3.25e+13           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+29 is 1.580211e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+29, overlap shift 5.8208e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931916368458       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931916368458       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931916368458       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931916368458       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931916368458       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931916119968       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.785199647420       residual = 1.89e+00           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+29 is 3.634677e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.736213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5399e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.264
    reference variance = 0.201822
====================================================
  Execution time = 2.6714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9089e-01
  Total weights = 1.9664e+06
  Execution time = 2.3062e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373716425
  error estimate for blocks of size 2^( 2) =       0.000388027161
  error estimate for blocks of size 2^( 3) =       0.000401186032
  error estimate for blocks of size 2^( 4) =       0.000410700542
  error estimate for blocks of size 2^( 5) =       0.000417686452
  error estimate for blocks of size 2^( 6) =       0.000421571426
  error estimate for blocks of size 2^( 7) =       0.000421560153

      target function =      -0.926783179332
              le_mean =     -17.209598664562
             les_mean =     296.461177460947
             stat err =       0.000417879643
             autocorr =       1.250311023858
   target nu stat err =       0.000417879643
   target dn stat err =       0.003515398977
      target stat err =       0.005773027947
              std dev =       0.528523292187
             le_variance =       0.279336870384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373716425
  error estimate for blocks of size 2^( 2) =       0.000388027161
  error estimate for blocks of size 2^( 3) =       0.000401186032
  error estimate for blocks of size 2^( 4) =       0.000410700542
  error estimate for blocks of size 2^( 5) =       0.000417686452
  error estimate for blocks of size 2^( 6) =       0.000421571426
  error estimate for blocks of size 2^( 7) =       0.000421560153

      target function =      -0.926783179332
              le_mean =     -17.209598664562
             les_mean =     296.461177460947
             stat err =       0.000417879643
             autocorr =       1.250311023858
   target nu stat err =       0.000417879643
   target dn stat err =       0.003515398977
      target stat err =       0.005773027947
              std dev =       0.528523292187
             le_variance =       0.279336870384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373716425
  error estimate for blocks of size 2^( 2) =       0.000388027161
  error estimate for blocks of size 2^( 3) =       0.000401186032
  error estimate for blocks of size 2^( 4) =       0.000410700542
  error estimate for blocks of size 2^( 5) =       0.000417686452
  error estimate for blocks of size 2^( 6) =       0.000421571426
  error estimate for blocks of size 2^( 7) =       0.000421560153

      target function =      -0.926783179332
              le_mean =     -17.209598664562
             les_mean =     296.461177460947
             stat err =       0.000417879643
             autocorr =       1.250311023858
   target nu stat err =       0.000417879643
   target dn stat err =       0.003515398977
      target stat err =       0.005773027947
              std dev =       0.528523292187
             le_variance =       0.279336870384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279346736877
                                         uncertainty =       0.002150499375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373716425
  error estimate for blocks of size 2^( 2) =       0.000388027161
  error estimate for blocks of size 2^( 3) =       0.000401186032
  error estimate for blocks of size 2^( 4) =       0.000410700542
  error estimate for blocks of size 2^( 5) =       0.000417686452
  error estimate for blocks of size 2^( 6) =       0.000421571426
  error estimate for blocks of size 2^( 7) =       0.000421560153

      target function =      -0.926783179332
              le_mean =     -17.209598664562
             les_mean =     296.461177460947
             stat err =       0.000417879643
             autocorr =       1.250311023858
   target nu stat err =       0.000417879643
   target dn stat err =       0.003515398977
      target stat err =       0.005773027947
              std dev =       0.528523292187
             le_variance =       0.279336870384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926783179332        initial  <--
     3.6380e+28     3.6380e+29             5.7227e-33        -0.926783179332
     1.4552e+29     1.4552e+30             1.5802e-33        -0.926783179332
     5.8208e+29     5.8208e+30             3.6347e-34        -0.926783179332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4063
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1114
    reference variance = 0.217724
====================================================
  Execution time = 2.7040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0478e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8941e-01
  Total weights = 1.966692889e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2818e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280600028952
                                         uncertainty =       0.002373949501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280600028952
                                         uncertainty =       0.002373949501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374544092
  error estimate for blocks of size 2^( 2) =       0.000389021254
  error estimate for blocks of size 2^( 3) =       0.000402532198
  error estimate for blocks of size 2^( 4) =       0.000412336735
  error estimate for blocks of size 2^( 5) =       0.000418491901
  error estimate for blocks of size 2^( 6) =       0.000421420979
  error estimate for blocks of size 2^( 7) =       0.000421987976

      target function =      -0.929185506711
              le_mean =     -17.210258304169
             les_mean =     296.482404096157
             stat err =       0.000418559398
             autocorr =       1.248844289400
   target nu stat err =       0.000418559398
   target dn stat err =       0.002825291412
      target stat err =       0.004690146031
              std dev =       0.529693809819
             le_variance =       0.280575532161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721025830417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+29, overlap shift 3.6380e+30 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929208241681       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929208241681       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929208241681       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929208241681       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+29 is 5.241629e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+30, overlap shift 1.4552e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929208241681       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929208241681       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929208241681       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929208241681       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929208241681       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929214477539       residual = 2.46e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+30 is 1.206745e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+30, overlap shift 5.8208e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929208241681       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929208241681       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.929208241681       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.929208241681       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.929208241681       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929208755493       residual = 5.13e+05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+30 is 3.016862e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.738725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5332e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1704
    reference variance = 0.470592
====================================================
  Execution time = 2.9013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8543e-01
  Total weights = 1.9666e+06
  Execution time = 2.3195e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372315523
  error estimate for blocks of size 2^( 2) =       0.000386597072
  error estimate for blocks of size 2^( 3) =       0.000399605724
  error estimate for blocks of size 2^( 4) =       0.000409346031
  error estimate for blocks of size 2^( 5) =       0.000414819674
  error estimate for blocks of size 2^( 6) =       0.000417866964
  error estimate for blocks of size 2^( 7) =       0.000420399089

      target function =      -0.935782311224
              le_mean =     -17.209082120223
             les_mean =     296.437942129802
             stat err =       0.000415607939
             autocorr =       1.246078443548
   target nu stat err =       0.000415607939
   target dn stat err =       0.002775636986
      target stat err =       0.004663371439
              std dev =       0.526542086554
             le_variance =       0.277246568913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372315523
  error estimate for blocks of size 2^( 2) =       0.000386597072
  error estimate for blocks of size 2^( 3) =       0.000399605724
  error estimate for blocks of size 2^( 4) =       0.000409346031
  error estimate for blocks of size 2^( 5) =       0.000414819674
  error estimate for blocks of size 2^( 6) =       0.000417866964
  error estimate for blocks of size 2^( 7) =       0.000420399089

      target function =      -0.935782311224
              le_mean =     -17.209082120223
             les_mean =     296.437942129802
             stat err =       0.000415607939
             autocorr =       1.246078443547
   target nu stat err =       0.000415607939
   target dn stat err =       0.002775636986
      target stat err =       0.004663371439
              std dev =       0.526542086554
             le_variance =       0.277246568913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372315523
  error estimate for blocks of size 2^( 2) =       0.000386597072
  error estimate for blocks of size 2^( 3) =       0.000399605724
  error estimate for blocks of size 2^( 4) =       0.000409346031
  error estimate for blocks of size 2^( 5) =       0.000414819674
  error estimate for blocks of size 2^( 6) =       0.000417866964
  error estimate for blocks of size 2^( 7) =       0.000420399089

      target function =      -0.935782311224
              le_mean =     -17.209082120223
             les_mean =     296.437942129802
             stat err =       0.000415607939
             autocorr =       1.246078443547
   target nu stat err =       0.000415607939
   target dn stat err =       0.002775636986
      target stat err =       0.004663371439
              std dev =       0.526542086554
             le_variance =       0.277246568913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277288621169
                                         uncertainty =       0.002455441598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372315523
  error estimate for blocks of size 2^( 2) =       0.000386597072
  error estimate for blocks of size 2^( 3) =       0.000399605724
  error estimate for blocks of size 2^( 4) =       0.000409346031
  error estimate for blocks of size 2^( 5) =       0.000414819674
  error estimate for blocks of size 2^( 6) =       0.000417866964
  error estimate for blocks of size 2^( 7) =       0.000420399089

      target function =      -0.935782311224
              le_mean =     -17.209082120223
             les_mean =     296.437942129802
             stat err =       0.000415607939
             autocorr =       1.246078443547
   target nu stat err =       0.000415607939
   target dn stat err =       0.002775636986
      target stat err =       0.004663371439
              std dev =       0.526542086554
             le_variance =       0.277246568913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935782311224        initial  <--
     3.6380e+29     3.6380e+30             5.2416e-34        -0.935782311224
     1.4552e+30     1.4552e+31             1.2067e-34        -0.935782311224
     5.8208e+30     5.8208e+31             3.0169e-35        -0.935782311224

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.7488
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.213266
====================================================
  Execution time = 2.7116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0515e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8334e-01
  Total weights = 1.966382603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3119e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273215741412
                                         uncertainty =       0.001491077747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273215741412
                                         uncertainty =       0.001491077747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369574384
  error estimate for blocks of size 2^( 2) =       0.000384172650
  error estimate for blocks of size 2^( 3) =       0.000397477403
  error estimate for blocks of size 2^( 4) =       0.000408399497
  error estimate for blocks of size 2^( 5) =       0.000414862491
  error estimate for blocks of size 2^( 6) =       0.000416684180
  error estimate for blocks of size 2^( 7) =       0.000419623784

      target function =      -0.939260365859
              le_mean =     -17.209567178621
             les_mean =     296.452546901625
             stat err =       0.000414892488
             autocorr =       1.260281092467
   target nu stat err =       0.000414892488
   target dn stat err =       0.002419661480
      target stat err =       0.004114720696
              std dev =       0.522665468149
             le_variance =       0.273179191595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720956717862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+30, overlap shift 3.6380e+31 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939277302141       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939277302141       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939277302141       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939277302141       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939277291298       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+30 is 3.493812e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+31, overlap shift 1.4552e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939277302141       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939277302141       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939277302141       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939277302141       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939277298748       residual = 4.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939270019531       residual = 5.79e+05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922524748032       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+31 is 8.734530e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+31, overlap shift 5.8208e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939277302141       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939277302141       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939277302141       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939277302141       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896913353654       residual = 4.47e+14           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.000000011700       residual = 8.26e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+31 is 2.183633e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.741516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5441e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.191001
====================================================
  Execution time = 2.7200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8486e-01
  Total weights = 1.9664e+06
  Execution time = 2.3262e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370475484
  error estimate for blocks of size 2^( 2) =       0.000385371755
  error estimate for blocks of size 2^( 3) =       0.000398568537
  error estimate for blocks of size 2^( 4) =       0.000407589849
  error estimate for blocks of size 2^( 5) =       0.000414096456
  error estimate for blocks of size 2^( 6) =       0.000416970371
  error estimate for blocks of size 2^( 7) =       0.000418111078

      target function =      -0.936723154248
              le_mean =     -17.209869201868
             les_mean =     296.464461624579
             stat err =       0.000414191939
             autocorr =       1.249926094252
   target nu stat err =       0.000414191939
   target dn stat err =       0.002113798884
      target stat err =       0.003595239965
              std dev =       0.523939837530
             le_variance =       0.274512953351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370475484
  error estimate for blocks of size 2^( 2) =       0.000385371755
  error estimate for blocks of size 2^( 3) =       0.000398568537
  error estimate for blocks of size 2^( 4) =       0.000407589849
  error estimate for blocks of size 2^( 5) =       0.000414096456
  error estimate for blocks of size 2^( 6) =       0.000416970371
  error estimate for blocks of size 2^( 7) =       0.000418111078

      target function =      -0.936723154248
              le_mean =     -17.209869201868
             les_mean =     296.464461624579
             stat err =       0.000414191939
             autocorr =       1.249926094252
   target nu stat err =       0.000414191939
   target dn stat err =       0.002113798884
      target stat err =       0.003595239965
              std dev =       0.523939837530
             le_variance =       0.274512953351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370475484
  error estimate for blocks of size 2^( 2) =       0.000385371755
  error estimate for blocks of size 2^( 3) =       0.000398568537
  error estimate for blocks of size 2^( 4) =       0.000407589849
  error estimate for blocks of size 2^( 5) =       0.000414096456
  error estimate for blocks of size 2^( 6) =       0.000416970371
  error estimate for blocks of size 2^( 7) =       0.000418111078

      target function =      -0.936723154248
              le_mean =     -17.209869201868
             les_mean =     296.464461624579
             stat err =       0.000414191939
             autocorr =       1.249926094252
   target nu stat err =       0.000414191939
   target dn stat err =       0.002113798884
      target stat err =       0.003595239965
              std dev =       0.523939837530
             le_variance =       0.274512953351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274544494217
                                         uncertainty =       0.001501263563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370475484
  error estimate for blocks of size 2^( 2) =       0.000385371755
  error estimate for blocks of size 2^( 3) =       0.000398568537
  error estimate for blocks of size 2^( 4) =       0.000407589849
  error estimate for blocks of size 2^( 5) =       0.000414096456
  error estimate for blocks of size 2^( 6) =       0.000416970371
  error estimate for blocks of size 2^( 7) =       0.000418111078

      target function =      -0.936723154248
              le_mean =     -17.209869201868
             les_mean =     296.464461624579
             stat err =       0.000414191939
             autocorr =       1.249926094252
   target nu stat err =       0.000414191939
   target dn stat err =       0.002113798884
      target stat err =       0.003595239965
              std dev =       0.523939837530
             le_variance =       0.274512953351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936723154248        initial  <--
     3.6380e+30     3.6380e+31             3.4938e-35        -0.936723154248
     1.4552e+31     1.4552e+32             8.7345e-36        -0.936723154248
     5.8208e+31     5.8208e+32             2.1836e-36        -0.936723154248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9692
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.16221
====================================================
  Execution time = 2.6998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0477e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8717e-01
  Total weights = 1.966266365e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4140e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278240478761
                                         uncertainty =       0.001543105291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278240478761
                                         uncertainty =       0.001543105291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022829
  error estimate for blocks of size 2^( 2) =       0.000387028708
  error estimate for blocks of size 2^( 3) =       0.000400534313
  error estimate for blocks of size 2^( 4) =       0.000410330660
  error estimate for blocks of size 2^( 5) =       0.000417453405
  error estimate for blocks of size 2^( 6) =       0.000420733826
  error estimate for blocks of size 2^( 7) =       0.000422585946

      target function =      -0.932908457918
              le_mean =     -17.209697929021
             les_mean =     296.460870639831
             stat err =       0.000417775959
             autocorr =       1.254342294819
   target nu stat err =       0.000417775959
   target dn stat err =       0.002084602972
      target stat err =       0.003519643336
              std dev =       0.527542384945
             le_variance =       0.278300967913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720969792902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+31, overlap shift 3.6380e+32 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+32, overlap shift 1.4552e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+32, overlap shift 5.8208e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932920582704       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.742780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5420e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2275
    reference variance = 0.850036
====================================================
  Execution time = 2.7002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8508e-01
  Total weights = 1.9664e+06
  Execution time = 2.3107e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371288599
  error estimate for blocks of size 2^( 2) =       0.000385692517
  error estimate for blocks of size 2^( 3) =       0.000398718730
  error estimate for blocks of size 2^( 4) =       0.000408140093
  error estimate for blocks of size 2^( 5) =       0.000414161812
  error estimate for blocks of size 2^( 6) =       0.000416650433
  error estimate for blocks of size 2^( 7) =       0.000417607831

      target function =      -0.936364847100
              le_mean =     -17.209739150468
             les_mean =     296.460200781417
             stat err =       0.000414140042
             autocorr =       1.244145629564
   target nu stat err =       0.000414140042
   target dn stat err =       0.002317424821
      target stat err =       0.003923743917
              std dev =       0.525089773869
             le_variance =       0.275719270622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371288599
  error estimate for blocks of size 2^( 2) =       0.000385692517
  error estimate for blocks of size 2^( 3) =       0.000398718730
  error estimate for blocks of size 2^( 4) =       0.000408140093
  error estimate for blocks of size 2^( 5) =       0.000414161812
  error estimate for blocks of size 2^( 6) =       0.000416650433
  error estimate for blocks of size 2^( 7) =       0.000417607831

      target function =      -0.936364847100
              le_mean =     -17.209739150468
             les_mean =     296.460200781417
             stat err =       0.000414140042
             autocorr =       1.244145629564
   target nu stat err =       0.000414140042
   target dn stat err =       0.002317424821
      target stat err =       0.003923743917
              std dev =       0.525089773869
             le_variance =       0.275719270622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371288599
  error estimate for blocks of size 2^( 2) =       0.000385692517
  error estimate for blocks of size 2^( 3) =       0.000398718730
  error estimate for blocks of size 2^( 4) =       0.000408140093
  error estimate for blocks of size 2^( 5) =       0.000414161812
  error estimate for blocks of size 2^( 6) =       0.000416650433
  error estimate for blocks of size 2^( 7) =       0.000417607831

      target function =      -0.936364847100
              le_mean =     -17.209739150468
             les_mean =     296.460200781417
             stat err =       0.000414140042
             autocorr =       1.244145629564
   target nu stat err =       0.000414140042
   target dn stat err =       0.002317424821
      target stat err =       0.003923743917
              std dev =       0.525089773869
             le_variance =       0.275719270622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275757851933
                                         uncertainty =       0.001749621814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371288599
  error estimate for blocks of size 2^( 2) =       0.000385692517
  error estimate for blocks of size 2^( 3) =       0.000398718730
  error estimate for blocks of size 2^( 4) =       0.000408140093
  error estimate for blocks of size 2^( 5) =       0.000414161812
  error estimate for blocks of size 2^( 6) =       0.000416650433
  error estimate for blocks of size 2^( 7) =       0.000417607831

      target function =      -0.936364847100
              le_mean =     -17.209739150468
             les_mean =     296.460200781417
             stat err =       0.000414140042
             autocorr =       1.244145629564
   target nu stat err =       0.000414140042
   target dn stat err =       0.002317424821
      target stat err =       0.003923743917
              std dev =       0.525089773869
             le_variance =       0.275719270622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936364847100        initial  <--
     3.6380e+31     3.6380e+32             0.0000e+00        -0.936364847100
     1.4552e+32     1.4552e+33             0.0000e+00        -0.936364847100
     5.8208e+32     5.8208e+33             0.0000e+00        -0.936364847100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6832
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.423709
====================================================
  Execution time = 2.7047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0495e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8862e-01
  Total weights = 1.966466049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1395e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277934633698
                                         uncertainty =       0.001690857599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277934633698
                                         uncertainty =       0.001690857599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372772608
  error estimate for blocks of size 2^( 2) =       0.000387037771
  error estimate for blocks of size 2^( 3) =       0.000400065390
  error estimate for blocks of size 2^( 4) =       0.000409533003
  error estimate for blocks of size 2^( 5) =       0.000415183840
  error estimate for blocks of size 2^( 6) =       0.000419738094
  error estimate for blocks of size 2^( 7) =       0.000421672464

      target function =      -0.930517427663
              le_mean =     -17.209539431024
             les_mean =     296.456868837500
             stat err =       0.000416531850
             autocorr =       1.248557212754
   target nu stat err =       0.000416531850
   target dn stat err =       0.002307125402
      target stat err =       0.003858476629
              std dev =       0.527188512123
             le_variance =       0.277927727314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720953943102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+32, overlap shift 3.6380e+33 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+33, overlap shift 1.4552e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+33, overlap shift 5.8208e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930532438332       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.744054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5195e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1815
    reference variance = 0.23093
====================================================
  Execution time = 2.6856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9279e-01
  Total weights = 1.9663e+06
  Execution time = 2.3182e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373919606
  error estimate for blocks of size 2^( 2) =       0.000388263289
  error estimate for blocks of size 2^( 3) =       0.000401485513
  error estimate for blocks of size 2^( 4) =       0.000410833630
  error estimate for blocks of size 2^( 5) =       0.000416001326
  error estimate for blocks of size 2^( 6) =       0.000418220366
  error estimate for blocks of size 2^( 7) =       0.000422695342

      target function =      -0.923679564962
              le_mean =     -17.209985761742
             les_mean =     296.476397462432
             stat err =       0.000416937666
             autocorr =       1.243328205400
   target nu stat err =       0.000416937666
   target dn stat err =       0.003873681013
      target stat err =       0.006314618129
              std dev =       0.528810639383
             le_variance =       0.279640692324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373919606
  error estimate for blocks of size 2^( 2) =       0.000388263289
  error estimate for blocks of size 2^( 3) =       0.000401485513
  error estimate for blocks of size 2^( 4) =       0.000410833630
  error estimate for blocks of size 2^( 5) =       0.000416001326
  error estimate for blocks of size 2^( 6) =       0.000418220366
  error estimate for blocks of size 2^( 7) =       0.000422695342

      target function =      -0.923679564962
              le_mean =     -17.209985761742
             les_mean =     296.476397462432
             stat err =       0.000416937666
             autocorr =       1.243328205396
   target nu stat err =       0.000416937666
   target dn stat err =       0.003873681013
      target stat err =       0.006314618129
              std dev =       0.528810639383
             le_variance =       0.279640692324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373919606
  error estimate for blocks of size 2^( 2) =       0.000388263289
  error estimate for blocks of size 2^( 3) =       0.000401485513
  error estimate for blocks of size 2^( 4) =       0.000410833630
  error estimate for blocks of size 2^( 5) =       0.000416001326
  error estimate for blocks of size 2^( 6) =       0.000418220366
  error estimate for blocks of size 2^( 7) =       0.000422695342

      target function =      -0.923679564962
              le_mean =     -17.209985761742
             les_mean =     296.476397462432
             stat err =       0.000416937666
             autocorr =       1.243328205396
   target nu stat err =       0.000416937666
   target dn stat err =       0.003873681013
      target stat err =       0.006314618129
              std dev =       0.528810639383
             le_variance =       0.279640692324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279732130997
                                         uncertainty =       0.001836515102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373919606
  error estimate for blocks of size 2^( 2) =       0.000388263289
  error estimate for blocks of size 2^( 3) =       0.000401485513
  error estimate for blocks of size 2^( 4) =       0.000410833630
  error estimate for blocks of size 2^( 5) =       0.000416001326
  error estimate for blocks of size 2^( 6) =       0.000418220366
  error estimate for blocks of size 2^( 7) =       0.000422695342

      target function =      -0.923679564962
              le_mean =     -17.209985761742
             les_mean =     296.476397462432
             stat err =       0.000416937666
             autocorr =       1.243328205396
   target nu stat err =       0.000416937666
   target dn stat err =       0.003873681013
      target stat err =       0.006314618129
              std dev =       0.528810639383
             le_variance =       0.279640692324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923679564962        initial  <--
     3.6380e+32     3.6380e+33             0.0000e+00        -0.923679564962
     1.4552e+33     1.4552e+34             0.0000e+00        -0.923679564962
     5.8208e+33     5.8208e+34             0.0000e+00        -0.923679564962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.5701
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1431
    reference variance = 0.965454
====================================================
  Execution time = 2.7011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8780e-01
  Total weights = 1.966087073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3162e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276702241907
                                         uncertainty =       0.002078181517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276702241907
                                         uncertainty =       0.002078181517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371973738
  error estimate for blocks of size 2^( 2) =       0.000386200767
  error estimate for blocks of size 2^( 3) =       0.000399556958
  error estimate for blocks of size 2^( 4) =       0.000408725211
  error estimate for blocks of size 2^( 5) =       0.000414426244
  error estimate for blocks of size 2^( 6) =       0.000417878845
  error estimate for blocks of size 2^( 7) =       0.000420030021

      target function =      -0.931822059795
              le_mean =     -17.210153081124
             les_mean =     296.477172202102
             stat err =       0.000415265080
             autocorr =       1.246310540786
   target nu stat err =       0.000415265080
   target dn stat err =       0.003569507544
      target stat err =       0.005929524535
              std dev =       0.526058721463
             le_variance =       0.276737778427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721015308112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+33, overlap shift 3.6380e+34 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+34, overlap shift 1.4552e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+34, overlap shift 5.8208e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931858714240       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.745280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5336e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1621
    reference variance = 0.202008
====================================================
  Execution time = 2.8984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8652e-01
  Total weights = 1.9664e+06
  Execution time = 2.3166e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372379044
  error estimate for blocks of size 2^( 2) =       0.000386605273
  error estimate for blocks of size 2^( 3) =       0.000399814860
  error estimate for blocks of size 2^( 4) =       0.000410323156
  error estimate for blocks of size 2^( 5) =       0.000415810363
  error estimate for blocks of size 2^( 6) =       0.000419048579
  error estimate for blocks of size 2^( 7) =       0.000422945405

      target function =      -0.933980373455
              le_mean =     -17.209517529761
             les_mean =     296.454015752126
             stat err =       0.000417031876
             autocorr =       1.254203586501
   target nu stat err =       0.000417031876
   target dn stat err =       0.002068417988
      target stat err =       0.003499903396
              std dev =       0.526631919693
             le_variance =       0.277341178840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372379044
  error estimate for blocks of size 2^( 2) =       0.000386605273
  error estimate for blocks of size 2^( 3) =       0.000399814860
  error estimate for blocks of size 2^( 4) =       0.000410323156
  error estimate for blocks of size 2^( 5) =       0.000415810363
  error estimate for blocks of size 2^( 6) =       0.000419048579
  error estimate for blocks of size 2^( 7) =       0.000422945405

      target function =      -0.933980373455
              le_mean =     -17.209517529761
             les_mean =     296.454015752126
             stat err =       0.000417031876
             autocorr =       1.254203586501
   target nu stat err =       0.000417031876
   target dn stat err =       0.002068417988
      target stat err =       0.003499903396
              std dev =       0.526631919693
             le_variance =       0.277341178840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372379044
  error estimate for blocks of size 2^( 2) =       0.000386605273
  error estimate for blocks of size 2^( 3) =       0.000399814860
  error estimate for blocks of size 2^( 4) =       0.000410323156
  error estimate for blocks of size 2^( 5) =       0.000415810363
  error estimate for blocks of size 2^( 6) =       0.000419048579
  error estimate for blocks of size 2^( 7) =       0.000422945405

      target function =      -0.933980373455
              le_mean =     -17.209517529761
             les_mean =     296.454015752126
             stat err =       0.000417031876
             autocorr =       1.254203586501
   target nu stat err =       0.000417031876
   target dn stat err =       0.002068417988
      target stat err =       0.003499903396
              std dev =       0.526631919693
             le_variance =       0.277341178840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277242136519
                                         uncertainty =       0.001668579033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372379044
  error estimate for blocks of size 2^( 2) =       0.000386605273
  error estimate for blocks of size 2^( 3) =       0.000399814860
  error estimate for blocks of size 2^( 4) =       0.000410323156
  error estimate for blocks of size 2^( 5) =       0.000415810363
  error estimate for blocks of size 2^( 6) =       0.000419048579
  error estimate for blocks of size 2^( 7) =       0.000422945405

      target function =      -0.933980373455
              le_mean =     -17.209517529761
             les_mean =     296.454015752126
             stat err =       0.000417031876
             autocorr =       1.254203586501
   target nu stat err =       0.000417031876
   target dn stat err =       0.002068417988
      target stat err =       0.003499903396
              std dev =       0.526631919693
             le_variance =       0.277341178840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933980373455        initial  <--
     3.6380e+33     3.6380e+34             0.0000e+00        -0.933980373455
     1.4552e+34     1.4552e+35             0.0000e+00        -0.933980373455
     5.8208e+34     5.8208e+35             0.0000e+00        -0.933980373455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.9821
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.18497
====================================================
  Execution time = 2.7389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0470e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8400e-01
  Total weights = 1.966397598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1974e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277007820263
                                         uncertainty =       0.001865406016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277007820263
                                         uncertainty =       0.001865406016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372138482
  error estimate for blocks of size 2^( 2) =       0.000386208984
  error estimate for blocks of size 2^( 3) =       0.000399236774
  error estimate for blocks of size 2^( 4) =       0.000408023877
  error estimate for blocks of size 2^( 5) =       0.000413177862
  error estimate for blocks of size 2^( 6) =       0.000416643187
  error estimate for blocks of size 2^( 7) =       0.000420202665

      target function =      -0.938161972021
              le_mean =     -17.209816118130
             les_mean =     296.461774302575
             stat err =       0.000414511898
             autocorr =       1.240694445281
   target nu stat err =       0.000414511898
   target dn stat err =       0.001812868982
      target stat err =       0.003115649164
              std dev =       0.526291708724
             le_variance =       0.276982962672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720981611813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+34, overlap shift 3.6380e+35 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+34 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+35, overlap shift 1.4552e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+35 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+35, overlap shift 5.8208e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938171304420       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+35 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.746476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5595e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.212788
====================================================
  Execution time = 2.6758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8787e-01
  Total weights = 1.9662e+06
  Execution time = 2.3153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070602
  error estimate for blocks of size 2^( 2) =       0.000387401055
  error estimate for blocks of size 2^( 3) =       0.000401247826
  error estimate for blocks of size 2^( 4) =       0.000411328764
  error estimate for blocks of size 2^( 5) =       0.000417372854
  error estimate for blocks of size 2^( 6) =       0.000419834324
  error estimate for blocks of size 2^( 7) =       0.000420882378

      target function =      -0.931748756825
              le_mean =     -17.209796569182
             les_mean =     296.464964063744
             stat err =       0.000417354580
             autocorr =       1.251492670661
   target nu stat err =       0.000417354580
   target dn stat err =       0.002476010393
      target stat err =       0.004144070467
              std dev =       0.527609947266
             le_variance =       0.278372256454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070602
  error estimate for blocks of size 2^( 2) =       0.000387401055
  error estimate for blocks of size 2^( 3) =       0.000401247826
  error estimate for blocks of size 2^( 4) =       0.000411328764
  error estimate for blocks of size 2^( 5) =       0.000417372854
  error estimate for blocks of size 2^( 6) =       0.000419834324
  error estimate for blocks of size 2^( 7) =       0.000420882378

      target function =      -0.931748756825
              le_mean =     -17.209796569182
             les_mean =     296.464964063744
             stat err =       0.000417354580
             autocorr =       1.251492670661
   target nu stat err =       0.000417354580
   target dn stat err =       0.002476010393
      target stat err =       0.004144070467
              std dev =       0.527609947266
             le_variance =       0.278372256454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070602
  error estimate for blocks of size 2^( 2) =       0.000387401055
  error estimate for blocks of size 2^( 3) =       0.000401247826
  error estimate for blocks of size 2^( 4) =       0.000411328764
  error estimate for blocks of size 2^( 5) =       0.000417372854
  error estimate for blocks of size 2^( 6) =       0.000419834324
  error estimate for blocks of size 2^( 7) =       0.000420882378

      target function =      -0.931748756825
              le_mean =     -17.209796569182
             les_mean =     296.464964063744
             stat err =       0.000417354580
             autocorr =       1.251492670661
   target nu stat err =       0.000417354580
   target dn stat err =       0.002476010393
      target stat err =       0.004144070467
              std dev =       0.527609947266
             le_variance =       0.278372256454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278391697281
                                         uncertainty =       0.001976211426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070602
  error estimate for blocks of size 2^( 2) =       0.000387401055
  error estimate for blocks of size 2^( 3) =       0.000401247826
  error estimate for blocks of size 2^( 4) =       0.000411328764
  error estimate for blocks of size 2^( 5) =       0.000417372854
  error estimate for blocks of size 2^( 6) =       0.000419834324
  error estimate for blocks of size 2^( 7) =       0.000420882378

      target function =      -0.931748756825
              le_mean =     -17.209796569182
             les_mean =     296.464964063744
             stat err =       0.000417354580
             autocorr =       1.251492670661
   target nu stat err =       0.000417354580
   target dn stat err =       0.002476010393
      target stat err =       0.004144070467
              std dev =       0.527609947266
             le_variance =       0.278372256454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931748756825        initial  <--
     3.6380e+34     3.6380e+35             0.0000e+00        -0.931748756825
     1.4552e+35     1.4552e+36             0.0000e+00        -0.931748756825
     5.8208e+35     5.8208e+36             0.0000e+00        -0.931748756825

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7110
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1903
    reference variance = 0.169845
====================================================
  Execution time = 2.7167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0499e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8200e-01
  Total weights = 1.966608471e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1330e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274671217070
                                         uncertainty =       0.001547996809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274671217070
                                         uncertainty =       0.001547996809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370586086
  error estimate for blocks of size 2^( 2) =       0.000385077463
  error estimate for blocks of size 2^( 3) =       0.000398160201
  error estimate for blocks of size 2^( 4) =       0.000407489444
  error estimate for blocks of size 2^( 5) =       0.000413634628
  error estimate for blocks of size 2^( 6) =       0.000415809744
  error estimate for blocks of size 2^( 7) =       0.000418244732

      target function =      -0.941525192023
              le_mean =     -17.209273497133
             les_mean =     296.441093819630
             stat err =       0.000413794637
             autocorr =       1.246784795975
   target nu stat err =       0.000413794637
   target dn stat err =       0.001941152049
      target stat err =       0.003343713902
              std dev =       0.524096253815
             le_variance =       0.274676883263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720927349713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+35, overlap shift 3.6380e+36 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+36, overlap shift 1.4552e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+36, overlap shift 5.8208e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941536114692       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.747715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5308e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1768
    reference variance = 0.177292
====================================================
  Execution time = 2.7113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8779e-01
  Total weights = 1.9662e+06
  Execution time = 2.3135e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371456315
  error estimate for blocks of size 2^( 2) =       0.000385546083
  error estimate for blocks of size 2^( 3) =       0.000398695215
  error estimate for blocks of size 2^( 4) =       0.000408389942
  error estimate for blocks of size 2^( 5) =       0.000413439842
  error estimate for blocks of size 2^( 6) =       0.000416616874
  error estimate for blocks of size 2^( 7) =       0.000419594017

      target function =      -0.931850228837
              le_mean =     -17.210169164102
             les_mean =     296.477712897604
             stat err =       0.000414510169
             autocorr =       1.245245228665
   target nu stat err =       0.000414510169
   target dn stat err =       0.003196437243
      target stat err =       0.005320106365
              std dev =       0.525326963683
             le_variance =       0.275968418772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371456315
  error estimate for blocks of size 2^( 2) =       0.000385546083
  error estimate for blocks of size 2^( 3) =       0.000398695215
  error estimate for blocks of size 2^( 4) =       0.000408389942
  error estimate for blocks of size 2^( 5) =       0.000413439842
  error estimate for blocks of size 2^( 6) =       0.000416616874
  error estimate for blocks of size 2^( 7) =       0.000419594017

      target function =      -0.931850228837
              le_mean =     -17.210169164102
             les_mean =     296.477712897604
             stat err =       0.000414510169
             autocorr =       1.245245228664
   target nu stat err =       0.000414510169
   target dn stat err =       0.003196437243
      target stat err =       0.005320106365
              std dev =       0.525326963683
             le_variance =       0.275968418772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371456315
  error estimate for blocks of size 2^( 2) =       0.000385546083
  error estimate for blocks of size 2^( 3) =       0.000398695215
  error estimate for blocks of size 2^( 4) =       0.000408389942
  error estimate for blocks of size 2^( 5) =       0.000413439842
  error estimate for blocks of size 2^( 6) =       0.000416616874
  error estimate for blocks of size 2^( 7) =       0.000419594017

      target function =      -0.931850228837
              le_mean =     -17.210169164102
             les_mean =     296.477712897604
             stat err =       0.000414510169
             autocorr =       1.245245228664
   target nu stat err =       0.000414510169
   target dn stat err =       0.003196437243
      target stat err =       0.005320106365
              std dev =       0.525326963683
             le_variance =       0.275968418772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276056804210
                                         uncertainty =       0.001487804621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371456315
  error estimate for blocks of size 2^( 2) =       0.000385546083
  error estimate for blocks of size 2^( 3) =       0.000398695215
  error estimate for blocks of size 2^( 4) =       0.000408389942
  error estimate for blocks of size 2^( 5) =       0.000413439842
  error estimate for blocks of size 2^( 6) =       0.000416616874
  error estimate for blocks of size 2^( 7) =       0.000419594017

      target function =      -0.931850228837
              le_mean =     -17.210169164102
             les_mean =     296.477712897604
             stat err =       0.000414510169
             autocorr =       1.245245228664
   target nu stat err =       0.000414510169
   target dn stat err =       0.003196437243
      target stat err =       0.005320106365
              std dev =       0.525326963683
             le_variance =       0.275968418772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931850228837        initial  <--
     3.6380e+35     3.6380e+36             0.0000e+00        -0.931850228837
     1.4552e+36     1.4552e+37             0.0000e+00        -0.931850228837
     5.8208e+36     5.8208e+37             0.0000e+00        -0.931850228837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.0688
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.250153
====================================================
  Execution time = 2.6943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0487e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8190e-01
  Total weights = 1.966405125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2272e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274470493683
                                         uncertainty =       0.001714112296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274470493683
                                         uncertainty =       0.001714112296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370424557
  error estimate for blocks of size 2^( 2) =       0.000384623351
  error estimate for blocks of size 2^( 3) =       0.000398224406
  error estimate for blocks of size 2^( 4) =       0.000408395265
  error estimate for blocks of size 2^( 5) =       0.000414653765
  error estimate for blocks of size 2^( 6) =       0.000417864304
  error estimate for blocks of size 2^( 7) =       0.000420424499

      target function =      -0.941695343572
              le_mean =     -17.209502423065
             les_mean =     296.448870708022
             stat err =       0.000415334458
             autocorr =       1.257176883541
   target nu stat err =       0.000415334458
   target dn stat err =       0.001896263581
      target stat err =       0.003273395916
              std dev =       0.523867814531
             le_variance =       0.274437487101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720950242306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+36, overlap shift 3.6380e+37 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+37, overlap shift 1.4552e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+37, overlap shift 5.8208e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941705665558       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.748971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5179e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2677
    reference variance = 0.342623
====================================================
  Execution time = 2.6989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8178e-01
  Total weights = 1.9665e+06
  Execution time = 2.3173e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370038555
  error estimate for blocks of size 2^( 2) =       0.000384189915
  error estimate for blocks of size 2^( 3) =       0.000397622468
  error estimate for blocks of size 2^( 4) =       0.000407025426
  error estimate for blocks of size 2^( 5) =       0.000413580604
  error estimate for blocks of size 2^( 6) =       0.000417049692
  error estimate for blocks of size 2^( 7) =       0.000420962571

      target function =      -0.941879236062
              le_mean =     -17.209321697523
             les_mean =     296.442537925703
             stat err =       0.000414654573
             autocorr =       1.255679966446
   target nu stat err =       0.000414654573
   target dn stat err =       0.002449160193
      target stat err =       0.004184137810
              std dev =       0.523321916491
             le_variance =       0.273865828280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370038555
  error estimate for blocks of size 2^( 2) =       0.000384189915
  error estimate for blocks of size 2^( 3) =       0.000397622468
  error estimate for blocks of size 2^( 4) =       0.000407025426
  error estimate for blocks of size 2^( 5) =       0.000413580604
  error estimate for blocks of size 2^( 6) =       0.000417049692
  error estimate for blocks of size 2^( 7) =       0.000420962571

      target function =      -0.941879236062
              le_mean =     -17.209321697523
             les_mean =     296.442537925703
             stat err =       0.000414654573
             autocorr =       1.255679966445
   target nu stat err =       0.000414654573
   target dn stat err =       0.002449160193
      target stat err =       0.004184137810
              std dev =       0.523321916491
             le_variance =       0.273865828280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370038555
  error estimate for blocks of size 2^( 2) =       0.000384189915
  error estimate for blocks of size 2^( 3) =       0.000397622468
  error estimate for blocks of size 2^( 4) =       0.000407025426
  error estimate for blocks of size 2^( 5) =       0.000413580604
  error estimate for blocks of size 2^( 6) =       0.000417049692
  error estimate for blocks of size 2^( 7) =       0.000420962571

      target function =      -0.941879236062
              le_mean =     -17.209321697523
             les_mean =     296.442537925703
             stat err =       0.000414654573
             autocorr =       1.255679966445
   target nu stat err =       0.000414654573
   target dn stat err =       0.002449160193
      target stat err =       0.004184137810
              std dev =       0.523321916491
             le_variance =       0.273865828280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273876314659
                                         uncertainty =       0.001842648525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370038555
  error estimate for blocks of size 2^( 2) =       0.000384189915
  error estimate for blocks of size 2^( 3) =       0.000397622468
  error estimate for blocks of size 2^( 4) =       0.000407025426
  error estimate for blocks of size 2^( 5) =       0.000413580604
  error estimate for blocks of size 2^( 6) =       0.000417049692
  error estimate for blocks of size 2^( 7) =       0.000420962571

      target function =      -0.941879236062
              le_mean =     -17.209321697523
             les_mean =     296.442537925703
             stat err =       0.000414654573
             autocorr =       1.255679966445
   target nu stat err =       0.000414654573
   target dn stat err =       0.002449160193
      target stat err =       0.004184137810
              std dev =       0.523321916491
             le_variance =       0.273865828280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941879236062        initial  <--
     3.6380e+36     3.6380e+37             0.0000e+00        -0.941879236062
     1.4552e+37     1.4552e+38             0.0000e+00        -0.941879236062
     5.8208e+37     5.8208e+38             0.0000e+00        -0.941879236062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9477
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2143
    reference variance = 0.31331
====================================================
  Execution time = 2.7028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8430e-01
  Total weights = 1.966394542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1983e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275747861917
                                         uncertainty =       0.001918919116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275747861917
                                         uncertainty =       0.001918919116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371333573
  error estimate for blocks of size 2^( 2) =       0.000385327353
  error estimate for blocks of size 2^( 3) =       0.000398547296
  error estimate for blocks of size 2^( 4) =       0.000407592348
  error estimate for blocks of size 2^( 5) =       0.000413098139
  error estimate for blocks of size 2^( 6) =       0.000416810691
  error estimate for blocks of size 2^( 7) =       0.000419261276

      target function =      -0.937658719132
              le_mean =     -17.209837320127
             les_mean =     296.462802708514
             stat err =       0.000414190613
             autocorr =       1.244148077123
   target nu stat err =       0.000414190613
   target dn stat err =       0.002187797536
      target stat err =       0.003722967763
              std dev =       0.525153376926
             le_variance =       0.275786069296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720983732013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+37, overlap shift 3.6380e+38 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+38, overlap shift 1.4552e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+38, overlap shift 5.8208e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937672473553       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.750207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5235e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2669
    reference variance = 0.175783
====================================================
  Execution time = 2.9554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8939e-01
  Total weights = 1.9664e+06
  Execution time = 2.3465e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371768471
  error estimate for blocks of size 2^( 2) =       0.000385904899
  error estimate for blocks of size 2^( 3) =       0.000398805713
  error estimate for blocks of size 2^( 4) =       0.000408060406
  error estimate for blocks of size 2^( 5) =       0.000414854242
  error estimate for blocks of size 2^( 6) =       0.000418531524
  error estimate for blocks of size 2^( 7) =       0.000419792836

      target function =      -0.929202178734
              le_mean =     -17.209863921495
             les_mean =     296.468804092701
             stat err =       0.000415309752
             autocorr =       1.247955633455
   target nu stat err =       0.000415309752
   target dn stat err =       0.004655948320
      target stat err =       0.007662686278
              std dev =       0.525768426419
             le_variance =       0.276432438219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371768471
  error estimate for blocks of size 2^( 2) =       0.000385904899
  error estimate for blocks of size 2^( 3) =       0.000398805713
  error estimate for blocks of size 2^( 4) =       0.000408060406
  error estimate for blocks of size 2^( 5) =       0.000414854242
  error estimate for blocks of size 2^( 6) =       0.000418531524
  error estimate for blocks of size 2^( 7) =       0.000419792836

      target function =      -0.929202178734
              le_mean =     -17.209863921495
             les_mean =     296.468804092701
             stat err =       0.000415309752
             autocorr =       1.247955633455
   target nu stat err =       0.000415309752
   target dn stat err =       0.004655948320
      target stat err =       0.007662686278
              std dev =       0.525768426419
             le_variance =       0.276432438219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371768471
  error estimate for blocks of size 2^( 2) =       0.000385904899
  error estimate for blocks of size 2^( 3) =       0.000398805713
  error estimate for blocks of size 2^( 4) =       0.000408060406
  error estimate for blocks of size 2^( 5) =       0.000414854242
  error estimate for blocks of size 2^( 6) =       0.000418531524
  error estimate for blocks of size 2^( 7) =       0.000419792836

      target function =      -0.929202178734
              le_mean =     -17.209863921495
             les_mean =     296.468804092701
             stat err =       0.000415309752
             autocorr =       1.247955633455
   target nu stat err =       0.000415309752
   target dn stat err =       0.004655948320
      target stat err =       0.007662686278
              std dev =       0.525768426419
             le_variance =       0.276432438219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276422688569
                                         uncertainty =       0.001632922781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371768471
  error estimate for blocks of size 2^( 2) =       0.000385904899
  error estimate for blocks of size 2^( 3) =       0.000398805713
  error estimate for blocks of size 2^( 4) =       0.000408060406
  error estimate for blocks of size 2^( 5) =       0.000414854242
  error estimate for blocks of size 2^( 6) =       0.000418531524
  error estimate for blocks of size 2^( 7) =       0.000419792836

      target function =      -0.929202178734
              le_mean =     -17.209863921495
             les_mean =     296.468804092701
             stat err =       0.000415309752
             autocorr =       1.247955633455
   target nu stat err =       0.000415309752
   target dn stat err =       0.004655948320
      target stat err =       0.007662686278
              std dev =       0.525768426419
             le_variance =       0.276432438219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929202178734        initial  <--
     3.6380e+37     3.6380e+38             0.0000e+00        -0.929202178734
     1.4552e+38     1.4552e+39             0.0000e+00        -0.929202178734
     5.8208e+38     5.8208e+39             0.0000e+00        -0.929202178734

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.2808
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2951
    reference variance = 0.209867
====================================================
  Execution time = 2.7271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0497e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8537e-01
  Total weights = 1.966234075e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1010e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276184401319
                                         uncertainty =       0.001658905757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276184401319
                                         uncertainty =       0.001658905757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371561920
  error estimate for blocks of size 2^( 2) =       0.000385827570
  error estimate for blocks of size 2^( 3) =       0.000399106001
  error estimate for blocks of size 2^( 4) =       0.000408922642
  error estimate for blocks of size 2^( 5) =       0.000415185695
  error estimate for blocks of size 2^( 6) =       0.000417934518
  error estimate for blocks of size 2^( 7) =       0.000423551927

      target function =      -0.935889560118
              le_mean =     -17.209150960270
             les_mean =     296.440251023701
             stat err =       0.000416398696
             autocorr =       1.255903650798
   target nu stat err =       0.000416398696
   target dn stat err =       0.002205054074
      target stat err =       0.003733229296
              std dev =       0.525476314599
             le_variance =       0.276125357204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720915096027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+38, overlap shift 3.6380e+39 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935903022782       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935903022782       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935903022782       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935903022782       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937500000000       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 4.28e+08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 5.14e+13           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+38 is 5.361605e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+39, overlap shift 1.4552e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935903022782       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935903022782       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935903022782       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935903022782       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937500000000       residual = 1.87e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.000000000000       residual = 5.64e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+39 is 1.340401e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+39, overlap shift 5.8208e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935903022782       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935903022782       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935903022782       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935903022782       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935903022782       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935903020763       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 7.23e+13           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+39 is 3.027333e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.753299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5382e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2583
    reference variance = 0.255898
====================================================
  Execution time = 2.7286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9194e-01
  Total weights = 1.9662e+06
  Execution time = 2.3192e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374545516
  error estimate for blocks of size 2^( 2) =       0.000388852277
  error estimate for blocks of size 2^( 3) =       0.000401493358
  error estimate for blocks of size 2^( 4) =       0.000411118023
  error estimate for blocks of size 2^( 5) =       0.000416898802
  error estimate for blocks of size 2^( 6) =       0.000420032814
  error estimate for blocks of size 2^( 7) =       0.000422922097

      target function =      -0.925074684203
              le_mean =     -17.209494730614
             les_mean =     296.458646424807
             stat err =       0.000417742934
             autocorr =       1.243967464954
   target nu stat err =       0.000417742934
   target dn stat err =       0.004060324050
      target stat err =       0.006628773742
              std dev =       0.529695822979
             le_variance =       0.280577664881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374545516
  error estimate for blocks of size 2^( 2) =       0.000388852277
  error estimate for blocks of size 2^( 3) =       0.000401493358
  error estimate for blocks of size 2^( 4) =       0.000411118023
  error estimate for blocks of size 2^( 5) =       0.000416898802
  error estimate for blocks of size 2^( 6) =       0.000420032814
  error estimate for blocks of size 2^( 7) =       0.000422922097

      target function =      -0.925074684203
              le_mean =     -17.209494730614
             les_mean =     296.458646424807
             stat err =       0.000417742934
             autocorr =       1.243967464961
   target nu stat err =       0.000417742934
   target dn stat err =       0.004060324050
      target stat err =       0.006628773742
              std dev =       0.529695822979
             le_variance =       0.280577664881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374545516
  error estimate for blocks of size 2^( 2) =       0.000388852277
  error estimate for blocks of size 2^( 3) =       0.000401493358
  error estimate for blocks of size 2^( 4) =       0.000411118023
  error estimate for blocks of size 2^( 5) =       0.000416898802
  error estimate for blocks of size 2^( 6) =       0.000420032814
  error estimate for blocks of size 2^( 7) =       0.000422922097

      target function =      -0.925074684203
              le_mean =     -17.209494730614
             les_mean =     296.458646424807
             stat err =       0.000417742934
             autocorr =       1.243967464961
   target nu stat err =       0.000417742934
   target dn stat err =       0.004060324050
      target stat err =       0.006628773742
              std dev =       0.529695822979
             le_variance =       0.280577664881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280585501584
                                         uncertainty =       0.002336517526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374545516
  error estimate for blocks of size 2^( 2) =       0.000388852277
  error estimate for blocks of size 2^( 3) =       0.000401493358
  error estimate for blocks of size 2^( 4) =       0.000411118023
  error estimate for blocks of size 2^( 5) =       0.000416898802
  error estimate for blocks of size 2^( 6) =       0.000420032814
  error estimate for blocks of size 2^( 7) =       0.000422922097

      target function =      -0.925074684203
              le_mean =     -17.209494730614
             les_mean =     296.458646424807
             stat err =       0.000417742934
             autocorr =       1.243967464961
   target nu stat err =       0.000417742934
   target dn stat err =       0.004060324050
      target stat err =       0.006628773742
              std dev =       0.529695822979
             le_variance =       0.280577664881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.925074684203        initial  <--
     3.6380e+38     3.6380e+39             5.3616e-43        -0.925074684203
     1.4552e+39     1.4552e+40             1.3404e-43        -0.925074684203
     5.8208e+39     5.8208e+40             3.0273e-44        -0.925074684203

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9514
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2446
    reference variance = 0.159623
====================================================
  Execution time = 2.7066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0479e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8974e-01
  Total weights = 1.966105312e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3087e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711532950
                                         uncertainty =       0.001741217718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277711532950
                                         uncertainty =       0.001741217718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372619321
  error estimate for blocks of size 2^( 2) =       0.000387082505
  error estimate for blocks of size 2^( 3) =       0.000400767168
  error estimate for blocks of size 2^( 4) =       0.000410391382
  error estimate for blocks of size 2^( 5) =       0.000415319907
  error estimate for blocks of size 2^( 6) =       0.000418507073
  error estimate for blocks of size 2^( 7) =       0.000422314333

      target function =      -0.928696456301
              le_mean =     -17.209075904871
             les_mean =     296.442030491335
             stat err =       0.000416633174
             autocorr =       1.250192686724
   target nu stat err =       0.000416633174
   target dn stat err =       0.002940096653
      target stat err =       0.004859606968
              std dev =       0.526971728571
             le_variance =       0.277699202714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720907590487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+39, overlap shift 3.6380e+40 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928720738011       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928720738011       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928710937500       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+39 is 2.469949e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+40, overlap shift 1.4552e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928720738011       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928720738011       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928710937500       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+40 is 6.174873e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+40, overlap shift 5.8208e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928720738011       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928720738011       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928710937500       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+40 is 1.543718e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.754876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5383e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.206164
====================================================
  Execution time = 2.7011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8568e-01
  Total weights = 1.9663e+06
  Execution time = 2.3147e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371846075
  error estimate for blocks of size 2^( 2) =       0.000385714390
  error estimate for blocks of size 2^( 3) =       0.000398925906
  error estimate for blocks of size 2^( 4) =       0.000408633661
  error estimate for blocks of size 2^( 5) =       0.000414229489
  error estimate for blocks of size 2^( 6) =       0.000417408243
  error estimate for blocks of size 2^( 7) =       0.000422192668

      target function =      -0.935354055335
              le_mean =     -17.210233908161
             les_mean =     296.477832794895
             stat err =       0.000415616015
             autocorr =       1.249275277453
   target nu stat err =       0.000415616015
   target dn stat err =       0.002122965129
      target stat err =       0.003602862032
              std dev =       0.525878176096
             le_variance =       0.276547856094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371846075
  error estimate for blocks of size 2^( 2) =       0.000385714390
  error estimate for blocks of size 2^( 3) =       0.000398925906
  error estimate for blocks of size 2^( 4) =       0.000408633661
  error estimate for blocks of size 2^( 5) =       0.000414229489
  error estimate for blocks of size 2^( 6) =       0.000417408243
  error estimate for blocks of size 2^( 7) =       0.000422192668

      target function =      -0.935354055335
              le_mean =     -17.210233908161
             les_mean =     296.477832794895
             stat err =       0.000415616015
             autocorr =       1.249275277453
   target nu stat err =       0.000415616015
   target dn stat err =       0.002122965129
      target stat err =       0.003602862032
              std dev =       0.525878176096
             le_variance =       0.276547856094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371846075
  error estimate for blocks of size 2^( 2) =       0.000385714390
  error estimate for blocks of size 2^( 3) =       0.000398925906
  error estimate for blocks of size 2^( 4) =       0.000408633661
  error estimate for blocks of size 2^( 5) =       0.000414229489
  error estimate for blocks of size 2^( 6) =       0.000417408243
  error estimate for blocks of size 2^( 7) =       0.000422192668

      target function =      -0.935354055335
              le_mean =     -17.210233908161
             les_mean =     296.477832794895
             stat err =       0.000415616015
             autocorr =       1.249275277453
   target nu stat err =       0.000415616015
   target dn stat err =       0.002122965129
      target stat err =       0.003602862032
              std dev =       0.525878176096
             le_variance =       0.276547856094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276570897732
                                         uncertainty =       0.001394488961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371846075
  error estimate for blocks of size 2^( 2) =       0.000385714390
  error estimate for blocks of size 2^( 3) =       0.000398925906
  error estimate for blocks of size 2^( 4) =       0.000408633661
  error estimate for blocks of size 2^( 5) =       0.000414229489
  error estimate for blocks of size 2^( 6) =       0.000417408243
  error estimate for blocks of size 2^( 7) =       0.000422192668

      target function =      -0.935354055335
              le_mean =     -17.210233908161
             les_mean =     296.477832794895
             stat err =       0.000415616015
             autocorr =       1.249275277453
   target nu stat err =       0.000415616015
   target dn stat err =       0.002122965129
      target stat err =       0.003602862032
              std dev =       0.525878176096
             le_variance =       0.276547856094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935354055335        initial  <--
     3.6380e+39     3.6380e+40             2.4699e-44        -0.935354055335
     1.4552e+40     1.4552e+41             6.1749e-45        -0.935354055335
     5.8208e+40     5.8208e+41             1.5437e-45        -0.935354055335

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6632
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.165309
====================================================
  Execution time = 2.7311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0458e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8901e-01
  Total weights = 1.966423942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2314e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278560174435
                                         uncertainty =       0.001654720922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278560174435
                                         uncertainty =       0.001654720922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373167838
  error estimate for blocks of size 2^( 2) =       0.000387523256
  error estimate for blocks of size 2^( 3) =       0.000400741866
  error estimate for blocks of size 2^( 4) =       0.000410216876
  error estimate for blocks of size 2^( 5) =       0.000415625757
  error estimate for blocks of size 2^( 6) =       0.000418578907
  error estimate for blocks of size 2^( 7) =       0.000420791619

      target function =      -0.929866414184
              le_mean =     -17.209843618052
             les_mean =     296.467725775149
             stat err =       0.000416303290
             autocorr =       1.244546915487
   target nu stat err =       0.000416303290
   target dn stat err =       0.002696726843
      target stat err =       0.004484422222
              std dev =       0.527747461269
             le_variance =       0.278517382876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720984361805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+40, overlap shift 3.6380e+41 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+41, overlap shift 1.4552e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+41, overlap shift 5.8208e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.929887040851       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.756132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5551e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2303
    reference variance = 0.24554
====================================================
  Execution time = 2.7059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9215e-01
  Total weights = 1.9662e+06
  Execution time = 2.3161e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375788604
  error estimate for blocks of size 2^( 2) =       0.000389664668
  error estimate for blocks of size 2^( 3) =       0.000402207671
  error estimate for blocks of size 2^( 4) =       0.000411730135
  error estimate for blocks of size 2^( 5) =       0.000418209857
  error estimate for blocks of size 2^( 6) =       0.000421450161
  error estimate for blocks of size 2^( 7) =       0.000422868647

      target function =      -0.924654117170
              le_mean =     -17.209310488579
             les_mean =     296.452521827187
             stat err =       0.000418564700
             autocorr =       1.240617733921
   target nu stat err =       0.000418564700
   target dn stat err =       0.006588618902
      target stat err =       0.010703096207
              std dev =       0.531453844044
             le_variance =       0.282443188349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375788604
  error estimate for blocks of size 2^( 2) =       0.000389664668
  error estimate for blocks of size 2^( 3) =       0.000402207671
  error estimate for blocks of size 2^( 4) =       0.000411730135
  error estimate for blocks of size 2^( 5) =       0.000418209857
  error estimate for blocks of size 2^( 6) =       0.000421450161
  error estimate for blocks of size 2^( 7) =       0.000422868647

      target function =      -0.924654117170
              le_mean =     -17.209310488579
             les_mean =     296.452521827187
             stat err =       0.000418564700
             autocorr =       1.240617733921
   target nu stat err =       0.000418564700
   target dn stat err =       0.006588618902
      target stat err =       0.010703096207
              std dev =       0.531453844044
             le_variance =       0.282443188349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375788604
  error estimate for blocks of size 2^( 2) =       0.000389664668
  error estimate for blocks of size 2^( 3) =       0.000402207671
  error estimate for blocks of size 2^( 4) =       0.000411730135
  error estimate for blocks of size 2^( 5) =       0.000418209857
  error estimate for blocks of size 2^( 6) =       0.000421450161
  error estimate for blocks of size 2^( 7) =       0.000422868647

      target function =      -0.924654117170
              le_mean =     -17.209310488579
             les_mean =     296.452521827187
             stat err =       0.000418564700
             autocorr =       1.240617733921
   target nu stat err =       0.000418564700
   target dn stat err =       0.006588618902
      target stat err =       0.010703096207
              std dev =       0.531453844044
             le_variance =       0.282443188349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282496215283
                                         uncertainty =       0.006177473702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375788604
  error estimate for blocks of size 2^( 2) =       0.000389664668
  error estimate for blocks of size 2^( 3) =       0.000402207671
  error estimate for blocks of size 2^( 4) =       0.000411730135
  error estimate for blocks of size 2^( 5) =       0.000418209857
  error estimate for blocks of size 2^( 6) =       0.000421450161
  error estimate for blocks of size 2^( 7) =       0.000422868647

      target function =      -0.924654117170
              le_mean =     -17.209310488579
             les_mean =     296.452521827187
             stat err =       0.000418564700
             autocorr =       1.240617733921
   target nu stat err =       0.000418564700
   target dn stat err =       0.006588618902
      target stat err =       0.010703096207
              std dev =       0.531453844044
             le_variance =       0.282443188349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924654117170        initial  <--
     3.6380e+40     3.6380e+41             0.0000e+00        -0.924654117170
     1.4552e+41     1.4552e+42             0.0000e+00        -0.924654117170
     5.8208e+41     5.8208e+42             0.0000e+00        -0.924654117170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7219
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.196572
====================================================
  Execution time = 2.7191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0461e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8670e-01
  Total weights = 1.966498731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1592e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276160528866
                                         uncertainty =       0.001625676527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276160528866
                                         uncertainty =       0.001625676527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371572889
  error estimate for blocks of size 2^( 2) =       0.000385538191
  error estimate for blocks of size 2^( 3) =       0.000398401515
  error estimate for blocks of size 2^( 4) =       0.000408068138
  error estimate for blocks of size 2^( 5) =       0.000412904418
  error estimate for blocks of size 2^( 6) =       0.000415400037
  error estimate for blocks of size 2^( 7) =       0.000417882947

      target function =      -0.933659797224
              le_mean =     -17.210231439348
             les_mean =     296.478766128336
             stat err =       0.000413563885
             autocorr =       1.238788528173
   target nu stat err =       0.000413563885
   target dn stat err =       0.002558025740
      target stat err =       0.004296757232
              std dev =       0.525491826817
             le_variance =       0.276141660051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721023143935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+41, overlap shift 3.6380e+42 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+42, overlap shift 1.4552e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+42, overlap shift 5.8208e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933678532014       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.757384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5359e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2504
    reference variance = 0.349347
====================================================
  Execution time = 2.9219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8782e-01
  Total weights = 1.9664e+06
  Execution time = 2.3285e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372501245
  error estimate for blocks of size 2^( 2) =       0.000386791412
  error estimate for blocks of size 2^( 3) =       0.000399815880
  error estimate for blocks of size 2^( 4) =       0.000409216298
  error estimate for blocks of size 2^( 5) =       0.000414954712
  error estimate for blocks of size 2^( 6) =       0.000418721418
  error estimate for blocks of size 2^( 7) =       0.000420234938

      target function =      -0.931793985525
              le_mean =     -17.209477616997
             les_mean =     296.453942606140
             stat err =       0.000415781841
             autocorr =       1.245878178604
   target nu stat err =       0.000415781841
   target dn stat err =       0.004326244881
      target stat err =       0.007159571645
              std dev =       0.526804741331
             le_variance =       0.277523235488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372501245
  error estimate for blocks of size 2^( 2) =       0.000386791412
  error estimate for blocks of size 2^( 3) =       0.000399815880
  error estimate for blocks of size 2^( 4) =       0.000409216298
  error estimate for blocks of size 2^( 5) =       0.000414954712
  error estimate for blocks of size 2^( 6) =       0.000418721418
  error estimate for blocks of size 2^( 7) =       0.000420234938

      target function =      -0.931793985525
              le_mean =     -17.209477616997
             les_mean =     296.453942606140
             stat err =       0.000415781841
             autocorr =       1.245878178606
   target nu stat err =       0.000415781841
   target dn stat err =       0.004326244881
      target stat err =       0.007159571645
              std dev =       0.526804741331
             le_variance =       0.277523235488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372501245
  error estimate for blocks of size 2^( 2) =       0.000386791412
  error estimate for blocks of size 2^( 3) =       0.000399815880
  error estimate for blocks of size 2^( 4) =       0.000409216298
  error estimate for blocks of size 2^( 5) =       0.000414954712
  error estimate for blocks of size 2^( 6) =       0.000418721418
  error estimate for blocks of size 2^( 7) =       0.000420234938

      target function =      -0.931793985525
              le_mean =     -17.209477616997
             les_mean =     296.453942606140
             stat err =       0.000415781841
             autocorr =       1.245878178606
   target nu stat err =       0.000415781841
   target dn stat err =       0.004326244881
      target stat err =       0.007159571645
              std dev =       0.526804741331
             le_variance =       0.277523235488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277441858041
                                         uncertainty =       0.002232845692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372501245
  error estimate for blocks of size 2^( 2) =       0.000386791412
  error estimate for blocks of size 2^( 3) =       0.000399815880
  error estimate for blocks of size 2^( 4) =       0.000409216298
  error estimate for blocks of size 2^( 5) =       0.000414954712
  error estimate for blocks of size 2^( 6) =       0.000418721418
  error estimate for blocks of size 2^( 7) =       0.000420234938

      target function =      -0.931793985525
              le_mean =     -17.209477616997
             les_mean =     296.453942606140
             stat err =       0.000415781841
             autocorr =       1.245878178606
   target nu stat err =       0.000415781841
   target dn stat err =       0.004326244881
      target stat err =       0.007159571645
              std dev =       0.526804741331
             le_variance =       0.277523235488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931793985525        initial  <--
     3.6380e+41     3.6380e+42             0.0000e+00        -0.931793985525
     1.4552e+42     1.4552e+43             0.0000e+00        -0.931793985525
     5.8208e+42     5.8208e+43             0.0000e+00        -0.931793985525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0307
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6396e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2091
    reference variance = 0.204708
====================================================
  Execution time = 2.6906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8466e-01
  Total weights = 1.966339329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1013e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275110431710
                                         uncertainty =       0.001609208323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275110431710
                                         uncertainty =       0.001609208323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370909038
  error estimate for blocks of size 2^( 2) =       0.000385329375
  error estimate for blocks of size 2^( 3) =       0.000398533284
  error estimate for blocks of size 2^( 4) =       0.000408446174
  error estimate for blocks of size 2^( 5) =       0.000415332385
  error estimate for blocks of size 2^( 6) =       0.000418886981
  error estimate for blocks of size 2^( 7) =       0.000422345390

      target function =      -0.937081163885
              le_mean =     -17.209333525070
             les_mean =     296.445815496177
             stat err =       0.000416252733
             autocorr =       1.259445454598
   target nu stat err =       0.000416252733
   target dn stat err =       0.002813170987
      target stat err =       0.004740227947
              std dev =       0.524552984619
             le_variance =       0.275155833673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720933352507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+42, overlap shift 3.6380e+43 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937094457303       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937094457303       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937094457303       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937094457303       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937094457303       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.74e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+42 is 3.441458e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+43, overlap shift 1.4552e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937094457303       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937094457303       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937094457303       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+43 is 1.081371e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+43, overlap shift 5.8208e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937094457303       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937094457303       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937500000000       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937094457271       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 3.80e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 5.45e+11           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+43 is 2.677810e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.759768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5017e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.453202
====================================================
  Execution time = 2.6842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8680e-01
  Total weights = 1.9662e+06
  Execution time = 2.3358e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439809
  error estimate for blocks of size 2^( 2) =       0.000386214986
  error estimate for blocks of size 2^( 3) =       0.000399016982
  error estimate for blocks of size 2^( 4) =       0.000408718559
  error estimate for blocks of size 2^( 5) =       0.000414227657
  error estimate for blocks of size 2^( 6) =       0.000417750068
  error estimate for blocks of size 2^( 7) =       0.000421871148

      target function =      -0.933497532710
              le_mean =     -17.209978513147
             les_mean =     296.470161086677
             stat err =       0.000415641858
             autocorr =       1.252165288359
   target nu stat err =       0.000415641858
   target dn stat err =       0.002751222009
      target stat err =       0.004608953011
              std dev =       0.525303620279
             le_variance =       0.275943893478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439809
  error estimate for blocks of size 2^( 2) =       0.000386214986
  error estimate for blocks of size 2^( 3) =       0.000399016982
  error estimate for blocks of size 2^( 4) =       0.000408718559
  error estimate for blocks of size 2^( 5) =       0.000414227657
  error estimate for blocks of size 2^( 6) =       0.000417750068
  error estimate for blocks of size 2^( 7) =       0.000421871148

      target function =      -0.933497532710
              le_mean =     -17.209978513147
             les_mean =     296.470161086677
             stat err =       0.000415641858
             autocorr =       1.252165288350
   target nu stat err =       0.000415641858
   target dn stat err =       0.002751222009
      target stat err =       0.004608953011
              std dev =       0.525303620279
             le_variance =       0.275943893478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439809
  error estimate for blocks of size 2^( 2) =       0.000386214986
  error estimate for blocks of size 2^( 3) =       0.000399016982
  error estimate for blocks of size 2^( 4) =       0.000408718559
  error estimate for blocks of size 2^( 5) =       0.000414227657
  error estimate for blocks of size 2^( 6) =       0.000417750068
  error estimate for blocks of size 2^( 7) =       0.000421871148

      target function =      -0.933497532710
              le_mean =     -17.209978513147
             les_mean =     296.470161086677
             stat err =       0.000415641858
             autocorr =       1.252165288350
   target nu stat err =       0.000415641858
   target dn stat err =       0.002751222009
      target stat err =       0.004608953011
              std dev =       0.525303620279
             le_variance =       0.275943893478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275950163481
                                         uncertainty =       0.001689340174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439809
  error estimate for blocks of size 2^( 2) =       0.000386214986
  error estimate for blocks of size 2^( 3) =       0.000399016982
  error estimate for blocks of size 2^( 4) =       0.000408718559
  error estimate for blocks of size 2^( 5) =       0.000414227657
  error estimate for blocks of size 2^( 6) =       0.000417750068
  error estimate for blocks of size 2^( 7) =       0.000421871148

      target function =      -0.933497532710
              le_mean =     -17.209978513147
             les_mean =     296.470161086677
             stat err =       0.000415641858
             autocorr =       1.252165288350
   target nu stat err =       0.000415641858
   target dn stat err =       0.002751222009
      target stat err =       0.004608953011
              std dev =       0.525303620279
             le_variance =       0.275943893478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933497532710        initial  <--
     3.6380e+42     3.6380e+43             3.4415e-47        -0.933497532710
     1.4552e+43     1.4552e+44             1.0814e-47        -0.933497532710
     5.8208e+43     5.8208e+44             2.6778e-48        -0.933497532710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6625
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.135679
====================================================
  Execution time = 2.7118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0484e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8994e-01
  Total weights = 1.966203291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0959e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280064765444
                                         uncertainty =       0.002472153370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280064765444
                                         uncertainty =       0.002472153370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374169297
  error estimate for blocks of size 2^( 2) =       0.000388340907
  error estimate for blocks of size 2^( 3) =       0.000401833871
  error estimate for blocks of size 2^( 4) =       0.000411544907
  error estimate for blocks of size 2^( 5) =       0.000417534895
  error estimate for blocks of size 2^( 6) =       0.000420222898
  error estimate for blocks of size 2^( 7) =       0.000422611056

      target function =      -0.928327970621
              le_mean =     -17.210127660324
             les_mean =     296.478435248196
             stat err =       0.000417978439
             autocorr =       1.247876089170
   target nu stat err =       0.000417978439
   target dn stat err =       0.002693762613
      target stat err =       0.004467906832
              std dev =       0.529163761211
             le_variance =       0.280014286179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721012766032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+43, overlap shift 3.6380e+44 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928348573044       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928348573044       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928348573044       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+43 is 3.454318e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+44, overlap shift 1.4552e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928348573044       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928348573044       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928348573044       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+44 is 1.214696e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+44, overlap shift 5.8208e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928348573044       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928348573044       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928348573044       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+44 is 3.036741e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.761331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5223e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.120328
====================================================
  Execution time = 2.7029e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8461e-01
  Total weights = 1.9664e+06
  Execution time = 2.3416e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372321608
  error estimate for blocks of size 2^( 2) =       0.000386866175
  error estimate for blocks of size 2^( 3) =       0.000399764453
  error estimate for blocks of size 2^( 4) =       0.000409321417
  error estimate for blocks of size 2^( 5) =       0.000415166952
  error estimate for blocks of size 2^( 6) =       0.000418932174
  error estimate for blocks of size 2^( 7) =       0.000419737038

      target function =      -0.937151775911
              le_mean =     -17.209702604593
             les_mean =     296.458470873536
             stat err =       0.000415789395
             autocorr =       1.247125997435
   target nu stat err =       0.000415789395
   target dn stat err =       0.002304309274
      target stat err =       0.003909045557
              std dev =       0.526550692672
             le_variance =       0.277255631953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372321608
  error estimate for blocks of size 2^( 2) =       0.000386866175
  error estimate for blocks of size 2^( 3) =       0.000399764453
  error estimate for blocks of size 2^( 4) =       0.000409321417
  error estimate for blocks of size 2^( 5) =       0.000415166952
  error estimate for blocks of size 2^( 6) =       0.000418932174
  error estimate for blocks of size 2^( 7) =       0.000419737038

      target function =      -0.937151775911
              le_mean =     -17.209702604593
             les_mean =     296.458470873536
             stat err =       0.000415789395
             autocorr =       1.247125997435
   target nu stat err =       0.000415789395
   target dn stat err =       0.002304309274
      target stat err =       0.003909045557
              std dev =       0.526550692672
             le_variance =       0.277255631953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372321608
  error estimate for blocks of size 2^( 2) =       0.000386866175
  error estimate for blocks of size 2^( 3) =       0.000399764453
  error estimate for blocks of size 2^( 4) =       0.000409321417
  error estimate for blocks of size 2^( 5) =       0.000415166952
  error estimate for blocks of size 2^( 6) =       0.000418932174
  error estimate for blocks of size 2^( 7) =       0.000419737038

      target function =      -0.937151775911
              le_mean =     -17.209702604593
             les_mean =     296.458470873536
             stat err =       0.000415789395
             autocorr =       1.247125997435
   target nu stat err =       0.000415789395
   target dn stat err =       0.002304309274
      target stat err =       0.003909045557
              std dev =       0.526550692672
             le_variance =       0.277255631953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277299827584
                                         uncertainty =       0.001955035787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372321608
  error estimate for blocks of size 2^( 2) =       0.000386866175
  error estimate for blocks of size 2^( 3) =       0.000399764453
  error estimate for blocks of size 2^( 4) =       0.000409321417
  error estimate for blocks of size 2^( 5) =       0.000415166952
  error estimate for blocks of size 2^( 6) =       0.000418932174
  error estimate for blocks of size 2^( 7) =       0.000419737038

      target function =      -0.937151775911
              le_mean =     -17.209702604593
             les_mean =     296.458470873536
             stat err =       0.000415789395
             autocorr =       1.247125997435
   target nu stat err =       0.000415789395
   target dn stat err =       0.002304309274
      target stat err =       0.003909045557
              std dev =       0.526550692672
             le_variance =       0.277255631953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937151775911        initial  <--
     3.6380e+43     3.6380e+44             3.4543e-48        -0.937151775911
     1.4552e+44     1.4552e+45             1.2147e-48        -0.937151775911
     5.8208e+44     5.8208e+45             3.0367e-49        -0.937151775911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.8665
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.179155
====================================================
  Execution time = 2.6971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0502e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9005e-01
  Total weights = 1.966475699e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3217e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296478548
                                         uncertainty =       0.001530198201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276296478548
                                         uncertainty =       0.001530198201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371659831
  error estimate for blocks of size 2^( 2) =       0.000385720501
  error estimate for blocks of size 2^( 3) =       0.000398555850
  error estimate for blocks of size 2^( 4) =       0.000408099654
  error estimate for blocks of size 2^( 5) =       0.000414011169
  error estimate for blocks of size 2^( 6) =       0.000416249523
  error estimate for blocks of size 2^( 7) =       0.000416682374

      target function =      -0.928118722377
              le_mean =     -17.210220897420
             les_mean =     296.481749278855
             stat err =       0.000413760680
             autocorr =       1.239387702523
   target nu stat err =       0.000413760680
   target dn stat err =       0.004372031239
      target stat err =       0.007187666194
              std dev =       0.525614783774
             le_variance =       0.276270900921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721022089742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+44, overlap shift 3.6380e+45 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928173551682       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928173551682       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928173551682       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+44 is 5.189866e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+45, overlap shift 1.4552e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928173551682       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928173551682       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928173551682       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+45 is 1.297467e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+45, overlap shift 5.8208e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928173551682       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928173551682       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928173551682       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+45 is 3.243667e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.762894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5302e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.475959
====================================================
  Execution time = 2.6918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8566e-01
  Total weights = 1.9665e+06
  Execution time = 2.3390e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371467896
  error estimate for blocks of size 2^( 2) =       0.000386058130
  error estimate for blocks of size 2^( 3) =       0.000399112112
  error estimate for blocks of size 2^( 4) =       0.000408453526
  error estimate for blocks of size 2^( 5) =       0.000414367240
  error estimate for blocks of size 2^( 6) =       0.000416949846
  error estimate for blocks of size 2^( 7) =       0.000420395113

      target function =      -0.935393368355
              le_mean =     -17.210192944867
             les_mean =     296.476397716245
             stat err =       0.000415041431
             autocorr =       1.248361398405
   target nu stat err =       0.000415041431
   target dn stat err =       0.002393728639
      target stat err =       0.004043985259
              std dev =       0.525343342406
             le_variance =       0.275985627410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371467896
  error estimate for blocks of size 2^( 2) =       0.000386058130
  error estimate for blocks of size 2^( 3) =       0.000399112112
  error estimate for blocks of size 2^( 4) =       0.000408453526
  error estimate for blocks of size 2^( 5) =       0.000414367240
  error estimate for blocks of size 2^( 6) =       0.000416949846
  error estimate for blocks of size 2^( 7) =       0.000420395113

      target function =      -0.935393368355
              le_mean =     -17.210192944867
             les_mean =     296.476397716245
             stat err =       0.000415041431
             autocorr =       1.248361398405
   target nu stat err =       0.000415041431
   target dn stat err =       0.002393728639
      target stat err =       0.004043985259
              std dev =       0.525343342406
             le_variance =       0.275985627410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371467896
  error estimate for blocks of size 2^( 2) =       0.000386058130
  error estimate for blocks of size 2^( 3) =       0.000399112112
  error estimate for blocks of size 2^( 4) =       0.000408453526
  error estimate for blocks of size 2^( 5) =       0.000414367240
  error estimate for blocks of size 2^( 6) =       0.000416949846
  error estimate for blocks of size 2^( 7) =       0.000420395113

      target function =      -0.935393368355
              le_mean =     -17.210192944867
             les_mean =     296.476397716245
             stat err =       0.000415041431
             autocorr =       1.248361398405
   target nu stat err =       0.000415041431
   target dn stat err =       0.002393728639
      target stat err =       0.004043985259
              std dev =       0.525343342406
             le_variance =       0.275985627410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275992282641
                                         uncertainty =       0.001707322381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371467896
  error estimate for blocks of size 2^( 2) =       0.000386058130
  error estimate for blocks of size 2^( 3) =       0.000399112112
  error estimate for blocks of size 2^( 4) =       0.000408453526
  error estimate for blocks of size 2^( 5) =       0.000414367240
  error estimate for blocks of size 2^( 6) =       0.000416949846
  error estimate for blocks of size 2^( 7) =       0.000420395113

      target function =      -0.935393368355
              le_mean =     -17.210192944867
             les_mean =     296.476397716245
             stat err =       0.000415041431
             autocorr =       1.248361398405
   target nu stat err =       0.000415041431
   target dn stat err =       0.002393728639
      target stat err =       0.004043985259
              std dev =       0.525343342406
             le_variance =       0.275985627410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935393368355        initial  <--
     3.6380e+44     3.6380e+45             5.1899e-49        -0.935393368355
     1.4552e+45     1.4552e+46             1.2975e-49        -0.935393368355
     5.8208e+45     5.8208e+46             3.2437e-50        -0.935393368355

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.7537
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2981
    reference variance = 0.293758
====================================================
  Execution time = 2.7067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8436e-01
  Total weights = 1.966337654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2107e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482853088
                                         uncertainty =       0.001400108083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482853088
                                         uncertainty =       0.001400108083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371216006
  error estimate for blocks of size 2^( 2) =       0.000385407359
  error estimate for blocks of size 2^( 3) =       0.000398554744
  error estimate for blocks of size 2^( 4) =       0.000408904219
  error estimate for blocks of size 2^( 5) =       0.000414308204
  error estimate for blocks of size 2^( 6) =       0.000418094926
  error estimate for blocks of size 2^( 7) =       0.000420487441

      target function =      -0.937584811538
              le_mean =     -17.208917975259
             les_mean =     296.431217074100
             stat err =       0.000415448697
             autocorr =       1.252510618680
   target nu stat err =       0.000415448697
   target dn stat err =       0.001898101222
      target stat err =       0.003245044998
              std dev =       0.524987109469
             le_variance =       0.275611465108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720891797526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+45, overlap shift 3.6380e+46 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+46, overlap shift 1.4552e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+46, overlap shift 5.8208e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937594834263       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.764121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5287e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1804
    reference variance = 0.334659
====================================================
  Execution time = 2.8906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8874e-01
  Total weights = 1.9663e+06
  Execution time = 2.3049e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373312094
  error estimate for blocks of size 2^( 2) =       0.000387810077
  error estimate for blocks of size 2^( 3) =       0.000400815372
  error estimate for blocks of size 2^( 4) =       0.000410448000
  error estimate for blocks of size 2^( 5) =       0.000414872412
  error estimate for blocks of size 2^( 6) =       0.000418238017
  error estimate for blocks of size 2^( 7) =       0.000417827681

      target function =      -0.930307157575
              le_mean =     -17.209763083243
             les_mean =     296.464689758751
             stat err =       0.000415346528
             autocorr =       1.237875728653
   target nu stat err =       0.000415346528
   target dn stat err =       0.002381053477
      target stat err =       0.003977234987
              std dev =       0.527951473772
             le_variance =       0.278732758658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373312094
  error estimate for blocks of size 2^( 2) =       0.000387810077
  error estimate for blocks of size 2^( 3) =       0.000400815372
  error estimate for blocks of size 2^( 4) =       0.000410448000
  error estimate for blocks of size 2^( 5) =       0.000414872412
  error estimate for blocks of size 2^( 6) =       0.000418238017
  error estimate for blocks of size 2^( 7) =       0.000417827681

      target function =      -0.930307157575
              le_mean =     -17.209763083243
             les_mean =     296.464689758751
             stat err =       0.000415346528
             autocorr =       1.237875728653
   target nu stat err =       0.000415346528
   target dn stat err =       0.002381053477
      target stat err =       0.003977234987
              std dev =       0.527951473772
             le_variance =       0.278732758658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373312094
  error estimate for blocks of size 2^( 2) =       0.000387810077
  error estimate for blocks of size 2^( 3) =       0.000400815372
  error estimate for blocks of size 2^( 4) =       0.000410448000
  error estimate for blocks of size 2^( 5) =       0.000414872412
  error estimate for blocks of size 2^( 6) =       0.000418238017
  error estimate for blocks of size 2^( 7) =       0.000417827681

      target function =      -0.930307157575
              le_mean =     -17.209763083243
             les_mean =     296.464689758751
             stat err =       0.000415346528
             autocorr =       1.237875728653
   target nu stat err =       0.000415346528
   target dn stat err =       0.002381053477
      target stat err =       0.003977234987
              std dev =       0.527951473772
             le_variance =       0.278732758658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278731003789
                                         uncertainty =       0.001615626866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373312094
  error estimate for blocks of size 2^( 2) =       0.000387810077
  error estimate for blocks of size 2^( 3) =       0.000400815372
  error estimate for blocks of size 2^( 4) =       0.000410448000
  error estimate for blocks of size 2^( 5) =       0.000414872412
  error estimate for blocks of size 2^( 6) =       0.000418238017
  error estimate for blocks of size 2^( 7) =       0.000417827681

      target function =      -0.930307157575
              le_mean =     -17.209763083243
             les_mean =     296.464689758751
             stat err =       0.000415346528
             autocorr =       1.237875728653
   target nu stat err =       0.000415346528
   target dn stat err =       0.002381053477
      target stat err =       0.003977234987
              std dev =       0.527951473772
             le_variance =       0.278732758658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930307157575        initial  <--
     3.6380e+45     3.6380e+46             0.0000e+00        -0.930307157575
     1.4552e+46     1.4552e+47             0.0000e+00        -0.930307157575
     5.8208e+46     5.8208e+47             0.0000e+00        -0.930307157575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5853
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2369
    reference variance = 0.183199
====================================================
  Execution time = 2.7307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0482e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8856e-01
  Total weights = 1.966277493e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2999e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278195287866
                                         uncertainty =       0.003055749004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278195287866
                                         uncertainty =       0.003055749004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372932080
  error estimate for blocks of size 2^( 2) =       0.000387004840
  error estimate for blocks of size 2^( 3) =       0.000400096233
  error estimate for blocks of size 2^( 4) =       0.000409734008
  error estimate for blocks of size 2^( 5) =       0.000417349813
  error estimate for blocks of size 2^( 6) =       0.000420210030
  error estimate for blocks of size 2^( 7) =       0.000419636973

      target function =      -0.930554743131
              le_mean =     -17.210286355380
             les_mean =     296.482516249814
             stat err =       0.000416732706
             autocorr =       1.248693023450
   target nu stat err =       0.000416732706
   target dn stat err =       0.004310537042
      target stat err =       0.007126090161
              std dev =       0.527414043415
             le_variance =       0.278165573191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721028635538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+46, overlap shift 3.6380e+47 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930608402160       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930608402160       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937500000000       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+46 is 3.244132e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+47, overlap shift 1.4552e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930608402160       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930608402160       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875000000000       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930608402160       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+47 is 8.110329e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+47, overlap shift 5.8208e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930608402160       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930608402160       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.000000000000       residual = 4.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+47 is 2.027582e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.765841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5616e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.3069
    reference variance = 0.294417
====================================================
  Execution time = 2.7511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8129e-01
  Total weights = 1.9666e+06
  Execution time = 2.3097e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369632528
  error estimate for blocks of size 2^( 2) =       0.000384097523
  error estimate for blocks of size 2^( 3) =       0.000397310983
  error estimate for blocks of size 2^( 4) =       0.000406446845
  error estimate for blocks of size 2^( 5) =       0.000411058846
  error estimate for blocks of size 2^( 6) =       0.000413106821
  error estimate for blocks of size 2^( 7) =       0.000413457153

      target function =      -0.942712939278
              le_mean =     -17.209588413497
             les_mean =     296.451225921671
             stat err =       0.000411017416
             autocorr =       1.236460035747
   target nu stat err =       0.000411017416
   target dn stat err =       0.001803396448
      target stat err =       0.003126756892
              std dev =       0.522747698311
             le_variance =       0.273265156089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369632528
  error estimate for blocks of size 2^( 2) =       0.000384097523
  error estimate for blocks of size 2^( 3) =       0.000397310983
  error estimate for blocks of size 2^( 4) =       0.000406446845
  error estimate for blocks of size 2^( 5) =       0.000411058846
  error estimate for blocks of size 2^( 6) =       0.000413106821
  error estimate for blocks of size 2^( 7) =       0.000413457153

      target function =      -0.942712939278
              le_mean =     -17.209588413497
             les_mean =     296.451225921671
             stat err =       0.000411017416
             autocorr =       1.236460035747
   target nu stat err =       0.000411017416
   target dn stat err =       0.001803396448
      target stat err =       0.003126756892
              std dev =       0.522747698311
             le_variance =       0.273265156089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369632528
  error estimate for blocks of size 2^( 2) =       0.000384097523
  error estimate for blocks of size 2^( 3) =       0.000397310983
  error estimate for blocks of size 2^( 4) =       0.000406446845
  error estimate for blocks of size 2^( 5) =       0.000411058846
  error estimate for blocks of size 2^( 6) =       0.000413106821
  error estimate for blocks of size 2^( 7) =       0.000413457153

      target function =      -0.942712939278
              le_mean =     -17.209588413497
             les_mean =     296.451225921671
             stat err =       0.000411017416
             autocorr =       1.236460035747
   target nu stat err =       0.000411017416
   target dn stat err =       0.001803396448
      target stat err =       0.003126756892
              std dev =       0.522747698311
             le_variance =       0.273265156089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273229195590
                                         uncertainty =       0.001434348557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369632528
  error estimate for blocks of size 2^( 2) =       0.000384097523
  error estimate for blocks of size 2^( 3) =       0.000397310983
  error estimate for blocks of size 2^( 4) =       0.000406446845
  error estimate for blocks of size 2^( 5) =       0.000411058846
  error estimate for blocks of size 2^( 6) =       0.000413106821
  error estimate for blocks of size 2^( 7) =       0.000413457153

      target function =      -0.942712939278
              le_mean =     -17.209588413497
             les_mean =     296.451225921671
             stat err =       0.000411017416
             autocorr =       1.236460035747
   target nu stat err =       0.000411017416
   target dn stat err =       0.001803396448
      target stat err =       0.003126756892
              std dev =       0.522747698311
             le_variance =       0.273265156089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942712939278        initial  <--
     3.6380e+46     3.6380e+47             3.2441e-51        -0.942712939278
     1.4552e+47     1.4552e+48             8.1103e-52        -0.942712939278
     5.8208e+47     5.8208e+48             2.0276e-52        -0.942712939278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.2206
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4844e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.244694
====================================================
  Execution time = 2.7046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0481e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8743e-01
  Total weights = 1.966318784e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.2189e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277565258357
                                         uncertainty =       0.001694638557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277565258357
                                         uncertainty =       0.001694638557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372522057
  error estimate for blocks of size 2^( 2) =       0.000386419808
  error estimate for blocks of size 2^( 3) =       0.000399537908
  error estimate for blocks of size 2^( 4) =       0.000408774530
  error estimate for blocks of size 2^( 5) =       0.000414223698
  error estimate for blocks of size 2^( 6) =       0.000416360692
  error estimate for blocks of size 2^( 7) =       0.000416962902

      target function =      -0.932454699957
              le_mean =     -17.210247896102
             les_mean =     296.480063656692
             stat err =       0.000414080455
             autocorr =       1.235564666471
   target nu stat err =       0.000414080455
   target dn stat err =       0.002286607309
      target stat err =       0.003845399147
              std dev =       0.526834174153
             le_variance =       0.277554247056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721024789610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+47, overlap shift 3.6380e+48 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+48, overlap shift 1.4552e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+48, overlap shift 5.8208e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932469558057       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.767085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5274e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.171146
====================================================
  Execution time = 2.7286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8692e-01
  Total weights = 1.9663e+06
  Execution time = 2.3068e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372352891
  error estimate for blocks of size 2^( 2) =       0.000386911432
  error estimate for blocks of size 2^( 3) =       0.000400309686
  error estimate for blocks of size 2^( 4) =       0.000409658413
  error estimate for blocks of size 2^( 5) =       0.000416181533
  error estimate for blocks of size 2^( 6) =       0.000417880182
  error estimate for blocks of size 2^( 7) =       0.000419782672

      target function =      -0.933303870714
              le_mean =     -17.209831235433
             les_mean =     296.465213160200
             stat err =       0.000415875700
             autocorr =       1.247434147631
   target nu stat err =       0.000415875700
   target dn stat err =       0.002571344183
      target stat err =       0.004312655876
              std dev =       0.526594934243
             le_variance =       0.277302224771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372352891
  error estimate for blocks of size 2^( 2) =       0.000386911432
  error estimate for blocks of size 2^( 3) =       0.000400309686
  error estimate for blocks of size 2^( 4) =       0.000409658413
  error estimate for blocks of size 2^( 5) =       0.000416181533
  error estimate for blocks of size 2^( 6) =       0.000417880182
  error estimate for blocks of size 2^( 7) =       0.000419782672

      target function =      -0.933303870714
              le_mean =     -17.209831235433
             les_mean =     296.465213160200
             stat err =       0.000415875700
             autocorr =       1.247434147633
   target nu stat err =       0.000415875700
   target dn stat err =       0.002571344183
      target stat err =       0.004312655876
              std dev =       0.526594934243
             le_variance =       0.277302224771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372352891
  error estimate for blocks of size 2^( 2) =       0.000386911432
  error estimate for blocks of size 2^( 3) =       0.000400309686
  error estimate for blocks of size 2^( 4) =       0.000409658413
  error estimate for blocks of size 2^( 5) =       0.000416181533
  error estimate for blocks of size 2^( 6) =       0.000417880182
  error estimate for blocks of size 2^( 7) =       0.000419782672

      target function =      -0.933303870714
              le_mean =     -17.209831235433
             les_mean =     296.465213160200
             stat err =       0.000415875700
             autocorr =       1.247434147633
   target nu stat err =       0.000415875700
   target dn stat err =       0.002571344183
      target stat err =       0.004312655876
              std dev =       0.526594934243
             le_variance =       0.277302224771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277352600724
                                         uncertainty =       0.001646303935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372352891
  error estimate for blocks of size 2^( 2) =       0.000386911432
  error estimate for blocks of size 2^( 3) =       0.000400309686
  error estimate for blocks of size 2^( 4) =       0.000409658413
  error estimate for blocks of size 2^( 5) =       0.000416181533
  error estimate for blocks of size 2^( 6) =       0.000417880182
  error estimate for blocks of size 2^( 7) =       0.000419782672

      target function =      -0.933303870714
              le_mean =     -17.209831235433
             les_mean =     296.465213160200
             stat err =       0.000415875700
             autocorr =       1.247434147633
   target nu stat err =       0.000415875700
   target dn stat err =       0.002571344183
      target stat err =       0.004312655876
              std dev =       0.526594934243
             le_variance =       0.277302224771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933303870714        initial  <--
     3.6380e+47     3.6380e+48             0.0000e+00        -0.933303870714
     1.4552e+48     1.4552e+49             0.0000e+00        -0.933303870714
     5.8208e+48     5.8208e+49             0.0000e+00        -0.933303870714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9524
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2082
    reference variance = 0.206888
====================================================
  Execution time = 2.7145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0483e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9047e-01
  Total weights = 1.966277120e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3068e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280324379515
                                         uncertainty =       0.001792787267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280324379515
                                         uncertainty =       0.001792787267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374369602
  error estimate for blocks of size 2^( 2) =       0.000388274746
  error estimate for blocks of size 2^( 3) =       0.000401335603
  error estimate for blocks of size 2^( 4) =       0.000411016428
  error estimate for blocks of size 2^( 5) =       0.000416864482
  error estimate for blocks of size 2^( 6) =       0.000420073913
  error estimate for blocks of size 2^( 7) =       0.000422186107

      target function =      -0.927475323109
              le_mean =     -17.209714244641
             les_mean =     296.464738737828
             stat err =       0.000417535233
             autocorr =       1.243898946840
   target nu stat err =       0.000417535233
   target dn stat err =       0.002536331896
      target stat err =       0.004203035484
              std dev =       0.529447039814
             le_variance =       0.280314167967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720971424464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+48, overlap shift 3.6380e+49 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927493415891       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927493415891       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927734375000       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+48 is 4.083881e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+49, overlap shift 1.4552e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927493415891       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927493415891       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927734375000       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+49 is 1.020970e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+49, overlap shift 5.8208e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.927493415891       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.927493415891       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.927493415891       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+49 is 2.552425e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.768678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5460e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2562
    reference variance = 0.195402
====================================================
  Execution time = 2.7329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8492e-01
  Total weights = 1.9663e+06
  Execution time = 2.3015e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372018356
  error estimate for blocks of size 2^( 2) =       0.000386481338
  error estimate for blocks of size 2^( 3) =       0.000399838600
  error estimate for blocks of size 2^( 4) =       0.000409706169
  error estimate for blocks of size 2^( 5) =       0.000415397694
  error estimate for blocks of size 2^( 6) =       0.000419552212
  error estimate for blocks of size 2^( 7) =       0.000422537626

      target function =      -0.936636693349
              le_mean =     -17.209707598526
             les_mean =     296.458955657218
             stat err =       0.000416798425
             autocorr =       1.255230260136
   target nu stat err =       0.000416798425
   target dn stat err =       0.001800306663
      target stat err =       0.003085839192
              std dev =       0.526121822265
             le_variance =       0.276804171863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372018356
  error estimate for blocks of size 2^( 2) =       0.000386481338
  error estimate for blocks of size 2^( 3) =       0.000399838600
  error estimate for blocks of size 2^( 4) =       0.000409706169
  error estimate for blocks of size 2^( 5) =       0.000415397694
  error estimate for blocks of size 2^( 6) =       0.000419552212
  error estimate for blocks of size 2^( 7) =       0.000422537626

      target function =      -0.936636693349
              le_mean =     -17.209707598526
             les_mean =     296.458955657218
             stat err =       0.000416798425
             autocorr =       1.255230260136
   target nu stat err =       0.000416798425
   target dn stat err =       0.001800306663
      target stat err =       0.003085839192
              std dev =       0.526121822265
             le_variance =       0.276804171863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372018356
  error estimate for blocks of size 2^( 2) =       0.000386481338
  error estimate for blocks of size 2^( 3) =       0.000399838600
  error estimate for blocks of size 2^( 4) =       0.000409706169
  error estimate for blocks of size 2^( 5) =       0.000415397694
  error estimate for blocks of size 2^( 6) =       0.000419552212
  error estimate for blocks of size 2^( 7) =       0.000422537626

      target function =      -0.936636693349
              le_mean =     -17.209707598526
             les_mean =     296.458955657218
             stat err =       0.000416798425
             autocorr =       1.255230260136
   target nu stat err =       0.000416798425
   target dn stat err =       0.001800306663
      target stat err =       0.003085839192
              std dev =       0.526121822265
             le_variance =       0.276804171863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276795157114
                                         uncertainty =       0.001442673246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372018356
  error estimate for blocks of size 2^( 2) =       0.000386481338
  error estimate for blocks of size 2^( 3) =       0.000399838600
  error estimate for blocks of size 2^( 4) =       0.000409706169
  error estimate for blocks of size 2^( 5) =       0.000415397694
  error estimate for blocks of size 2^( 6) =       0.000419552212
  error estimate for blocks of size 2^( 7) =       0.000422537626

      target function =      -0.936636693349
              le_mean =     -17.209707598526
             les_mean =     296.458955657218
             stat err =       0.000416798425
             autocorr =       1.255230260136
   target nu stat err =       0.000416798425
   target dn stat err =       0.001800306663
      target stat err =       0.003085839192
              std dev =       0.526121822265
             le_variance =       0.276804171863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936636693349        initial  <--
     3.6380e+48     3.6380e+49             4.0839e-53        -0.936636693349
     1.4552e+49     1.4552e+50             1.0210e-53        -0.936636693349
     5.8208e+49     5.8208e+50             2.5524e-54        -0.936636693349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.9763
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.300181
====================================================
  Execution time = 2.7289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9150e-01
  Total weights = 1.966426732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1195e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278782406852
                                         uncertainty =       0.002168601911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278782406852
                                         uncertainty =       0.002168601911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373378003
  error estimate for blocks of size 2^( 2) =       0.000387280831
  error estimate for blocks of size 2^( 3) =       0.000399992502
  error estimate for blocks of size 2^( 4) =       0.000409482352
  error estimate for blocks of size 2^( 5) =       0.000415207584
  error estimate for blocks of size 2^( 6) =       0.000417877817
  error estimate for blocks of size 2^( 7) =       0.000421924242

      target function =      -0.925808909579
              le_mean =     -17.209355176187
             les_mean =     296.453401179417
             stat err =       0.000416122999
             autocorr =       1.242069743584
   target nu stat err =       0.000416122999
   target dn stat err =       0.003582168167
      target stat err =       0.005865569729
              std dev =       0.528044683996
             le_variance =       0.278831188297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720935517619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+49, overlap shift 3.6380e+50 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+50, overlap shift 1.4552e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+50, overlap shift 5.8208e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925844845596       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.769954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5417e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2406
    reference variance = 0.195979
====================================================
  Execution time = 2.9413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8458e-01
  Total weights = 1.9661e+06
  Execution time = 2.3185e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102662
  error estimate for blocks of size 2^( 2) =       0.000385142444
  error estimate for blocks of size 2^( 3) =       0.000398747217
  error estimate for blocks of size 2^( 4) =       0.000407939333
  error estimate for blocks of size 2^( 5) =       0.000414204524
  error estimate for blocks of size 2^( 6) =       0.000417582042
  error estimate for blocks of size 2^( 7) =       0.000420038091

      target function =      -0.937189995564
              le_mean =     -17.209601401421
             les_mean =     296.454964444302
             stat err =       0.000414940997
             autocorr =       1.250214562533
   target nu stat err =       0.000414940997
   target dn stat err =       0.002466919695
      target stat err =       0.004174629821
              std dev =       0.524826814950
             le_variance =       0.275443185691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102662
  error estimate for blocks of size 2^( 2) =       0.000385142444
  error estimate for blocks of size 2^( 3) =       0.000398747217
  error estimate for blocks of size 2^( 4) =       0.000407939333
  error estimate for blocks of size 2^( 5) =       0.000414204524
  error estimate for blocks of size 2^( 6) =       0.000417582042
  error estimate for blocks of size 2^( 7) =       0.000420038091

      target function =      -0.937189995564
              le_mean =     -17.209601401421
             les_mean =     296.454964444302
             stat err =       0.000414940997
             autocorr =       1.250214562533
   target nu stat err =       0.000414940997
   target dn stat err =       0.002466919695
      target stat err =       0.004174629821
              std dev =       0.524826814950
             le_variance =       0.275443185691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102662
  error estimate for blocks of size 2^( 2) =       0.000385142444
  error estimate for blocks of size 2^( 3) =       0.000398747217
  error estimate for blocks of size 2^( 4) =       0.000407939333
  error estimate for blocks of size 2^( 5) =       0.000414204524
  error estimate for blocks of size 2^( 6) =       0.000417582042
  error estimate for blocks of size 2^( 7) =       0.000420038091

      target function =      -0.937189995564
              le_mean =     -17.209601401421
             les_mean =     296.454964444302
             stat err =       0.000414940997
             autocorr =       1.250214562533
   target nu stat err =       0.000414940997
   target dn stat err =       0.002466919695
      target stat err =       0.004174629821
              std dev =       0.524826814950
             le_variance =       0.275443185691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275482506520
                                         uncertainty =       0.001701488844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102662
  error estimate for blocks of size 2^( 2) =       0.000385142444
  error estimate for blocks of size 2^( 3) =       0.000398747217
  error estimate for blocks of size 2^( 4) =       0.000407939333
  error estimate for blocks of size 2^( 5) =       0.000414204524
  error estimate for blocks of size 2^( 6) =       0.000417582042
  error estimate for blocks of size 2^( 7) =       0.000420038091

      target function =      -0.937189995564
              le_mean =     -17.209601401421
             les_mean =     296.454964444302
             stat err =       0.000414940997
             autocorr =       1.250214562533
   target nu stat err =       0.000414940997
   target dn stat err =       0.002466919695
      target stat err =       0.004174629821
              std dev =       0.524826814950
             le_variance =       0.275443185691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937189995564        initial  <--
     3.6380e+49     3.6380e+50             0.0000e+00        -0.937189995564
     1.4552e+50     1.4552e+51             0.0000e+00        -0.937189995564
     5.8208e+50     5.8208e+51             0.0000e+00        -0.937189995564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.1144
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.356991
====================================================
  Execution time = 2.6987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0474e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.9108e-01
  Total weights = 1.966395283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0108e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280494106065
                                         uncertainty =       0.002491219332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280494106065
                                         uncertainty =       0.002491219332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374549288
  error estimate for blocks of size 2^( 2) =       0.000388548410
  error estimate for blocks of size 2^( 3) =       0.000401575231
  error estimate for blocks of size 2^( 4) =       0.000411247274
  error estimate for blocks of size 2^( 5) =       0.000416790805
  error estimate for blocks of size 2^( 6) =       0.000418769046
  error estimate for blocks of size 2^( 7) =       0.000419127039

      target function =      -0.926436236840
              le_mean =     -17.210189693337
             les_mean =     296.481713318062
             stat err =       0.000416483541
             autocorr =       1.236453349748
   target nu stat err =       0.000416483541
   target dn stat err =       0.003911187663
      target stat err =       0.006415202247
              std dev =       0.529701157424
             le_variance =       0.280583316176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721018969334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+50, overlap shift 3.6380e+51 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+51, overlap shift 1.4552e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+51, overlap shift 5.8208e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926480032263       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.771250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5006e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2723
    reference variance = 0.391659
====================================================
  Execution time = 2.6560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8872e-01
  Total weights = 1.9661e+06
  Execution time = 2.3135e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372743222
  error estimate for blocks of size 2^( 2) =       0.000387032347
  error estimate for blocks of size 2^( 3) =       0.000400015805
  error estimate for blocks of size 2^( 4) =       0.000409894798
  error estimate for blocks of size 2^( 5) =       0.000415186366
  error estimate for blocks of size 2^( 6) =       0.000418434248
  error estimate for blocks of size 2^( 7) =       0.000419112646

      target function =      -0.930327388801
              le_mean =     -17.209658875660
             les_mean =     296.461081639933
             stat err =       0.000415657014
             autocorr =       1.243514114086
   target nu stat err =       0.000415657014
   target dn stat err =       0.003450389954
      target stat err =       0.005711224440
              std dev =       0.527146953299
             le_variance =       0.277883910372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372743222
  error estimate for blocks of size 2^( 2) =       0.000387032347
  error estimate for blocks of size 2^( 3) =       0.000400015805
  error estimate for blocks of size 2^( 4) =       0.000409894798
  error estimate for blocks of size 2^( 5) =       0.000415186366
  error estimate for blocks of size 2^( 6) =       0.000418434248
  error estimate for blocks of size 2^( 7) =       0.000419112646

      target function =      -0.930327388801
              le_mean =     -17.209658875660
             les_mean =     296.461081639933
             stat err =       0.000415657014
             autocorr =       1.243514114086
   target nu stat err =       0.000415657014
   target dn stat err =       0.003450389954
      target stat err =       0.005711224440
              std dev =       0.527146953299
             le_variance =       0.277883910372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372743222
  error estimate for blocks of size 2^( 2) =       0.000387032347
  error estimate for blocks of size 2^( 3) =       0.000400015805
  error estimate for blocks of size 2^( 4) =       0.000409894798
  error estimate for blocks of size 2^( 5) =       0.000415186366
  error estimate for blocks of size 2^( 6) =       0.000418434248
  error estimate for blocks of size 2^( 7) =       0.000419112646

      target function =      -0.930327388801
              le_mean =     -17.209658875660
             les_mean =     296.461081639933
             stat err =       0.000415657014
             autocorr =       1.243514114086
   target nu stat err =       0.000415657014
   target dn stat err =       0.003450389954
      target stat err =       0.005711224440
              std dev =       0.527146953299
             le_variance =       0.277883910372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277883439638
                                         uncertainty =       0.002179038589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372743222
  error estimate for blocks of size 2^( 2) =       0.000387032347
  error estimate for blocks of size 2^( 3) =       0.000400015805
  error estimate for blocks of size 2^( 4) =       0.000409894798
  error estimate for blocks of size 2^( 5) =       0.000415186366
  error estimate for blocks of size 2^( 6) =       0.000418434248
  error estimate for blocks of size 2^( 7) =       0.000419112646

      target function =      -0.930327388801
              le_mean =     -17.209658875660
             les_mean =     296.461081639933
             stat err =       0.000415657014
             autocorr =       1.243514114086
   target nu stat err =       0.000415657014
   target dn stat err =       0.003450389954
      target stat err =       0.005711224440
              std dev =       0.527146953299
             le_variance =       0.277883910372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930327388801        initial  <--
     3.6380e+50     3.6380e+51             0.0000e+00        -0.930327388801
     1.4552e+51     1.4552e+52             0.0000e+00        -0.930327388801
     5.8208e+51     5.8208e+52             0.0000e+00        -0.930327388801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.2768
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2633
    reference variance = 0.393304
====================================================
  Execution time = 2.6906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0500e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8863e-01
  Total weights = 1.966338060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1303e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278571208929
                                         uncertainty =       0.001798875999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278571208929
                                         uncertainty =       0.001798875999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373165351
  error estimate for blocks of size 2^( 2) =       0.000387315809
  error estimate for blocks of size 2^( 3) =       0.000400065874
  error estimate for blocks of size 2^( 4) =       0.000409840528
  error estimate for blocks of size 2^( 5) =       0.000415097878
  error estimate for blocks of size 2^( 6) =       0.000418930671
  error estimate for blocks of size 2^( 7) =       0.000419357095

      target function =      -0.930476221364
              le_mean =     -17.210056840810
             les_mean =     296.474690731364
             stat err =       0.000415806543
             autocorr =       1.241595168932
   target nu stat err =       0.000415806543
   target dn stat err =       0.002522608717
      target stat err =       0.004209872622
              std dev =       0.527743944214
             le_variance =       0.278513670654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721005684081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+51, overlap shift 3.6380e+52 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+52, overlap shift 1.4552e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+52, overlap shift 5.8208e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930493977395       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.772513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5045e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2386
    reference variance = 0.203212
====================================================
  Execution time = 2.6736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8675e-01
  Total weights = 1.9663e+06
  Execution time = 2.3108e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372787742
  error estimate for blocks of size 2^( 2) =       0.000387044138
  error estimate for blocks of size 2^( 3) =       0.000400273376
  error estimate for blocks of size 2^( 4) =       0.000410007412
  error estimate for blocks of size 2^( 5) =       0.000415340198
  error estimate for blocks of size 2^( 6) =       0.000418331452
  error estimate for blocks of size 2^( 7) =       0.000419975324

      target function =      -0.933586885267
              le_mean =     -17.209771337060
             les_mean =     296.462979342422
             stat err =       0.000415913596
             autocorr =       1.244752447885
   target nu stat err =       0.000415913596
   target dn stat err =       0.002790551596
      target stat err =       0.004672294273
              std dev =       0.527209915547
             le_variance =       0.277950295051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372787742
  error estimate for blocks of size 2^( 2) =       0.000387044138
  error estimate for blocks of size 2^( 3) =       0.000400273376
  error estimate for blocks of size 2^( 4) =       0.000410007412
  error estimate for blocks of size 2^( 5) =       0.000415340198
  error estimate for blocks of size 2^( 6) =       0.000418331452
  error estimate for blocks of size 2^( 7) =       0.000419975324

      target function =      -0.933586885267
              le_mean =     -17.209771337060
             les_mean =     296.462979342422
             stat err =       0.000415913596
             autocorr =       1.244752447885
   target nu stat err =       0.000415913596
   target dn stat err =       0.002790551596
      target stat err =       0.004672294273
              std dev =       0.527209915547
             le_variance =       0.277950295051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372787742
  error estimate for blocks of size 2^( 2) =       0.000387044138
  error estimate for blocks of size 2^( 3) =       0.000400273376
  error estimate for blocks of size 2^( 4) =       0.000410007412
  error estimate for blocks of size 2^( 5) =       0.000415340198
  error estimate for blocks of size 2^( 6) =       0.000418331452
  error estimate for blocks of size 2^( 7) =       0.000419975324

      target function =      -0.933586885267
              le_mean =     -17.209771337060
             les_mean =     296.462979342422
             stat err =       0.000415913596
             autocorr =       1.244752447885
   target nu stat err =       0.000415913596
   target dn stat err =       0.002790551596
      target stat err =       0.004672294273
              std dev =       0.527209915547
             le_variance =       0.277950295051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277950863543
                                         uncertainty =       0.002036178212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372787742
  error estimate for blocks of size 2^( 2) =       0.000387044138
  error estimate for blocks of size 2^( 3) =       0.000400273376
  error estimate for blocks of size 2^( 4) =       0.000410007412
  error estimate for blocks of size 2^( 5) =       0.000415340198
  error estimate for blocks of size 2^( 6) =       0.000418331452
  error estimate for blocks of size 2^( 7) =       0.000419975324

      target function =      -0.933586885267
              le_mean =     -17.209771337060
             les_mean =     296.462979342422
             stat err =       0.000415913596
             autocorr =       1.244752447885
   target nu stat err =       0.000415913596
   target dn stat err =       0.002790551596
      target stat err =       0.004672294273
              std dev =       0.527209915547
             le_variance =       0.277950295051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933586885267        initial  <--
     3.6380e+51     3.6380e+52             0.0000e+00        -0.933586885267
     1.4552e+52     1.4552e+53             0.0000e+00        -0.933586885267
     5.8208e+52     5.8208e+53             0.0000e+00        -0.933586885267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.3968
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.289
    reference variance = 0.174041
====================================================
  Execution time = 2.7126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0503e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8502e-01
  Total weights = 1.966432434e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1706e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275929407458
                                         uncertainty =       0.001502840908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275929407458
                                         uncertainty =       0.001502840908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371454426
  error estimate for blocks of size 2^( 2) =       0.000385846503
  error estimate for blocks of size 2^( 3) =       0.000398922275
  error estimate for blocks of size 2^( 4) =       0.000408330007
  error estimate for blocks of size 2^( 5) =       0.000414872067
  error estimate for blocks of size 2^( 6) =       0.000418413343
  error estimate for blocks of size 2^( 7) =       0.000419669243

      target function =      -0.936455657960
              le_mean =     -17.210211511113
             les_mean =     296.476398943212
             stat err =       0.000415321165
             autocorr =       1.250135400292
   target nu stat err =       0.000415321165
   target dn stat err =       0.002224802976
      target stat err =       0.003777050278
              std dev =       0.525324291430
             le_variance =       0.275965611167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721021151111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+52, overlap shift 3.6380e+53 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+53, overlap shift 1.4552e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+53, overlap shift 5.8208e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936469994351       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.773766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5305e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.144
    reference variance = 0.24214
====================================================
  Execution time = 2.6713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9015e-01
  Total weights = 1.9664e+06
  Execution time = 2.3096e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373363835
  error estimate for blocks of size 2^( 2) =       0.000387307473
  error estimate for blocks of size 2^( 3) =       0.000400071375
  error estimate for blocks of size 2^( 4) =       0.000409796025
  error estimate for blocks of size 2^( 5) =       0.000416576913
  error estimate for blocks of size 2^( 6) =       0.000419405991
  error estimate for blocks of size 2^( 7) =       0.000421868669

      target function =      -0.928005587080
              le_mean =     -17.209481208014
             les_mean =     296.456396704102
             stat err =       0.000416911899
             autocorr =       1.246878351450
   target nu stat err =       0.000416911899
   target dn stat err =       0.002714790046
      target stat err =       0.004492934899
              std dev =       0.528024647015
             le_variance =       0.278810027856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373363835
  error estimate for blocks of size 2^( 2) =       0.000387307473
  error estimate for blocks of size 2^( 3) =       0.000400071375
  error estimate for blocks of size 2^( 4) =       0.000409796025
  error estimate for blocks of size 2^( 5) =       0.000416576913
  error estimate for blocks of size 2^( 6) =       0.000419405991
  error estimate for blocks of size 2^( 7) =       0.000421868669

      target function =      -0.928005587080
              le_mean =     -17.209481208014
             les_mean =     296.456396704102
             stat err =       0.000416911899
             autocorr =       1.246878351450
   target nu stat err =       0.000416911899
   target dn stat err =       0.002714790046
      target stat err =       0.004492934899
              std dev =       0.528024647015
             le_variance =       0.278810027856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373363835
  error estimate for blocks of size 2^( 2) =       0.000387307473
  error estimate for blocks of size 2^( 3) =       0.000400071375
  error estimate for blocks of size 2^( 4) =       0.000409796025
  error estimate for blocks of size 2^( 5) =       0.000416576913
  error estimate for blocks of size 2^( 6) =       0.000419405991
  error estimate for blocks of size 2^( 7) =       0.000421868669

      target function =      -0.928005587080
              le_mean =     -17.209481208014
             les_mean =     296.456396704102
             stat err =       0.000416911899
             autocorr =       1.246878351450
   target nu stat err =       0.000416911899
   target dn stat err =       0.002714790046
      target stat err =       0.004492934899
              std dev =       0.528024647015
             le_variance =       0.278810027856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278877092522
                                         uncertainty =       0.001807902613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373363835
  error estimate for blocks of size 2^( 2) =       0.000387307473
  error estimate for blocks of size 2^( 3) =       0.000400071375
  error estimate for blocks of size 2^( 4) =       0.000409796025
  error estimate for blocks of size 2^( 5) =       0.000416576913
  error estimate for blocks of size 2^( 6) =       0.000419405991
  error estimate for blocks of size 2^( 7) =       0.000421868669

      target function =      -0.928005587080
              le_mean =     -17.209481208014
             les_mean =     296.456396704102
             stat err =       0.000416911899
             autocorr =       1.246878351450
   target nu stat err =       0.000416911899
   target dn stat err =       0.002714790046
      target stat err =       0.004492934899
              std dev =       0.528024647015
             le_variance =       0.278810027856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928005587080        initial  <--
     3.6380e+52     3.6380e+53             0.0000e+00        -0.928005587080
     1.4552e+53     1.4552e+54             0.0000e+00        -0.928005587080
     5.8208e+53     5.8208e+54             0.0000e+00        -0.928005587080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.3786
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.160928
====================================================
  Execution time = 2.6927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0476e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8981e-01
  Total weights = 1.966561780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1135e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279676464521
                                         uncertainty =       0.001749175469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279676464521
                                         uncertainty =       0.001749175469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373923842
  error estimate for blocks of size 2^( 2) =       0.000388436482
  error estimate for blocks of size 2^( 3) =       0.000401047832
  error estimate for blocks of size 2^( 4) =       0.000410640490
  error estimate for blocks of size 2^( 5) =       0.000416416118
  error estimate for blocks of size 2^( 6) =       0.000419344204
  error estimate for blocks of size 2^( 7) =       0.000421800774

      target function =      -0.928581238858
              le_mean =     -17.209117737162
             les_mean =     296.443545038901
             stat err =       0.000417050396
             autocorr =       1.243972449272
   target nu stat err =       0.000417050396
   target dn stat err =       0.002381379516
      target stat err =       0.003958974485
              std dev =       0.528816629419
             le_variance =       0.279647027550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720911773716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+53, overlap shift 3.6380e+54 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928597154522       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928597154522       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.64e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+53 is 4.434195e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+54, overlap shift 1.4552e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928597154522       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928597154522       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928597154522       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928597154520       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928597154522       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 5.34e+13           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+54 is 1.518811e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+54, overlap shift 5.8208e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928597154522       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928597154522       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.64e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+54 is 2.771372e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.776000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5050e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.16816
====================================================
  Execution time = 2.8871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8566e-01
  Total weights = 1.9666e+06
  Execution time = 2.3173e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371759312
  error estimate for blocks of size 2^( 2) =       0.000386023669
  error estimate for blocks of size 2^( 3) =       0.000399296874
  error estimate for blocks of size 2^( 4) =       0.000408020005
  error estimate for blocks of size 2^( 5) =       0.000413682634
  error estimate for blocks of size 2^( 6) =       0.000417279335
  error estimate for blocks of size 2^( 7) =       0.000418227383

      target function =      -0.935418153947
              le_mean =     -17.209119065840
             les_mean =     296.439436868886
             stat err =       0.000414302339
             autocorr =       1.241969865754
   target nu stat err =       0.000414302339
   target dn stat err =       0.002307315771
      target stat err =       0.003894945549
              std dev =       0.525755473387
             le_variance =       0.276418817796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371759312
  error estimate for blocks of size 2^( 2) =       0.000386023669
  error estimate for blocks of size 2^( 3) =       0.000399296874
  error estimate for blocks of size 2^( 4) =       0.000408020005
  error estimate for blocks of size 2^( 5) =       0.000413682634
  error estimate for blocks of size 2^( 6) =       0.000417279335
  error estimate for blocks of size 2^( 7) =       0.000418227383

      target function =      -0.935418153947
              le_mean =     -17.209119065840
             les_mean =     296.439436868886
             stat err =       0.000414302339
             autocorr =       1.241969865754
   target nu stat err =       0.000414302339
   target dn stat err =       0.002307315771
      target stat err =       0.003894945549
              std dev =       0.525755473387
             le_variance =       0.276418817796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371759312
  error estimate for blocks of size 2^( 2) =       0.000386023669
  error estimate for blocks of size 2^( 3) =       0.000399296874
  error estimate for blocks of size 2^( 4) =       0.000408020005
  error estimate for blocks of size 2^( 5) =       0.000413682634
  error estimate for blocks of size 2^( 6) =       0.000417279335
  error estimate for blocks of size 2^( 7) =       0.000418227383

      target function =      -0.935418153947
              le_mean =     -17.209119065840
             les_mean =     296.439436868886
             stat err =       0.000414302339
             autocorr =       1.241969865754
   target nu stat err =       0.000414302339
   target dn stat err =       0.002307315771
      target stat err =       0.003894945549
              std dev =       0.525755473387
             le_variance =       0.276418817796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276468232925
                                         uncertainty =       0.001774736844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371759312
  error estimate for blocks of size 2^( 2) =       0.000386023669
  error estimate for blocks of size 2^( 3) =       0.000399296874
  error estimate for blocks of size 2^( 4) =       0.000408020005
  error estimate for blocks of size 2^( 5) =       0.000413682634
  error estimate for blocks of size 2^( 6) =       0.000417279335
  error estimate for blocks of size 2^( 7) =       0.000418227383

      target function =      -0.935418153947
              le_mean =     -17.209119065840
             les_mean =     296.439436868886
             stat err =       0.000414302339
             autocorr =       1.241969865754
   target nu stat err =       0.000414302339
   target dn stat err =       0.002307315771
      target stat err =       0.003894945549
              std dev =       0.525755473387
             le_variance =       0.276418817796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935418153947        initial  <--
     3.6380e+53     3.6380e+54             4.4342e-58        -0.935418153947
     1.4552e+54     1.4552e+55             1.5188e-58        -0.935418153947
     5.8208e+54     5.8208e+55             2.7714e-59        -0.935418153947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.5591
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.257166
====================================================
  Execution time = 2.6993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0494e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8534e-01
  Total weights = 1.966500168e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.1325e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275883420971
                                         uncertainty =       0.001934673782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275883420971
                                         uncertainty =       0.001934673782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371418030
  error estimate for blocks of size 2^( 2) =       0.000386082050
  error estimate for blocks of size 2^( 3) =       0.000399350318
  error estimate for blocks of size 2^( 4) =       0.000409530856
  error estimate for blocks of size 2^( 5) =       0.000415250650
  error estimate for blocks of size 2^( 6) =       0.000417593635
  error estimate for blocks of size 2^( 7) =       0.000419947307

      target function =      -0.935928960201
              le_mean =     -17.209056358479
             les_mean =     296.436963908441
             stat err =       0.000415580612
             autocorr =       1.251943100367
   target nu stat err =       0.000415580612
   target dn stat err =       0.003086402407
      target stat err =       0.005174475906
              std dev =       0.525272820070
             le_variance =       0.275911535504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720905635848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+54, overlap shift 3.6380e+55 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+55, overlap shift 1.4552e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+55, overlap shift 5.8208e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935956629203       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.777281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5134e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.235956
====================================================
  Execution time = 2.6888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.8708e-01
  Total weights = 1.9663e+06
  Execution time = 2.3261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457237
  error estimate for blocks of size 2^( 2) =       0.000386772452
  error estimate for blocks of size 2^( 3) =       0.000399822398
  error estimate for blocks of size 2^( 4) =       0.000409466548
  error estimate for blocks of size 2^( 5) =       0.000415250665
  error estimate for blocks of size 2^( 6) =       0.000417072866
  error estimate for blocks of size 2^( 7) =       0.000419938914

      target function =      -0.933072725466
              le_mean =     -17.208978692518
             les_mean =     296.436024250183
             stat err =       0.000415432248
             autocorr =       1.244077907980
   target nu stat err =       0.000415432248
   target dn stat err =       0.002523538540
      target stat err =       0.004225794676
              std dev =       0.526742503288
             le_variance =       0.277457664770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457237
  error estimate for blocks of size 2^( 2) =       0.000386772452
  error estimate for blocks of size 2^( 3) =       0.000399822398
  error estimate for blocks of size 2^( 4) =       0.000409466548
  error estimate for blocks of size 2^( 5) =       0.000415250665
  error estimate for blocks of size 2^( 6) =       0.000417072866
  error estimate for blocks of size 2^( 7) =       0.000419938914

      target function =      -0.933072725466
              le_mean =     -17.208978692518
             les_mean =     296.436024250183
             stat err =       0.000415432248
             autocorr =       1.244077907980
   target nu stat err =       0.000415432248
   target dn stat err =       0.002523538540
      target stat err =       0.004225794676
              std dev =       0.526742503288
             le_variance =       0.277457664770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457237
  error estimate for blocks of size 2^( 2) =       0.000386772452
  error estimate for blocks of size 2^( 3) =       0.000399822398
  error estimate for blocks of size 2^( 4) =       0.000409466548
  error estimate for blocks of size 2^( 5) =       0.000415250665
  error estimate for blocks of size 2^( 6) =       0.000417072866
  error estimate for blocks of size 2^( 7) =       0.000419938914

      target function =      -0.933072725466
              le_mean =     -17.208978692518
             les_mean =     296.436024250183
             stat err =       0.000415432248
             autocorr =       1.244077907980
   target nu stat err =       0.000415432248
   target dn stat err =       0.002523538540
      target stat err =       0.004225794676
              std dev =       0.526742503288
             le_variance =       0.277457664770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277536837781
                                         uncertainty =       0.001739246259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372457237
  error estimate for blocks of size 2^( 2) =       0.000386772452
  error estimate for blocks of size 2^( 3) =       0.000399822398
  error estimate for blocks of size 2^( 4) =       0.000409466548
  error estimate for blocks of size 2^( 5) =       0.000415250665
  error estimate for blocks of size 2^( 6) =       0.000417072866
  error estimate for blocks of size 2^( 7) =       0.000419938914

      target function =      -0.933072725466
              le_mean =     -17.208978692518
             les_mean =     296.436024250183
             stat err =       0.000415432248
             autocorr =       1.244077907980
   target nu stat err =       0.000415432248
   target dn stat err =       0.002523538540
      target stat err =       0.004225794676
              std dev =       0.526742503288
             le_variance =       0.277457664770


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933072725466        initial  <--
     3.6380e+54     3.6380e+55             0.0000e+00        -0.933072725466
     1.4552e+55     1.4552e+56             0.0000e+00        -0.933072725466
     5.8208e+55     5.8208e+56             0.0000e+00        -0.933072725466

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.6204
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3761e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1593
    reference variance = 0.170819
====================================================
  Execution time = 2.6902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0475e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.8832e-01
  Total weights = 1.966516845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3126e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278346819984
                                         uncertainty =       0.001601222372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278346819984
                                         uncertainty =       0.001601222372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373059129
  error estimate for blocks of size 2^( 2) =       0.000387089152
  error estimate for blocks of size 2^( 3) =       0.000400377301
  error estimate for blocks of size 2^( 4) =       0.000409967042
  error estimate for blocks of size 2^( 5) =       0.000416187658
  error estimate for blocks of size 2^( 6) =       0.000419529230
  error estimate for blocks of size 2^( 7) =       0.000419800766

      target function =      -0.930991575936
              le_mean =     -17.210078777239
             les_mean =     296.475135934968
             stat err =       0.000416371174
             autocorr =       1.245678496128
   target nu stat err =       0.000416371174
   target dn stat err =       0.001996154162
      target stat err =       0.003365386180
              std dev =       0.527593720538
             le_variance =       0.278355133952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721007877724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 97
Check correct_vf_var_size: 294, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+55, overlap shift 3.6380e+56 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 3.6380e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+56, overlap shift 1.4552e+57 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 1.4552e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+56, overlap shift 5.8208e+57 and omega -1.7737e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931002700774       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 98 and evec_eigen.size(): 98
The largest weight on the derivative vector for shift 5.8208e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                              16.778569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 98 and numParams is: 97

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5223e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.274212
====================================================
  Execution time = 2.6802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.7209e+01
  VMC Evar = 2.9235e-01
  Total weights = 1.9665e+06
  Execution time = 2.3214e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375063973
  error estimate for blocks of size 2^( 2) =       0.000389115275
  error estimate for blocks of size 2^( 3) =       0.000401762866
  error estimate for blocks of size 2^( 4) =       0.000410897046
  error estimate for blocks of size 2^( 5) =       0.000416536245
  error estimate for blocks of size 2^( 6) =       0.000418522655
  error estimate for blocks of size 2^( 7) =       0.000421927420

      target function =      -0.924431747376
              le_mean =     -17.209437571639
             les_mean =     296.457095474019
             stat err =       0.000416970842
             autocorr =       1.235949351577
   target nu stat err =       0.000416970842
   target dn stat err =       0.002488626724
      target stat err =       0.004097477904
              std dev =       0.530429043337
             le_variance =       0.281354970016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375063973
  error estimate for blocks of size 2^( 2) =       0.000389115275
  error estimate for blocks of size 2^( 3) =       0.000401762866
  error estimate for blocks of size 2^( 4) =       0.000410897046
  error estimate for blocks of size 2^( 5) =       0.000416536245
  error estimate for blocks of size 2^( 6) =       0.000418522655
  error estimate for blocks of size 2^( 7) =       0.000421927420

      target function =      -0.924431747376
              le_mean =     -17.209437571639
             les_mean =     296.457095474019
             stat err =       0.000416970842
             autocorr =       1.235949351577
   target nu stat err =       0.000416970842
   target dn stat err =       0.002488626724
      target stat err =       0.004097477904
              std dev =       0.530429043337
             le_variance =       0.281354970016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375063973
  error estimate for blocks of size 2^( 2) =       0.000389115275
  error estimate for blocks of size 2^( 3) =       0.000401762866
  error estimate for blocks of size 2^( 4) =       0.000410897046
  error estimate for blocks of size 2^( 5) =       0.000416536245
  error estimate for blocks of size 2^( 6) =       0.000418522655
  error estimate for blocks of size 2^( 7) =       0.000421927420

      target function =      -0.924431747376
              le_mean =     -17.209437571639
             les_mean =     296.457095474019
             stat err =       0.000416970842
             autocorr =       1.235949351577
   target nu stat err =       0.000416970842
   target dn stat err =       0.002488626724
      target stat err =       0.004097477904
              std dev =       0.530429043337
             le_variance =       0.281354970016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281275113006
                                         uncertainty =       0.001840783407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375063973
  error estimate for blocks of size 2^( 2) =       0.000389115275
  error estimate for blocks of size 2^( 3) =       0.000401762866
  error estimate for blocks of size 2^( 4) =       0.000410897046
  error estimate for blocks of size 2^( 5) =       0.000416536245
  error estimate for blocks of size 2^( 6) =       0.000418522655
  error estimate for blocks of size 2^( 7) =       0.000421927420

      target function =      -0.924431747376
              le_mean =     -17.209437571639
             les_mean =     296.457095474019
             stat err =       0.000416970842
             autocorr =       1.235949351577
   target nu stat err =       0.000416970842
   target dn stat err =       0.002488626724
      target stat err =       0.004097477904
              std dev =       0.530429043337
             le_variance =       0.281354970016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924431747376        initial  <--
     3.6380e+55     3.6380e+56             0.0000e+00        -0.924431747376
     1.4552e+56     1.4552e+57             0.0000e+00        -0.924431747376
     5.8208e+56     5.8208e+57             0.0000e+00        -0.924431747376

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.4914
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.084906e-01 1 1  ON 0
  uu_1                 5.267492e-02 1 1  ON 1
  uu_2                -3.672328e-02 1 1  ON 2
  uu_3                -8.984987e-02 1 1  ON 3
  uu_4                -1.217617e-01 1 1  ON 4
  uu_5                -1.312712e-01 1 1  ON 5
  uu_6                -1.137552e-01 1 1  ON 6
  uu_7                -5.646654e-02 1 1  ON 7
  uu_8                 5.948112e-02 1 1  ON 8
  uu_9                 1.220871e-01 1 1  ON 9
  ud_0                 3.006703e-01 1 1  ON 10
  ud_1                 7.340215e-02 1 1  ON 11
  ud_2                -2.594437e-02 1 1  ON 12
  ud_3                -7.709097e-02 1 1  ON 13
  ud_4                -1.122879e-01 1 1  ON 14
  ud_5                -1.317609e-01 1 1  ON 15
  ud_6                -1.269123e-01 1 1  ON 16
  ud_7                -8.779749e-02 1 1  ON 17
  ud_8                -4.235440e-03 1 1  ON 18
  ud_9                 8.491370e-02 1 1  ON 19
  eO_0                -6.932043e-01 1 1  ON 20
  eO_1                -4.132229e-01 1 1  ON 21
  eO_2                -4.142654e-02 1 1  ON 22
  eO_3                 1.783598e-01 1 1  ON 23
  eO_4                 2.499460e-01 1 1  ON 24
  eO_5                 2.747759e-01 1 1  ON 25
  eO_6                 2.477584e-01 1 1  ON 26
  eO_7                 1.370902e-01 1 1  ON 27
  eO_8                 2.907815e-02 1 1  ON 28
  eO_9                 1.941143e-02 1 1  ON 29
 eH1_0                -2.054429e-01 1 1  ON 30
 eH1_1                -1.005068e-01 1 1  ON 31
 eH1_2                -4.948312e-02 1 1  ON 32
 eH1_3                -1.791148e-02 1 1  ON 33
 eH1_4                 1.722512e-02 1 1  ON 34
 eH1_5                 2.532599e-02 1 1  ON 35
 eH1_6                 7.901743e-02 1 1  ON 36
 eH1_7                 1.070401e-01 1 1  ON 37
 eH1_8                 1.027396e-01 1 1  ON 38
 eH1_9                 2.587884e-02 1 1  ON 39
 eH2_0                -2.016950e-01 1 1  ON 40
 eH2_1                -9.694478e-02 1 1  ON 41
 eH2_2                -4.657011e-02 1 1  ON 42
 eH2_3                -1.598591e-02 1 1  ON 43
 eH2_4                 1.733486e-02 1 1  ON 44
 eH2_5                 2.121233e-02 1 1  ON 45
 eH2_6                 7.058523e-02 1 1  ON 46
 eH2_7                 1.059928e-01 1 1  ON 47
 eH2_8                 1.046974e-01 1 1  ON 48
 eH2_9                 2.830401e-02 1 1  ON 49
ci_001                -4.234820e-02 3 1  ON 50
ci_002                -3.115767e-02 3 1  ON 51
ci_003                -2.574034e-02 3 1  ON 52
ci_004                 2.449476e-02 3 1  ON 53
ci_005                 2.459963e-02 3 1  ON 54
ci_006                -2.028983e-02 3 1  ON 55
ci_007                -2.042712e-02 3 1  ON 56
ci_008                -8.986543e-03 3 1  ON 57
ci_009                -1.503533e-02 3 1  ON 58
ci_010                -9.449101e-03 3 1  ON 59
ci_011                -1.021813e-02 3 1  ON 60
ci_012                -1.008577e-02 3 1  ON 61
ci_013                -1.953204e-02 3 1  ON 62
ci_014                 1.300348e-02 3 1  ON 63
ci_015                 1.321417e-02 3 1  ON 64
ci_016                 1.641275e-02 3 1  ON 65
ci_017                 1.617585e-02 3 1  ON 66
ci_018                 1.019118e-02 3 1  ON 67
ci_019                 1.038108e-02 3 1  ON 68
ci_020                 1.646544e-02 3 1  ON 69
ci_021                 1.644450e-02 3 1  ON 70
ci_022                 1.057049e-02 3 1  ON 71
ci_023                 9.303628e-03 3 1  ON 72
ci_024                 7.513555e-03 3 1  ON 73
ci_025                 6.088060e-03 3 1  ON 74
ci_026                 1.169012e-02 3 1  ON 75
ci_027                 1.166392e-02 3 1  ON 76
ci_028                -1.519464e-02 3 1  ON 77
ci_029                -1.537306e-02 3 1  ON 78
ci_030                -4.449329e-03 3 1  ON 79
ci_031                -4.859836e-03 3 1  ON 80
ci_032                -1.535516e-02 3 1  ON 81
ci_033                 6.942381e-03 3 1  ON 82
ci_034                 7.336025e-03 3 1  ON 83
ci_035                -4.586067e-03 3 1  ON 84
ci_036                -1.273199e-02 3 1  ON 85
ci_037                -1.278210e-02 3 1  ON 86
ci_038                 1.164935e-03 3 1  ON 87
ci_039                 1.335712e-03 3 1  ON 88
ci_040                -2.705603e-03 3 1  ON 89
ci_041                 8.457517e-03 3 1  ON 90
ci_042                 8.382752e-03 3 1  ON 91
ci_043                -3.617790e-03 3 1  ON 92
ci_044                -4.712630e-03 3 1  ON 93
ci_045                -2.790554e-03 3 1  ON 94
ci_046                 5.835381e-03 3 1  ON 95
ci_047                 5.643953e-03 3 1  ON 96
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3720e+01 secs
  Total Execution time = 7.4979e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
