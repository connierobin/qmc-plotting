--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0247.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 84233 MB
Rank =    1  Free Memory = 84219 MB
Rank =    2  Free Memory = 84219 MB
Rank =    3  Free Memory = 84219 MB
Rank =    4  Free Memory = 84219 MB
Rank =    5  Free Memory = 84219 MB
Rank =    6  Free Memory = 84219 MB
Rank =    7  Free Memory = 84219 MB
Rank =    8  Free Memory = 84219 MB
Rank =    9  Free Memory = 84219 MB
Rank =   10  Free Memory = 84219 MB
Rank =   11  Free Memory = 84219 MB
Rank =   12  Free Memory = 84219 MB
Rank =   13  Free Memory = 84219 MB
Rank =   14  Free Memory = 84219 MB
Rank =   15  Free Memory = 84219 MB
Rank =   16  Free Memory = 84219 MB
Rank =   17  Free Memory = 84219 MB
Rank =   18  Free Memory = 84219 MB
Rank =   19  Free Memory = 84219 MB
Rank =   20  Free Memory = 84219 MB
Rank =   21  Free Memory = 84219 MB
Rank =   22  Free Memory = 84219 MB
Rank =   23  Free Memory = 84219 MB
Rank =   24  Free Memory = 84219 MB
Rank =   25  Free Memory = 84219 MB
Rank =   26  Free Memory = 84219 MB
Rank =   27  Free Memory = 84219 MB
Rank =   28  Free Memory = 84219 MB
Rank =   29  Free Memory = 84219 MB
Rank =   30  Free Memory = 84219 MB
Rank =   31  Free Memory = 84219 MB
Rank =   32  Free Memory = 84219 MB
Rank =   33  Free Memory = 84219 MB
Rank =   34  Free Memory = 84219 MB
Rank =   35  Free Memory = 84219 MB
Rank =   36  Free Memory = 84219 MB
Rank =   37  Free Memory = 84219 MB
Rank =   38  Free Memory = 84219 MB
Rank =   39  Free Memory = 84219 MB
Rank =   40  Free Memory = 83430 MB
Rank =   41  Free Memory = 83430 MB
Rank =   42  Free Memory = 83430 MB
Rank =   43  Free Memory = 83430 MB
Rank =   44  Free Memory = 83430 MB
Rank =   45  Free Memory = 83430 MB
Rank =   46  Free Memory = 83430 MB
Rank =   47  Free Memory = 83430 MB
Rank =   48  Free Memory = 83430 MB
Rank =   49  Free Memory = 83430 MB
Rank =   50  Free Memory = 83430 MB
Rank =   51  Free Memory = 83430 MB
Rank =   52  Free Memory = 83430 MB
Rank =   53  Free Memory = 83430 MB
Rank =   54  Free Memory = 83430 MB
Rank =   55  Free Memory = 83430 MB
Rank =   56  Free Memory = 83430 MB
Rank =   57  Free Memory = 83430 MB
Rank =   58  Free Memory = 83430 MB
Rank =   59  Free Memory = 83430 MB
Rank =   60  Free Memory = 83430 MB
Rank =   61  Free Memory = 83430 MB
Rank =   62  Free Memory = 83430 MB
Rank =   63  Free Memory = 83430 MB
Rank =   64  Free Memory = 83430 MB
Rank =   65  Free Memory = 83430 MB
Rank =   66  Free Memory = 83430 MB
Rank =   67  Free Memory = 83429 MB
Rank =   68  Free Memory = 83429 MB
Rank =   69  Free Memory = 83429 MB
Rank =   70  Free Memory = 83429 MB
Rank =   71  Free Memory = 83429 MB
Rank =   72  Free Memory = 83429 MB
Rank =   73  Free Memory = 83429 MB
Rank =   74  Free Memory = 83429 MB
Rank =   75  Free Memory = 83429 MB
Rank =   76  Free Memory = 83429 MB
Rank =   77  Free Memory = 83429 MB
Rank =   78  Free Memory = 83429 MB
Rank =   79  Free Memory = 83429 MB
Rank =   80  Free Memory = 83187 MB
Rank =   81  Free Memory = 83187 MB
Rank =   82  Free Memory = 83187 MB
Rank =   83  Free Memory = 83187 MB
Rank =   84  Free Memory = 83187 MB
Rank =   85  Free Memory = 83187 MB
Rank =   86  Free Memory = 83187 MB
Rank =   87  Free Memory = 83187 MB
Rank =   88  Free Memory = 83187 MB
Rank =   89  Free Memory = 83187 MB
Rank =   90  Free Memory = 83187 MB
Rank =   91  Free Memory = 83187 MB
Rank =   92  Free Memory = 83187 MB
Rank =   93  Free Memory = 83187 MB
Rank =   94  Free Memory = 83187 MB
Rank =   95  Free Memory = 83187 MB
Rank =   96  Free Memory = 83187 MB
Rank =   97  Free Memory = 83187 MB
Rank =   98  Free Memory = 83187 MB
Rank =   99  Free Memory = 83187 MB
Rank =  100  Free Memory = 83187 MB
Rank =  101  Free Memory = 83187 MB
Rank =  102  Free Memory = 83187 MB
Rank =  103  Free Memory = 83187 MB
Rank =  104  Free Memory = 83187 MB
Rank =  105  Free Memory = 83187 MB
Rank =  106  Free Memory = 83187 MB
Rank =  107  Free Memory = 83187 MB
Rank =  108  Free Memory = 83187 MB
Rank =  109  Free Memory = 83187 MB
Rank =  110  Free Memory = 83187 MB
Rank =  111  Free Memory = 83187 MB
Rank =  112  Free Memory = 83187 MB
Rank =  113  Free Memory = 83187 MB
Rank =  114  Free Memory = 83187 MB
Rank =  115  Free Memory = 83187 MB
Rank =  116  Free Memory = 83187 MB
Rank =  117  Free Memory = 83187 MB
Rank =  118  Free Memory = 83187 MB
Rank =  119  Free Memory = 83187 MB
  Input file(s): opt_form_gs_gvpabs_run002n.xml 
Rank =  120  Free Memory = 84437 MB
Rank =  121  Free Memory = 84437 MB
Rank =  127  Free Memory = 84437 MB
Rank =  122  Free Memory = 84437 MB
Rank =  123  Free Memory = 84437 MB
Rank =  124  Free Memory = 84437 MB
Rank =  125  Free Memory = 84437 MB
Rank =  126  Free Memory = 84437 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_gvpabs_run002n.xml

  Project = FORM
  date    = 2023-04-09 19:05:10 PDT
  host    = n0234.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 726

  Range of prime numbers to use as seeds over processors and threads = 5507-6637


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.664783e-01    1         1  ON     0
     uu_1                 9.249808e-02    1         1  ON     1
     uu_2                -1.873842e-02    1         1  ON     2
     uu_3                -8.391695e-02    1         1  ON     3
     uu_4                -1.211232e-01    1         1  ON     4
     uu_5                -1.433658e-01    1         1  ON     5
     uu_6                -1.556002e-01    1         1  ON     6
     uu_7                -1.568645e-01    1         1  ON     7
     uu_8                -1.435382e-01    1         1  ON     8
     uu_9                -1.063369e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.385533e-01    1         1  ON     0
     ud_1                 1.563148e-01    1         1  ON     1
     ud_2                 1.048389e-02    1         1  ON     2
     ud_3                -6.939507e-02    1         1  ON     3
     ud_4                -1.163764e-01    1         1  ON     4
     ud_5                -1.459841e-01    1         1  ON     5
     ud_6                -1.638431e-01    1         1  ON     6
     ud_7                -1.693212e-01    1         1  ON     7
     ud_8                -1.575847e-01    1         1  ON     8
     ud_9                -1.246153e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.615608e-01    1         1  ON     0
     eC_1                -4.069796e-01    1         1  ON     1
     eC_2                -1.565496e-01    1         1  ON     2
     eC_3                -7.988006e-03    1         1  ON     3
     eC_4                 4.417923e-02    1         1  ON     4
     eC_5                 1.354077e-01    1         1  ON     5
     eC_6                 2.551366e-01    1         1  ON     6
     eC_7                 3.887734e-01    1         1  ON     7
     eC_8                 2.462322e-01    1         1  ON     8
     eC_9                 5.992534e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.224971e+00    1         1  ON     0
     eO_1                -8.464779e-01    1         1  ON     1
     eO_2                -3.681017e-01    1         1  ON     2
     eO_3                -2.412454e-02    1         1  ON     3
     eO_4                 2.024768e-01    1         1  ON     4
     eO_5                 3.832419e-01    1         1  ON     5
     eO_6                 4.683382e-01    1         1  ON     6
     eO_7                 5.218843e-01    1         1  ON     7
     eO_8                 4.602161e-01    1         1  ON     8
     eO_9                 2.918664e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820721e-01    1         1  ON     0
     eH1_1                -9.474299e-02    1         1  ON     1
     eH1_2                -6.220731e-02    1         1  ON     2
     eH1_3                -4.723889e-02    1         1  ON     3
     eH1_4                 1.240447e-02    1         1  ON     4
     eH1_5                 6.672275e-02    1         1  ON     5
     eH1_6                 1.201583e-01    1         1  ON     6
     eH1_7                 9.196306e-02    1         1  ON     7
     eH1_8                 4.802343e-03    1         1  ON     8
     eH1_9                 1.150751e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.833490e-01    1         1  ON     0
     eH2_1                -9.544051e-02    1         1  ON     1
     eH2_2                -6.231624e-02    1         1  ON     2
     eH2_3                -4.741999e-02    1         1  ON     3
     eH2_4                 1.191618e-02    1         1  ON     4
     eH2_5                 6.667505e-02    1         1  ON     5
     eH2_6                 1.195983e-01    1         1  ON     6
     eH2_7                 9.197146e-02    1         1  ON     7
     eH2_8                -2.463624e-04    1         1  ON     8
     eH2_9                 1.429061e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.710103e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.1151e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0234.savio3:56690] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0234.savio3:56690] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8407
    reference variance = 0.404925
====================================================
  Execution time = 4.4807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499057374710
                                         uncertainty =       0.003118064335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499057374710
                                         uncertainty =       0.003118064335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499501059
  error estimate for blocks of size 2^( 2) =       0.000517182438
  error estimate for blocks of size 2^( 3) =       0.000533612265
  error estimate for blocks of size 2^( 4) =       0.000544933897
  error estimate for blocks of size 2^( 5) =       0.000552622498
  error estimate for blocks of size 2^( 6) =       0.000556636618
  error estimate for blocks of size 2^( 7) =       0.000559264757

      target function =                  N/A
              le_mean =     -22.825286050809
             les_mean =     521.492685667841
             stat err =       0.000553364442
             autocorr =       1.227296997074
              std dev =       0.706401172208
             le_variance =       0.499002616096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282528605081e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825286050809       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825284875575       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825285163661       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825286927537       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825285540198       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825286457668       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825287087797       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825287346208       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825287640958       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825288039532       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825287942979       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825288056796       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825287668234       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 5.469846e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825286050809       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825285614665       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825285598003       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825286414379       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825286090497       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825286083679       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825286263125       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825286381502       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825286622885       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825286703795       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825286662852       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.555032e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825286050809       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825285926747       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825285908717       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825286162608       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825286109600       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825286088034       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825286135546       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825286138907       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825286215939       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825286243777       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 4.032242e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9859e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.665192e-01                 1 1 ON  0
uu_1  9.259372e-02                 1 1 ON  1
uu_2  -1.869446e-02                1 1 ON  2
uu_3  -8.390818e-02                1 1 ON  3
uu_4  -1.210902e-01                1 1 ON  4
uu_5  -1.433763e-01                1 1 ON  5
uu_6  -1.556592e-01                1 1 ON  6
uu_7  -1.569706e-01                1 1 ON  7
uu_8  -1.435698e-01                1 1 ON  8
uu_9  -1.063805e-01                1 1 ON  9
ud_0  4.386229e-01                 1 1 ON  10
ud_1  1.563491e-01                 1 1 ON  11
ud_2  1.051725e-02                 1 1 ON  12
ud_3  -6.938734e-02                1 1 ON  13
ud_4  -1.164261e-01                1 1 ON  14
ud_5  -1.459259e-01                1 1 ON  15
ud_6  -1.638265e-01                1 1 ON  16
ud_7  -1.692727e-01                1 1 ON  17
ud_8  -1.576285e-01                1 1 ON  18
ud_9  -1.246666e-01                1 1 ON  19
eC_0  -5.614730e-01                1 1 ON  20
eC_1  -4.071215e-01                1 1 ON  21
eC_2  -1.566585e-01                1 1 ON  22
eC_3  -7.897550e-03                1 1 ON  23
eC_4  4.413988e-02                 1 1 ON  24
eC_5  1.353860e-01                 1 1 ON  25
eC_6  2.551023e-01                 1 1 ON  26
eC_7  3.887597e-01                 1 1 ON  27
eC_8  2.463567e-01                 1 1 ON  28
eC_9  5.997727e-02                 1 1 ON  29
eO_0  -1.225127e+00                1 1 ON  30
eO_1  -8.465735e-01                1 1 ON  31
eO_2  -3.681268e-01                1 1 ON  32
eO_3  -2.407436e-02                1 1 ON  33
eO_4  2.023492e-01                 1 1 ON  34
eO_5  3.833567e-01                 1 1 ON  35
eO_6  4.683309e-01                 1 1 ON  36
eO_7  5.218849e-01                 1 1 ON  37
eO_8  4.602693e-01                 1 1 ON  38
eO_9  2.919730e-01                 1 1 ON  39
eH1_0 -1.820301e-01                1 1 ON  40
eH1_1 -9.478085e-02                1 1 ON  41
eH1_2 -6.220994e-02                1 1 ON  42
eH1_3 -4.723364e-02                1 1 ON  43
eH1_4 1.236465e-02                 1 1 ON  44
eH1_5 6.673448e-02                 1 1 ON  45
eH1_6 1.201024e-01                 1 1 ON  46
eH1_7 9.202810e-02                 1 1 ON  47
eH1_8 4.815250e-03                 1 1 ON  48
eH1_9 1.146312e-02                 1 1 ON  49
eH2_0 -1.833676e-01                1 1 ON  50
eH2_1 -9.536047e-02                1 1 ON  51
eH2_2 -6.244825e-02                1 1 ON  52
eH2_3 -4.750392e-02                1 1 ON  53
eH2_4 1.196239e-02                 1 1 ON  54
eH2_5 6.666221e-02                 1 1 ON  55
eH2_6 1.197197e-01                 1 1 ON  56
eH2_7 9.192641e-02                 1 1 ON  57
eH2_8 -1.979722e-04                1 1 ON  58
eH2_9 1.425003e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8756
    reference variance = 0.357713
====================================================
  Execution time = 4.5640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0560e-01
  Total weights = 2.0000e+06
  Execution time = 3.5504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505625475263
                                         uncertainty =       0.004213582272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505625475263
                                         uncertainty =       0.004213582272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502758419
  error estimate for blocks of size 2^( 2) =       0.000519944294
  error estimate for blocks of size 2^( 3) =       0.000535892015
  error estimate for blocks of size 2^( 4) =       0.000546547864
  error estimate for blocks of size 2^( 5) =       0.000553387337
  error estimate for blocks of size 2^( 6) =       0.000557038488
  error estimate for blocks of size 2^( 7) =       0.000556932957

      target function =                  N/A
              le_mean =     -22.825199559910
             les_mean =     521.495266751731
             stat err =       0.000553476661
             autocorr =       1.211936658063
              std dev =       0.711007774058
             le_variance =       0.505532054771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505832536261
                                         uncertainty =       0.004215594174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505832536261
                                         uncertainty =       0.004215594174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502861396
  error estimate for blocks of size 2^( 2) =       0.000520041042
  error estimate for blocks of size 2^( 3) =       0.000535981635
  error estimate for blocks of size 2^( 4) =       0.000546632440
  error estimate for blocks of size 2^( 5) =       0.000553471627
  error estimate for blocks of size 2^( 6) =       0.000557123603
  error estimate for blocks of size 2^( 7) =       0.000557026658

      target function =                  N/A
              le_mean =     -22.825199402606
             les_mean =     521.495466683915
             stat err =       0.000553563582
             autocorr =       1.211820869733
              std dev =       0.711153406847
             le_variance =       0.505739168070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505754486571
                                         uncertainty =       0.004215300878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505754486571
                                         uncertainty =       0.004215300878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502822590
  error estimate for blocks of size 2^( 2) =       0.000520003962
  error estimate for blocks of size 2^( 3) =       0.000535946711
  error estimate for blocks of size 2^( 4) =       0.000546600271
  error estimate for blocks of size 2^( 5) =       0.000553440719
  error estimate for blocks of size 2^( 6) =       0.000557092898
  error estimate for blocks of size 2^( 7) =       0.000556994656

      target function =                  N/A
              le_mean =     -22.825199501904
             les_mean =     521.495393163036
             stat err =       0.000553532136
             autocorr =       1.211870231153
              std dev =       0.711098526342
             le_variance =       0.505661114166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505643911910
                                         uncertainty =       0.004213885186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505643911910
                                         uncertainty =       0.004213885186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502767589
  error estimate for blocks of size 2^( 2) =       0.000519952711
  error estimate for blocks of size 2^( 3) =       0.000535899651
  error estimate for blocks of size 2^( 4) =       0.000546555181
  error estimate for blocks of size 2^( 5) =       0.000553394838
  error estimate for blocks of size 2^( 6) =       0.000557046236
  error estimate for blocks of size 2^( 7) =       0.000556941830

      target function =                  N/A
              le_mean =     -22.825199490038
             les_mean =     521.495282004855
             stat err =       0.000553484521
             autocorr =       1.211926867369
              std dev =       0.711020743447
             le_variance =       0.505550497612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825199559910        initial  <--
     2.5000e-01     2.5000e+00             5.4698e-04       -22.825199402606
     1.0000e+00     1.0000e+01             1.5550e-04       -22.825199501904
     4.0000e+00     4.0000e+01             4.0322e-05       -22.825199490038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4313
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.664783e-01 1 1  ON 0
 uu_1                 9.249808e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391695e-02 1 1  ON 3
 uu_4                -1.211232e-01 1 1  ON 4
 uu_5                -1.433658e-01 1 1  ON 5
 uu_6                -1.556002e-01 1 1  ON 6
 uu_7                -1.568645e-01 1 1  ON 7
 uu_8                -1.435382e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385533e-01 1 1  ON 10
 ud_1                 1.563148e-01 1 1  ON 11
 ud_2                 1.048389e-02 1 1  ON 12
 ud_3                -6.939507e-02 1 1  ON 13
 ud_4                -1.163764e-01 1 1  ON 14
 ud_5                -1.459841e-01 1 1  ON 15
 ud_6                -1.638431e-01 1 1  ON 16
 ud_7                -1.693212e-01 1 1  ON 17
 ud_8                -1.575847e-01 1 1  ON 18
 ud_9                -1.246153e-01 1 1  ON 19
 eC_0                -5.615608e-01 1 1  ON 20
 eC_1                -4.069796e-01 1 1  ON 21
 eC_2                -1.565496e-01 1 1  ON 22
 eC_3                -7.988006e-03 1 1  ON 23
 eC_4                 4.417923e-02 1 1  ON 24
 eC_5                 1.354077e-01 1 1  ON 25
 eC_6                 2.551366e-01 1 1  ON 26
 eC_7                 3.887734e-01 1 1  ON 27
 eC_8                 2.462322e-01 1 1  ON 28
 eC_9                 5.992534e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464779e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412454e-02 1 1  ON 33
 eO_4                 2.024768e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683382e-01 1 1  ON 36
 eO_7                 5.218843e-01 1 1  ON 37
 eO_8                 4.602161e-01 1 1  ON 38
 eO_9                 2.918664e-01 1 1  ON 39
eH1_0                -1.820721e-01 1 1  ON 40
eH1_1                -9.474299e-02 1 1  ON 41
eH1_2                -6.220731e-02 1 1  ON 42
eH1_3                -4.723889e-02 1 1  ON 43
eH1_4                 1.240447e-02 1 1  ON 44
eH1_5                 6.672275e-02 1 1  ON 45
eH1_6                 1.201583e-01 1 1  ON 46
eH1_7                 9.196306e-02 1 1  ON 47
eH1_8                 4.802343e-03 1 1  ON 48
eH1_9                 1.150751e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544051e-02 1 1  ON 51
eH2_2                -6.231624e-02 1 1  ON 52
eH2_3                -4.741999e-02 1 1  ON 53
eH2_4                 1.191618e-02 1 1  ON 54
eH2_5                 6.667505e-02 1 1  ON 55
eH2_6                 1.195983e-01 1 1  ON 56
eH2_7                 9.197146e-02 1 1  ON 57
eH2_8                -2.463624e-04 1 1  ON 58
eH2_9                 1.429061e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2330e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2858e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8757
    reference variance = 0.610041
====================================================
  Execution time = 4.4818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.1068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5261e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510752224619
                                         uncertainty =       0.004838136436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510752224619
                                         uncertainty =       0.004838136436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505312387
  error estimate for blocks of size 2^( 2) =       0.000523222296
  error estimate for blocks of size 2^( 3) =       0.000537741773
  error estimate for blocks of size 2^( 4) =       0.000548591132
  error estimate for blocks of size 2^( 5) =       0.000554872067
  error estimate for blocks of size 2^( 6) =       0.000557876537
  error estimate for blocks of size 2^( 7) =       0.000561897705

      target function =                  N/A
              le_mean =     -22.826711613034
             les_mean =     521.569444027119
             stat err =       0.000555809360
             autocorr =       1.209850819361
              std dev =       0.714619631587
             le_variance =       0.510681217850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282671161303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826711613034       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826711621522       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826711504723       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826711491260       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826711348322       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826711320250       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826711377931       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826711508880       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826711470846       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826711475247       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 6.162311e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826711613034       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826711615315       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826711584753       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826711582449       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826711545461       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826711533314       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826711537346       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826711573163       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826711565685       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826711566195       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.742584e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826711613034       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826711613615       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826711605881       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826711605386       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826711596032       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826711592632       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826711592873       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826711601772       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826711600161       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826711600266       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 4.507953e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0087e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.664771e-01 1 1  ON 0
 uu_1                 9.249516e-02 1 1  ON 1
 uu_2                -1.873409e-02 1 1  ON 2
 uu_3                -8.391406e-02 1 1  ON 3
 uu_4                -1.211235e-01 1 1  ON 4
 uu_5                -1.433677e-01 1 1  ON 5
 uu_6                -1.556007e-01 1 1  ON 6
 uu_7                -1.568607e-01 1 1  ON 7
 uu_8                -1.435369e-01 1 1  ON 8
 uu_9                -1.063436e-01 1 1  ON 9
 ud_0                 4.385641e-01 1 1  ON 10
 ud_1                 1.563084e-01 1 1  ON 11
 ud_2                 1.049003e-02 1 1  ON 12
 ud_3                -6.939486e-02 1 1  ON 13
 ud_4                -1.163753e-01 1 1  ON 14
 ud_5                -1.459946e-01 1 1  ON 15
 ud_6                -1.638256e-01 1 1  ON 16
 ud_7                -1.693148e-01 1 1  ON 17
 ud_8                -1.575869e-01 1 1  ON 18
 ud_9                -1.246241e-01 1 1  ON 19
 eC_0                -5.615635e-01 1 1  ON 20
 eC_1                -4.069779e-01 1 1  ON 21
 eC_2                -1.565443e-01 1 1  ON 22
 eC_3                -7.991938e-03 1 1  ON 23
 eC_4                 4.417063e-02 1 1  ON 24
 eC_5                 1.354030e-01 1 1  ON 25
 eC_6                 2.551329e-01 1 1  ON 26
 eC_7                 3.887752e-01 1 1  ON 27
 eC_8                 2.462422e-01 1 1  ON 28
 eC_9                 5.993005e-02 1 1  ON 29
 eO_0                -1.224984e+00 1 1  ON 30
 eO_1                -8.464836e-01 1 1  ON 31
 eO_2                -3.681115e-01 1 1  ON 32
 eO_3                -2.412877e-02 1 1  ON 33
 eO_4                 2.024659e-01 1 1  ON 34
 eO_5                 3.832548e-01 1 1  ON 35
 eO_6                 4.683347e-01 1 1  ON 36
 eO_7                 5.218900e-01 1 1  ON 37
 eO_8                 4.602224e-01 1 1  ON 38
 eO_9                 2.918783e-01 1 1  ON 39
eH1_0                -1.820765e-01 1 1  ON 40
eH1_1                -9.474509e-02 1 1  ON 41
eH1_2                -6.221733e-02 1 1  ON 42
eH1_3                -4.724523e-02 1 1  ON 43
eH1_4                 1.240466e-02 1 1  ON 44
eH1_5                 6.672934e-02 1 1  ON 45
eH1_6                 1.201685e-01 1 1  ON 46
eH1_7                 9.196807e-02 1 1  ON 47
eH1_8                 4.806981e-03 1 1  ON 48
eH1_9                 1.150156e-02 1 1  ON 49
eH2_0                -1.833346e-01 1 1  ON 50
eH2_1                -9.543131e-02 1 1  ON 51
eH2_2                -6.231428e-02 1 1  ON 52
eH2_3                -4.742821e-02 1 1  ON 53
eH2_4                 1.192060e-02 1 1  ON 54
eH2_5                 6.668099e-02 1 1  ON 55
eH2_6                 1.195849e-01 1 1  ON 56
eH2_7                 9.195921e-02 1 1  ON 57
eH2_8                -2.436082e-04 1 1  ON 58
eH2_9                 1.428261e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7953
    reference variance = 0.423978
====================================================
  Execution time = 4.3949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9839e-01
  Total weights = 2.0000e+06
  Execution time = 3.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498466447148
                                         uncertainty =       0.004587627640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498466447148
                                         uncertainty =       0.004587627640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499193039
  error estimate for blocks of size 2^( 2) =       0.000516812255
  error estimate for blocks of size 2^( 3) =       0.000532855632
  error estimate for blocks of size 2^( 4) =       0.000544010602
  error estimate for blocks of size 2^( 5) =       0.000551191977
  error estimate for blocks of size 2^( 6) =       0.000553748774
  error estimate for blocks of size 2^( 7) =       0.000556378360

      target function =                  N/A
              le_mean =     -22.825453398219
             les_mean =     521.499709965179
             stat err =       0.000551332428
             autocorr =       1.219803945845
              std dev =       0.705965565798
             le_variance =       0.498387380092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469972528
                                         uncertainty =       0.004587604577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469972528
                                         uncertainty =       0.004587604577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499194795
  error estimate for blocks of size 2^( 2) =       0.000516814523
  error estimate for blocks of size 2^( 3) =       0.000532858394
  error estimate for blocks of size 2^( 4) =       0.000544012503
  error estimate for blocks of size 2^( 5) =       0.000551192994
  error estimate for blocks of size 2^( 6) =       0.000553751117
  error estimate for blocks of size 2^( 7) =       0.000556380846

      target function =                  N/A
              le_mean =     -22.825453265797
             les_mean =     521.499707427141
             stat err =       0.000551334365
             autocorr =       1.219803933077
              std dev =       0.705968049726
             le_variance =       0.498390887234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469425444
                                         uncertainty =       0.004587623297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469425444
                                         uncertainty =       0.004587623297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499194525
  error estimate for blocks of size 2^( 2) =       0.000516814001
  error estimate for blocks of size 2^( 3) =       0.000532857662
  error estimate for blocks of size 2^( 4) =       0.000544012135
  error estimate for blocks of size 2^( 5) =       0.000551193038
  error estimate for blocks of size 2^( 6) =       0.000553750653
  error estimate for blocks of size 2^( 7) =       0.000556380284

      target function =                  N/A
              le_mean =     -22.825453331855
             les_mean =     521.499709903050
             stat err =       0.000551334028
             autocorr =       1.219803759930
              std dev =       0.705967667487
             le_variance =       0.498390347538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498466863465
                                         uncertainty =       0.004587627386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498466863465
                                         uncertainty =       0.004587627386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499193247
  error estimate for blocks of size 2^( 2) =       0.000516812495
  error estimate for blocks of size 2^( 3) =       0.000532855909
  error estimate for blocks of size 2^( 4) =       0.000544010815
  error estimate for blocks of size 2^( 5) =       0.000551192129
  error estimate for blocks of size 2^( 6) =       0.000553749034
  error estimate for blocks of size 2^( 7) =       0.000556378625

      target function =                  N/A
              le_mean =     -22.825453389365
             les_mean =     521.499709975874
             stat err =       0.000551332651
             autocorr =       1.219803915203
              std dev =       0.705965859644
             le_variance =       0.498387794983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825453398219        initial  <--
     2.5000e+00     2.5000e+01             6.1623e-05       -22.825453265797
     1.0000e+01     1.0000e+02             1.7426e-05       -22.825453331855
     4.0000e+01     4.0000e+02             4.5080e-06       -22.825453389365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7850
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.664783e-01 1 1  ON 0
 uu_1                 9.249808e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391695e-02 1 1  ON 3
 uu_4                -1.211232e-01 1 1  ON 4
 uu_5                -1.433658e-01 1 1  ON 5
 uu_6                -1.556002e-01 1 1  ON 6
 uu_7                -1.568645e-01 1 1  ON 7
 uu_8                -1.435382e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385533e-01 1 1  ON 10
 ud_1                 1.563148e-01 1 1  ON 11
 ud_2                 1.048389e-02 1 1  ON 12
 ud_3                -6.939507e-02 1 1  ON 13
 ud_4                -1.163764e-01 1 1  ON 14
 ud_5                -1.459841e-01 1 1  ON 15
 ud_6                -1.638431e-01 1 1  ON 16
 ud_7                -1.693212e-01 1 1  ON 17
 ud_8                -1.575847e-01 1 1  ON 18
 ud_9                -1.246153e-01 1 1  ON 19
 eC_0                -5.615608e-01 1 1  ON 20
 eC_1                -4.069796e-01 1 1  ON 21
 eC_2                -1.565496e-01 1 1  ON 22
 eC_3                -7.988006e-03 1 1  ON 23
 eC_4                 4.417923e-02 1 1  ON 24
 eC_5                 1.354077e-01 1 1  ON 25
 eC_6                 2.551366e-01 1 1  ON 26
 eC_7                 3.887734e-01 1 1  ON 27
 eC_8                 2.462322e-01 1 1  ON 28
 eC_9                 5.992534e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464779e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412454e-02 1 1  ON 33
 eO_4                 2.024768e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683382e-01 1 1  ON 36
 eO_7                 5.218843e-01 1 1  ON 37
 eO_8                 4.602161e-01 1 1  ON 38
 eO_9                 2.918664e-01 1 1  ON 39
eH1_0                -1.820721e-01 1 1  ON 40
eH1_1                -9.474299e-02 1 1  ON 41
eH1_2                -6.220731e-02 1 1  ON 42
eH1_3                -4.723889e-02 1 1  ON 43
eH1_4                 1.240447e-02 1 1  ON 44
eH1_5                 6.672275e-02 1 1  ON 45
eH1_6                 1.201583e-01 1 1  ON 46
eH1_7                 9.196306e-02 1 1  ON 47
eH1_8                 4.802343e-03 1 1  ON 48
eH1_9                 1.150751e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544051e-02 1 1  ON 51
eH2_2                -6.231624e-02 1 1  ON 52
eH2_3                -4.741999e-02 1 1  ON 53
eH2_4                 1.191618e-02 1 1  ON 54
eH2_5                 6.667505e-02 1 1  ON 55
eH2_6                 1.195983e-01 1 1  ON 56
eH2_7                 9.197146e-02 1 1  ON 57
eH2_8                -2.463624e-04 1 1  ON 58
eH2_9                 1.429061e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2207e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2847e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7271
    reference variance = 0.38149
====================================================
  Execution time = 4.3971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5265e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502932918742
                                         uncertainty =       0.003814175804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502932918742
                                         uncertainty =       0.003814175804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501614637
  error estimate for blocks of size 2^( 2) =       0.000519693999
  error estimate for blocks of size 2^( 3) =       0.000534996635
  error estimate for blocks of size 2^( 4) =       0.000545694058
  error estimate for blocks of size 2^( 5) =       0.000552261822
  error estimate for blocks of size 2^( 6) =       0.000554023831
  error estimate for blocks of size 2^( 7) =       0.000555279012

      target function =                  N/A
              le_mean =     -22.825336271984
             les_mean =     521.499210166391
             stat err =       0.000551814681
             autocorr =       1.210169209695
              std dev =       0.709390223256
             le_variance =       0.503234488851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282533627198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825336271984       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825336275179       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825336309742       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825336308704       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825336313030       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825336303429       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825336318581       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825336322684       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825336323385       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825336322250       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 7.760196e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825336271984       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825336272786       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825336281449       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825336281225       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825336282348       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825336279880       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825336283668       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825336284695       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825336284867       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825336284556       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.972707e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825336271984       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825336272185       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825336274352       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825336274298       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825336274582       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825336273961       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825336274908       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825336275164       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825336275207       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825336275127       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 4.952551e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9244e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.664797e-01 1 1  ON 0
 uu_1                 9.249810e-02 1 1  ON 1
 uu_2                -1.873792e-02 1 1  ON 2
 uu_3                -8.391607e-02 1 1  ON 3
 uu_4                -1.211231e-01 1 1  ON 4
 uu_5                -1.433647e-01 1 1  ON 5
 uu_6                -1.556005e-01 1 1  ON 6
 uu_7                -1.568647e-01 1 1  ON 7
 uu_8                -1.435395e-01 1 1  ON 8
 uu_9                -1.063384e-01 1 1  ON 9
 ud_0                 4.385553e-01 1 1  ON 10
 ud_1                 1.563143e-01 1 1  ON 11
 ud_2                 1.048376e-02 1 1  ON 12
 ud_3                -6.939552e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459844e-01 1 1  ON 15
 ud_6                -1.638415e-01 1 1  ON 16
 ud_7                -1.693194e-01 1 1  ON 17
 ud_8                -1.575859e-01 1 1  ON 18
 ud_9                -1.246161e-01 1 1  ON 19
 eC_0                -5.615608e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565493e-01 1 1  ON 22
 eC_3                -7.987155e-03 1 1  ON 23
 eC_4                 4.417826e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551357e-01 1 1  ON 26
 eC_7                 3.887730e-01 1 1  ON 27
 eC_8                 2.462331e-01 1 1  ON 28
 eC_9                 5.992570e-02 1 1  ON 29
 eO_0                -1.224972e+00 1 1  ON 30
 eO_1                -8.464793e-01 1 1  ON 31
 eO_2                -3.681029e-01 1 1  ON 32
 eO_3                -2.412475e-02 1 1  ON 33
 eO_4                 2.024766e-01 1 1  ON 34
 eO_5                 3.832422e-01 1 1  ON 35
 eO_6                 4.683388e-01 1 1  ON 36
 eO_7                 5.218850e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918674e-01 1 1  ON 39
eH1_0                -1.820713e-01 1 1  ON 40
eH1_1                -9.474106e-02 1 1  ON 41
eH1_2                -6.220740e-02 1 1  ON 42
eH1_3                -4.723928e-02 1 1  ON 43
eH1_4                 1.240361e-02 1 1  ON 44
eH1_5                 6.672404e-02 1 1  ON 45
eH1_6                 1.201565e-01 1 1  ON 46
eH1_7                 9.196318e-02 1 1  ON 47
eH1_8                 4.801882e-03 1 1  ON 48
eH1_9                 1.150677e-02 1 1  ON 49
eH2_0                -1.833491e-01 1 1  ON 50
eH2_1                -9.543940e-02 1 1  ON 51
eH2_2                -6.231753e-02 1 1  ON 52
eH2_3                -4.741881e-02 1 1  ON 53
eH2_4                 1.191671e-02 1 1  ON 54
eH2_5                 6.667448e-02 1 1  ON 55
eH2_6                 1.195989e-01 1 1  ON 56
eH2_7                 9.197060e-02 1 1  ON 57
eH2_8                -2.465149e-04 1 1  ON 58
eH2_9                 1.428973e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8911
    reference variance = 0.58128
====================================================
  Execution time = 4.3564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0595e-01
  Total weights = 2.0000e+06
  Execution time = 3.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506008102498
                                         uncertainty =       0.005755956574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506008102498
                                         uncertainty =       0.005755956574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502967619
  error estimate for blocks of size 2^( 2) =       0.000520494690
  error estimate for blocks of size 2^( 3) =       0.000536534679
  error estimate for blocks of size 2^( 4) =       0.000548251275
  error estimate for blocks of size 2^( 5) =       0.000553419860
  error estimate for blocks of size 2^( 6) =       0.000556384830
  error estimate for blocks of size 2^( 7) =       0.000559223547

      target function =                  N/A
              le_mean =     -22.825050349408
             les_mean =     521.488876051657
             stat err =       0.000554319878
             autocorr =       1.214621189549
              std dev =       0.711303628298
             le_variance =       0.505952851630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506016868299
                                         uncertainty =       0.005756070634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506016868299
                                         uncertainty =       0.005756070634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502971975
  error estimate for blocks of size 2^( 2) =       0.000520498867
  error estimate for blocks of size 2^( 3) =       0.000536538668
  error estimate for blocks of size 2^( 4) =       0.000548255084
  error estimate for blocks of size 2^( 5) =       0.000553423591
  error estimate for blocks of size 2^( 6) =       0.000556388654
  error estimate for blocks of size 2^( 7) =       0.000559227268

      target function =                  N/A
              le_mean =     -22.825050334948
             les_mean =     521.488884154674
             stat err =       0.000554323649
             autocorr =       1.214616678812
              std dev =       0.711309788176
             le_variance =       0.505961614756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506012552446
                                         uncertainty =       0.005756014402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506012552446
                                         uncertainty =       0.005756014402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502969830
  error estimate for blocks of size 2^( 2) =       0.000520496810
  error estimate for blocks of size 2^( 3) =       0.000536536705
  error estimate for blocks of size 2^( 4) =       0.000548253209
  error estimate for blocks of size 2^( 5) =       0.000553421754
  error estimate for blocks of size 2^( 6) =       0.000556386772
  error estimate for blocks of size 2^( 7) =       0.000559225438

      target function =                  N/A
              le_mean =     -22.825050341966
             les_mean =     521.488880160541
             stat err =       0.000554321793
             autocorr =       1.214618903375
              std dev =       0.711306755359
             le_variance =       0.505957300220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506008660805
                                         uncertainty =       0.005755963828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506008660805
                                         uncertainty =       0.005755963828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502967896
  error estimate for blocks of size 2^( 2) =       0.000520494956
  error estimate for blocks of size 2^( 3) =       0.000536534933
  error estimate for blocks of size 2^( 4) =       0.000548251518
  error estimate for blocks of size 2^( 5) =       0.000553420098
  error estimate for blocks of size 2^( 6) =       0.000556385074
  error estimate for blocks of size 2^( 7) =       0.000559223784

      target function =                  N/A
              le_mean =     -22.825050348461
             les_mean =     521.488876566582
             stat err =       0.000554320118
             autocorr =       1.214620902792
              std dev =       0.711304020632
             le_variance =       0.505953409767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825050349408        initial  <--
     2.5000e+01     2.5000e+02             7.7602e-06       -22.825050334948
     1.0000e+02     1.0000e+03             1.9727e-06       -22.825050341966
     4.0000e+02     4.0000e+03             4.9526e-07       -22.825050348461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5798
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.664783e-01 1 1  ON 0
 uu_1                 9.249808e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391695e-02 1 1  ON 3
 uu_4                -1.211232e-01 1 1  ON 4
 uu_5                -1.433658e-01 1 1  ON 5
 uu_6                -1.556002e-01 1 1  ON 6
 uu_7                -1.568645e-01 1 1  ON 7
 uu_8                -1.435382e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385533e-01 1 1  ON 10
 ud_1                 1.563148e-01 1 1  ON 11
 ud_2                 1.048389e-02 1 1  ON 12
 ud_3                -6.939507e-02 1 1  ON 13
 ud_4                -1.163764e-01 1 1  ON 14
 ud_5                -1.459841e-01 1 1  ON 15
 ud_6                -1.638431e-01 1 1  ON 16
 ud_7                -1.693212e-01 1 1  ON 17
 ud_8                -1.575847e-01 1 1  ON 18
 ud_9                -1.246153e-01 1 1  ON 19
 eC_0                -5.615608e-01 1 1  ON 20
 eC_1                -4.069796e-01 1 1  ON 21
 eC_2                -1.565496e-01 1 1  ON 22
 eC_3                -7.988006e-03 1 1  ON 23
 eC_4                 4.417923e-02 1 1  ON 24
 eC_5                 1.354077e-01 1 1  ON 25
 eC_6                 2.551366e-01 1 1  ON 26
 eC_7                 3.887734e-01 1 1  ON 27
 eC_8                 2.462322e-01 1 1  ON 28
 eC_9                 5.992534e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464779e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412454e-02 1 1  ON 33
 eO_4                 2.024768e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683382e-01 1 1  ON 36
 eO_7                 5.218843e-01 1 1  ON 37
 eO_8                 4.602161e-01 1 1  ON 38
 eO_9                 2.918664e-01 1 1  ON 39
eH1_0                -1.820721e-01 1 1  ON 40
eH1_1                -9.474299e-02 1 1  ON 41
eH1_2                -6.220731e-02 1 1  ON 42
eH1_3                -4.723889e-02 1 1  ON 43
eH1_4                 1.240447e-02 1 1  ON 44
eH1_5                 6.672275e-02 1 1  ON 45
eH1_6                 1.201583e-01 1 1  ON 46
eH1_7                 9.196306e-02 1 1  ON 47
eH1_8                 4.802343e-03 1 1  ON 48
eH1_9                 1.150751e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544051e-02 1 1  ON 51
eH2_2                -6.231624e-02 1 1  ON 52
eH2_3                -4.741999e-02 1 1  ON 53
eH2_4                 1.191618e-02 1 1  ON 54
eH2_5                 6.667505e-02 1 1  ON 55
eH2_6                 1.195983e-01 1 1  ON 56
eH2_7                 9.197146e-02 1 1  ON 57
eH2_8                -2.463624e-04 1 1  ON 58
eH2_9                 1.429061e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2085e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8418
    reference variance = 0.499422
====================================================
  Execution time = 4.6840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0157e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5176e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501469978970
                                         uncertainty =       0.004493834917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501469978970
                                         uncertainty =       0.004493834917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500783699
  error estimate for blocks of size 2^( 2) =       0.000518450673
  error estimate for blocks of size 2^( 3) =       0.000534475961
  error estimate for blocks of size 2^( 4) =       0.000544326476
  error estimate for blocks of size 2^( 5) =       0.000552151895
  error estimate for blocks of size 2^( 6) =       0.000557486736
  error estimate for blocks of size 2^( 7) =       0.000559768955

      target function =                  N/A
              le_mean =     -22.825276148405
             les_mean =     521.494799626824
             stat err =       0.000553433515
             autocorr =       1.221323024534
              std dev =       0.708215099138
             le_variance =       0.501568626647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282527614841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825276148405       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825276149225       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825276149097       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825276149692       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825276150918       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825276151775       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825276153205       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825276153194       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825276153745       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825276153553       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 1.109494e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825276148405       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825276148610       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825276148578       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825276148727       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825276149033       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825276149248       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825276149605       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825276149606       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825276149741       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825276149696       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 2.775573e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825276148405       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825276148457       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825276148449       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825276148486       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825276148563       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825276148617       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825276148708       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825276148700       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825276148733       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825276148714       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 6.940084e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2024e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.664784e-01 1 1  ON 0
 uu_1                 9.249806e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391688e-02 1 1  ON 3
 uu_4                -1.211232e-01 1 1  ON 4
 uu_5                -1.433659e-01 1 1  ON 5
 uu_6                -1.556002e-01 1 1  ON 6
 uu_7                -1.568646e-01 1 1  ON 7
 uu_8                -1.435381e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385534e-01 1 1  ON 10
 ud_1                 1.563148e-01 1 1  ON 11
 ud_2                 1.048392e-02 1 1  ON 12
 ud_3                -6.939511e-02 1 1  ON 13
 ud_4                -1.163764e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638429e-01 1 1  ON 16
 ud_7                -1.693212e-01 1 1  ON 17
 ud_8                -1.575847e-01 1 1  ON 18
 ud_9                -1.246154e-01 1 1  ON 19
 eC_0                -5.615609e-01 1 1  ON 20
 eC_1                -4.069796e-01 1 1  ON 21
 eC_2                -1.565496e-01 1 1  ON 22
 eC_3                -7.987938e-03 1 1  ON 23
 eC_4                 4.417922e-02 1 1  ON 24
 eC_5                 1.354077e-01 1 1  ON 25
 eC_6                 2.551366e-01 1 1  ON 26
 eC_7                 3.887734e-01 1 1  ON 27
 eC_8                 2.462323e-01 1 1  ON 28
 eC_9                 5.992538e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464782e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412461e-02 1 1  ON 33
 eO_4                 2.024769e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683381e-01 1 1  ON 36
 eO_7                 5.218842e-01 1 1  ON 37
 eO_8                 4.602162e-01 1 1  ON 38
 eO_9                 2.918665e-01 1 1  ON 39
eH1_0                -1.820722e-01 1 1  ON 40
eH1_1                -9.474320e-02 1 1  ON 41
eH1_2                -6.220741e-02 1 1  ON 42
eH1_3                -4.723885e-02 1 1  ON 43
eH1_4                 1.240453e-02 1 1  ON 44
eH1_5                 6.672288e-02 1 1  ON 45
eH1_6                 1.201584e-01 1 1  ON 46
eH1_7                 9.196313e-02 1 1  ON 47
eH1_8                 4.802368e-03 1 1  ON 48
eH1_9                 1.150746e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544045e-02 1 1  ON 51
eH2_2                -6.231633e-02 1 1  ON 52
eH2_3                -4.741997e-02 1 1  ON 53
eH2_4                 1.191625e-02 1 1  ON 54
eH2_5                 6.667511e-02 1 1  ON 55
eH2_6                 1.195981e-01 1 1  ON 56
eH2_7                 9.197150e-02 1 1  ON 57
eH2_8                -2.463415e-04 1 1  ON 58
eH2_9                 1.429052e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8581
    reference variance = 0.325027
====================================================
  Execution time = 4.3421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9866e-01
  Total weights = 2.0000e+06
  Execution time = 3.5625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763929180
                                         uncertainty =       0.003084389542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763929180
                                         uncertainty =       0.003084389542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499330421
  error estimate for blocks of size 2^( 2) =       0.000517133699
  error estimate for blocks of size 2^( 3) =       0.000532704734
  error estimate for blocks of size 2^( 4) =       0.000543414080
  error estimate for blocks of size 2^( 5) =       0.000550601731
  error estimate for blocks of size 2^( 6) =       0.000552152316
  error estimate for blocks of size 2^( 7) =       0.000553441556

      target function =                  N/A
              le_mean =     -22.825821785600
             les_mean =     521.516801677710
             stat err =       0.000549902421
             autocorr =       1.212816820085
              std dev =       0.706159853775
             le_variance =       0.498661739084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763991020
                                         uncertainty =       0.003084391568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763991020
                                         uncertainty =       0.003084391568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499330452
  error estimate for blocks of size 2^( 2) =       0.000517133733
  error estimate for blocks of size 2^( 3) =       0.000532704763
  error estimate for blocks of size 2^( 4) =       0.000543414108
  error estimate for blocks of size 2^( 5) =       0.000550601748
  error estimate for blocks of size 2^( 6) =       0.000552152331
  error estimate for blocks of size 2^( 7) =       0.000553441593

      target function =                  N/A
              le_mean =     -22.825821788009
             les_mean =     521.516801849638
             stat err =       0.000549902445
             autocorr =       1.212816775349
              std dev =       0.706159897641
             le_variance =       0.498661801036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763960106
                                         uncertainty =       0.003084390557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763960106
                                         uncertainty =       0.003084390557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499330437
  error estimate for blocks of size 2^( 2) =       0.000517133716
  error estimate for blocks of size 2^( 3) =       0.000532704748
  error estimate for blocks of size 2^( 4) =       0.000543414094
  error estimate for blocks of size 2^( 5) =       0.000550601739
  error estimate for blocks of size 2^( 6) =       0.000552152323
  error estimate for blocks of size 2^( 7) =       0.000553441574

      target function =                  N/A
              le_mean =     -22.825821786806
             les_mean =     521.516801763760
             stat err =       0.000549902433
             autocorr =       1.212816797779
              std dev =       0.706159875712
             le_variance =       0.498661770066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763933045
                                         uncertainty =       0.003084389669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498763933045
                                         uncertainty =       0.003084389669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499330423
  error estimate for blocks of size 2^( 2) =       0.000517133701
  error estimate for blocks of size 2^( 3) =       0.000532704736
  error estimate for blocks of size 2^( 4) =       0.000543414081
  error estimate for blocks of size 2^( 5) =       0.000550601732
  error estimate for blocks of size 2^( 6) =       0.000552152317
  error estimate for blocks of size 2^( 7) =       0.000553441558

      target function =                  N/A
              le_mean =     -22.825821785750
             les_mean =     521.516801688465
             stat err =       0.000549902422
             autocorr =       1.212816817302
              std dev =       0.706159856517
             le_variance =       0.498661742956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825821785600        initial
     2.5000e+02     2.5000e+03             1.1095e-06       -22.825821788009  <--
     1.0000e+03     1.0000e+04             2.7756e-07       -22.825821786806
     4.0000e+03     4.0000e+04             6.9401e-08       -22.825821785750

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 6.1272e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048401e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987738e-03 1 1  ON 23
 eC_4                 4.417918e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462326e-01 1 1  ON 28
 eC_9                 5.992550e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464790e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412484e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474384e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723871e-02 1 1  ON 43
eH1_4                 1.240471e-02 1 1  ON 44
eH1_5                 6.672328e-02 1 1  ON 45
eH1_6                 1.201586e-01 1 1  ON 46
eH1_7                 9.196332e-02 1 1  ON 47
eH1_8                 4.802445e-03 1 1  ON 48
eH1_9                 1.150729e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544029e-02 1 1  ON 51
eH2_2                -6.231657e-02 1 1  ON 52
eH2_3                -4.741990e-02 1 1  ON 53
eH2_4                 1.191647e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197165e-02 1 1  ON 57
eH2_8                -2.462789e-04 1 1  ON 58
eH2_9                 1.429025e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2341e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8478
    reference variance = 0.654474
====================================================
  Execution time = 4.5075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5043e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508146201306
                                         uncertainty =       0.003650471990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508146201306
                                         uncertainty =       0.003650471990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504098782
  error estimate for blocks of size 2^( 2) =       0.000521595386
  error estimate for blocks of size 2^( 3) =       0.000537422394
  error estimate for blocks of size 2^( 4) =       0.000548760159
  error estimate for blocks of size 2^( 5) =       0.000553854785
  error estimate for blocks of size 2^( 6) =       0.000556259769
  error estimate for blocks of size 2^( 7) =       0.000558899948

      target function =                  N/A
              le_mean =     -22.825500137082
             les_mean =     521.511687418088
             stat err =       0.000554443665
             autocorr =       1.209716364271
              std dev =       0.712903334466
             le_variance =       0.508231164293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282550013708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825500137082       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825500138047       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825500135033       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825500137712       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825500141050       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825500134401       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825500128113       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825500128515       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825500132036       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825500130941       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 3.101930e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825500137082       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825500137324       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825500136564       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825500137227       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825500138046       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825500136370       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825500134788       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825500134877       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825500135754       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825500135483       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 7.771748e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825500137082       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825500137142       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825500136952       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825500137117       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825500137321       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825500136901       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825500136505       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825500136527       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825500136742       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825500136678       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 1.943999e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0128e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.664782e-01 1 1  ON 0
 uu_1                 9.249786e-02 1 1  ON 1
 uu_2                -1.873772e-02 1 1  ON 2
 uu_3                -8.391660e-02 1 1  ON 3
 uu_4                -1.211231e-01 1 1  ON 4
 uu_5                -1.433659e-01 1 1  ON 5
 uu_6                -1.555994e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435387e-01 1 1  ON 8
 uu_9                -1.063373e-01 1 1  ON 9
 ud_0                 4.385543e-01 1 1  ON 10
 ud_1                 1.563146e-01 1 1  ON 11
 ud_2                 1.048425e-02 1 1  ON 12
 ud_3                -6.939557e-02 1 1  ON 13
 ud_4                -1.163769e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638420e-01 1 1  ON 16
 ud_7                -1.693207e-01 1 1  ON 17
 ud_8                -1.575853e-01 1 1  ON 18
 ud_9                -1.246155e-01 1 1  ON 19
 eC_0                -5.615612e-01 1 1  ON 20
 eC_1                -4.069793e-01 1 1  ON 21
 eC_2                -1.565496e-01 1 1  ON 22
 eC_3                -7.987622e-03 1 1  ON 23
 eC_4                 4.417859e-02 1 1  ON 24
 eC_5                 1.354068e-01 1 1  ON 25
 eC_6                 2.551365e-01 1 1  ON 26
 eC_7                 3.887736e-01 1 1  ON 27
 eC_8                 2.462331e-01 1 1  ON 28
 eC_9                 5.992568e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464798e-01 1 1  ON 31
 eO_2                -3.681016e-01 1 1  ON 32
 eO_3                -2.412503e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832417e-01 1 1  ON 35
 eO_6                 4.683380e-01 1 1  ON 36
 eO_7                 5.218843e-01 1 1  ON 37
 eO_8                 4.602167e-01 1 1  ON 38
 eO_9                 2.918674e-01 1 1  ON 39
eH1_0                -1.820725e-01 1 1  ON 40
eH1_1                -9.474375e-02 1 1  ON 41
eH1_2                -6.220770e-02 1 1  ON 42
eH1_3                -4.723875e-02 1 1  ON 43
eH1_4                 1.240500e-02 1 1  ON 44
eH1_5                 6.672383e-02 1 1  ON 45
eH1_6                 1.201581e-01 1 1  ON 46
eH1_7                 9.196290e-02 1 1  ON 47
eH1_8                 4.802455e-03 1 1  ON 48
eH1_9                 1.150717e-02 1 1  ON 49
eH2_0                -1.833486e-01 1 1  ON 50
eH2_1                -9.543982e-02 1 1  ON 51
eH2_2                -6.231696e-02 1 1  ON 52
eH2_3                -4.742005e-02 1 1  ON 53
eH2_4                 1.191676e-02 1 1  ON 54
eH2_5                 6.667502e-02 1 1  ON 55
eH2_6                 1.195975e-01 1 1  ON 56
eH2_7                 9.197146e-02 1 1  ON 57
eH2_8                -2.461070e-04 1 1  ON 58
eH2_9                 1.429006e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7347
    reference variance = 0.510686
====================================================
  Execution time = 4.4251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.0337e-01
  Total weights = 2.0000e+06
  Execution time = 3.5691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402447168
                                         uncertainty =       0.003325062389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402447168
                                         uncertainty =       0.003325062389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501680493
  error estimate for blocks of size 2^( 2) =       0.000519313417
  error estimate for blocks of size 2^( 3) =       0.000534678580
  error estimate for blocks of size 2^( 4) =       0.000545682788
  error estimate for blocks of size 2^( 5) =       0.000553084341
  error estimate for blocks of size 2^( 6) =       0.000555060808
  error estimate for blocks of size 2^( 7) =       0.000556534537

      target function =                  N/A
              le_mean =     -22.826543203697
             les_mean =     521.554441011788
             stat err =       0.000552590619
             autocorr =       1.213256388539
              std dev =       0.709483356554
             le_variance =       0.503366633228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503403075911
                                         uncertainty =       0.003325073642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503403075911
                                         uncertainty =       0.003325073642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501680805
  error estimate for blocks of size 2^( 2) =       0.000519313770
  error estimate for blocks of size 2^( 3) =       0.000534678959
  error estimate for blocks of size 2^( 4) =       0.000545683162
  error estimate for blocks of size 2^( 5) =       0.000553084597
  error estimate for blocks of size 2^( 6) =       0.000555060959
  error estimate for blocks of size 2^( 7) =       0.000556534580

      target function =                  N/A
              le_mean =     -22.826543180580
             les_mean =     521.554440584252
             stat err =       0.000552590824
             autocorr =       1.213255778178
              std dev =       0.709483798992
             le_variance =       0.503367261032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402763338
                                         uncertainty =       0.003325068093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402763338
                                         uncertainty =       0.003325068093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501680650
  error estimate for blocks of size 2^( 2) =       0.000519313595
  error estimate for blocks of size 2^( 3) =       0.000534678771
  error estimate for blocks of size 2^( 4) =       0.000545682976
  error estimate for blocks of size 2^( 5) =       0.000553084470
  error estimate for blocks of size 2^( 6) =       0.000555060884
  error estimate for blocks of size 2^( 7) =       0.000556534559

      target function =                  N/A
              le_mean =     -22.826543192038
             les_mean =     521.554440795223
             stat err =       0.000552590722
             autocorr =       1.213256081988
              std dev =       0.709483579036
             le_variance =       0.503366948921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402486727
                                         uncertainty =       0.003325063105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503402486727
                                         uncertainty =       0.003325063105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501680512
  error estimate for blocks of size 2^( 2) =       0.000519313439
  error estimate for blocks of size 2^( 3) =       0.000534678604
  error estimate for blocks of size 2^( 4) =       0.000545682812
  error estimate for blocks of size 2^( 5) =       0.000553084357
  error estimate for blocks of size 2^( 6) =       0.000555060817
  error estimate for blocks of size 2^( 7) =       0.000556534540

      target function =                  N/A
              le_mean =     -22.826543202234
             les_mean =     521.554440984514
             stat err =       0.000552590632
             autocorr =       1.213256350185
              std dev =       0.709483384391
             le_variance =       0.503366672726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826543203697        initial  <--
     6.2500e+01     6.2500e+02             3.1019e-06       -22.826543180580
     2.5000e+02     2.5000e+03             7.7717e-07       -22.826543192038
     1.0000e+03     1.0000e+04             1.9440e-07       -22.826543202234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1471
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048401e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987738e-03 1 1  ON 23
 eC_4                 4.417918e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462326e-01 1 1  ON 28
 eC_9                 5.992550e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464790e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412484e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474384e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723871e-02 1 1  ON 43
eH1_4                 1.240471e-02 1 1  ON 44
eH1_5                 6.672328e-02 1 1  ON 45
eH1_6                 1.201586e-01 1 1  ON 46
eH1_7                 9.196332e-02 1 1  ON 47
eH1_8                 4.802445e-03 1 1  ON 48
eH1_9                 1.150729e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544029e-02 1 1  ON 51
eH2_2                -6.231657e-02 1 1  ON 52
eH2_3                -4.741990e-02 1 1  ON 53
eH2_4                 1.191647e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197165e-02 1 1  ON 57
eH2_8                -2.462789e-04 1 1  ON 58
eH2_9                 1.429025e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2237e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6513
    reference variance = 1.06784
====================================================
  Execution time = 4.4330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5187e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501959657511
                                         uncertainty =       0.005137905611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501959657511
                                         uncertainty =       0.005137905611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501006018
  error estimate for blocks of size 2^( 2) =       0.000518805623
  error estimate for blocks of size 2^( 3) =       0.000534617354
  error estimate for blocks of size 2^( 4) =       0.000545378567
  error estimate for blocks of size 2^( 5) =       0.000550694311
  error estimate for blocks of size 2^( 6) =       0.000555770762
  error estimate for blocks of size 2^( 7) =       0.000557513854

      target function =                  N/A
              le_mean =     -22.825732743654
             les_mean =     521.516089094136
             stat err =       0.000552339374
             autocorr =       1.215419278854
              std dev =       0.708529505694
             le_variance =       0.502014060439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282573274365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825732743654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825732744317       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825732745140       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825732745839       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825732745019       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825732744198       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825732744654       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825732744766       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825732745137       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825732745230       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 3.693469e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825732743654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825732743819       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825732744025       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825732744200       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825732743996       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825732743790       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825732743898       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825732743929       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825732744023       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825732744051       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 9.236220e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825732743654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825732743695       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825732743747       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825732743795       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825732743740       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825732743684       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825732743731       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825732743727       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825732743747       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825732743739       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 2.309214e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0931e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.664786e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873839e-02 1 1  ON 2
 uu_3                -8.391667e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048400e-02 1 1  ON 12
 ud_3                -6.939526e-02 1 1  ON 13
 ud_4                -1.163767e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987701e-03 1 1  ON 23
 eC_4                 4.417914e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462327e-01 1 1  ON 28
 eC_9                 5.992552e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464791e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412478e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474383e-02 1 1  ON 41
eH1_2                -6.220774e-02 1 1  ON 42
eH1_3                -4.723868e-02 1 1  ON 43
eH1_4                 1.240467e-02 1 1  ON 44
eH1_5                 6.672330e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196334e-02 1 1  ON 47
eH1_8                 4.802468e-03 1 1  ON 48
eH1_9                 1.150726e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544030e-02 1 1  ON 51
eH2_2                -6.231663e-02 1 1  ON 52
eH2_3                -4.741991e-02 1 1  ON 53
eH2_4                 1.191649e-02 1 1  ON 54
eH2_5                 6.667533e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197164e-02 1 1  ON 57
eH2_8                -2.462611e-04 1 1  ON 58
eH2_9                 1.429023e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8491
    reference variance = 0.433101
====================================================
  Execution time = 4.3221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0718e-01
  Total weights = 2.0000e+06
  Execution time = 3.5523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071500174
                                         uncertainty =       0.005676829131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071500174
                                         uncertainty =       0.005676829131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503575908
  error estimate for blocks of size 2^( 2) =       0.000521310272
  error estimate for blocks of size 2^( 3) =       0.000537095368
  error estimate for blocks of size 2^( 4) =       0.000548324101
  error estimate for blocks of size 2^( 5) =       0.000555399664
  error estimate for blocks of size 2^( 6) =       0.000556577387
  error estimate for blocks of size 2^( 7) =       0.000557903175

      target function =                  N/A
              le_mean =     -22.825146724998
             les_mean =     521.494500154715
             stat err =       0.000554551082
             autocorr =       1.212699571566
              std dev =       0.712163879032
             le_variance =       0.507177390599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071909717
                                         uncertainty =       0.005676835195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071909717
                                         uncertainty =       0.005676835195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503576112
  error estimate for blocks of size 2^( 2) =       0.000521310465
  error estimate for blocks of size 2^( 3) =       0.000537095552
  error estimate for blocks of size 2^( 4) =       0.000548324274
  error estimate for blocks of size 2^( 5) =       0.000555399830
  error estimate for blocks of size 2^( 6) =       0.000556577554
  error estimate for blocks of size 2^( 7) =       0.000557903330

      target function =                  N/A
              le_mean =     -22.825146723919
             les_mean =     521.494500515222
             stat err =       0.000554551247
             autocorr =       1.212699314973
              std dev =       0.712164166725
             le_variance =       0.507177800367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071705047
                                         uncertainty =       0.005676832165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071705047
                                         uncertainty =       0.005676832165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503576010
  error estimate for blocks of size 2^( 2) =       0.000521310368
  error estimate for blocks of size 2^( 3) =       0.000537095460
  error estimate for blocks of size 2^( 4) =       0.000548324187
  error estimate for blocks of size 2^( 5) =       0.000555399747
  error estimate for blocks of size 2^( 6) =       0.000556577471
  error estimate for blocks of size 2^( 7) =       0.000557903253

      target function =                  N/A
              le_mean =     -22.825146724459
             les_mean =     521.494500335061
             stat err =       0.000554551164
             autocorr =       1.212699443218
              std dev =       0.712164022950
             le_variance =       0.507177595584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071525786
                                         uncertainty =       0.005676829510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507071525786
                                         uncertainty =       0.005676829510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503575921
  error estimate for blocks of size 2^( 2) =       0.000521310284
  error estimate for blocks of size 2^( 3) =       0.000537095379
  error estimate for blocks of size 2^( 4) =       0.000548324112
  error estimate for blocks of size 2^( 5) =       0.000555399674
  error estimate for blocks of size 2^( 6) =       0.000556577397
  error estimate for blocks of size 2^( 7) =       0.000557903185

      target function =                  N/A
              le_mean =     -22.825146724931
             les_mean =     521.494500177261
             stat err =       0.000554551092
             autocorr =       1.212699555527
              std dev =       0.712163897024
             le_variance =       0.507177416225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825146724998        initial  <--
     6.2500e+02     6.2500e+03             3.6935e-07       -22.825146723919
     2.5000e+03     2.5000e+04             9.2362e-08       -22.825146724459
     1.0000e+04     1.0000e+05             2.3092e-08       -22.825146724931

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0264
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048401e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987738e-03 1 1  ON 23
 eC_4                 4.417918e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462326e-01 1 1  ON 28
 eC_9                 5.992550e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464790e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412484e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474384e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723871e-02 1 1  ON 43
eH1_4                 1.240471e-02 1 1  ON 44
eH1_5                 6.672328e-02 1 1  ON 45
eH1_6                 1.201586e-01 1 1  ON 46
eH1_7                 9.196332e-02 1 1  ON 47
eH1_8                 4.802445e-03 1 1  ON 48
eH1_9                 1.150729e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544029e-02 1 1  ON 51
eH2_2                -6.231657e-02 1 1  ON 52
eH2_3                -4.741990e-02 1 1  ON 53
eH2_4                 1.191647e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197165e-02 1 1  ON 57
eH2_8                -2.462789e-04 1 1  ON 58
eH2_9                 1.429025e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2228e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8731
    reference variance = 0.402183
====================================================
  Execution time = 4.4799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5271e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519946872303
                                         uncertainty =       0.009498568635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519946872303
                                         uncertainty =       0.009498568635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509771037
  error estimate for blocks of size 2^( 2) =       0.000527297983
  error estimate for blocks of size 2^( 3) =       0.000543041193
  error estimate for blocks of size 2^( 4) =       0.000552626997
  error estimate for blocks of size 2^( 5) =       0.000559703619
  error estimate for blocks of size 2^( 6) =       0.000562705848
  error estimate for blocks of size 2^( 7) =       0.000566239487

      target function =                  N/A
              le_mean =     -22.825568946258
             les_mean =     521.526330481339
             stat err =       0.000560318988
             autocorr =       1.208148627098
              std dev =       0.720925114580
             le_variance =       0.519733020832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282556894626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568946258       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825568946173       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825568946082       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825568946093       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825568946077       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825568946165       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825568946259       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825568946312       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825568946300       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825568946283       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 2.958400e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568946258       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825568946237       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825568946214       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825568946217       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825568946214       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825568946256       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825568946237       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825568946242       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825568946255       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825568946185       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 7.396219e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568946258       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825568946253       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825568946247       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825568946248       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825568946210       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825568946133       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825568946232       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825568946273       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825568946176       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825568946158       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 1.849069e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0078e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873842e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048401e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987739e-03 1 1  ON 23
 eC_4                 4.417918e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462326e-01 1 1  ON 28
 eC_9                 5.992550e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464790e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412484e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474384e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723871e-02 1 1  ON 43
eH1_4                 1.240471e-02 1 1  ON 44
eH1_5                 6.672328e-02 1 1  ON 45
eH1_6                 1.201586e-01 1 1  ON 46
eH1_7                 9.196332e-02 1 1  ON 47
eH1_8                 4.802445e-03 1 1  ON 48
eH1_9                 1.150728e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544029e-02 1 1  ON 51
eH2_2                -6.231658e-02 1 1  ON 52
eH2_3                -4.741990e-02 1 1  ON 53
eH2_4                 1.191648e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197165e-02 1 1  ON 57
eH2_8                -2.462798e-04 1 1  ON 58
eH2_9                 1.429025e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.9215
    reference variance = 0.41193
====================================================
  Execution time = 4.3464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9765e-01
  Total weights = 2.0000e+06
  Execution time = 3.5636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740778164
                                         uncertainty =       0.003000138131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740778164
                                         uncertainty =       0.003000138131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498826240
  error estimate for blocks of size 2^( 2) =       0.000516810469
  error estimate for blocks of size 2^( 3) =       0.000532467035
  error estimate for blocks of size 2^( 4) =       0.000543072696
  error estimate for blocks of size 2^( 5) =       0.000550192399
  error estimate for blocks of size 2^( 6) =       0.000554992336
  error estimate for blocks of size 2^( 7) =       0.000556040191

      target function =                  N/A
              le_mean =     -22.825669064617
             les_mean =     521.508823233309
             stat err =       0.000551074406
             autocorr =       1.220455364756
              std dev =       0.705446833363
             le_variance =       0.497655234702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740780513
                                         uncertainty =       0.003000138154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740780513
                                         uncertainty =       0.003000138154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498826241
  error estimate for blocks of size 2^( 2) =       0.000516810470
  error estimate for blocks of size 2^( 3) =       0.000532467035
  error estimate for blocks of size 2^( 4) =       0.000543072696
  error estimate for blocks of size 2^( 5) =       0.000550192399
  error estimate for blocks of size 2^( 6) =       0.000554992336
  error estimate for blocks of size 2^( 7) =       0.000556040192

      target function =                  N/A
              le_mean =     -22.825669064706
             les_mean =     521.508823239704
             stat err =       0.000551074406
             autocorr =       1.220455358759
              std dev =       0.705446835022
             le_variance =       0.497655237043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740779338
                                         uncertainty =       0.003000138143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740779338
                                         uncertainty =       0.003000138143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498826240
  error estimate for blocks of size 2^( 2) =       0.000516810470
  error estimate for blocks of size 2^( 3) =       0.000532467035
  error estimate for blocks of size 2^( 4) =       0.000543072696
  error estimate for blocks of size 2^( 5) =       0.000550192399
  error estimate for blocks of size 2^( 6) =       0.000554992336
  error estimate for blocks of size 2^( 7) =       0.000556040191

      target function =                  N/A
              le_mean =     -22.825669064662
             les_mean =     521.508823236506
             stat err =       0.000551074406
             autocorr =       1.220455361761
              std dev =       0.705446834192
             le_variance =       0.497655235872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740778311
                                         uncertainty =       0.003000138132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497740778311
                                         uncertainty =       0.003000138132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498826240
  error estimate for blocks of size 2^( 2) =       0.000516810469
  error estimate for blocks of size 2^( 3) =       0.000532467035
  error estimate for blocks of size 2^( 4) =       0.000543072696
  error estimate for blocks of size 2^( 5) =       0.000550192399
  error estimate for blocks of size 2^( 6) =       0.000554992336
  error estimate for blocks of size 2^( 7) =       0.000556040191

      target function =                  N/A
              le_mean =     -22.825669064623
             les_mean =     521.508823233708
             stat err =       0.000551074406
             autocorr =       1.220455364384
              std dev =       0.705446833467
             le_variance =       0.497655234848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825669064617        initial
     6.2500e+03     6.2500e+04             2.9584e-08       -22.825669064706  <--
     2.5000e+04     2.5000e+05             7.3962e-09       -22.825669064662
     1.0000e+05     1.0000e+06             1.8491e-09       -22.825669064623

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 6.1317e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249797e-02 1 1  ON 1
 uu_2                -1.873841e-02 1 1  ON 2
 uu_3                -8.391664e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048401e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987743e-03 1 1  ON 23
 eC_4                 4.417920e-02 1 1  ON 24
 eC_5                 1.354074e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462326e-01 1 1  ON 28
 eC_9                 5.992551e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464790e-01 1 1  ON 31
 eO_2                -3.681017e-01 1 1  ON 32
 eO_3                -2.412485e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820723e-01 1 1  ON 40
eH1_1                -9.474385e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723872e-02 1 1  ON 43
eH1_4                 1.240471e-02 1 1  ON 44
eH1_5                 6.672328e-02 1 1  ON 45
eH1_6                 1.201586e-01 1 1  ON 46
eH1_7                 9.196332e-02 1 1  ON 47
eH1_8                 4.802443e-03 1 1  ON 48
eH1_9                 1.150728e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544028e-02 1 1  ON 51
eH2_2                -6.231659e-02 1 1  ON 52
eH2_3                -4.741990e-02 1 1  ON 53
eH2_4                 1.191648e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197164e-02 1 1  ON 57
eH2_8                -2.462825e-04 1 1  ON 58
eH2_9                 1.429024e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2142e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 0.615521
====================================================
  Execution time = 4.4718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5303e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508330078143
                                         uncertainty =       0.006694164235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508330078143
                                         uncertainty =       0.006694164235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504081405
  error estimate for blocks of size 2^( 2) =       0.000521972993
  error estimate for blocks of size 2^( 3) =       0.000538046702
  error estimate for blocks of size 2^( 4) =       0.000549654108
  error estimate for blocks of size 2^( 5) =       0.000556662465
  error estimate for blocks of size 2^( 6) =       0.000559853440
  error estimate for blocks of size 2^( 7) =       0.000561960579

      target function =                  N/A
              le_mean =     -22.825770769678
             les_mean =     521.524007101233
             stat err =       0.000557032648
             autocorr =       1.221124504582
              std dev =       0.712878759295
             le_variance =       0.508196125455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282577076968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825770769678       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825770769938       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825770769743       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825770769996       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825770770577       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825770770627       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825770770831       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825770770721       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825770770644       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825770770662       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.288318e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825770769678       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825770769743       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825770769694       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825770769757       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825770769903       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825770769916       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825770769962       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825770769953       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825770769881       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825770769920       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 3.221183e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825770769678       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825770769694       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825770769682       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825770769698       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825770769734       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825770769739       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825770769756       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825770769759       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825770769745       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825770769749       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 8.053198e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0030e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249796e-02 1 1  ON 1
 uu_2                -1.873840e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.556000e-01 1 1  ON 6
 uu_7                -1.568650e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385536e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048403e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575850e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615613e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987755e-03 1 1  ON 23
 eC_4                 4.417920e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462327e-01 1 1  ON 28
 eC_9                 5.992551e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464791e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412485e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832418e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602165e-01 1 1  ON 38
 eO_9                 2.918670e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474384e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723870e-02 1 1  ON 43
eH1_4                 1.240470e-02 1 1  ON 44
eH1_5                 6.672329e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196334e-02 1 1  ON 47
eH1_8                 4.802448e-03 1 1  ON 48
eH1_9                 1.150727e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544027e-02 1 1  ON 51
eH2_2                -6.231662e-02 1 1  ON 52
eH2_3                -4.741991e-02 1 1  ON 53
eH2_4                 1.191649e-02 1 1  ON 54
eH2_5                 6.667529e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197164e-02 1 1  ON 57
eH2_8                -2.462747e-04 1 1  ON 58
eH2_9                 1.429024e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8479
    reference variance = 0.621464
====================================================
  Execution time = 4.3314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0929e-01
  Total weights = 2.0000e+06
  Execution time = 3.5162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270986786
                                         uncertainty =       0.009734346513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270986786
                                         uncertainty =       0.009734346513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504625264
  error estimate for blocks of size 2^( 2) =       0.000522361761
  error estimate for blocks of size 2^( 3) =       0.000538020447
  error estimate for blocks of size 2^( 4) =       0.000548324093
  error estimate for blocks of size 2^( 5) =       0.000555011733
  error estimate for blocks of size 2^( 6) =       0.000558488443
  error estimate for blocks of size 2^( 7) =       0.000560375031

      target function =                  N/A
              le_mean =     -22.825922197849
             les_mean =     521.532017242385
             stat err =       0.000555549825
             autocorr =       1.212015154611
              std dev =       0.713647892730
             le_variance =       0.509293314798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270950150
                                         uncertainty =       0.009734346084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270950150
                                         uncertainty =       0.009734346084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504625246
  error estimate for blocks of size 2^( 2) =       0.000522361745
  error estimate for blocks of size 2^( 3) =       0.000538020433
  error estimate for blocks of size 2^( 4) =       0.000548324078
  error estimate for blocks of size 2^( 5) =       0.000555011718
  error estimate for blocks of size 2^( 6) =       0.000558488427
  error estimate for blocks of size 2^( 7) =       0.000560375013

      target function =                  N/A
              le_mean =     -22.825922198783
             les_mean =     521.532017248490
             stat err =       0.000555549809
             autocorr =       1.212015172730
              std dev =       0.713647867131
             le_variance =       0.509293278261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270968464
                                         uncertainty =       0.009734346298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270968464
                                         uncertainty =       0.009734346298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504625255
  error estimate for blocks of size 2^( 2) =       0.000522361753
  error estimate for blocks of size 2^( 3) =       0.000538020440
  error estimate for blocks of size 2^( 4) =       0.000548324085
  error estimate for blocks of size 2^( 5) =       0.000555011725
  error estimate for blocks of size 2^( 6) =       0.000558488435
  error estimate for blocks of size 2^( 7) =       0.000560375022

      target function =                  N/A
              le_mean =     -22.825922198316
             les_mean =     521.532017245437
             stat err =       0.000555549817
             autocorr =       1.212015163670
              std dev =       0.713647879928
             le_variance =       0.509293296526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270984495
                                         uncertainty =       0.009734346486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509270984495
                                         uncertainty =       0.009734346486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504625263
  error estimate for blocks of size 2^( 2) =       0.000522361760
  error estimate for blocks of size 2^( 3) =       0.000538020447
  error estimate for blocks of size 2^( 4) =       0.000548324092
  error estimate for blocks of size 2^( 5) =       0.000555011732
  error estimate for blocks of size 2^( 6) =       0.000558488442
  error estimate for blocks of size 2^( 7) =       0.000560375030

      target function =                  N/A
              le_mean =     -22.825922197907
             les_mean =     521.532017242767
             stat err =       0.000555549824
             autocorr =       1.212015155758
              std dev =       0.713647891130
             le_variance =       0.509293312514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825922197849        initial
     1.5625e+03     1.5625e+04             1.2883e-07       -22.825922198783  <--
     6.2500e+03     6.2500e+04             3.2212e-08       -22.825922198316
     2.5000e+04     2.5000e+05             8.0532e-09       -22.825922197907

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 6.3922e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873839e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048409e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565498e-01 1 1  ON 22
 eC_3                -7.987790e-03 1 1  ON 23
 eC_4                 4.417921e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462327e-01 1 1  ON 28
 eC_9                 5.992554e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464791e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412486e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474382e-02 1 1  ON 41
eH1_2                -6.220773e-02 1 1  ON 42
eH1_3                -4.723865e-02 1 1  ON 43
eH1_4                 1.240466e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196338e-02 1 1  ON 47
eH1_8                 4.802463e-03 1 1  ON 48
eH1_9                 1.150725e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544024e-02 1 1  ON 51
eH2_2                -6.231670e-02 1 1  ON 52
eH2_3                -4.741994e-02 1 1  ON 53
eH2_4                 1.191650e-02 1 1  ON 54
eH2_5                 6.667532e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462513e-04 1 1  ON 58
eH2_9                 1.429022e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2396e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8226
    reference variance = 0.354642
====================================================
  Execution time = 4.4319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0886e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4822e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508878929782
                                         uncertainty =       0.006512305050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508878929782
                                         uncertainty =       0.006512305050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504409550
  error estimate for blocks of size 2^( 2) =       0.000521953331
  error estimate for blocks of size 2^( 3) =       0.000538366714
  error estimate for blocks of size 2^( 4) =       0.000550247206
  error estimate for blocks of size 2^( 5) =       0.000555953473
  error estimate for blocks of size 2^( 6) =       0.000560249279
  error estimate for blocks of size 2^( 7) =       0.000558930729

      target function =                  N/A
              le_mean =     -22.824785115148
             les_mean =     521.479673285961
             stat err =       0.000556345172
             autocorr =       1.216527822765
              std dev =       0.713342826218
             le_variance =       0.508857987716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282478511515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785115148       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824785116961       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824785118244       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824785120954       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824785123064       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824785122816       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824785122762       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824785122626       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824785122879       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824785122668       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 7.370428e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785115148       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824785115601       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824785115922       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824785116600       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824785117129       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824785117066       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824785117056       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824785117017       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824785117080       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824785117029       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.843803e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785115148       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824785115261       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824785115341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824785115511       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824785115643       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824785115628       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824785115621       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824785115614       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824785115641       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824785115612       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 4.610257e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9149e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.664786e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391669e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385538e-01 1 1  ON 10
 ud_1                 1.563151e-01 1 1  ON 11
 ud_2                 1.048408e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163767e-01 1 1  ON 14
 ud_5                -1.459843e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575852e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987722e-03 1 1  ON 23
 eC_4                 4.417918e-02 1 1  ON 24
 eC_5                 1.354072e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992556e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464793e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412488e-02 1 1  ON 33
 eO_4                 2.024773e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820725e-01 1 1  ON 40
eH1_1                -9.474383e-02 1 1  ON 41
eH1_2                -6.220775e-02 1 1  ON 42
eH1_3                -4.723866e-02 1 1  ON 43
eH1_4                 1.240476e-02 1 1  ON 44
eH1_5                 6.672332e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196345e-02 1 1  ON 47
eH1_8                 4.802454e-03 1 1  ON 48
eH1_9                 1.150721e-02 1 1  ON 49
eH2_0                -1.833489e-01 1 1  ON 50
eH2_1                -9.544015e-02 1 1  ON 51
eH2_2                -6.231681e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191643e-02 1 1  ON 54
eH2_5                 6.667524e-02 1 1  ON 55
eH2_6                 1.195979e-01 1 1  ON 56
eH2_7                 9.197168e-02 1 1  ON 57
eH2_8                -2.461995e-04 1 1  ON 58
eH2_9                 1.429019e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7559
    reference variance = 0.360436
====================================================
  Execution time = 4.3436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0951e-01
  Total weights = 2.0000e+06
  Execution time = 3.5097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497610701
                                         uncertainty =       0.007094194738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497610701
                                         uncertainty =       0.007094194738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504733933
  error estimate for blocks of size 2^( 2) =       0.000522725670
  error estimate for blocks of size 2^( 3) =       0.000538888910
  error estimate for blocks of size 2^( 4) =       0.000550078381
  error estimate for blocks of size 2^( 5) =       0.000556599014
  error estimate for blocks of size 2^( 6) =       0.000559857229
  error estimate for blocks of size 2^( 7) =       0.000561111479

      target function =                  N/A
              le_mean =     -22.826177780322
             les_mean =     521.543904490596
             stat err =       0.000556911526
             autocorr =       1.217439547689
              std dev =       0.713801573612
             le_variance =       0.509512686491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509498316931
                                         uncertainty =       0.007094206621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509498316931
                                         uncertainty =       0.007094206621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504734283
  error estimate for blocks of size 2^( 2) =       0.000522726003
  error estimate for blocks of size 2^( 3) =       0.000538889220
  error estimate for blocks of size 2^( 4) =       0.000550078677
  error estimate for blocks of size 2^( 5) =       0.000556599293
  error estimate for blocks of size 2^( 6) =       0.000559857520
  error estimate for blocks of size 2^( 7) =       0.000561111780

      target function =                  N/A
              le_mean =     -22.826177777543
             les_mean =     521.543905070116
             stat err =       0.000556911818
             autocorr =       1.217439136467
              std dev =       0.713802068408
             le_variance =       0.509513392863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497964021
                                         uncertainty =       0.007094200683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497964021
                                         uncertainty =       0.007094200683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504734108
  error estimate for blocks of size 2^( 2) =       0.000522725837
  error estimate for blocks of size 2^( 3) =       0.000538889065
  error estimate for blocks of size 2^( 4) =       0.000550078529
  error estimate for blocks of size 2^( 5) =       0.000556599154
  error estimate for blocks of size 2^( 6) =       0.000559857375
  error estimate for blocks of size 2^( 7) =       0.000561111629

      target function =                  N/A
              le_mean =     -22.826177778931
             les_mean =     521.543904780484
             stat err =       0.000556911672
             autocorr =       1.217439341959
              std dev =       0.713801821153
             le_variance =       0.509513039882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497654872
                                         uncertainty =       0.007094195481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509497654872
                                         uncertainty =       0.007094195481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504733955
  error estimate for blocks of size 2^( 2) =       0.000522725691
  error estimate for blocks of size 2^( 3) =       0.000538888929
  error estimate for blocks of size 2^( 4) =       0.000550078399
  error estimate for blocks of size 2^( 5) =       0.000556599031
  error estimate for blocks of size 2^( 6) =       0.000559857247
  error estimate for blocks of size 2^( 7) =       0.000561111497

      target function =                  N/A
              le_mean =     -22.826177780148
             les_mean =     521.543904526833
             stat err =       0.000556911544
             autocorr =       1.217439521968
              std dev =       0.713801604559
             le_variance =       0.509512730671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826177780322        initial  <--
     3.9062e+02     3.9062e+03             7.3704e-07       -22.826177777543
     1.5625e+03     1.5625e+04             1.8438e-07       -22.826177778931
     6.2500e+03     6.2500e+04             4.6103e-08       -22.826177780148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0279
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873839e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048409e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565498e-01 1 1  ON 22
 eC_3                -7.987790e-03 1 1  ON 23
 eC_4                 4.417921e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462327e-01 1 1  ON 28
 eC_9                 5.992554e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464791e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412486e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474382e-02 1 1  ON 41
eH1_2                -6.220773e-02 1 1  ON 42
eH1_3                -4.723865e-02 1 1  ON 43
eH1_4                 1.240466e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196338e-02 1 1  ON 47
eH1_8                 4.802463e-03 1 1  ON 48
eH1_9                 1.150725e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544024e-02 1 1  ON 51
eH2_2                -6.231670e-02 1 1  ON 52
eH2_3                -4.741994e-02 1 1  ON 53
eH2_4                 1.191650e-02 1 1  ON 54
eH2_5                 6.667532e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462513e-04 1 1  ON 58
eH2_9                 1.429022e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7939
    reference variance = 0.248279
====================================================
  Execution time = 4.3855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0482e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5098e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504855463724
                                         uncertainty =       0.006873065404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504855463724
                                         uncertainty =       0.006873065404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502403496
  error estimate for blocks of size 2^( 2) =       0.000520486737
  error estimate for blocks of size 2^( 3) =       0.000536288836
  error estimate for blocks of size 2^( 4) =       0.000546844930
  error estimate for blocks of size 2^( 5) =       0.000553032403
  error estimate for blocks of size 2^( 6) =       0.000555901125
  error estimate for blocks of size 2^( 7) =       0.000557936198

      target function =                  N/A
              le_mean =     -22.824683716394
             les_mean =     521.471005045624
             stat err =       0.000553428664
             autocorr =       1.213439123278
              std dev =       0.710505837156
             le_variance =       0.504818544633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282468371639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824683716394       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824683716547       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824683716824       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824683716948       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824683716938       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824683717000       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824683716965       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824683716993       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824683716985       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824683717019       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 7.696748e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824683716394       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824683716432       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824683716501       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824683716532       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824683716529       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824683716547       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824683716547       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824683716534       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824683716559       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824683716566       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.924292e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824683716394       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824683716403       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824683716420       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824683716425       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824683716428       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824683716448       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824683716380       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824683716398       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824683716554       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824683716301       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+04 is 4.810796e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8962e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873838e-02 1 1  ON 2
 uu_3                -8.391665e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048408e-02 1 1  ON 12
 ud_3                -6.939523e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246157e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987786e-03 1 1  ON 23
 eC_4                 4.417921e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462327e-01 1 1  ON 28
 eC_9                 5.992554e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412487e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832419e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474382e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723864e-02 1 1  ON 43
eH1_4                 1.240466e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196337e-02 1 1  ON 47
eH1_8                 4.802464e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544024e-02 1 1  ON 51
eH2_2                -6.231670e-02 1 1  ON 52
eH2_3                -4.741994e-02 1 1  ON 53
eH2_4                 1.191651e-02 1 1  ON 54
eH2_5                 6.667531e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462461e-04 1 1  ON 58
eH2_9                 1.429022e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8485
    reference variance = 0.415829
====================================================
  Execution time = 4.3859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0907e-01
  Total weights = 2.0000e+06
  Execution time = 3.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077024524
                                         uncertainty =       0.005656591343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077024524
                                         uncertainty =       0.005656591343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504516445
  error estimate for blocks of size 2^( 2) =       0.000522360218
  error estimate for blocks of size 2^( 3) =       0.000538097333
  error estimate for blocks of size 2^( 4) =       0.000549405123
  error estimate for blocks of size 2^( 5) =       0.000557230850
  error estimate for blocks of size 2^( 6) =       0.000558544373
  error estimate for blocks of size 2^( 7) =       0.000560618444

      target function =                  N/A
              le_mean =     -22.825025745923
             les_mean =     521.490873734951
             stat err =       0.000556449697
             autocorr =       1.216469337960
              std dev =       0.713493999570
             le_variance =       0.509073687423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077065645
                                         uncertainty =       0.005656590851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077065645
                                         uncertainty =       0.005656590851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504516466
  error estimate for blocks of size 2^( 2) =       0.000522360237
  error estimate for blocks of size 2^( 3) =       0.000538097350
  error estimate for blocks of size 2^( 4) =       0.000549405140
  error estimate for blocks of size 2^( 5) =       0.000557230867
  error estimate for blocks of size 2^( 6) =       0.000558544390
  error estimate for blocks of size 2^( 7) =       0.000560618462

      target function =                  N/A
              le_mean =     -22.825025746162
             les_mean =     521.490873786963
             stat err =       0.000556449715
             autocorr =       1.216469315311
              std dev =       0.713494028375
             le_variance =       0.509073728527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077045086
                                         uncertainty =       0.005656591097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077045086
                                         uncertainty =       0.005656591097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504516456
  error estimate for blocks of size 2^( 2) =       0.000522360227
  error estimate for blocks of size 2^( 3) =       0.000538097342
  error estimate for blocks of size 2^( 4) =       0.000549405132
  error estimate for blocks of size 2^( 5) =       0.000557230858
  error estimate for blocks of size 2^( 6) =       0.000558544381
  error estimate for blocks of size 2^( 7) =       0.000560618453

      target function =                  N/A
              le_mean =     -22.825025746043
             les_mean =     521.490873760958
             stat err =       0.000556449706
             autocorr =       1.216469326635
              std dev =       0.713494013973
             le_variance =       0.509073707976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077027094
                                         uncertainty =       0.005656591313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509077027094
                                         uncertainty =       0.005656591313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504516447
  error estimate for blocks of size 2^( 2) =       0.000522360219
  error estimate for blocks of size 2^( 3) =       0.000538097334
  error estimate for blocks of size 2^( 4) =       0.000549405124
  error estimate for blocks of size 2^( 5) =       0.000557230851
  error estimate for blocks of size 2^( 6) =       0.000558544374
  error estimate for blocks of size 2^( 7) =       0.000560618445

      target function =                  N/A
              le_mean =     -22.825025745938
             les_mean =     521.490873738202
             stat err =       0.000556449698
             autocorr =       1.216469336539
              std dev =       0.713494001370
             le_variance =       0.509073689992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825025745923        initial
     3.9062e+03     3.9062e+04             7.6967e-08       -22.825025746162  <--
     1.5625e+04     1.5625e+05             1.9243e-08       -22.825025746043
     6.2500e+04     6.2500e+05             4.8108e-09       -22.825025745938

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 6.1394e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987773e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741995e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462302e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2037e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8491
    reference variance = 0.437651
====================================================
  Execution time = 4.4081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5476e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506675836161
                                         uncertainty =       0.004683806052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506675836161
                                         uncertainty =       0.004683806052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503305702
  error estimate for blocks of size 2^( 2) =       0.000521518417
  error estimate for blocks of size 2^( 3) =       0.000537385566
  error estimate for blocks of size 2^( 4) =       0.000549139522
  error estimate for blocks of size 2^( 5) =       0.000555931626
  error estimate for blocks of size 2^( 6) =       0.000561074026
  error estimate for blocks of size 2^( 7) =       0.000562709848

      target function =                  N/A
              le_mean =     -22.824740682229
             les_mean =     521.475420216316
             stat err =       0.000557213756
             autocorr =       1.225688066582
              std dev =       0.711781749292
             le_variance =       0.506633258625


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282474068223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824740682229       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824740681369       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824740681411       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824740681508       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824740681579       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824740682128       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824740681884       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824740681783       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824740682048       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824740682005       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 1.971363e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824740682229       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824740682014       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824740682024       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824740682048       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824740682066       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824740682205       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824740682157       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824740682120       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824740682189       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824740682179       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 4.928815e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824740682229       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824740682175       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824740682178       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824740682184       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824740682189       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824740682222       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824740682202       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824740682131       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824740682182       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824740682230       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.232230e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9565e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249793e-02 1 1  ON 1
 uu_2                -1.873832e-02 1 1  ON 2
 uu_3                -8.391663e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433660e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063370e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048403e-02 1 1  ON 12
 ud_3                -6.939526e-02 1 1  ON 13
 ud_4                -1.163767e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638422e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069793e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987785e-03 1 1  ON 23
 eC_4                 4.417920e-02 1 1  ON 24
 eC_5                 1.354072e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992556e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464793e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412490e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474382e-02 1 1  ON 41
eH1_2                -6.220773e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240464e-02 1 1  ON 44
eH1_5                 6.672334e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150722e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544025e-02 1 1  ON 51
eH2_2                -6.231674e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191654e-02 1 1  ON 54
eH2_5                 6.667531e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197164e-02 1 1  ON 57
eH2_8                -2.462120e-04 1 1  ON 58
eH2_9                 1.429019e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.873
    reference variance = 0.462859
====================================================
  Execution time = 4.3467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1453e-01
  Total weights = 2.0000e+06
  Execution time = 3.5687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562810026
                                         uncertainty =       0.008507297348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562810026
                                         uncertainty =       0.008507297348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507215215
  error estimate for blocks of size 2^( 2) =       0.000525038674
  error estimate for blocks of size 2^( 3) =       0.000541128906
  error estimate for blocks of size 2^( 4) =       0.000552086386
  error estimate for blocks of size 2^( 5) =       0.000558574148
  error estimate for blocks of size 2^( 6) =       0.000562133703
  error estimate for blocks of size 2^( 7) =       0.000565675995

      target function =                  N/A
              le_mean =     -22.825622521101
             les_mean =     521.523577766465
             stat err =       0.000559617558
             autocorr =       1.217301393416
              std dev =       0.717310635587
             le_variance =       0.514534547926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562992708
                                         uncertainty =       0.008507288039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562992708
                                         uncertainty =       0.008507288039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507215305
  error estimate for blocks of size 2^( 2) =       0.000525038759
  error estimate for blocks of size 2^( 3) =       0.000541128987
  error estimate for blocks of size 2^( 4) =       0.000552086463
  error estimate for blocks of size 2^( 5) =       0.000558574219
  error estimate for blocks of size 2^( 6) =       0.000562133774
  error estimate for blocks of size 2^( 7) =       0.000565676070

      target function =                  N/A
              le_mean =     -22.825622521048
             les_mean =     521.523577946806
             stat err =       0.000559617631
             autocorr =       1.217301280494
              std dev =       0.717310762974
             le_variance =       0.514534730678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562901404
                                         uncertainty =       0.008507292692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562901404
                                         uncertainty =       0.008507292692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507215260
  error estimate for blocks of size 2^( 2) =       0.000525038717
  error estimate for blocks of size 2^( 3) =       0.000541128946
  error estimate for blocks of size 2^( 4) =       0.000552086424
  error estimate for blocks of size 2^( 5) =       0.000558574183
  error estimate for blocks of size 2^( 6) =       0.000562133738
  error estimate for blocks of size 2^( 7) =       0.000565676032

      target function =                  N/A
              le_mean =     -22.825622521075
             les_mean =     521.523577856659
             stat err =       0.000559617595
             autocorr =       1.217301336929
              std dev =       0.717310699306
             le_variance =       0.514534639339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562821450
                                         uncertainty =       0.008507296766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514562821450
                                         uncertainty =       0.008507296766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507215220
  error estimate for blocks of size 2^( 2) =       0.000525038679
  error estimate for blocks of size 2^( 3) =       0.000541128911
  error estimate for blocks of size 2^( 4) =       0.000552086391
  error estimate for blocks of size 2^( 5) =       0.000558574152
  error estimate for blocks of size 2^( 6) =       0.000562133708
  error estimate for blocks of size 2^( 7) =       0.000565675999

      target function =                  N/A
              le_mean =     -22.825622521098
             les_mean =     521.523577777740
             stat err =       0.000559617562
             autocorr =       1.217301386358
              std dev =       0.717310643553
             le_variance =       0.514534559354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825622521101        initial  <--
     9.7656e+02     9.7656e+03             1.9714e-07       -22.825622521048
     3.9062e+03     3.9062e+04             4.9288e-08       -22.825622521075
     1.5625e+04     1.5625e+05             1.2322e-08       -22.825622521098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1282
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987773e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741995e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462302e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2070e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.828611
====================================================
  Execution time = 4.4409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5061e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505362078040
                                         uncertainty =       0.004465783458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505362078040
                                         uncertainty =       0.004465783458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502606330
  error estimate for blocks of size 2^( 2) =       0.000520272155
  error estimate for blocks of size 2^( 3) =       0.000536282801
  error estimate for blocks of size 2^( 4) =       0.000547783927
  error estimate for blocks of size 2^( 5) =       0.000554951434
  error estimate for blocks of size 2^( 6) =       0.000557299312
  error estimate for blocks of size 2^( 7) =       0.000558025775

      target function =                  N/A
              le_mean =     -22.825115556585
             les_mean =     521.491126165128
             stat err =       0.000554515112
             autocorr =       1.217225002441
              std dev =       0.710792688690
             le_variance =       0.505226246296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282511555658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825115556585       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825115556601       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825115556670       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825115556712       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825115556748       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825115556741       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825115556730       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825115556741       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825115556727       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.877735e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825115556585       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825115556589       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825115556606       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825115556603       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825115556626       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825115556615       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825115556680       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825115556528       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825115556644       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 7.194481e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825115556585       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825115556586       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825115556590       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825115556593       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825115556646       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825115556382       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825115556662       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825115556559       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825115556789       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 1.798629e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9478e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987773e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802468e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741995e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462304e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7491
    reference variance = 0.750324
====================================================
  Execution time = 4.4021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0229e-01
  Total weights = 2.0000e+06
  Execution time = 3.5149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246788317
                                         uncertainty =       0.004337127185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246788317
                                         uncertainty =       0.004337127185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501142389
  error estimate for blocks of size 2^( 2) =       0.000519784246
  error estimate for blocks of size 2^( 3) =       0.000536491736
  error estimate for blocks of size 2^( 4) =       0.000549107834
  error estimate for blocks of size 2^( 5) =       0.000558034340
  error estimate for blocks of size 2^( 6) =       0.000566209788
  error estimate for blocks of size 2^( 7) =       0.000577661373

      target function =                  N/A
              le_mean =     -22.824442847780
             les_mean =     521.457478447559
             stat err =       0.000562753334
             autocorr =       1.260996483706
              std dev =       0.708722362510
             le_variance =       0.502287387121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246799001
                                         uncertainty =       0.004337127283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246799001
                                         uncertainty =       0.004337127283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501142394
  error estimate for blocks of size 2^( 2) =       0.000519784251
  error estimate for blocks of size 2^( 3) =       0.000536491741
  error estimate for blocks of size 2^( 4) =       0.000549107839
  error estimate for blocks of size 2^( 5) =       0.000558034344
  error estimate for blocks of size 2^( 6) =       0.000566209792
  error estimate for blocks of size 2^( 7) =       0.000577661377

      target function =                  N/A
              le_mean =     -22.824442847702
             les_mean =     521.457478454659
             stat err =       0.000562753338
             autocorr =       1.260996476822
              std dev =       0.708722370039
             le_variance =       0.502287397794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246793659
                                         uncertainty =       0.004337127234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246793659
                                         uncertainty =       0.004337127234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501142391
  error estimate for blocks of size 2^( 2) =       0.000519784248
  error estimate for blocks of size 2^( 3) =       0.000536491738
  error estimate for blocks of size 2^( 4) =       0.000549107837
  error estimate for blocks of size 2^( 5) =       0.000558034342
  error estimate for blocks of size 2^( 6) =       0.000566209790
  error estimate for blocks of size 2^( 7) =       0.000577661375

      target function =                  N/A
              le_mean =     -22.824442847741
             les_mean =     521.457478451109
             stat err =       0.000562753336
             autocorr =       1.260996480264
              std dev =       0.708722366274
             le_variance =       0.502287392458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246788985
                                         uncertainty =       0.004337127191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502246788985
                                         uncertainty =       0.004337127191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501142389
  error estimate for blocks of size 2^( 2) =       0.000519784246
  error estimate for blocks of size 2^( 3) =       0.000536491736
  error estimate for blocks of size 2^( 4) =       0.000549107835
  error estimate for blocks of size 2^( 5) =       0.000558034340
  error estimate for blocks of size 2^( 6) =       0.000566209788
  error estimate for blocks of size 2^( 7) =       0.000577661373

      target function =                  N/A
              le_mean =     -22.824442847775
             les_mean =     521.457478448002
             stat err =       0.000562753334
             autocorr =       1.260996483284
              std dev =       0.708722362980
             le_variance =       0.502287387788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824442847780        initial  <--
     9.7656e+03     9.7656e+04             2.8777e-08       -22.824442847702
     3.9062e+04     3.9062e+05             7.1945e-09       -22.824442847741
     1.5625e+05     1.5625e+06             1.7986e-09       -22.824442847775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6474
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987773e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741995e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462302e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8084
    reference variance = 0.469025
====================================================
  Execution time = 4.4614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0739e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5203e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507369438341
                                         uncertainty =       0.004332453253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507369438341
                                         uncertainty =       0.004332453253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503683012
  error estimate for blocks of size 2^( 2) =       0.000521694015
  error estimate for blocks of size 2^( 3) =       0.000538460563
  error estimate for blocks of size 2^( 4) =       0.000549633578
  error estimate for blocks of size 2^( 5) =       0.000555513877
  error estimate for blocks of size 2^( 6) =       0.000558887043
  error estimate for blocks of size 2^( 7) =       0.000562130368

      target function =                  N/A
              le_mean =     -22.824466693474
             les_mean =     521.463672741355
             stat err =       0.000556541216
             autocorr =       1.220899899899
              std dev =       0.712315346974
             le_variance =       0.507393153534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282446669347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824466693474       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824466693474       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824466693479       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824466693422       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824466693471       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824466693404       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824466693467       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824466693463       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824466693075       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824466693214       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 2.547050e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824466693474       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824466693474       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824466693475       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824466693476       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824466693476       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824466693476       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824466693702       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824466693536       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824466693031       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824466693966       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+05 is 6.367633e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824466693474       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824466693474       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824466693475       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824466693475       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824466693202       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824466693318       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824466694501       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824466693196       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824466692605       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824466694490       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+06 is 1.591909e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9825e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987773e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741995e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462302e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8074
    reference variance = 0.897452
====================================================
  Execution time = 4.3252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0766e-01
  Total weights = 2.0000e+06
  Execution time = 4.0852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320711
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320711
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503817737
  error estimate for blocks of size 2^( 2) =       0.000521705180
  error estimate for blocks of size 2^( 3) =       0.000537321305
  error estimate for blocks of size 2^( 4) =       0.000548085858
  error estimate for blocks of size 2^( 5) =       0.000554475758
  error estimate for blocks of size 2^( 6) =       0.000559076656
  error estimate for blocks of size 2^( 7) =       0.000561395758

      target function =                  N/A
              le_mean =     -22.825769896259
             les_mean =     521.523435727041
             stat err =       0.000555758507
             autocorr =       1.216817182012
              std dev =       0.712505876390
             le_variance =       0.507664623890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320854
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320854
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503817737
  error estimate for blocks of size 2^( 2) =       0.000521705180
  error estimate for blocks of size 2^( 3) =       0.000537321305
  error estimate for blocks of size 2^( 4) =       0.000548085858
  error estimate for blocks of size 2^( 5) =       0.000554475758
  error estimate for blocks of size 2^( 6) =       0.000559076656
  error estimate for blocks of size 2^( 7) =       0.000561395758

      target function =                  N/A
              le_mean =     -22.825769896275
             les_mean =     521.523435727870
             stat err =       0.000555758507
             autocorr =       1.216817182094
              std dev =       0.712505876486
             le_variance =       0.507664624028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320783
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320783
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503817737
  error estimate for blocks of size 2^( 2) =       0.000521705180
  error estimate for blocks of size 2^( 3) =       0.000537321305
  error estimate for blocks of size 2^( 4) =       0.000548085858
  error estimate for blocks of size 2^( 5) =       0.000554475758
  error estimate for blocks of size 2^( 6) =       0.000559076656
  error estimate for blocks of size 2^( 7) =       0.000561395758

      target function =                  N/A
              le_mean =     -22.825769896267
             les_mean =     521.523435727456
             stat err =       0.000555758507
             autocorr =       1.216817182055
              std dev =       0.712505876438
             le_variance =       0.507664623959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320720
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507021320720
                                         uncertainty =       0.004123692650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503817737
  error estimate for blocks of size 2^( 2) =       0.000521705180
  error estimate for blocks of size 2^( 3) =       0.000537321305
  error estimate for blocks of size 2^( 4) =       0.000548085858
  error estimate for blocks of size 2^( 5) =       0.000554475758
  error estimate for blocks of size 2^( 6) =       0.000559076656
  error estimate for blocks of size 2^( 7) =       0.000561395758

      target function =                  N/A
              le_mean =     -22.825769896260
             les_mean =     521.523435727093
             stat err =       0.000555758507
             autocorr =       1.216817182023
              std dev =       0.712505876396
             le_variance =       0.507664623899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825769896259        initial
     9.7656e+04     9.7656e+05             2.5470e-09       -22.825769896275  <--
     3.9062e+05     3.9062e+06             6.3676e-10       -22.825769896267
     1.5625e+06     1.5625e+07             1.5919e-10       -22.825769896260

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 6.1876e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987772e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802467e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462301e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2172e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.9128
    reference variance = 1.10985
====================================================
  Execution time = 4.4437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4892e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504956494841
                                         uncertainty =       0.004574031882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504956494841
                                         uncertainty =       0.004574031882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502460881
  error estimate for blocks of size 2^( 2) =       0.000520089908
  error estimate for blocks of size 2^( 3) =       0.000535679263
  error estimate for blocks of size 2^( 4) =       0.000546361429
  error estimate for blocks of size 2^( 5) =       0.000553304384
  error estimate for blocks of size 2^( 6) =       0.000557993766
  error estimate for blocks of size 2^( 7) =       0.000561942934

      target function =                  N/A
              le_mean =     -22.824449626728
             les_mean =     521.460434384181
             stat err =       0.000554900628
             autocorr =       1.219623888364
              std dev =       0.710586992271
             le_variance =       0.504933873585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282444962673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449626728       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449626745       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824449626756       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824449626783       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824449626814       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824449626801       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824449626801       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824449626821       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824449626792       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824449626871       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 1.301805e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449626728       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449626733       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824449626735       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824449626742       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824449626760       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824449626782       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824449626783       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824449626914       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824449626615       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824449626777       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 3.254548e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449626728       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449626729       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824449626730       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824449626732       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824449626724       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824449626745       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824449626999       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824449626334       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824449627118       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824449626669       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+05 is 8.136396e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9337e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987771e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802468e-03 1 1  ON 48
eH1_9                 1.150724e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462300e-04 1 1  ON 58
eH2_9                 1.429021e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.9228
    reference variance = 0.650364
====================================================
  Execution time = 4.4081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1213e-01
  Total weights = 2.0000e+06
  Execution time = 3.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936574
                                         uncertainty =       0.004621910563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936574
                                         uncertainty =       0.004621910563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506026709
  error estimate for blocks of size 2^( 2) =       0.000523818826
  error estimate for blocks of size 2^( 3) =       0.000540188639
  error estimate for blocks of size 2^( 4) =       0.000550674209
  error estimate for blocks of size 2^( 5) =       0.000556428621
  error estimate for blocks of size 2^( 6) =       0.000558336515
  error estimate for blocks of size 2^( 7) =       0.000559069493

      target function =                  N/A
              le_mean =     -22.824928983838
             les_mean =     521.489508920749
             stat err =       0.000556127209
             autocorr =       1.207817751906
              std dev =       0.715629834174
             le_variance =       0.512126059560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936718
                                         uncertainty =       0.004621910554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936718
                                         uncertainty =       0.004621910554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506026709
  error estimate for blocks of size 2^( 2) =       0.000523818826
  error estimate for blocks of size 2^( 3) =       0.000540188639
  error estimate for blocks of size 2^( 4) =       0.000550674210
  error estimate for blocks of size 2^( 5) =       0.000556428621
  error estimate for blocks of size 2^( 6) =       0.000558336515
  error estimate for blocks of size 2^( 7) =       0.000559069493

      target function =                  N/A
              le_mean =     -22.824928983892
             les_mean =     521.489508923381
             stat err =       0.000556127210
             autocorr =       1.207817752989
              std dev =       0.715629834280
             le_variance =       0.512126059712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936646
                                         uncertainty =       0.004621910558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936646
                                         uncertainty =       0.004621910558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506026709
  error estimate for blocks of size 2^( 2) =       0.000523818826
  error estimate for blocks of size 2^( 3) =       0.000540188639
  error estimate for blocks of size 2^( 4) =       0.000550674209
  error estimate for blocks of size 2^( 5) =       0.000556428621
  error estimate for blocks of size 2^( 6) =       0.000558336515
  error estimate for blocks of size 2^( 7) =       0.000559069493

      target function =                  N/A
              le_mean =     -22.824928983865
             les_mean =     521.489508922065
             stat err =       0.000556127210
             autocorr =       1.207817752439
              std dev =       0.715629834227
             le_variance =       0.512126059636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936583
                                         uncertainty =       0.004621910562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512087936583
                                         uncertainty =       0.004621910562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506026709
  error estimate for blocks of size 2^( 2) =       0.000523818826
  error estimate for blocks of size 2^( 3) =       0.000540188639
  error estimate for blocks of size 2^( 4) =       0.000550674209
  error estimate for blocks of size 2^( 5) =       0.000556428621
  error estimate for blocks of size 2^( 6) =       0.000558336515
  error estimate for blocks of size 2^( 7) =       0.000559069493

      target function =                  N/A
              le_mean =     -22.824928983841
             les_mean =     521.489508920914
             stat err =       0.000556127209
             autocorr =       1.207817751966
              std dev =       0.715629834181
             le_variance =       0.512126059569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824928983838        initial
     2.4414e+04     2.4414e+05             1.3018e-08       -22.824928983892  <--
     9.7656e+04     9.7656e+05             3.2545e-09       -22.824928983865
     3.9062e+05     3.9062e+06             8.1364e-10       -22.824928983841

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 6.1687e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7741
    reference variance = 0.309045
====================================================
  Execution time = 4.4069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5151e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916227332
                                         uncertainty =       0.003991024603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916227332
                                         uncertainty =       0.003991024603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501960727
  error estimate for blocks of size 2^( 2) =       0.000520392821
  error estimate for blocks of size 2^( 3) =       0.000536639736
  error estimate for blocks of size 2^( 4) =       0.000548090490
  error estimate for blocks of size 2^( 5) =       0.000555444689
  error estimate for blocks of size 2^( 6) =       0.000558685695
  error estimate for blocks of size 2^( 7) =       0.000561701256

      target function =                  N/A
              le_mean =     -22.825513929654
             les_mean =     521.508015043723
             stat err =       0.000555980532
             autocorr =       1.226816732837
              std dev =       0.709879667858
             le_variance =       0.503929142838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282551392965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825513929654       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825513929623       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825513929597       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825513929619       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825513929617       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825513929680       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825513929774       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825513929738       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825513929753       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825513929738       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 3.913674e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825513929654       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825513929646       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825513929640       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825513929646       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825513929645       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825513929650       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825513929685       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825513929659       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825513929623       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825513929610       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 9.784476e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825513929654       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825513929652       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825513929651       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825513929652       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825513929567       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825513929590       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825513929700       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825513929659       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825513929859       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825513929813       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 2.446137e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9282e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249790e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048406e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987764e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354072e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681018e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196336e-02 1 1  ON 47
eH1_8                 4.802470e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667527e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462276e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8181
    reference variance = 0.407221
====================================================
  Execution time = 4.3125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1622e-01
  Total weights = 2.0000e+06
  Execution time = 3.5242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226698665
                                         uncertainty =       0.010142109066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226698665
                                         uncertainty =       0.010142109066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508042937
  error estimate for blocks of size 2^( 2) =       0.000525835250
  error estimate for blocks of size 2^( 3) =       0.000541522601
  error estimate for blocks of size 2^( 4) =       0.000552637006
  error estimate for blocks of size 2^( 5) =       0.000557068276
  error estimate for blocks of size 2^( 6) =       0.000559656561
  error estimate for blocks of size 2^( 7) =       0.000560168931

      target function =                  N/A
              le_mean =     -22.824982128044
             les_mean =     521.496024140047
             stat err =       0.000557382694
             autocorr =       1.203666361353
              std dev =       0.718481212449
             le_variance =       0.516215252642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226749102
                                         uncertainty =       0.010142110131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226749102
                                         uncertainty =       0.010142110131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508042962
  error estimate for blocks of size 2^( 2) =       0.000525835273
  error estimate for blocks of size 2^( 3) =       0.000541522622
  error estimate for blocks of size 2^( 4) =       0.000552637027
  error estimate for blocks of size 2^( 5) =       0.000557068296
  error estimate for blocks of size 2^( 6) =       0.000559656580
  error estimate for blocks of size 2^( 7) =       0.000560168950

      target function =                  N/A
              le_mean =     -22.824982127775
             les_mean =     521.496024178222
             stat err =       0.000557382713
             autocorr =       1.203666327091
              std dev =       0.718481247536
             le_variance =       0.516215303061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226723885
                                         uncertainty =       0.010142109599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226723885
                                         uncertainty =       0.010142109599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508042950
  error estimate for blocks of size 2^( 2) =       0.000525835262
  error estimate for blocks of size 2^( 3) =       0.000541522611
  error estimate for blocks of size 2^( 4) =       0.000552637017
  error estimate for blocks of size 2^( 5) =       0.000557068286
  error estimate for blocks of size 2^( 6) =       0.000559656571
  error estimate for blocks of size 2^( 7) =       0.000560168941

      target function =                  N/A
              le_mean =     -22.824982127910
             les_mean =     521.496024159135
             stat err =       0.000557382704
             autocorr =       1.203666344220
              std dev =       0.718481229994
             le_variance =       0.516215277853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226701818
                                         uncertainty =       0.010142109133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516226701818
                                         uncertainty =       0.010142109133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508042939
  error estimate for blocks of size 2^( 2) =       0.000525835251
  error estimate for blocks of size 2^( 3) =       0.000541522602
  error estimate for blocks of size 2^( 4) =       0.000552637008
  error estimate for blocks of size 2^( 5) =       0.000557068278
  error estimate for blocks of size 2^( 6) =       0.000559656563
  error estimate for blocks of size 2^( 7) =       0.000560168933

      target function =                  N/A
              le_mean =     -22.824982128027
             les_mean =     521.496024142433
             stat err =       0.000557382695
             autocorr =       1.203666359203
              std dev =       0.718481214642
             le_variance =       0.516215255793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824982128044        initial  <--
     6.1035e+03     6.1035e+04             3.9137e-08       -22.824982127775
     2.4414e+04     2.4414e+05             9.7845e-09       -22.824982127910
     9.7656e+04     9.7656e+05             2.4461e-09       -22.824982128027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7884
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2008e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7916
    reference variance = 0.233222
====================================================
  Execution time = 4.5413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0716e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5189e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507119387075
                                         uncertainty =       0.006095997988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507119387075
                                         uncertainty =       0.006095997988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503568511
  error estimate for blocks of size 2^( 2) =       0.000521541681
  error estimate for blocks of size 2^( 3) =       0.000537571053
  error estimate for blocks of size 2^( 4) =       0.000549229910
  error estimate for blocks of size 2^( 5) =       0.000555192528
  error estimate for blocks of size 2^( 6) =       0.000560011492
  error estimate for blocks of size 2^( 7) =       0.000563291268

      target function =                  N/A
              le_mean =     -22.825641648825
             les_mean =     521.517078917317
             stat err =       0.000556931300
             autocorr =       1.223168032322
              std dev =       0.712153417693
             le_variance =       0.507162490332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282564164882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825641648825       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825641648832       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825641648839       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825641648819       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825641648839       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825641648833       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825641648895       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825641648916       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825641648762       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825641648712       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 2.722949e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825641648825       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825641648827       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825641648828       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825641648829       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825641648905       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825641648800       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825641648828       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825641648750       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825641648534       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825641648292       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 6.807391e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825641648825       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825641648825       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825641648826       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825641648826       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825641648725       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825641648574       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825641648860       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825641648936       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825641648551       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825641653337       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+05 is 1.701850e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0611e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433660e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462294e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7953
    reference variance = 0.317697
====================================================
  Execution time = 4.3942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0053e-01
  Total weights = 2.0000e+06
  Execution time = 3.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605699132
                                         uncertainty =       0.003336560234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605699132
                                         uncertainty =       0.003336560234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500264487
  error estimate for blocks of size 2^( 2) =       0.000518049644
  error estimate for blocks of size 2^( 3) =       0.000533840508
  error estimate for blocks of size 2^( 4) =       0.000544222113
  error estimate for blocks of size 2^( 5) =       0.000550131424
  error estimate for blocks of size 2^( 6) =       0.000555211971
  error estimate for blocks of size 2^( 7) =       0.000558153527

      target function =                  N/A
              le_mean =     -22.825416179104
             les_mean =     521.500152613567
             stat err =       0.000551929759
             autocorr =       1.217217738564
              std dev =       0.707480822721
             le_variance =       0.500529114518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605697879
                                         uncertainty =       0.003336560220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605697879
                                         uncertainty =       0.003336560220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500264487
  error estimate for blocks of size 2^( 2) =       0.000518049644
  error estimate for blocks of size 2^( 3) =       0.000533840507
  error estimate for blocks of size 2^( 4) =       0.000544222112
  error estimate for blocks of size 2^( 5) =       0.000550131423
  error estimate for blocks of size 2^( 6) =       0.000555211970
  error estimate for blocks of size 2^( 7) =       0.000558153526

      target function =                  N/A
              le_mean =     -22.825416179088
             les_mean =     521.500152611576
             stat err =       0.000551929758
             autocorr =       1.217217738973
              std dev =       0.707480821835
             le_variance =       0.500529113265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605698505
                                         uncertainty =       0.003336560227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605698505
                                         uncertainty =       0.003336560227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500264487
  error estimate for blocks of size 2^( 2) =       0.000518049644
  error estimate for blocks of size 2^( 3) =       0.000533840508
  error estimate for blocks of size 2^( 4) =       0.000544222112
  error estimate for blocks of size 2^( 5) =       0.000550131424
  error estimate for blocks of size 2^( 6) =       0.000555211971
  error estimate for blocks of size 2^( 7) =       0.000558153526

      target function =                  N/A
              le_mean =     -22.825416179096
             les_mean =     521.500152612571
             stat err =       0.000551929758
             autocorr =       1.217217738760
              std dev =       0.707480822278
             le_variance =       0.500529113891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605699054
                                         uncertainty =       0.003336560233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500605699054
                                         uncertainty =       0.003336560233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500264487
  error estimate for blocks of size 2^( 2) =       0.000518049644
  error estimate for blocks of size 2^( 3) =       0.000533840508
  error estimate for blocks of size 2^( 4) =       0.000544222113
  error estimate for blocks of size 2^( 5) =       0.000550131424
  error estimate for blocks of size 2^( 6) =       0.000555211971
  error estimate for blocks of size 2^( 7) =       0.000558153527

      target function =                  N/A
              le_mean =     -22.825416179103
             les_mean =     521.500152613442
             stat err =       0.000551929759
             autocorr =       1.217217738583
              std dev =       0.707480822666
             le_variance =       0.500529114440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825416179104        initial  <--
     6.1035e+04     6.1035e+05             2.7229e-09       -22.825416179088
     2.4414e+05     2.4414e+06             6.8074e-10       -22.825416179096
     9.7656e+05     9.7656e+06             1.7019e-10       -22.825416179103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5680
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2222e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7946
    reference variance = 0.3455
====================================================
  Execution time = 4.4596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5151e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505572366361
                                         uncertainty =       0.004122057910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505572366361
                                         uncertainty =       0.004122057910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502772467
  error estimate for blocks of size 2^( 2) =       0.000520140280
  error estimate for blocks of size 2^( 3) =       0.000535036261
  error estimate for blocks of size 2^( 4) =       0.000546873453
  error estimate for blocks of size 2^( 5) =       0.000553945221
  error estimate for blocks of size 2^( 6) =       0.000557779856
  error estimate for blocks of size 2^( 7) =       0.000559290389

      target function =                  N/A
              le_mean =     -22.825478893177
             les_mean =     521.508046757751
             stat err =       0.000554472230
             autocorr =       1.216232559691
              std dev =       0.711027641994
             le_variance =       0.505560307679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282547889318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478893177       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825478893178       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825478893178       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825478893198       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825478893161       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825478893260       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825478893231       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825478893739       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825478892729       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825478893509       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 3.482041e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478893177       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825478893177       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825478893177       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825478893084       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825478894496       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825478892824       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825478884094       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825478892981       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825478892290       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825478883880       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+06 is 8.704609e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825478893177       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825478893177       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825478893177       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825478888811       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825478889280       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825478899069       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825478892860       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825478897294       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825478883104       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825478889206       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+06 is 2.176280e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9756e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.979
    reference variance = 0.887116
====================================================
  Execution time = 4.3710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0714e-01
  Total weights = 2.0000e+06
  Execution time = 3.5112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498946
                                         uncertainty =       0.005194767532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498946
                                         uncertainty =       0.005194767532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503555757
  error estimate for blocks of size 2^( 2) =       0.000521139173
  error estimate for blocks of size 2^( 3) =       0.000536963371
  error estimate for blocks of size 2^( 4) =       0.000548188792
  error estimate for blocks of size 2^( 5) =       0.000554673818
  error estimate for blocks of size 2^( 6) =       0.000558949962
  error estimate for blocks of size 2^( 7) =       0.000563413769

      target function =                  N/A
              le_mean =     -22.825998106270
             les_mean =     521.533326094224
             stat err =       0.000556306585
             autocorr =       1.220487318537
              std dev =       0.712135380644
             le_variance =       0.507136800365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498660
                                         uncertainty =       0.005194767527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498660
                                         uncertainty =       0.005194767527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503555757
  error estimate for blocks of size 2^( 2) =       0.000521139173
  error estimate for blocks of size 2^( 3) =       0.000536963371
  error estimate for blocks of size 2^( 4) =       0.000548188792
  error estimate for blocks of size 2^( 5) =       0.000554673818
  error estimate for blocks of size 2^( 6) =       0.000558949962
  error estimate for blocks of size 2^( 7) =       0.000563413768

      target function =                  N/A
              le_mean =     -22.825998106269
             les_mean =     521.533326093913
             stat err =       0.000556306585
             autocorr =       1.220487318651
              std dev =       0.712135380443
             le_variance =       0.507136800079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498803
                                         uncertainty =       0.005194767530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498803
                                         uncertainty =       0.005194767530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503555757
  error estimate for blocks of size 2^( 2) =       0.000521139173
  error estimate for blocks of size 2^( 3) =       0.000536963371
  error estimate for blocks of size 2^( 4) =       0.000548188792
  error estimate for blocks of size 2^( 5) =       0.000554673818
  error estimate for blocks of size 2^( 6) =       0.000558949962
  error estimate for blocks of size 2^( 7) =       0.000563413769

      target function =                  N/A
              le_mean =     -22.825998106269
             les_mean =     521.533326094069
             stat err =       0.000556306585
             autocorr =       1.220487318598
              std dev =       0.712135380544
             le_variance =       0.507136800222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498928
                                         uncertainty =       0.005194767532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506996498928
                                         uncertainty =       0.005194767532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503555757
  error estimate for blocks of size 2^( 2) =       0.000521139173
  error estimate for blocks of size 2^( 3) =       0.000536963371
  error estimate for blocks of size 2^( 4) =       0.000548188792
  error estimate for blocks of size 2^( 5) =       0.000554673818
  error estimate for blocks of size 2^( 6) =       0.000558949962
  error estimate for blocks of size 2^( 7) =       0.000563413769

      target function =                  N/A
              le_mean =     -22.825998106270
             les_mean =     521.533326094204
             stat err =       0.000556306585
             autocorr =       1.220487318550
              std dev =       0.712135380631
             le_variance =       0.507136800347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825998106270        initial  <--
     6.1035e+05     6.1035e+06             3.4820e-10       -22.825998106269
     2.4414e+06     2.4414e+07             8.7046e-11       -22.825998106269
     9.7656e+06     9.7656e+07             2.1763e-11       -22.825998106270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2930
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2106e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.9044
    reference variance = 1.89494
====================================================
  Execution time = 4.3925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0420e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5088e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504099137393
                                         uncertainty =       0.004612321225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504099137393
                                         uncertainty =       0.004612321225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502094265
  error estimate for blocks of size 2^( 2) =       0.000520456189
  error estimate for blocks of size 2^( 3) =       0.000537082078
  error estimate for blocks of size 2^( 4) =       0.000548622052
  error estimate for blocks of size 2^( 5) =       0.000555174131
  error estimate for blocks of size 2^( 6) =       0.000560087385
  error estimate for blocks of size 2^( 7) =       0.000560919589

      target function =                  N/A
              le_mean =     -22.824872534512
             les_mean =     521.479003266751
             stat err =       0.000556200789
             autocorr =       1.227135950873
              std dev =       0.710068519314
             le_variance =       0.504197302120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282487253451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824872534512       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824872534512       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824872534513       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824872534513       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824872535422       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824872534279       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824872533097       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824872530513       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824872534193       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824872542335       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+06 is 4.177875e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824872534512       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824872534512       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824872534512       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824872534512       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824872536325       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824872536564       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824872532424       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824872535518       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824872543205       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824872517336       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+07 is 1.044457e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824872534512       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824872534512       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824872534512       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824872531490       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824872531080       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824872542291       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824872515674       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824872475002       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824872508164       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824872533050       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+07 is 2.611482e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9021e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7929
    reference variance = 0.381695
====================================================
  Execution time = 4.4879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0448e-01
  Total weights = 2.0000e+06
  Execution time = 3.5673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690430
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690430
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502237380
  error estimate for blocks of size 2^( 2) =       0.000519907178
  error estimate for blocks of size 2^( 3) =       0.000535479143
  error estimate for blocks of size 2^( 4) =       0.000545793749
  error estimate for blocks of size 2^( 5) =       0.000552103798
  error estimate for blocks of size 2^( 6) =       0.000556622264
  error estimate for blocks of size 2^( 7) =       0.000559462481

      target function =                  N/A
              le_mean =     -22.826286303485
             les_mean =     521.543830928597
             stat err =       0.000553495573
             autocorr =       1.214535566080
              std dev =       0.710270914648
             le_variance =       0.504484772195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690442
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690442
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502237380
  error estimate for blocks of size 2^( 2) =       0.000519907178
  error estimate for blocks of size 2^( 3) =       0.000535479143
  error estimate for blocks of size 2^( 4) =       0.000545793749
  error estimate for blocks of size 2^( 5) =       0.000552103798
  error estimate for blocks of size 2^( 6) =       0.000556622264
  error estimate for blocks of size 2^( 7) =       0.000559462481

      target function =                  N/A
              le_mean =     -22.826286303485
             les_mean =     521.543830928612
             stat err =       0.000553495573
             autocorr =       1.214535566081
              std dev =       0.710270914656
             le_variance =       0.504484772206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690436
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690436
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502237380
  error estimate for blocks of size 2^( 2) =       0.000519907178
  error estimate for blocks of size 2^( 3) =       0.000535479143
  error estimate for blocks of size 2^( 4) =       0.000545793749
  error estimate for blocks of size 2^( 5) =       0.000552103798
  error estimate for blocks of size 2^( 6) =       0.000556622264
  error estimate for blocks of size 2^( 7) =       0.000559462481

      target function =                  N/A
              le_mean =     -22.826286303485
             les_mean =     521.543830928605
             stat err =       0.000553495573
             autocorr =       1.214535566080
              std dev =       0.710270914652
             le_variance =       0.504484772200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690431
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504522690431
                                         uncertainty =       0.004730079267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502237380
  error estimate for blocks of size 2^( 2) =       0.000519907178
  error estimate for blocks of size 2^( 3) =       0.000535479143
  error estimate for blocks of size 2^( 4) =       0.000545793749
  error estimate for blocks of size 2^( 5) =       0.000552103798
  error estimate for blocks of size 2^( 6) =       0.000556622264
  error estimate for blocks of size 2^( 7) =       0.000559462481

      target function =                  N/A
              le_mean =     -22.826286303485
             les_mean =     521.543830928598
             stat err =       0.000553495573
             autocorr =       1.214535566082
              std dev =       0.710270914648
             le_variance =       0.504484772195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826286303485        initial
     6.1035e+06     6.1035e+07             4.1779e-11       -22.826286303485  <--
     2.4414e+07     2.4414e+08             1.0445e-11       -22.826286303485
     9.7656e+07     9.7656e+08             2.6115e-12       -22.826286303485

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 6.2593e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2167e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8296
    reference variance = 0.33582
====================================================
  Execution time = 4.4193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5057e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502566581290
                                         uncertainty =       0.003755404277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502566581290
                                         uncertainty =       0.003755404277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501289369
  error estimate for blocks of size 2^( 2) =       0.000518513139
  error estimate for blocks of size 2^( 3) =       0.000533709627
  error estimate for blocks of size 2^( 4) =       0.000544109300
  error estimate for blocks of size 2^( 5) =       0.000550301478
  error estimate for blocks of size 2^( 6) =       0.000552415160
  error estimate for blocks of size 2^( 7) =       0.000555941350

      target function =                  N/A
              le_mean =     -22.826274254952
             les_mean =     521.541378173743
             stat err =       0.000550691822
             autocorr =       1.206813793274
              std dev =       0.708930224172
             le_variance =       0.502582062745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282627425495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826274254952       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826274254952       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826274254953       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826274255130       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826274256464       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826274256550       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826274255426       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826274254255       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826274255582       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 1.067480e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826274254952       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826274254952       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826274254952       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826274254952       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826274260082       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826274250336       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826274254439       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826274248631       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826274253153       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+06 is 2.668800e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826274254952       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826274254952       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826274254952       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826274258299       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826274291149       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826274242576       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826274262149       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826274255771       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826274268145       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+07 is 6.671759e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9258e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8515
    reference variance = 0.423442
====================================================
  Execution time = 4.3833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0354e-01
  Total weights = 2.0000e+06
  Execution time = 3.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064029
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064029
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501766613
  error estimate for blocks of size 2^( 2) =       0.000519957403
  error estimate for blocks of size 2^( 3) =       0.000535178629
  error estimate for blocks of size 2^( 4) =       0.000546063667
  error estimate for blocks of size 2^( 5) =       0.000553160480
  error estimate for blocks of size 2^( 6) =       0.000556126916
  error estimate for blocks of size 2^( 7) =       0.000555648189

      target function =                  N/A
              le_mean =     -22.825365372362
             les_mean =     521.500843597424
             stat err =       0.000552749813
             autocorr =       1.213538859380
              std dev =       0.709605148931
             le_variance =       0.503539467389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064122
                                         uncertainty =       0.003469146228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064122
                                         uncertainty =       0.003469146228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501766613
  error estimate for blocks of size 2^( 2) =       0.000519957403
  error estimate for blocks of size 2^( 3) =       0.000535178629
  error estimate for blocks of size 2^( 4) =       0.000546063667
  error estimate for blocks of size 2^( 5) =       0.000553160480
  error estimate for blocks of size 2^( 6) =       0.000556126916
  error estimate for blocks of size 2^( 7) =       0.000555648189

      target function =                  N/A
              le_mean =     -22.825365372361
             les_mean =     521.500843597504
             stat err =       0.000552749813
             autocorr =       1.213538859341
              std dev =       0.709605148997
             le_variance =       0.503539467483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064075
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064075
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501766613
  error estimate for blocks of size 2^( 2) =       0.000519957403
  error estimate for blocks of size 2^( 3) =       0.000535178629
  error estimate for blocks of size 2^( 4) =       0.000546063667
  error estimate for blocks of size 2^( 5) =       0.000553160480
  error estimate for blocks of size 2^( 6) =       0.000556126916
  error estimate for blocks of size 2^( 7) =       0.000555648189

      target function =                  N/A
              le_mean =     -22.825365372361
             les_mean =     521.500843597464
             stat err =       0.000552749813
             autocorr =       1.213538859361
              std dev =       0.709605148964
             le_variance =       0.503539467436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064034
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503591064034
                                         uncertainty =       0.003469146227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501766613
  error estimate for blocks of size 2^( 2) =       0.000519957403
  error estimate for blocks of size 2^( 3) =       0.000535178629
  error estimate for blocks of size 2^( 4) =       0.000546063667
  error estimate for blocks of size 2^( 5) =       0.000553160480
  error estimate for blocks of size 2^( 6) =       0.000556126916
  error estimate for blocks of size 2^( 7) =       0.000555648189

      target function =                  N/A
              le_mean =     -22.825365372362
             les_mean =     521.500843597429
             stat err =       0.000552749813
             autocorr =       1.213538859378
              std dev =       0.709605148935
             le_variance =       0.503539467395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825365372362        initial  <--
     1.5259e+06     1.5259e+07             1.0675e-10       -22.825365372361
     6.1035e+06     6.1035e+07             2.6688e-11       -22.825365372361
     2.4414e+07     2.4414e+08             6.6718e-12       -22.825365372362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4057
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2068e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7389
    reference variance = 0.343763
====================================================
  Execution time = 4.3956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1045e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5006e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510539501515
                                         uncertainty =       0.013558996056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510539501515
                                         uncertainty =       0.013558996056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505196030
  error estimate for blocks of size 2^( 2) =       0.000523178257
  error estimate for blocks of size 2^( 3) =       0.000538815684
  error estimate for blocks of size 2^( 4) =       0.000549625652
  error estimate for blocks of size 2^( 5) =       0.000555622842
  error estimate for blocks of size 2^( 6) =       0.000559456018
  error estimate for blocks of size 2^( 7) =       0.000560978542

      target function =                  N/A
              le_mean =     -22.826026149010
             les_mean =     521.537915556936
             stat err =       0.000556420763
             autocorr =       1.213072612558
              std dev =       0.714455076882
             le_variance =       0.510446056882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282602614901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026149010       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826026149010       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826026149010       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826026146205       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826026149128       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826026147375       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826026145821       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826026137658       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826026150914       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826026144934       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+07 is 1.525672e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026149010       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826026149010       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826026149010       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826026122484       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826026147673       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826026150199       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826026138164       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826026102575       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826026132366       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826026076287       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+07 is 3.814705e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826026149010       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826026149010       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826026149010       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826026149010       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826026149010       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826026149010       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826026249450       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826026435043       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826026159643       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826026146741       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+08 is 9.526582e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8970e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7145
    reference variance = 0.321769
====================================================
  Execution time = 4.3563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0236e-01
  Total weights = 2.0000e+06
  Execution time = 3.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383882
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383882
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501178684
  error estimate for blocks of size 2^( 2) =       0.000519078247
  error estimate for blocks of size 2^( 3) =       0.000534346766
  error estimate for blocks of size 2^( 4) =       0.000545562966
  error estimate for blocks of size 2^( 5) =       0.000551182511
  error estimate for blocks of size 2^( 6) =       0.000556087943
  error estimate for blocks of size 2^( 7) =       0.000557540090

      target function =                  N/A
              le_mean =     -22.825057565464
             les_mean =     521.485612762447
             stat err =       0.000552593378
             autocorr =       1.215699305804
              std dev =       0.708773692301
             le_variance =       0.502360146898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383883
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383883
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501178684
  error estimate for blocks of size 2^( 2) =       0.000519078247
  error estimate for blocks of size 2^( 3) =       0.000534346766
  error estimate for blocks of size 2^( 4) =       0.000545562966
  error estimate for blocks of size 2^( 5) =       0.000551182511
  error estimate for blocks of size 2^( 6) =       0.000556087943
  error estimate for blocks of size 2^( 7) =       0.000557540090

      target function =                  N/A
              le_mean =     -22.825057565464
             les_mean =     521.485612762447
             stat err =       0.000552593378
             autocorr =       1.215699305806
              std dev =       0.708773692302
             le_variance =       0.502360146899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383883
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383883
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501178684
  error estimate for blocks of size 2^( 2) =       0.000519078247
  error estimate for blocks of size 2^( 3) =       0.000534346766
  error estimate for blocks of size 2^( 4) =       0.000545562966
  error estimate for blocks of size 2^( 5) =       0.000551182511
  error estimate for blocks of size 2^( 6) =       0.000556087943
  error estimate for blocks of size 2^( 7) =       0.000557540090

      target function =                  N/A
              le_mean =     -22.825057565464
             les_mean =     521.485612762447
             stat err =       0.000552593378
             autocorr =       1.215699305814
              std dev =       0.708773692302
             le_variance =       0.502360146899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383882
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502350383882
                                         uncertainty =       0.003958355472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501178684
  error estimate for blocks of size 2^( 2) =       0.000519078247
  error estimate for blocks of size 2^( 3) =       0.000534346766
  error estimate for blocks of size 2^( 4) =       0.000545562966
  error estimate for blocks of size 2^( 5) =       0.000551182511
  error estimate for blocks of size 2^( 6) =       0.000556087943
  error estimate for blocks of size 2^( 7) =       0.000557540090

      target function =                  N/A
              le_mean =     -22.825057565464
             les_mean =     521.485612762447
             stat err =       0.000552593378
             autocorr =       1.215699305806
              std dev =       0.708773692301
             le_variance =       0.502360146898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825057565464        initial  <--
     1.5259e+07     1.5259e+08             1.5257e-11       -22.825057565464
     6.1035e+07     6.1035e+08             3.8147e-12       -22.825057565464
     2.4414e+08     2.4414e+09             9.5266e-13       -22.825057565464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1761
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2016e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8852
    reference variance = 0.335986
====================================================
  Execution time = 4.6130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4860e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509487410631
                                         uncertainty =       0.005459433188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509487410631
                                         uncertainty =       0.005459433188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504694185
  error estimate for blocks of size 2^( 2) =       0.000522564146
  error estimate for blocks of size 2^( 3) =       0.000538059441
  error estimate for blocks of size 2^( 4) =       0.000548789586
  error estimate for blocks of size 2^( 5) =       0.000556537287
  error estimate for blocks of size 2^( 6) =       0.000560160962
  error estimate for blocks of size 2^( 7) =       0.000560659159

      target function =                  N/A
              le_mean =     -22.825953867723
             les_mean =     521.533602156937
             stat err =       0.000556536748
             autocorr =       1.215993046262
              std dev =       0.713745360908
             le_variance =       0.509432440218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282595386772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825953867723       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825953867723       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825953867723       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825953867723       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825953794073       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825953874146       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825953866042       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825953865520       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825953858076       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825953874137       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+08 is 1.231486e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825953867723       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825953867723       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825953867723       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825953867723       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825953800611       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825953916180       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825953926600       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825953803467       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825953805593       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825954273029       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+08 is 3.078339e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825953867723       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825953867723       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825953867723       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825953584749       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825951493627       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825953787317       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825952805733       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825952541807       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825952890982       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825953692683       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+09 is 7.799912e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0998e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.935
    reference variance = 0.384445
====================================================
  Execution time = 4.3208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0169e-01
  Total weights = 2.0000e+06
  Execution time = 3.5136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987535
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987535
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500845083
  error estimate for blocks of size 2^( 2) =       0.000518858345
  error estimate for blocks of size 2^( 3) =       0.000534961025
  error estimate for blocks of size 2^( 4) =       0.000546529880
  error estimate for blocks of size 2^( 5) =       0.000553638722
  error estimate for blocks of size 2^( 6) =       0.000557658293
  error estimate for blocks of size 2^( 7) =       0.000560400281

      target function =                  N/A
              le_mean =     -22.825482583560
             les_mean =     521.504346515225
             stat err =       0.000554556794
             autocorr =       1.225985213828
              std dev =       0.708301908551
             le_variance =       0.501691593657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987536
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987536
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500845083
  error estimate for blocks of size 2^( 2) =       0.000518858345
  error estimate for blocks of size 2^( 3) =       0.000534961025
  error estimate for blocks of size 2^( 4) =       0.000546529880
  error estimate for blocks of size 2^( 5) =       0.000553638722
  error estimate for blocks of size 2^( 6) =       0.000557658293
  error estimate for blocks of size 2^( 7) =       0.000560400281

      target function =                  N/A
              le_mean =     -22.825482583560
             les_mean =     521.504346515227
             stat err =       0.000554556794
             autocorr =       1.225985213830
              std dev =       0.708301908552
             le_variance =       0.501691593659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987536
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987536
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500845083
  error estimate for blocks of size 2^( 2) =       0.000518858345
  error estimate for blocks of size 2^( 3) =       0.000534961025
  error estimate for blocks of size 2^( 4) =       0.000546529880
  error estimate for blocks of size 2^( 5) =       0.000553638722
  error estimate for blocks of size 2^( 6) =       0.000557658293
  error estimate for blocks of size 2^( 7) =       0.000560400281

      target function =                  N/A
              le_mean =     -22.825482583560
             les_mean =     521.504346515226
             stat err =       0.000554556794
             autocorr =       1.225985213820
              std dev =       0.708301908552
             le_variance =       0.501691593658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987535
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501682987535
                                         uncertainty =       0.003396817408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500845083
  error estimate for blocks of size 2^( 2) =       0.000518858345
  error estimate for blocks of size 2^( 3) =       0.000534961025
  error estimate for blocks of size 2^( 4) =       0.000546529880
  error estimate for blocks of size 2^( 5) =       0.000553638722
  error estimate for blocks of size 2^( 6) =       0.000557658293
  error estimate for blocks of size 2^( 7) =       0.000560400281

      target function =                  N/A
              le_mean =     -22.825482583560
             les_mean =     521.504346515226
             stat err =       0.000554556794
             autocorr =       1.225985213828
              std dev =       0.708301908551
             le_variance =       0.501691593657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825482583560        initial  <--
     1.5259e+08     1.5259e+09             1.2315e-12       -22.825482583560
     6.1035e+08     6.1035e+09             3.0783e-13       -22.825482583560
     2.4414e+09     2.4414e+10             7.7999e-14       -22.825482583560

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7922
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8791
    reference variance = 0.890235
====================================================
  Execution time = 4.3831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0513e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504956578764
                                         uncertainty =       0.005261806453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504956578764
                                         uncertainty =       0.005261806453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502558618
  error estimate for blocks of size 2^( 2) =       0.000520079736
  error estimate for blocks of size 2^( 3) =       0.000535806941
  error estimate for blocks of size 2^( 4) =       0.000546971426
  error estimate for blocks of size 2^( 5) =       0.000553586786
  error estimate for blocks of size 2^( 6) =       0.000557139426
  error estimate for blocks of size 2^( 7) =       0.000560579497

      target function =                  N/A
              le_mean =     -22.824650870986
             les_mean =     521.469817459448
             stat err =       0.000554569284
             autocorr =       1.217694019177
              std dev =       0.710725213857
             le_variance =       0.505130329612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282465087099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824650870986       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824650870986       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824650870986       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824650870986       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824650770192       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824650871834       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824651211873       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824651146414       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824655490708       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824651447501       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+09 is 1.190012e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824650870986       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824650870986       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824650870986       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824650870986       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824650870986       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824652272593       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824650872708       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824643367355       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824652095933       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824652985679       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824650234718       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+09 is 2.990325e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824650870986       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824650870986       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824650870986       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824650870986       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824652205504       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824627514190       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824650442359       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824664249610       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824580839224       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824679166713       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824646136679       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824704965587       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824591985348       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824722752203       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824598090744       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.823919894821       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825265097906       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824744008828       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.824795169756       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.824395812635       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.823456425190       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.826423745824       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.823815225351       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.823629840328       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.824548522956       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.824319321963       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.823716420157       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.826256051350       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.821918010561       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.823381212861       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.825707723561       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.821718792084       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.824928499832       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.823087719593       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.822263841351       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.831319047307       residual = 2.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -22.826828413999       residual = 2.43e-03           smallest_sin_value = 9.96e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.822928558483       residual = 1.45e-03           smallest_sin_value = 9.93e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+10 is 8.124899e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9069e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7968
    reference variance = 0.467092
====================================================
  Execution time = 4.3323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0864e-01
  Total weights = 2.0000e+06
  Execution time = 3.5212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504300424
  error estimate for blocks of size 2^( 2) =       0.000522171683
  error estimate for blocks of size 2^( 3) =       0.000537927331
  error estimate for blocks of size 2^( 4) =       0.000548366588
  error estimate for blocks of size 2^( 5) =       0.000554414348
  error estimate for blocks of size 2^( 6) =       0.000558630523
  error estimate for blocks of size 2^( 7) =       0.000560655286

      target function =                  N/A
              le_mean =     -22.824975916225
             les_mean =     521.488163156311
             stat err =       0.000555516686
             autocorr =       1.213432300339
              std dev =       0.713188498486
             le_variance =       0.508637834373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504300424
  error estimate for blocks of size 2^( 2) =       0.000522171683
  error estimate for blocks of size 2^( 3) =       0.000537927331
  error estimate for blocks of size 2^( 4) =       0.000548366588
  error estimate for blocks of size 2^( 5) =       0.000554414348
  error estimate for blocks of size 2^( 6) =       0.000558630523
  error estimate for blocks of size 2^( 7) =       0.000560655286

      target function =                  N/A
              le_mean =     -22.824975916225
             les_mean =     521.488163156311
             stat err =       0.000555516686
             autocorr =       1.213432300341
              std dev =       0.713188498486
             le_variance =       0.508637834373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504300424
  error estimate for blocks of size 2^( 2) =       0.000522171683
  error estimate for blocks of size 2^( 3) =       0.000537927331
  error estimate for blocks of size 2^( 4) =       0.000548366588
  error estimate for blocks of size 2^( 5) =       0.000554414348
  error estimate for blocks of size 2^( 6) =       0.000558630523
  error estimate for blocks of size 2^( 7) =       0.000560655286

      target function =                  N/A
              le_mean =     -22.824975916225
             les_mean =     521.488163156311
             stat err =       0.000555516686
             autocorr =       1.213432300337
              std dev =       0.713188498486
             le_variance =       0.508637834373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508634557260
                                         uncertainty =       0.004275721463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504300424
  error estimate for blocks of size 2^( 2) =       0.000522171683
  error estimate for blocks of size 2^( 3) =       0.000537927331
  error estimate for blocks of size 2^( 4) =       0.000548366588
  error estimate for blocks of size 2^( 5) =       0.000554414348
  error estimate for blocks of size 2^( 6) =       0.000558630523
  error estimate for blocks of size 2^( 7) =       0.000560655286

      target function =                  N/A
              le_mean =     -22.824975916225
             les_mean =     521.488163156311
             stat err =       0.000555516686
             autocorr =       1.213432300339
              std dev =       0.713188498486
             le_variance =       0.508637834373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824975916225        initial  <--
     1.5259e+09     1.5259e+10             1.1900e-13       -22.824975916225
     6.1035e+09     6.1035e+10             2.9903e-14       -22.824975916225
     2.4414e+10     2.4414e+11             8.1249e-15       -22.824975916225

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9433
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2004e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.9559
    reference variance = 0.651257
====================================================
  Execution time = 4.3622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5664e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502337910023
                                         uncertainty =       0.005821436326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502337910023
                                         uncertainty =       0.005821436326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501127085
  error estimate for blocks of size 2^( 2) =       0.000519036159
  error estimate for blocks of size 2^( 3) =       0.000534872616
  error estimate for blocks of size 2^( 4) =       0.000545893685
  error estimate for blocks of size 2^( 5) =       0.000551887504
  error estimate for blocks of size 2^( 6) =       0.000554738457
  error estimate for blocks of size 2^( 7) =       0.000557117640

      target function =                  N/A
              le_mean =     -22.825116518545
             les_mean =     521.488200544756
             stat err =       0.000552409322
             autocorr =       1.215139795937
              std dev =       0.708700720133
             le_variance =       0.502256710717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282511651855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825116518545       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825116518545       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825116518545       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825107385797       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825115838010       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825116898606       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825116411896       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825118376277       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825115189012       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825117923989       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+10 is 9.611789e-15

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825116518545       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825116518545       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825116518545       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825143741093       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825151190756       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825116518545       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825146390278       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825094938441       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824907616223       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825097930189       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825182454242       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825327832108       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825003481966       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825018416850       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825772629395       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824989905468       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824239787917       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825762816358       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.826794131096       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.823974360409       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.823231232119       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.825453161912       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.824887943945       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.826755025494       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.833050639602       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.823294401569       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.818283979584       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.822584410309       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.824299888918       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.828048882751       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.816205189597       residual = 4.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.829377893607       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.825157735274       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.828025596278       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.826556667760       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.820400158283       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.824173264304       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.825169300671       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.833395831833       residual = 3.76e-02           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.821528762074       residual = 7.62e-03           smallest_sin_value = 9.94e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.823186819621       residual = 3.45e-03           smallest_sin_value = 9.90e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.43e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+10 is 2.303868e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825116518545       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825116518545       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825116518545       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825080984574       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824872209560       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825869013753       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824746897592       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824321696283       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824838731004       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824188805644       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824200743204       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825336624192       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825639435472       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826195052155       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.822033975657       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.826272777013       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824427010429       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.832820939272       residual = 3.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.826681464694       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.826105604015       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.839123062001       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.832997733853       residual = 3.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.827015812725       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.812758877523       residual = 8.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.844010615905       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.827733462788       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.828383922751       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.800782406120       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.850944567282       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.820275446639       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.831103873310       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.825499905522       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.786481871228       residual = 7.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.828621144062       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.849298448653       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.806213708314       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.834561371802       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.824196879549       residual = 2.31e-03           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.786669605351       residual = 7.62e-01           smallest_sin_value = 9.96e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+11 is 3.840279e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9347e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8961
    reference variance = 0.68851
====================================================
  Execution time = 4.5458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0782e-01
  Total weights = 2.0000e+06
  Execution time = 3.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503893865
  error estimate for blocks of size 2^( 2) =       0.000521624399
  error estimate for blocks of size 2^( 3) =       0.000537049286
  error estimate for blocks of size 2^( 4) =       0.000548234797
  error estimate for blocks of size 2^( 5) =       0.000554678096
  error estimate for blocks of size 2^( 6) =       0.000558934390
  error estimate for blocks of size 2^( 7) =       0.000560790522

      target function =                  N/A
              le_mean =     -22.825969854098
             les_mean =     521.532717580312
             stat err =       0.000555659451
             autocorr =       1.216015946619
              std dev =       0.712613537652
             le_variance =       0.507818054045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503893865
  error estimate for blocks of size 2^( 2) =       0.000521624399
  error estimate for blocks of size 2^( 3) =       0.000537049286
  error estimate for blocks of size 2^( 4) =       0.000548234797
  error estimate for blocks of size 2^( 5) =       0.000554678096
  error estimate for blocks of size 2^( 6) =       0.000558934390
  error estimate for blocks of size 2^( 7) =       0.000560790522

      target function =                  N/A
              le_mean =     -22.825969854098
             les_mean =     521.532717580312
             stat err =       0.000555659451
             autocorr =       1.216015946619
              std dev =       0.712613537652
             le_variance =       0.507818054045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503893865
  error estimate for blocks of size 2^( 2) =       0.000521624399
  error estimate for blocks of size 2^( 3) =       0.000537049286
  error estimate for blocks of size 2^( 4) =       0.000548234797
  error estimate for blocks of size 2^( 5) =       0.000554678096
  error estimate for blocks of size 2^( 6) =       0.000558934390
  error estimate for blocks of size 2^( 7) =       0.000560790522

      target function =                  N/A
              le_mean =     -22.825969854098
             les_mean =     521.532717580312
             stat err =       0.000555659451
             autocorr =       1.216015946619
              std dev =       0.712613537652
             le_variance =       0.507818054045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507960125550
                                         uncertainty =       0.004711211449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503893865
  error estimate for blocks of size 2^( 2) =       0.000521624399
  error estimate for blocks of size 2^( 3) =       0.000537049286
  error estimate for blocks of size 2^( 4) =       0.000548234797
  error estimate for blocks of size 2^( 5) =       0.000554678096
  error estimate for blocks of size 2^( 6) =       0.000558934390
  error estimate for blocks of size 2^( 7) =       0.000560790522

      target function =                  N/A
              le_mean =     -22.825969854098
             les_mean =     521.532717580312
             stat err =       0.000555659451
             autocorr =       1.216015946616
              std dev =       0.712613537652
             le_variance =       0.507818054045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825969854098        initial  <--
     1.5259e+10     1.5259e+11             9.6118e-15       -22.825969854098
     6.1035e+10     6.1035e+11             2.3039e-15       -22.825969854098
     2.4414e+11     2.4414e+12             3.8403e-16       -22.825969854098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0910
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8073
    reference variance = 0.645303
====================================================
  Execution time = 4.4528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4897e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509896128097
                                         uncertainty =       0.003881054281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509896128097
                                         uncertainty =       0.003881054281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504892127
  error estimate for blocks of size 2^( 2) =       0.000522955197
  error estimate for blocks of size 2^( 3) =       0.000539311401
  error estimate for blocks of size 2^( 4) =       0.000550822483
  error estimate for blocks of size 2^( 5) =       0.000557757100
  error estimate for blocks of size 2^( 6) =       0.000561272518
  error estimate for blocks of size 2^( 7) =       0.000562344059

      target function =                  N/A
              le_mean =     -22.825489401993
             les_mean =     521.512798305630
             stat err =       0.000558049040
             autocorr =       1.221652064918
              std dev =       0.714025293717
             le_variance =       0.509832120068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282548940199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825489401993       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825489401993       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825489401993       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825409670620       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825560109350       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825373024423       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825487549504       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825314879237       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825177292797       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825470407529       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826140811196       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825533049539       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825381312574       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824749818108       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825938304326       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824043509363       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.826909201780       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.826104013815       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.821974764696       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.817108831530       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.824868040343       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.825353850548       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.823306041724       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.812993118222       residual = 8.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.821687511791       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.833180231141       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.826033039358       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.831393371907       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.819468476041       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.826001275760       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.824229165113       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.824689842858       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.797631328002       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.802088196624       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.812253637007       residual = 9.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.841743427503       residual = 1.45e-01           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -22.833086308503       residual = 3.03e-02           smallest_sin_value = 9.98e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+11 is 1.432055e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825489401993       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825489401993       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825489401993       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825489401993       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825517118786       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825550478408       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.828229807219       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.828468958736       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825249977884       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826028760424       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.823678316992       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826063615870       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.823698279401       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.819140165552       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.815855872269       residual = 4.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.842928133592       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.791152605965       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.795027226731       residual = 4.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.838446597577       residual = 9.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.804018442421       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.781222916984       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.849651899977       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.857478179621       residual = 5.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.849555186590       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.815702110046       residual = 5.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.756773228850       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.786774725936       residual = 8.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.845738314017       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.719458552692       residual = 6.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.779557900941       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.844565486555       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.792913011398       residual = 5.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.731163243026       residual = 4.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.881128768373       residual = 1.67e+00           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -22.769962150925       residual = 1.73e+00           smallest_sin_value = 9.98e-01
davidson iteration   35:   krylov dim =  36   energy =     -22.722426295252       residual = 5.72e+00           smallest_sin_value = 9.91e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+11 is 1.933638e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825489401993       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825489401993       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326966 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9473e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8124
    reference variance = 0.359842
====================================================
  Execution time = 4.3717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1373e-01
  Total weights = 2.0000e+06
  Execution time = 3.5143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506818172
  error estimate for blocks of size 2^( 2) =       0.000524670334
  error estimate for blocks of size 2^( 3) =       0.000540169183
  error estimate for blocks of size 2^( 4) =       0.000550187096
  error estimate for blocks of size 2^( 5) =       0.000557218675
  error estimate for blocks of size 2^( 6) =       0.000559868898
  error estimate for blocks of size 2^( 7) =       0.000563054869

      target function =                  N/A
              le_mean =     -22.825210594080
             les_mean =     521.503967726538
             stat err =       0.000557582385
             autocorr =       1.210357688512
              std dev =       0.716749132759
             le_variance =       0.513729319310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506818172
  error estimate for blocks of size 2^( 2) =       0.000524670334
  error estimate for blocks of size 2^( 3) =       0.000540169183
  error estimate for blocks of size 2^( 4) =       0.000550187096
  error estimate for blocks of size 2^( 5) =       0.000557218675
  error estimate for blocks of size 2^( 6) =       0.000559868898
  error estimate for blocks of size 2^( 7) =       0.000563054869

      target function =                  N/A
              le_mean =     -22.825210594080
             les_mean =     521.503967726538
             stat err =       0.000557582385
             autocorr =       1.210357688513
              std dev =       0.716749132759
             le_variance =       0.513729319310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506818172
  error estimate for blocks of size 2^( 2) =       0.000524670334
  error estimate for blocks of size 2^( 3) =       0.000540169183
  error estimate for blocks of size 2^( 4) =       0.000550187096
  error estimate for blocks of size 2^( 5) =       0.000557218675
  error estimate for blocks of size 2^( 6) =       0.000559868898
  error estimate for blocks of size 2^( 7) =       0.000563054869

      target function =                  N/A
              le_mean =     -22.825210594080
             les_mean =     521.503967726538
             stat err =       0.000557582385
             autocorr =       1.210357688512
              std dev =       0.716749132759
             le_variance =       0.513729319310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513772918033
                                         uncertainty =       0.010354516223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506818172
  error estimate for blocks of size 2^( 2) =       0.000524670334
  error estimate for blocks of size 2^( 3) =       0.000540169183
  error estimate for blocks of size 2^( 4) =       0.000550187096
  error estimate for blocks of size 2^( 5) =       0.000557218675
  error estimate for blocks of size 2^( 6) =       0.000559868898
  error estimate for blocks of size 2^( 7) =       0.000563054869

      target function =                  N/A
              le_mean =     -22.825210594080
             les_mean =     521.503967726538
             stat err =       0.000557582385
             autocorr =       1.210357688512
              std dev =       0.716749132759
             le_variance =       0.513729319310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825210594080        initial  <--
     1.5259e+11     1.5259e+12             1.4321e-15       -22.825210594080
     6.1035e+11     6.1035e+12             1.9336e-16       -22.825210594080
     2.4414e+12     2.4414e+13             0.0000e+00       -22.825210594080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4309
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2091e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.9189
    reference variance = 0.391503
====================================================
  Execution time = 4.4032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4933e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505363186307
                                         uncertainty =       0.004855659219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505363186307
                                         uncertainty =       0.004855659219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502617250
  error estimate for blocks of size 2^( 2) =       0.000520505783
  error estimate for blocks of size 2^( 3) =       0.000535402692
  error estimate for blocks of size 2^( 4) =       0.000546286978
  error estimate for blocks of size 2^( 5) =       0.000552458640
  error estimate for blocks of size 2^( 6) =       0.000556456513
  error estimate for blocks of size 2^( 7) =       0.000558673091

      target function =                  N/A
              le_mean =     -22.824895921235
             les_mean =     521.481121762912
             stat err =       0.000553468806
             autocorr =       1.212583117007
              std dev =       0.710808131856
             le_variance =       0.505248200312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282489592124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824895921235       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8971e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8315
    reference variance = 0.350922
====================================================
  Execution time = 4.4070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0646e-01
  Total weights = 2.0000e+06
  Execution time = 3.5132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503221284
  error estimate for blocks of size 2^( 2) =       0.000520881780
  error estimate for blocks of size 2^( 3) =       0.000536789055
  error estimate for blocks of size 2^( 4) =       0.000547377163
  error estimate for blocks of size 2^( 5) =       0.000553866443
  error estimate for blocks of size 2^( 6) =       0.000555793211
  error estimate for blocks of size 2^( 7) =       0.000555568682

      target function =                  N/A
              le_mean =     -22.825891800602
             les_mean =     521.527799560027
             stat err =       0.000553151375
             autocorr =       1.208286685541
              std dev =       0.711662364104
             le_variance =       0.506463320482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503221284
  error estimate for blocks of size 2^( 2) =       0.000520881780
  error estimate for blocks of size 2^( 3) =       0.000536789055
  error estimate for blocks of size 2^( 4) =       0.000547377163
  error estimate for blocks of size 2^( 5) =       0.000553866443
  error estimate for blocks of size 2^( 6) =       0.000555793211
  error estimate for blocks of size 2^( 7) =       0.000555568682

      target function =                  N/A
              le_mean =     -22.825891800602
             les_mean =     521.527799560027
             stat err =       0.000553151375
             autocorr =       1.208286685541
              std dev =       0.711662364104
             le_variance =       0.506463320482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503221284
  error estimate for blocks of size 2^( 2) =       0.000520881780
  error estimate for blocks of size 2^( 3) =       0.000536789055
  error estimate for blocks of size 2^( 4) =       0.000547377163
  error estimate for blocks of size 2^( 5) =       0.000553866443
  error estimate for blocks of size 2^( 6) =       0.000555793211
  error estimate for blocks of size 2^( 7) =       0.000555568682

      target function =                  N/A
              le_mean =     -22.825891800602
             les_mean =     521.527799560027
             stat err =       0.000553151375
             autocorr =       1.208286685541
              std dev =       0.711662364104
             le_variance =       0.506463320482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506638354722
                                         uncertainty =       0.005054313384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503221284
  error estimate for blocks of size 2^( 2) =       0.000520881780
  error estimate for blocks of size 2^( 3) =       0.000536789055
  error estimate for blocks of size 2^( 4) =       0.000547377163
  error estimate for blocks of size 2^( 5) =       0.000553866443
  error estimate for blocks of size 2^( 6) =       0.000555793211
  error estimate for blocks of size 2^( 7) =       0.000555568682

      target function =                  N/A
              le_mean =     -22.825891800602
             les_mean =     521.527799560027
             stat err =       0.000553151375
             autocorr =       1.208286685541
              std dev =       0.711662364104
             le_variance =       0.506463320482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825891800602        initial  <--
     1.5259e+12     1.5259e+13             0.0000e+00       -22.825891800602
     6.1035e+12     6.1035e+13             0.0000e+00       -22.825891800602
     2.4414e+13     2.4414e+14             0.0000e+00       -22.825891800602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6782
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2066e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.9583
    reference variance = 1.09414
====================================================
  Execution time = 4.5705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.2571e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5030e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525738077384
                                         uncertainty =       0.018801947876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525738077384
                                         uncertainty =       0.018801947876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512693791
  error estimate for blocks of size 2^( 2) =       0.000529717415
  error estimate for blocks of size 2^( 3) =       0.000545403602
  error estimate for blocks of size 2^( 4) =       0.000556534640
  error estimate for blocks of size 2^( 5) =       0.000564444204
  error estimate for blocks of size 2^( 6) =       0.000566122236
  error estimate for blocks of size 2^( 7) =       0.000570302567

      target function =                  N/A
              le_mean =     -22.825017430621
             les_mean =     521.507130292192
             stat err =       0.000564350912
             autocorr =       1.211664394100
              std dev =       0.725058512750
             le_variance =       0.525709846911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282501743062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825017430621       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0741e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8601
    reference variance = 0.398028
====================================================
  Execution time = 4.3433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1377e-01
  Total weights = 2.0000e+06
  Execution time = 3.5169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506838446
  error estimate for blocks of size 2^( 2) =       0.000524909945
  error estimate for blocks of size 2^( 3) =       0.000540120286
  error estimate for blocks of size 2^( 4) =       0.000550380593
  error estimate for blocks of size 2^( 5) =       0.000556625841
  error estimate for blocks of size 2^( 6) =       0.000561893664
  error estimate for blocks of size 2^( 7) =       0.000562781167

      target function =                  N/A
              le_mean =     -22.825749942528
             les_mean =     521.528630601629
             stat err =       0.000557920316
             autocorr =       1.211728301698
              std dev =       0.716777803588
             le_variance =       0.513770419717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506838446
  error estimate for blocks of size 2^( 2) =       0.000524909945
  error estimate for blocks of size 2^( 3) =       0.000540120286
  error estimate for blocks of size 2^( 4) =       0.000550380593
  error estimate for blocks of size 2^( 5) =       0.000556625841
  error estimate for blocks of size 2^( 6) =       0.000561893664
  error estimate for blocks of size 2^( 7) =       0.000562781167

      target function =                  N/A
              le_mean =     -22.825749942528
             les_mean =     521.528630601629
             stat err =       0.000557920316
             autocorr =       1.211728301698
              std dev =       0.716777803588
             le_variance =       0.513770419717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506838446
  error estimate for blocks of size 2^( 2) =       0.000524909945
  error estimate for blocks of size 2^( 3) =       0.000540120286
  error estimate for blocks of size 2^( 4) =       0.000550380593
  error estimate for blocks of size 2^( 5) =       0.000556625841
  error estimate for blocks of size 2^( 6) =       0.000561893664
  error estimate for blocks of size 2^( 7) =       0.000562781167

      target function =                  N/A
              le_mean =     -22.825749942528
             les_mean =     521.528630601629
             stat err =       0.000557920316
             autocorr =       1.211728301698
              std dev =       0.716777803588
             le_variance =       0.513770419717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513810964173
                                         uncertainty =       0.010958015784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506838446
  error estimate for blocks of size 2^( 2) =       0.000524909945
  error estimate for blocks of size 2^( 3) =       0.000540120286
  error estimate for blocks of size 2^( 4) =       0.000550380593
  error estimate for blocks of size 2^( 5) =       0.000556625841
  error estimate for blocks of size 2^( 6) =       0.000561893664
  error estimate for blocks of size 2^( 7) =       0.000562781167

      target function =                  N/A
              le_mean =     -22.825749942528
             les_mean =     521.528630601629
             stat err =       0.000557920316
             autocorr =       1.211728301698
              std dev =       0.716777803588
             le_variance =       0.513770419717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825749942528        initial  <--
     1.5259e+13     1.5259e+14             0.0000e+00       -22.825749942528
     6.1035e+13     6.1035e+14             0.0000e+00       -22.825749942528
     2.4414e+14     2.4414e+15             0.0000e+00       -22.825749942528

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0657
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2181e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9398
    reference variance = 0.348995
====================================================
  Execution time = 4.4118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9942e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5245e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499475881585
                                         uncertainty =       0.003375905807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499475881585
                                         uncertainty =       0.003375905807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499710643
  error estimate for blocks of size 2^( 2) =       0.000517625572
  error estimate for blocks of size 2^( 3) =       0.000533267258
  error estimate for blocks of size 2^( 4) =       0.000544719760
  error estimate for blocks of size 2^( 5) =       0.000550787686
  error estimate for blocks of size 2^( 6) =       0.000554804800
  error estimate for blocks of size 2^( 7) =       0.000555406731

      target function =                  N/A
              le_mean =     -22.825334122337
             les_mean =     521.495299000560
             stat err =       0.000551429744
             autocorr =       1.217708051977
              std dev =       0.706697568927
             le_variance =       0.499421453927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282533412234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825334122337       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9369e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9578
    reference variance = 2.09822
====================================================
  Execution time = 4.3667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0275e-01
  Total weights = 2.0000e+06
  Execution time = 3.5172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501374155
  error estimate for blocks of size 2^( 2) =       0.000519880891
  error estimate for blocks of size 2^( 3) =       0.000535287861
  error estimate for blocks of size 2^( 4) =       0.000546301097
  error estimate for blocks of size 2^( 5) =       0.000552201287
  error estimate for blocks of size 2^( 6) =       0.000555032002
  error estimate for blocks of size 2^( 7) =       0.000558245255

      target function =                  N/A
              le_mean =     -22.825338419182
             les_mean =     521.498825785190
             stat err =       0.000552944910
             autocorr =       1.216297582622
              std dev =       0.709050129666
             le_variance =       0.502752086380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501374155
  error estimate for blocks of size 2^( 2) =       0.000519880891
  error estimate for blocks of size 2^( 3) =       0.000535287861
  error estimate for blocks of size 2^( 4) =       0.000546301097
  error estimate for blocks of size 2^( 5) =       0.000552201287
  error estimate for blocks of size 2^( 6) =       0.000555032002
  error estimate for blocks of size 2^( 7) =       0.000558245255

      target function =                  N/A
              le_mean =     -22.825338419182
             les_mean =     521.498825785190
             stat err =       0.000552944910
             autocorr =       1.216297582622
              std dev =       0.709050129666
             le_variance =       0.502752086380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501374155
  error estimate for blocks of size 2^( 2) =       0.000519880891
  error estimate for blocks of size 2^( 3) =       0.000535287861
  error estimate for blocks of size 2^( 4) =       0.000546301097
  error estimate for blocks of size 2^( 5) =       0.000552201287
  error estimate for blocks of size 2^( 6) =       0.000555032002
  error estimate for blocks of size 2^( 7) =       0.000558245255

      target function =                  N/A
              le_mean =     -22.825338419182
             les_mean =     521.498825785190
             stat err =       0.000552944910
             autocorr =       1.216297582622
              std dev =       0.709050129666
             le_variance =       0.502752086380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502673776256
                                         uncertainty =       0.003285165562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501374155
  error estimate for blocks of size 2^( 2) =       0.000519880891
  error estimate for blocks of size 2^( 3) =       0.000535287861
  error estimate for blocks of size 2^( 4) =       0.000546301097
  error estimate for blocks of size 2^( 5) =       0.000552201287
  error estimate for blocks of size 2^( 6) =       0.000555032002
  error estimate for blocks of size 2^( 7) =       0.000558245255

      target function =                  N/A
              le_mean =     -22.825338419182
             les_mean =     521.498825785190
             stat err =       0.000552944910
             autocorr =       1.216297582622
              std dev =       0.709050129666
             le_variance =       0.502752086380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825338419182        initial  <--
     1.5259e+14     1.5259e+15             0.0000e+00       -22.825338419182
     6.1035e+14     6.1035e+15             0.0000e+00       -22.825338419182
     2.4414e+15     2.4414e+16             0.0000e+00       -22.825338419182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2972
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2068e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8159
    reference variance = 0.347106
====================================================
  Execution time = 4.3656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4991e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501060421954
                                         uncertainty =       0.004122672492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501060421954
                                         uncertainty =       0.004122672492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500514429
  error estimate for blocks of size 2^( 2) =       0.000518525566
  error estimate for blocks of size 2^( 3) =       0.000534205815
  error estimate for blocks of size 2^( 4) =       0.000544995958
  error estimate for blocks of size 2^( 5) =       0.000552104153
  error estimate for blocks of size 2^( 6) =       0.000554767600
  error estimate for blocks of size 2^( 7) =       0.000557457807

      target function =                  N/A
              le_mean =     -22.825396333662
             les_mean =     521.499746926491
             stat err =       0.000552331380
             autocorr =       1.217772689988
              std dev =       0.707834294333
             le_variance =       0.501029388233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282539633366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825396333662       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8653e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7563
    reference variance = 1.12885
====================================================
  Execution time = 4.5473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1072e-01
  Total weights = 2.0000e+06
  Execution time = 3.5105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505330541
  error estimate for blocks of size 2^( 2) =       0.000522940743
  error estimate for blocks of size 2^( 3) =       0.000538506240
  error estimate for blocks of size 2^( 4) =       0.000550345951
  error estimate for blocks of size 2^( 5) =       0.000557279668
  error estimate for blocks of size 2^( 6) =       0.000561062741
  error estimate for blocks of size 2^( 7) =       0.000562079165

      target function =                  N/A
              le_mean =     -22.825709426595
             les_mean =     521.523728483026
             stat err =       0.000557691881
             autocorr =       1.217972690975
              std dev =       0.714645304339
             le_variance =       0.510717911014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505330541
  error estimate for blocks of size 2^( 2) =       0.000522940743
  error estimate for blocks of size 2^( 3) =       0.000538506240
  error estimate for blocks of size 2^( 4) =       0.000550345951
  error estimate for blocks of size 2^( 5) =       0.000557279668
  error estimate for blocks of size 2^( 6) =       0.000561062741
  error estimate for blocks of size 2^( 7) =       0.000562079165

      target function =                  N/A
              le_mean =     -22.825709426595
             les_mean =     521.523728483026
             stat err =       0.000557691881
             autocorr =       1.217972690975
              std dev =       0.714645304339
             le_variance =       0.510717911014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505330541
  error estimate for blocks of size 2^( 2) =       0.000522940743
  error estimate for blocks of size 2^( 3) =       0.000538506240
  error estimate for blocks of size 2^( 4) =       0.000550345951
  error estimate for blocks of size 2^( 5) =       0.000557279668
  error estimate for blocks of size 2^( 6) =       0.000561062741
  error estimate for blocks of size 2^( 7) =       0.000562079165

      target function =                  N/A
              le_mean =     -22.825709426595
             les_mean =     521.523728483026
             stat err =       0.000557691881
             autocorr =       1.217972690975
              std dev =       0.714645304339
             le_variance =       0.510717911014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510446734487
                                         uncertainty =       0.007156493241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505330541
  error estimate for blocks of size 2^( 2) =       0.000522940743
  error estimate for blocks of size 2^( 3) =       0.000538506240
  error estimate for blocks of size 2^( 4) =       0.000550345951
  error estimate for blocks of size 2^( 5) =       0.000557279668
  error estimate for blocks of size 2^( 6) =       0.000561062741
  error estimate for blocks of size 2^( 7) =       0.000562079165

      target function =                  N/A
              le_mean =     -22.825709426595
             les_mean =     521.523728483026
             stat err =       0.000557691881
             autocorr =       1.217972690975
              std dev =       0.714645304339
             le_variance =       0.510717911014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825709426595        initial  <--
     1.5259e+15     1.5259e+16             0.0000e+00       -22.825709426595
     6.1035e+15     6.1035e+16             0.0000e+00       -22.825709426595
     2.4414e+16     2.4414e+17             0.0000e+00       -22.825709426595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0717
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2173e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2840e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7346
    reference variance = 0.475101
====================================================
  Execution time = 4.3751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0239e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4823e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502447054437
                                         uncertainty =       0.003835581026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502447054437
                                         uncertainty =       0.003835581026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501191562
  error estimate for blocks of size 2^( 2) =       0.000519159623
  error estimate for blocks of size 2^( 3) =       0.000535269279
  error estimate for blocks of size 2^( 4) =       0.000547346544
  error estimate for blocks of size 2^( 5) =       0.000554833205
  error estimate for blocks of size 2^( 6) =       0.000558618048
  error estimate for blocks of size 2^( 7) =       0.000561092688

      target function =                  N/A
              le_mean =     -22.825888481048
             les_mean =     521.523570660897
             stat err =       0.000555472621
             autocorr =       1.228337794479
              std dev =       0.708791903786
             le_variance =       0.502385962873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282588848105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825888481048       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8579e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7436
    reference variance = 0.937598
====================================================
  Execution time = 4.3172e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1271e-01
  Total weights = 2.0000e+06
  Execution time = 3.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506316439
  error estimate for blocks of size 2^( 2) =       0.000524242881
  error estimate for blocks of size 2^( 3) =       0.000539062964
  error estimate for blocks of size 2^( 4) =       0.000549281565
  error estimate for blocks of size 2^( 5) =       0.000555800667
  error estimate for blocks of size 2^( 6) =       0.000558192571
  error estimate for blocks of size 2^( 7) =       0.000561593021

      target function =                  N/A
              le_mean =     -22.826251660007
             les_mean =     521.550477261717
             stat err =       0.000556216956
             autocorr =       1.206825259674
              std dev =       0.716039574406
             le_variance =       0.512712672116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506316439
  error estimate for blocks of size 2^( 2) =       0.000524242881
  error estimate for blocks of size 2^( 3) =       0.000539062964
  error estimate for blocks of size 2^( 4) =       0.000549281565
  error estimate for blocks of size 2^( 5) =       0.000555800667
  error estimate for blocks of size 2^( 6) =       0.000558192571
  error estimate for blocks of size 2^( 7) =       0.000561593021

      target function =                  N/A
              le_mean =     -22.826251660007
             les_mean =     521.550477261717
             stat err =       0.000556216956
             autocorr =       1.206825259674
              std dev =       0.716039574406
             le_variance =       0.512712672116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506316439
  error estimate for blocks of size 2^( 2) =       0.000524242881
  error estimate for blocks of size 2^( 3) =       0.000539062964
  error estimate for blocks of size 2^( 4) =       0.000549281565
  error estimate for blocks of size 2^( 5) =       0.000555800667
  error estimate for blocks of size 2^( 6) =       0.000558192571
  error estimate for blocks of size 2^( 7) =       0.000561593021

      target function =                  N/A
              le_mean =     -22.826251660007
             les_mean =     521.550477261717
             stat err =       0.000556216956
             autocorr =       1.206825259674
              std dev =       0.716039574406
             le_variance =       0.512712672116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512732737161
                                         uncertainty =       0.007414865522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506316439
  error estimate for blocks of size 2^( 2) =       0.000524242881
  error estimate for blocks of size 2^( 3) =       0.000539062964
  error estimate for blocks of size 2^( 4) =       0.000549281565
  error estimate for blocks of size 2^( 5) =       0.000555800667
  error estimate for blocks of size 2^( 6) =       0.000558192571
  error estimate for blocks of size 2^( 7) =       0.000561593021

      target function =                  N/A
              le_mean =     -22.826251660007
             les_mean =     521.550477261717
             stat err =       0.000556216956
             autocorr =       1.206825259674
              std dev =       0.716039574406
             le_variance =       0.512712672116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826251660007        initial  <--
     1.5259e+16     1.5259e+17             0.0000e+00       -22.826251660007
     6.1035e+16     6.1035e+17             0.0000e+00       -22.826251660007
     2.4414e+17     2.4414e+18             0.0000e+00       -22.826251660007

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7426
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1933e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8328
    reference variance = 0.427612
====================================================
  Execution time = 4.3904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4975e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500664350982
                                         uncertainty =       0.003165948134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500664350982
                                         uncertainty =       0.003165948134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500284551
  error estimate for blocks of size 2^( 2) =       0.000518100236
  error estimate for blocks of size 2^( 3) =       0.000534064205
  error estimate for blocks of size 2^( 4) =       0.000545178067
  error estimate for blocks of size 2^( 5) =       0.000551185231
  error estimate for blocks of size 2^( 6) =       0.000554859650
  error estimate for blocks of size 2^( 7) =       0.000555706013

      target function =                  N/A
              le_mean =     -22.825155721817
             les_mean =     521.488302738723
             stat err =       0.000551732240
             autocorr =       1.216249126028
              std dev =       0.707509196972
             le_variance =       0.500569263800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282515572182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825155721817       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825155721817       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825155721817       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+17 is 6.925038e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825155721817       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825155721817       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825155721817       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825155721828       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+17 is 1.731259e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825155721817       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825155721817       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825155721817       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+18 is 4.328149e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8885e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7807
    reference variance = 0.505144
====================================================
  Execution time = 4.3235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0259e-01
  Total weights = 2.0000e+06
  Execution time = 3.5296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501295351
  error estimate for blocks of size 2^( 2) =       0.000519077314
  error estimate for blocks of size 2^( 3) =       0.000534860367
  error estimate for blocks of size 2^( 4) =       0.000546085488
  error estimate for blocks of size 2^( 5) =       0.000552390751
  error estimate for blocks of size 2^( 6) =       0.000556513268
  error estimate for blocks of size 2^( 7) =       0.000559532520

      target function =                  N/A
              le_mean =     -22.824496382065
             les_mean =     521.460228900494
             stat err =       0.000553630506
             autocorr =       1.219699013130
              std dev =       0.708938683465
             le_variance =       0.502594056914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501295351
  error estimate for blocks of size 2^( 2) =       0.000519077314
  error estimate for blocks of size 2^( 3) =       0.000534860367
  error estimate for blocks of size 2^( 4) =       0.000546085488
  error estimate for blocks of size 2^( 5) =       0.000552390751
  error estimate for blocks of size 2^( 6) =       0.000556513268
  error estimate for blocks of size 2^( 7) =       0.000559532520

      target function =                  N/A
              le_mean =     -22.824496382065
             les_mean =     521.460228900494
             stat err =       0.000553630506
             autocorr =       1.219699013134
              std dev =       0.708938683465
             le_variance =       0.502594056914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501295351
  error estimate for blocks of size 2^( 2) =       0.000519077314
  error estimate for blocks of size 2^( 3) =       0.000534860367
  error estimate for blocks of size 2^( 4) =       0.000546085488
  error estimate for blocks of size 2^( 5) =       0.000552390751
  error estimate for blocks of size 2^( 6) =       0.000556513268
  error estimate for blocks of size 2^( 7) =       0.000559532520

      target function =                  N/A
              le_mean =     -22.824496382065
             les_mean =     521.460228900494
             stat err =       0.000553630506
             autocorr =       1.219699013134
              std dev =       0.708938683465
             le_variance =       0.502594056914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502604162725
                                         uncertainty =       0.003543721296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501295351
  error estimate for blocks of size 2^( 2) =       0.000519077314
  error estimate for blocks of size 2^( 3) =       0.000534860367
  error estimate for blocks of size 2^( 4) =       0.000546085488
  error estimate for blocks of size 2^( 5) =       0.000552390751
  error estimate for blocks of size 2^( 6) =       0.000556513268
  error estimate for blocks of size 2^( 7) =       0.000559532520

      target function =                  N/A
              le_mean =     -22.824496382065
             les_mean =     521.460228900494
             stat err =       0.000553630506
             autocorr =       1.219699013134
              std dev =       0.708938683465
             le_variance =       0.502594056914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824496382065        initial  <--
     1.5259e+17     1.5259e+18             6.9250e-22       -22.824496382065
     6.1035e+17     6.1035e+18             1.7313e-22       -22.824496382065
     2.4414e+18     2.4414e+19             4.3281e-23       -22.824496382065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9348
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1983e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8365
    reference variance = 0.341566
====================================================
  Execution time = 4.6972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0927e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5234e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509283673616
                                         uncertainty =       0.004921230263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509283673616
                                         uncertainty =       0.004921230263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504616006
  error estimate for blocks of size 2^( 2) =       0.000522393121
  error estimate for blocks of size 2^( 3) =       0.000538708388
  error estimate for blocks of size 2^( 4) =       0.000549543616
  error estimate for blocks of size 2^( 5) =       0.000556921100
  error estimate for blocks of size 2^( 6) =       0.000559060299
  error estimate for blocks of size 2^( 7) =       0.000559752768

      target function =                  N/A
              le_mean =     -22.826017428513
             les_mean =     521.536346018629
             stat err =       0.000556319446
             autocorr =       1.215420165887
              std dev =       0.713634799090
             le_variance =       0.509274626472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282601742851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826017428513       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2212e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7993
    reference variance = 0.339902
====================================================
  Execution time = 4.4079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0240e-01
  Total weights = 2.0000e+06
  Execution time = 3.5007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501196267
  error estimate for blocks of size 2^( 2) =       0.000519537030
  error estimate for blocks of size 2^( 3) =       0.000535611308
  error estimate for blocks of size 2^( 4) =       0.000546779885
  error estimate for blocks of size 2^( 5) =       0.000553335275
  error estimate for blocks of size 2^( 6) =       0.000557059956
  error estimate for blocks of size 2^( 7) =       0.000560029415

      target function =                  N/A
              le_mean =     -22.824197391658
             les_mean =     521.446381718516
             stat err =       0.000554301133
             autocorr =       1.223139176096
              std dev =       0.708798558358
             le_variance =       0.502395396330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501196267
  error estimate for blocks of size 2^( 2) =       0.000519537030
  error estimate for blocks of size 2^( 3) =       0.000535611308
  error estimate for blocks of size 2^( 4) =       0.000546779885
  error estimate for blocks of size 2^( 5) =       0.000553335275
  error estimate for blocks of size 2^( 6) =       0.000557059956
  error estimate for blocks of size 2^( 7) =       0.000560029415

      target function =                  N/A
              le_mean =     -22.824197391658
             les_mean =     521.446381718516
             stat err =       0.000554301133
             autocorr =       1.223139176096
              std dev =       0.708798558358
             le_variance =       0.502395396330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501196267
  error estimate for blocks of size 2^( 2) =       0.000519537030
  error estimate for blocks of size 2^( 3) =       0.000535611308
  error estimate for blocks of size 2^( 4) =       0.000546779885
  error estimate for blocks of size 2^( 5) =       0.000553335275
  error estimate for blocks of size 2^( 6) =       0.000557059956
  error estimate for blocks of size 2^( 7) =       0.000560029415

      target function =                  N/A
              le_mean =     -22.824197391658
             les_mean =     521.446381718516
             stat err =       0.000554301133
             autocorr =       1.223139176096
              std dev =       0.708798558358
             le_variance =       0.502395396330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502477491720
                                         uncertainty =       0.004269476462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501196267
  error estimate for blocks of size 2^( 2) =       0.000519537030
  error estimate for blocks of size 2^( 3) =       0.000535611308
  error estimate for blocks of size 2^( 4) =       0.000546779885
  error estimate for blocks of size 2^( 5) =       0.000553335275
  error estimate for blocks of size 2^( 6) =       0.000557059956
  error estimate for blocks of size 2^( 7) =       0.000560029415

      target function =                  N/A
              le_mean =     -22.824197391658
             les_mean =     521.446381718516
             stat err =       0.000554301133
             autocorr =       1.223139176096
              std dev =       0.708798558358
             le_variance =       0.502395396330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824197391658        initial  <--
     1.5259e+18     1.5259e+19             0.0000e+00       -22.824197391658
     6.1035e+18     6.1035e+19             0.0000e+00       -22.824197391658
     2.4414e+19     2.4414e+20             0.0000e+00       -22.824197391658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6349
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2385e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.30263
====================================================
  Execution time = 4.3818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4956e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503903122766
                                         uncertainty =       0.004040339273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503903122766
                                         uncertainty =       0.004040339273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502037236
  error estimate for blocks of size 2^( 2) =       0.000520161038
  error estimate for blocks of size 2^( 3) =       0.000535849126
  error estimate for blocks of size 2^( 4) =       0.000545626177
  error estimate for blocks of size 2^( 5) =       0.000551705911
  error estimate for blocks of size 2^( 6) =       0.000556061088
  error estimate for blocks of size 2^( 7) =       0.000557850361

      target function =                  N/A
              le_mean =     -22.825059385485
             les_mean =     521.487418472489
             stat err =       0.000552810884
             autocorr =       1.212498779949
              std dev =       0.709987868644
             le_variance =       0.504082773622


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282505938548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825059385485       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825059385485       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825059385485       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+19 is 2.030228e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825059385485       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825059385485       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825059385488       residual = 4.13e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825059385485       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+19 is 1.398945e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825059385485       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825059385485       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825059385485       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+20 is 1.268893e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8781e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.85
    reference variance = 0.409823
====================================================
  Execution time = 4.3517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1462e-01
  Total weights = 2.0000e+06
  Execution time = 3.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507259744
  error estimate for blocks of size 2^( 2) =       0.000524419966
  error estimate for blocks of size 2^( 3) =       0.000540101108
  error estimate for blocks of size 2^( 4) =       0.000549773463
  error estimate for blocks of size 2^( 5) =       0.000556383537
  error estimate for blocks of size 2^( 6) =       0.000559976267
  error estimate for blocks of size 2^( 7) =       0.000563489180

      target function =                  N/A
              le_mean =     -22.825029208677
             les_mean =     521.496583015270
             stat err =       0.000557405612
             autocorr =       1.207485369149
              std dev =       0.717373609518
             le_variance =       0.514624895634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507259744
  error estimate for blocks of size 2^( 2) =       0.000524419966
  error estimate for blocks of size 2^( 3) =       0.000540101108
  error estimate for blocks of size 2^( 4) =       0.000549773463
  error estimate for blocks of size 2^( 5) =       0.000556383537
  error estimate for blocks of size 2^( 6) =       0.000559976267
  error estimate for blocks of size 2^( 7) =       0.000563489180

      target function =                  N/A
              le_mean =     -22.825029208677
             les_mean =     521.496583015270
             stat err =       0.000557405612
             autocorr =       1.207485369149
              std dev =       0.717373609518
             le_variance =       0.514624895634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507259744
  error estimate for blocks of size 2^( 2) =       0.000524419966
  error estimate for blocks of size 2^( 3) =       0.000540101108
  error estimate for blocks of size 2^( 4) =       0.000549773463
  error estimate for blocks of size 2^( 5) =       0.000556383537
  error estimate for blocks of size 2^( 6) =       0.000559976267
  error estimate for blocks of size 2^( 7) =       0.000563489180

      target function =                  N/A
              le_mean =     -22.825029208677
             les_mean =     521.496583015270
             stat err =       0.000557405612
             autocorr =       1.207485369149
              std dev =       0.717373609518
             le_variance =       0.514624895634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514738142964
                                         uncertainty =       0.012248775489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507259744
  error estimate for blocks of size 2^( 2) =       0.000524419966
  error estimate for blocks of size 2^( 3) =       0.000540101108
  error estimate for blocks of size 2^( 4) =       0.000549773463
  error estimate for blocks of size 2^( 5) =       0.000556383537
  error estimate for blocks of size 2^( 6) =       0.000559976267
  error estimate for blocks of size 2^( 7) =       0.000563489180

      target function =                  N/A
              le_mean =     -22.825029208677
             les_mean =     521.496583015270
             stat err =       0.000557405612
             autocorr =       1.207485369149
              std dev =       0.717373609518
             le_variance =       0.514624895634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825029208677        initial  <--
     1.5259e+19     1.5259e+20             2.0302e-24       -22.825029208677
     6.1035e+19     6.1035e+20             1.3989e-24       -22.825029208677
     2.4414e+20     2.4414e+21             1.2689e-25       -22.825029208677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0341
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1983e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8393
    reference variance = 0.329493
====================================================
  Execution time = 4.3717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0423e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5247e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504190032592
                                         uncertainty =       0.004053564694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504190032592
                                         uncertainty =       0.004053564694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502111895
  error estimate for blocks of size 2^( 2) =       0.000519940660
  error estimate for blocks of size 2^( 3) =       0.000536030389
  error estimate for blocks of size 2^( 4) =       0.000546350168
  error estimate for blocks of size 2^( 5) =       0.000552862706
  error estimate for blocks of size 2^( 6) =       0.000554849069
  error estimate for blocks of size 2^( 7) =       0.000556100606

      target function =                  N/A
              le_mean =     -22.824790452449
             les_mean =     521.475291656164
             stat err =       0.000552540638
             autocorr =       1.210953395147
              std dev =       0.710093451642
             le_variance =       0.504232710065


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282479045245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824790452449       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+20 is 5.781153e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824790452449       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+20 is 1.445288e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824790452449       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8970e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8917
    reference variance = 0.525378
====================================================
  Execution time = 4.5049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1016e-01
  Total weights = 2.0000e+06
  Execution time = 3.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505054558
  error estimate for blocks of size 2^( 2) =       0.000523322080
  error estimate for blocks of size 2^( 3) =       0.000539620261
  error estimate for blocks of size 2^( 4) =       0.000550965375
  error estimate for blocks of size 2^( 5) =       0.000557227667
  error estimate for blocks of size 2^( 6) =       0.000561258532
  error estimate for blocks of size 2^( 7) =       0.000563244306

      target function =                  N/A
              le_mean =     -22.825336947458
             les_mean =     521.506166722038
             stat err =       0.000558173970
             autocorr =       1.221413091611
              std dev =       0.714255004965
             le_variance =       0.510160212118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505054558
  error estimate for blocks of size 2^( 2) =       0.000523322080
  error estimate for blocks of size 2^( 3) =       0.000539620261
  error estimate for blocks of size 2^( 4) =       0.000550965375
  error estimate for blocks of size 2^( 5) =       0.000557227667
  error estimate for blocks of size 2^( 6) =       0.000561258532
  error estimate for blocks of size 2^( 7) =       0.000563244306

      target function =                  N/A
              le_mean =     -22.825336947458
             les_mean =     521.506166722038
             stat err =       0.000558173970
             autocorr =       1.221413091611
              std dev =       0.714255004965
             le_variance =       0.510160212118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505054558
  error estimate for blocks of size 2^( 2) =       0.000523322080
  error estimate for blocks of size 2^( 3) =       0.000539620261
  error estimate for blocks of size 2^( 4) =       0.000550965375
  error estimate for blocks of size 2^( 5) =       0.000557227667
  error estimate for blocks of size 2^( 6) =       0.000561258532
  error estimate for blocks of size 2^( 7) =       0.000563244306

      target function =                  N/A
              le_mean =     -22.825336947458
             les_mean =     521.506166722038
             stat err =       0.000558173970
             autocorr =       1.221413091611
              std dev =       0.714255004965
             le_variance =       0.510160212118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510200113394
                                         uncertainty =       0.005458447202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505054558
  error estimate for blocks of size 2^( 2) =       0.000523322080
  error estimate for blocks of size 2^( 3) =       0.000539620261
  error estimate for blocks of size 2^( 4) =       0.000550965375
  error estimate for blocks of size 2^( 5) =       0.000557227667
  error estimate for blocks of size 2^( 6) =       0.000561258532
  error estimate for blocks of size 2^( 7) =       0.000563244306

      target function =                  N/A
              le_mean =     -22.825336947458
             les_mean =     521.506166722038
             stat err =       0.000558173970
             autocorr =       1.221413091611
              std dev =       0.714255004965
             le_variance =       0.510160212118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825336947458        initial  <--
     1.5259e+20     1.5259e+21             5.7812e-25       -22.825336947458
     6.1035e+20     6.1035e+21             1.4453e-25       -22.825336947458
     2.4414e+21     2.4414e+22             0.0000e+00       -22.825336947458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6125
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2159e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8089
    reference variance = 0.495609
====================================================
  Execution time = 4.4132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0039e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5035e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500466399920
                                         uncertainty =       0.003391258039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500466399920
                                         uncertainty =       0.003391258039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500196018
  error estimate for blocks of size 2^( 2) =       0.000518336306
  error estimate for blocks of size 2^( 3) =       0.000533584125
  error estimate for blocks of size 2^( 4) =       0.000543513899
  error estimate for blocks of size 2^( 5) =       0.000550355274
  error estimate for blocks of size 2^( 6) =       0.000553836185
  error estimate for blocks of size 2^( 7) =       0.000558302689

      target function =                  N/A
              le_mean =     -22.825622941472
             les_mean =     521.509454528388
             stat err =       0.000551502012
             autocorr =       1.215664522104
              std dev =       0.707383992139
             le_variance =       0.500392112335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282562294147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825622941472       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+21 is 1.619221e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825622941472       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+21 is 4.048052e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825622941472       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825622941472       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+22 is 1.012013e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9173e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.875
    reference variance = 0.376325
====================================================
  Execution time = 4.3257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9768e-01
  Total weights = 2.0000e+06
  Execution time = 3.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498838253
  error estimate for blocks of size 2^( 2) =       0.000516630858
  error estimate for blocks of size 2^( 3) =       0.000532330404
  error estimate for blocks of size 2^( 4) =       0.000543344148
  error estimate for blocks of size 2^( 5) =       0.000549137426
  error estimate for blocks of size 2^( 6) =       0.000550603735
  error estimate for blocks of size 2^( 7) =       0.000553350033

      target function =                  N/A
              le_mean =     -22.825241735120
             les_mean =     521.489339223016
             stat err =       0.000549108836
             autocorr =       1.211706296407
              std dev =       0.705463822741
             le_variance =       0.497679205196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498838253
  error estimate for blocks of size 2^( 2) =       0.000516630858
  error estimate for blocks of size 2^( 3) =       0.000532330404
  error estimate for blocks of size 2^( 4) =       0.000543344148
  error estimate for blocks of size 2^( 5) =       0.000549137426
  error estimate for blocks of size 2^( 6) =       0.000550603735
  error estimate for blocks of size 2^( 7) =       0.000553350033

      target function =                  N/A
              le_mean =     -22.825241735120
             les_mean =     521.489339223016
             stat err =       0.000549108836
             autocorr =       1.211706296407
              std dev =       0.705463822741
             le_variance =       0.497679205196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498838253
  error estimate for blocks of size 2^( 2) =       0.000516630858
  error estimate for blocks of size 2^( 3) =       0.000532330404
  error estimate for blocks of size 2^( 4) =       0.000543344148
  error estimate for blocks of size 2^( 5) =       0.000549137426
  error estimate for blocks of size 2^( 6) =       0.000550603735
  error estimate for blocks of size 2^( 7) =       0.000553350033

      target function =                  N/A
              le_mean =     -22.825241735120
             les_mean =     521.489339223016
             stat err =       0.000549108836
             autocorr =       1.211706296407
              std dev =       0.705463822741
             le_variance =       0.497679205196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497737116891
                                         uncertainty =       0.002990364857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498838253
  error estimate for blocks of size 2^( 2) =       0.000516630858
  error estimate for blocks of size 2^( 3) =       0.000532330404
  error estimate for blocks of size 2^( 4) =       0.000543344148
  error estimate for blocks of size 2^( 5) =       0.000549137426
  error estimate for blocks of size 2^( 6) =       0.000550603735
  error estimate for blocks of size 2^( 7) =       0.000553350033

      target function =                  N/A
              le_mean =     -22.825241735120
             les_mean =     521.489339223016
             stat err =       0.000549108836
             autocorr =       1.211706296407
              std dev =       0.705463822741
             le_variance =       0.497679205196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825241735120        initial  <--
     1.5259e+21     1.5259e+22             1.6192e-26       -22.825241735120
     6.1035e+21     6.1035e+22             4.0481e-27       -22.825241735120
     2.4414e+22     2.4414e+23             1.0120e-27       -22.825241735120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7704
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2011e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.9413
    reference variance = 0.446026
====================================================
  Execution time = 4.3803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0583e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5202e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505877767690
                                         uncertainty =       0.006180202808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505877767690
                                         uncertainty =       0.006180202808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502906109
  error estimate for blocks of size 2^( 2) =       0.000520475837
  error estimate for blocks of size 2^( 3) =       0.000535842697
  error estimate for blocks of size 2^( 4) =       0.000546633665
  error estimate for blocks of size 2^( 5) =       0.000554009620
  error estimate for blocks of size 2^( 6) =       0.000556407580
  error estimate for blocks of size 2^( 7) =       0.000558565846

      target function =                  N/A
              le_mean =     -22.825441471099
             les_mean =     521.506607206784
             stat err =       0.000553904178
             autocorr =       1.213096805926
              std dev =       0.711216640090
             le_variance =       0.505829109141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282544147110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825441471099       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9010e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7222
    reference variance = 0.456081
====================================================
  Execution time = 4.3190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0863e-01
  Total weights = 2.0000e+06
  Execution time = 3.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504295230
  error estimate for blocks of size 2^( 2) =       0.000521882561
  error estimate for blocks of size 2^( 3) =       0.000536908827
  error estimate for blocks of size 2^( 4) =       0.000548238989
  error estimate for blocks of size 2^( 5) =       0.000556556432
  error estimate for blocks of size 2^( 6) =       0.000560622595
  error estimate for blocks of size 2^( 7) =       0.000560715694

      target function =                  N/A
              le_mean =     -22.824630832996
             les_mean =     521.472399766919
             stat err =       0.000556533427
             autocorr =       1.217903247202
              std dev =       0.713181154187
             le_variance =       0.508627358687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504295230
  error estimate for blocks of size 2^( 2) =       0.000521882561
  error estimate for blocks of size 2^( 3) =       0.000536908827
  error estimate for blocks of size 2^( 4) =       0.000548238989
  error estimate for blocks of size 2^( 5) =       0.000556556432
  error estimate for blocks of size 2^( 6) =       0.000560622595
  error estimate for blocks of size 2^( 7) =       0.000560715694

      target function =                  N/A
              le_mean =     -22.824630832996
             les_mean =     521.472399766919
             stat err =       0.000556533427
             autocorr =       1.217903247202
              std dev =       0.713181154187
             le_variance =       0.508627358687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504295230
  error estimate for blocks of size 2^( 2) =       0.000521882561
  error estimate for blocks of size 2^( 3) =       0.000536908827
  error estimate for blocks of size 2^( 4) =       0.000548238989
  error estimate for blocks of size 2^( 5) =       0.000556556432
  error estimate for blocks of size 2^( 6) =       0.000560622595
  error estimate for blocks of size 2^( 7) =       0.000560715694

      target function =                  N/A
              le_mean =     -22.824630832996
             les_mean =     521.472399766919
             stat err =       0.000556533427
             autocorr =       1.217903247202
              std dev =       0.713181154187
             le_variance =       0.508627358687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508670014891
                                         uncertainty =       0.008519124238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504295230
  error estimate for blocks of size 2^( 2) =       0.000521882561
  error estimate for blocks of size 2^( 3) =       0.000536908827
  error estimate for blocks of size 2^( 4) =       0.000548238989
  error estimate for blocks of size 2^( 5) =       0.000556556432
  error estimate for blocks of size 2^( 6) =       0.000560622595
  error estimate for blocks of size 2^( 7) =       0.000560715694

      target function =                  N/A
              le_mean =     -22.824630832996
             les_mean =     521.472399766919
             stat err =       0.000556533427
             autocorr =       1.217903247202
              std dev =       0.713181154187
             le_variance =       0.508627358687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824630832996        initial  <--
     1.5259e+22     1.5259e+23             0.0000e+00       -22.824630832996
     6.1035e+22     6.1035e+23             0.0000e+00       -22.824630832996
     2.4414e+23     2.4414e+24             0.0000e+00       -22.824630832996

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7225
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1974e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8347
    reference variance = 0.594858
====================================================
  Execution time = 4.5599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4931e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518025181637
                                         uncertainty =       0.014189982563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518025181637
                                         uncertainty =       0.014189982563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508948795
  error estimate for blocks of size 2^( 2) =       0.000526511781
  error estimate for blocks of size 2^( 3) =       0.000541829795
  error estimate for blocks of size 2^( 4) =       0.000553684567
  error estimate for blocks of size 2^( 5) =       0.000561123776
  error estimate for blocks of size 2^( 6) =       0.000564009789
  error estimate for blocks of size 2^( 7) =       0.000566171248

      target function =                  N/A
              le_mean =     -22.825175963854
             les_mean =     521.506715273628
             stat err =       0.000561247345
             autocorr =       1.216075160582
              std dev =       0.719762288379
             le_variance =       0.518057751773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282517596385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825175963854       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0536e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8265
    reference variance = 0.470071
====================================================
  Execution time = 4.3843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0395e-01
  Total weights = 2.0000e+06
  Execution time = 3.5001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501971968
  error estimate for blocks of size 2^( 2) =       0.000519240716
  error estimate for blocks of size 2^( 3) =       0.000534943907
  error estimate for blocks of size 2^( 4) =       0.000546231233
  error estimate for blocks of size 2^( 5) =       0.000553163820
  error estimate for blocks of size 2^( 6) =       0.000558389820
  error estimate for blocks of size 2^( 7) =       0.000558730383

      target function =                  N/A
              le_mean =     -22.825354529911
             les_mean =     521.500760877628
             stat err =       0.000554128814
             autocorr =       1.218603823646
              std dev =       0.709895565189
             le_variance =       0.503951713476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501971968
  error estimate for blocks of size 2^( 2) =       0.000519240716
  error estimate for blocks of size 2^( 3) =       0.000534943907
  error estimate for blocks of size 2^( 4) =       0.000546231233
  error estimate for blocks of size 2^( 5) =       0.000553163820
  error estimate for blocks of size 2^( 6) =       0.000558389820
  error estimate for blocks of size 2^( 7) =       0.000558730383

      target function =                  N/A
              le_mean =     -22.825354529911
             les_mean =     521.500760877628
             stat err =       0.000554128814
             autocorr =       1.218603823646
              std dev =       0.709895565189
             le_variance =       0.503951713476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501971968
  error estimate for blocks of size 2^( 2) =       0.000519240716
  error estimate for blocks of size 2^( 3) =       0.000534943907
  error estimate for blocks of size 2^( 4) =       0.000546231233
  error estimate for blocks of size 2^( 5) =       0.000553163820
  error estimate for blocks of size 2^( 6) =       0.000558389820
  error estimate for blocks of size 2^( 7) =       0.000558730383

      target function =                  N/A
              le_mean =     -22.825354529911
             les_mean =     521.500760877628
             stat err =       0.000554128814
             autocorr =       1.218603823646
              std dev =       0.709895565189
             le_variance =       0.503951713476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503898155161
                                         uncertainty =       0.003360779757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501971968
  error estimate for blocks of size 2^( 2) =       0.000519240716
  error estimate for blocks of size 2^( 3) =       0.000534943907
  error estimate for blocks of size 2^( 4) =       0.000546231233
  error estimate for blocks of size 2^( 5) =       0.000553163820
  error estimate for blocks of size 2^( 6) =       0.000558389820
  error estimate for blocks of size 2^( 7) =       0.000558730383

      target function =                  N/A
              le_mean =     -22.825354529911
             les_mean =     521.500760877628
             stat err =       0.000554128814
             autocorr =       1.218603823646
              std dev =       0.709895565189
             le_variance =       0.503951713476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825354529911        initial  <--
     1.5259e+23     1.5259e+24             0.0000e+00       -22.825354529911
     6.1035e+23     6.1035e+24             0.0000e+00       -22.825354529911
     2.4414e+24     2.4414e+25             0.0000e+00       -22.825354529911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3844
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2193e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7349
    reference variance = 0.753068
====================================================
  Execution time = 4.3575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5011e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515906140383
                                         uncertainty =       0.007305166329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515906140383
                                         uncertainty =       0.007305166329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507874869
  error estimate for blocks of size 2^( 2) =       0.000525887420
  error estimate for blocks of size 2^( 3) =       0.000541530316
  error estimate for blocks of size 2^( 4) =       0.000551888792
  error estimate for blocks of size 2^( 5) =       0.000558552203
  error estimate for blocks of size 2^( 6) =       0.000561222765
  error estimate for blocks of size 2^( 7) =       0.000560570644

      target function =                  N/A
              le_mean =     -22.825590336218
             les_mean =     521.523447704702
             stat err =       0.000558058601
             autocorr =       1.207386081192
              std dev =       0.718243528205
             le_variance =       0.515873765808


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282559033622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825590336218       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825590336218       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825590336218       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825590336218       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825590336218       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825590336217       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825590336218       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825590336218       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825590336218       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8592e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8213
    reference variance = 0.488007
====================================================
  Execution time = 4.3014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0345e-01
  Total weights = 2.0000e+06
  Execution time = 3.4871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501723016
  error estimate for blocks of size 2^( 2) =       0.000519206105
  error estimate for blocks of size 2^( 3) =       0.000535594284
  error estimate for blocks of size 2^( 4) =       0.000547559830
  error estimate for blocks of size 2^( 5) =       0.000555235060
  error estimate for blocks of size 2^( 6) =       0.000559440037
  error estimate for blocks of size 2^( 7) =       0.000562726494

      target function =                  N/A
              le_mean =     -22.825191648074
             les_mean =     521.492825490130
             stat err =       0.000556240355
             autocorr =       1.229127507865
              std dev =       0.709543494487
             le_variance =       0.503451970569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501723016
  error estimate for blocks of size 2^( 2) =       0.000519206105
  error estimate for blocks of size 2^( 3) =       0.000535594284
  error estimate for blocks of size 2^( 4) =       0.000547559830
  error estimate for blocks of size 2^( 5) =       0.000555235060
  error estimate for blocks of size 2^( 6) =       0.000559440037
  error estimate for blocks of size 2^( 7) =       0.000562726494

      target function =                  N/A
              le_mean =     -22.825191648074
             les_mean =     521.492825490130
             stat err =       0.000556240355
             autocorr =       1.229127507865
              std dev =       0.709543494487
             le_variance =       0.503451970569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501723016
  error estimate for blocks of size 2^( 2) =       0.000519206105
  error estimate for blocks of size 2^( 3) =       0.000535594284
  error estimate for blocks of size 2^( 4) =       0.000547559830
  error estimate for blocks of size 2^( 5) =       0.000555235060
  error estimate for blocks of size 2^( 6) =       0.000559440037
  error estimate for blocks of size 2^( 7) =       0.000562726494

      target function =                  N/A
              le_mean =     -22.825191648074
             les_mean =     521.492825490130
             stat err =       0.000556240355
             autocorr =       1.229127507865
              std dev =       0.709543494487
             le_variance =       0.503451970569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503459406037
                                         uncertainty =       0.003763902759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501723016
  error estimate for blocks of size 2^( 2) =       0.000519206105
  error estimate for blocks of size 2^( 3) =       0.000535594284
  error estimate for blocks of size 2^( 4) =       0.000547559830
  error estimate for blocks of size 2^( 5) =       0.000555235060
  error estimate for blocks of size 2^( 6) =       0.000559440037
  error estimate for blocks of size 2^( 7) =       0.000562726494

      target function =                  N/A
              le_mean =     -22.825191648074
             les_mean =     521.492825490130
             stat err =       0.000556240355
             autocorr =       1.229127507865
              std dev =       0.709543494487
             le_variance =       0.503451970569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825191648074        initial  <--
     1.5259e+24     1.5259e+25             0.0000e+00       -22.825191648074
     6.1035e+24     6.1035e+25             0.0000e+00       -22.825191648074
     2.4414e+25     2.4414e+26             0.0000e+00       -22.825191648074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5720
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1917e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8372
    reference variance = 0.712595
====================================================
  Execution time = 4.3905e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4954e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516286491974
                                         uncertainty =       0.008980402119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516286491974
                                         uncertainty =       0.008980402119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508038313
  error estimate for blocks of size 2^( 2) =       0.000525783028
  error estimate for blocks of size 2^( 3) =       0.000540924582
  error estimate for blocks of size 2^( 4) =       0.000551475218
  error estimate for blocks of size 2^( 5) =       0.000557247492
  error estimate for blocks of size 2^( 6) =       0.000559525789
  error estimate for blocks of size 2^( 7) =       0.000560315288

      target function =                  N/A
              le_mean =     -22.825183394314
             les_mean =     521.505202581618
             stat err =       0.000557140947
             autocorr =       1.202644375035
              std dev =       0.718474672931
             le_variance =       0.516205855643


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282518339431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825183394314       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+25 is 1.918473e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825183394314       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+25 is 4.796181e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825183394314       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825183394314       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+26 is 1.199045e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8865e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7961
    reference variance = 0.659337
====================================================
  Execution time = 4.5600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0535e-01
  Total weights = 2.0000e+06
  Execution time = 3.5005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502668165
  error estimate for blocks of size 2^( 2) =       0.000520594985
  error estimate for blocks of size 2^( 3) =       0.000536697892
  error estimate for blocks of size 2^( 4) =       0.000547935779
  error estimate for blocks of size 2^( 5) =       0.000554422180
  error estimate for blocks of size 2^( 6) =       0.000556798160
  error estimate for blocks of size 2^( 7) =       0.000561776982

      target function =                  N/A
              le_mean =     -22.825378617608
             les_mean =     521.503259353349
             stat err =       0.000555233275
             autocorr =       1.220079719056
              std dev =       0.710880136790
             le_variance =       0.505350568882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502668165
  error estimate for blocks of size 2^( 2) =       0.000520594985
  error estimate for blocks of size 2^( 3) =       0.000536697892
  error estimate for blocks of size 2^( 4) =       0.000547935779
  error estimate for blocks of size 2^( 5) =       0.000554422180
  error estimate for blocks of size 2^( 6) =       0.000556798160
  error estimate for blocks of size 2^( 7) =       0.000561776982

      target function =                  N/A
              le_mean =     -22.825378617608
             les_mean =     521.503259353349
             stat err =       0.000555233275
             autocorr =       1.220079719056
              std dev =       0.710880136790
             le_variance =       0.505350568882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502668165
  error estimate for blocks of size 2^( 2) =       0.000520594985
  error estimate for blocks of size 2^( 3) =       0.000536697892
  error estimate for blocks of size 2^( 4) =       0.000547935779
  error estimate for blocks of size 2^( 5) =       0.000554422180
  error estimate for blocks of size 2^( 6) =       0.000556798160
  error estimate for blocks of size 2^( 7) =       0.000561776982

      target function =                  N/A
              le_mean =     -22.825378617608
             les_mean =     521.503259353349
             stat err =       0.000555233275
             autocorr =       1.220079719056
              std dev =       0.710880136790
             le_variance =       0.505350568882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505328648094
                                         uncertainty =       0.003821414036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502668165
  error estimate for blocks of size 2^( 2) =       0.000520594985
  error estimate for blocks of size 2^( 3) =       0.000536697892
  error estimate for blocks of size 2^( 4) =       0.000547935779
  error estimate for blocks of size 2^( 5) =       0.000554422180
  error estimate for blocks of size 2^( 6) =       0.000556798160
  error estimate for blocks of size 2^( 7) =       0.000561776982

      target function =                  N/A
              le_mean =     -22.825378617608
             les_mean =     521.503259353349
             stat err =       0.000555233275
             autocorr =       1.220079719056
              std dev =       0.710880136790
             le_variance =       0.505350568882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825378617608        initial  <--
     1.5259e+25     1.5259e+26             1.9185e-30       -22.825378617608
     6.1035e+25     6.1035e+26             4.7962e-31       -22.825378617608
     2.4414e+26     2.4414e+27             1.1990e-31       -22.825378617608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1551
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2203e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.895
    reference variance = 0.44027
====================================================
  Execution time = 4.4305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.2674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5196e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526859918645
                                         uncertainty =       0.021136384675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526859918645
                                         uncertainty =       0.021136384675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513195038
  error estimate for blocks of size 2^( 2) =       0.000530872389
  error estimate for blocks of size 2^( 3) =       0.000546571869
  error estimate for blocks of size 2^( 4) =       0.000557341667
  error estimate for blocks of size 2^( 5) =       0.000564662948
  error estimate for blocks of size 2^( 6) =       0.000567652059
  error estimate for blocks of size 2^( 7) =       0.000569905574

      target function =                  N/A
              le_mean =     -22.825677178902
             les_mean =     521.538276705279
             stat err =       0.000564890562
             autocorr =       1.211612489001
              std dev =       0.725767382293
             le_variance =       0.526738293201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282567717890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825677178902       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825677178902       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825677178902       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+26 is 2.113497e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825677178902       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825677178902       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825677178902       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825677178902       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825677178917       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+27 is 1.320935e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9506e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8607
    reference variance = 0.263985
====================================================
  Execution time = 4.3479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0252e-01
  Total weights = 2.0000e+06
  Execution time = 3.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501259239
  error estimate for blocks of size 2^( 2) =       0.000519124139
  error estimate for blocks of size 2^( 3) =       0.000535048022
  error estimate for blocks of size 2^( 4) =       0.000546228589
  error estimate for blocks of size 2^( 5) =       0.000554279503
  error estimate for blocks of size 2^( 6) =       0.000557428032
  error estimate for blocks of size 2^( 7) =       0.000561553126

      target function =                  N/A
              le_mean =     -22.824923608716
             les_mean =     521.479659142345
             stat err =       0.000554872312
             autocorr =       1.225353308307
              std dev =       0.708887614427
             le_variance =       0.502521649889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501259239
  error estimate for blocks of size 2^( 2) =       0.000519124139
  error estimate for blocks of size 2^( 3) =       0.000535048022
  error estimate for blocks of size 2^( 4) =       0.000546228589
  error estimate for blocks of size 2^( 5) =       0.000554279503
  error estimate for blocks of size 2^( 6) =       0.000557428032
  error estimate for blocks of size 2^( 7) =       0.000561553126

      target function =                  N/A
              le_mean =     -22.824923608716
             les_mean =     521.479659142345
             stat err =       0.000554872312
             autocorr =       1.225353308307
              std dev =       0.708887614427
             le_variance =       0.502521649889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501259239
  error estimate for blocks of size 2^( 2) =       0.000519124139
  error estimate for blocks of size 2^( 3) =       0.000535048022
  error estimate for blocks of size 2^( 4) =       0.000546228589
  error estimate for blocks of size 2^( 5) =       0.000554279503
  error estimate for blocks of size 2^( 6) =       0.000557428032
  error estimate for blocks of size 2^( 7) =       0.000561553126

      target function =                  N/A
              le_mean =     -22.824923608716
             les_mean =     521.479659142345
             stat err =       0.000554872312
             autocorr =       1.225353308307
              std dev =       0.708887614427
             le_variance =       0.502521649889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617523857
                                         uncertainty =       0.003439303409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501259239
  error estimate for blocks of size 2^( 2) =       0.000519124139
  error estimate for blocks of size 2^( 3) =       0.000535048022
  error estimate for blocks of size 2^( 4) =       0.000546228589
  error estimate for blocks of size 2^( 5) =       0.000554279503
  error estimate for blocks of size 2^( 6) =       0.000557428032
  error estimate for blocks of size 2^( 7) =       0.000561553126

      target function =                  N/A
              le_mean =     -22.824923608716
             les_mean =     521.479659142345
             stat err =       0.000554872312
             autocorr =       1.225353308307
              std dev =       0.708887614427
             le_variance =       0.502521649889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824923608716        initial  <--
     1.5259e+26     1.5259e+27             2.1135e-31       -22.824923608716
     6.1035e+26     6.1035e+27             0.0000e+00       -22.824923608716
     2.4414e+27     2.4414e+28             1.3209e-32       -22.824923608716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0111
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2052e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8462
    reference variance = 0.572735
====================================================
  Execution time = 4.4219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0826e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5167e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508300649883
                                         uncertainty =       0.004542450071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508300649883
                                         uncertainty =       0.004542450071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504114991
  error estimate for blocks of size 2^( 2) =       0.000521540273
  error estimate for blocks of size 2^( 3) =       0.000537450188
  error estimate for blocks of size 2^( 4) =       0.000548486817
  error estimate for blocks of size 2^( 5) =       0.000556169581
  error estimate for blocks of size 2^( 6) =       0.000559946964
  error estimate for blocks of size 2^( 7) =       0.000562963649

      target function =                  N/A
              le_mean =     -22.825348260109
             les_mean =     521.504786788674
             stat err =       0.000556891753
             autocorr =       1.220344219549
              std dev =       0.712926256739
             le_variance =       0.508263847548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282534826011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825348260109       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9444e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8448
    reference variance = 0.342621
====================================================
  Execution time = 4.3228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0023e-01
  Total weights = 2.0000e+06
  Execution time = 3.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500113923
  error estimate for blocks of size 2^( 2) =       0.000518318246
  error estimate for blocks of size 2^( 3) =       0.000534147794
  error estimate for blocks of size 2^( 4) =       0.000544972872
  error estimate for blocks of size 2^( 5) =       0.000551242644
  error estimate for blocks of size 2^( 6) =       0.000552675583
  error estimate for blocks of size 2^( 7) =       0.000555076924

      target function =                  N/A
              le_mean =     -22.824964749235
             les_mean =     521.479243425575
             stat err =       0.000550992006
             autocorr =       1.213815572387
              std dev =       0.707267892583
             le_variance =       0.500227871879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500113923
  error estimate for blocks of size 2^( 2) =       0.000518318246
  error estimate for blocks of size 2^( 3) =       0.000534147794
  error estimate for blocks of size 2^( 4) =       0.000544972872
  error estimate for blocks of size 2^( 5) =       0.000551242644
  error estimate for blocks of size 2^( 6) =       0.000552675583
  error estimate for blocks of size 2^( 7) =       0.000555076924

      target function =                  N/A
              le_mean =     -22.824964749235
             les_mean =     521.479243425575
             stat err =       0.000550992006
             autocorr =       1.213815572387
              std dev =       0.707267892583
             le_variance =       0.500227871879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500113923
  error estimate for blocks of size 2^( 2) =       0.000518318246
  error estimate for blocks of size 2^( 3) =       0.000534147794
  error estimate for blocks of size 2^( 4) =       0.000544972872
  error estimate for blocks of size 2^( 5) =       0.000551242644
  error estimate for blocks of size 2^( 6) =       0.000552675583
  error estimate for blocks of size 2^( 7) =       0.000555076924

      target function =                  N/A
              le_mean =     -22.824964749235
             les_mean =     521.479243425575
             stat err =       0.000550992006
             autocorr =       1.213815572387
              std dev =       0.707267892583
             le_variance =       0.500227871879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500361533493
                                         uncertainty =       0.002949021357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500113923
  error estimate for blocks of size 2^( 2) =       0.000518318246
  error estimate for blocks of size 2^( 3) =       0.000534147794
  error estimate for blocks of size 2^( 4) =       0.000544972872
  error estimate for blocks of size 2^( 5) =       0.000551242644
  error estimate for blocks of size 2^( 6) =       0.000552675583
  error estimate for blocks of size 2^( 7) =       0.000555076924

      target function =                  N/A
              le_mean =     -22.824964749235
             les_mean =     521.479243425575
             stat err =       0.000550992006
             autocorr =       1.213815572387
              std dev =       0.707267892583
             le_variance =       0.500227871879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824964749235        initial  <--
     1.5259e+27     1.5259e+28             0.0000e+00       -22.824964749235
     6.1035e+27     6.1035e+28             0.0000e+00       -22.824964749235
     2.4414e+28     2.4414e+29             0.0000e+00       -22.824964749235

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7911
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.664785e-01 1 1  ON 0
 uu_1                 9.249791e-02 1 1  ON 1
 uu_2                -1.873836e-02 1 1  ON 2
 uu_3                -8.391666e-02 1 1  ON 3
 uu_4                -1.211233e-01 1 1  ON 4
 uu_5                -1.433661e-01 1 1  ON 5
 uu_6                -1.555999e-01 1 1  ON 6
 uu_7                -1.568651e-01 1 1  ON 7
 uu_8                -1.435380e-01 1 1  ON 8
 uu_9                -1.063369e-01 1 1  ON 9
 ud_0                 4.385537e-01 1 1  ON 10
 ud_1                 1.563150e-01 1 1  ON 11
 ud_2                 1.048407e-02 1 1  ON 12
 ud_3                -6.939524e-02 1 1  ON 13
 ud_4                -1.163766e-01 1 1  ON 14
 ud_5                -1.459842e-01 1 1  ON 15
 ud_6                -1.638423e-01 1 1  ON 16
 ud_7                -1.693210e-01 1 1  ON 17
 ud_8                -1.575851e-01 1 1  ON 18
 ud_9                -1.246156e-01 1 1  ON 19
 eC_0                -5.615614e-01 1 1  ON 20
 eC_1                -4.069794e-01 1 1  ON 21
 eC_2                -1.565499e-01 1 1  ON 22
 eC_3                -7.987768e-03 1 1  ON 23
 eC_4                 4.417919e-02 1 1  ON 24
 eC_5                 1.354073e-01 1 1  ON 25
 eC_6                 2.551367e-01 1 1  ON 26
 eC_7                 3.887735e-01 1 1  ON 27
 eC_8                 2.462328e-01 1 1  ON 28
 eC_9                 5.992555e-02 1 1  ON 29
 eO_0                -1.224971e+00 1 1  ON 30
 eO_1                -8.464792e-01 1 1  ON 31
 eO_2                -3.681019e-01 1 1  ON 32
 eO_3                -2.412489e-02 1 1  ON 33
 eO_4                 2.024772e-01 1 1  ON 34
 eO_5                 3.832420e-01 1 1  ON 35
 eO_6                 4.683378e-01 1 1  ON 36
 eO_7                 5.218841e-01 1 1  ON 37
 eO_8                 4.602166e-01 1 1  ON 38
 eO_9                 2.918671e-01 1 1  ON 39
eH1_0                -1.820724e-01 1 1  ON 40
eH1_1                -9.474380e-02 1 1  ON 41
eH1_2                -6.220772e-02 1 1  ON 42
eH1_3                -4.723862e-02 1 1  ON 43
eH1_4                 1.240465e-02 1 1  ON 44
eH1_5                 6.672331e-02 1 1  ON 45
eH1_6                 1.201585e-01 1 1  ON 46
eH1_7                 9.196335e-02 1 1  ON 47
eH1_8                 4.802469e-03 1 1  ON 48
eH1_9                 1.150723e-02 1 1  ON 49
eH2_0                -1.833490e-01 1 1  ON 50
eH2_1                -9.544022e-02 1 1  ON 51
eH2_2                -6.231671e-02 1 1  ON 52
eH2_3                -4.741996e-02 1 1  ON 53
eH2_4                 1.191652e-02 1 1  ON 54
eH2_5                 6.667528e-02 1 1  ON 55
eH2_6                 1.195978e-01 1 1  ON 56
eH2_7                 9.197163e-02 1 1  ON 57
eH2_8                -2.462295e-04 1 1  ON 58
eH2_9                 1.429020e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2024e+02 secs
  Total Execution time = 4.8512e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
